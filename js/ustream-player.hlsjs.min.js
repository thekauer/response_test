(self.webpackChunkustreamPlayer=self.webpackChunkustreamPlayer||[]).push([[602],{33492:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return Jh}});var n=r(82971),a=r.n(n),i=r(43308),o=r(75069),s=r(38727),u=r(71489),c=r.n(u),l=r(31065),d=r(25657),f=r(87757),h="SET_VIDEO_TAG_DURATION",p="SET_INIT_PTS",g="SET_CAN_PLAY",v="SET_CAPTION_POSITION",m=r(83935),y=r(29186),b=r(97894),S="SET_SELECTED_QUALITY",E="SET_QUALITY_LOADING",T="SET_QUALITIES";function w(e){return{type:S,payload:{id:e}}}function O(e){return{type:E,payload:{loading:e}}}function A(e){return{type:T,payload:{qualities:e}}}var _="SET_INITIAL_LOADING_TIME",R="SET_UMS_CONNECTION_START_TIME",k="SET_UMS_CONNECTION_CONNECTED_TIME",P="SET_STREAM_MODULE_RECEIVED_TIME",C="SET_FIRST_FRAME_TIME",L="SET_BUFFERING_START_TIME",D="SET_QUALITY_CHANGE_START_TIME";function I(e){return{type:R,payload:e}}function x(e){return{type:k,payload:e}}function M(e){return{type:L,payload:e}}var U=r(93492),j=r(70427),F=r(62074),N=r(50812),B=r(60461),G=r(36891),V=r(38209),K=r(45878),H=r(17719),Z=r(3494),Y=r(87212),q="SET_ADS_PLAYING",W="SET_RULESET",z={PRE:"pre",MID:"mid",POST:"post"},X={DELAY:"delay",GOOGLE:"googleads"},Q="SET_STREAM_MODULE",$="SET_META_MODULE",J="SET_ALL_TIME_TOTAL_MODULE",ee="SET_ALL_VIEWERS_MODULE",te="SET_VIEWERS_MODULE",re="SET_LOGO_MODULE",ne="SET_SHARE_MODULE",ae="SET_BROADCASTER_MODULE",ie="SET_LIVE_CTA_MODULE",oe="SET_THUMBNAIL_MODULE",se="SET_POLL_MODULE",ue="SET_CAPTION_SEARCH_MODULE",ce="SET_SLIDES_MODULE";function le(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function de(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?le(Object(r),!0).forEach((function(t){fe(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):le(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function fe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var he={adsPlaying:!1,ruleset:null,adIndex:0,position:z.PRE,enabled:void 0};function pe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ge(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?pe(Object(r),!0).forEach((function(t){ve(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ve(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var me={userName:null,benefits:[]},ye=r(36811),be="RESET",Se={offAir:"OFF_AIR",mediaChange:"MEDIA_CHANGE"};function Ee(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Se.mediaChange;if(!Object.values(Se).includes(e))throw new Error("Invalid reset type");return{type:be,payload:{type:e}}}function Te(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function we(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Te(Object(r),!0).forEach((function(t){Oe(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Te(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Oe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Ae={panelVisibility:!1,visibility:!1,searchResult:null},_e=r(42640);function Re(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ke(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Re(Object(r),!0).forEach((function(t){Pe(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Re(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Pe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Ce={activeCues:[],options:{}},Le=r(52097),De=r(74504),Ie="SET_INITIAL_SEEK_TIME_IN_MS",xe="SET_INITIAL_API_SEEK_TIME_IN_MS",Me="SET_MEDIA_CHANGE",Ue=r(79884),je=r(80253),Fe=r(72177),Ne=r(304);function Be(e){return!(e!==m.w_.recorded&&e!==m.w_.offairVideo||Ue.Z.isDashboard)}function Ge(e){var t=e.mediaType,r=e.initialSeekTimeInMs;if(Be(t)){if(r)return r;var n=(0,je.hB)({content:e}).id,a=Fe.Z.getSavedProgressToVideoId(n);if(a)return a.progress-Ne.Z.CONTINUE_WATCHING_OFFSET_IN_MS}}var Ve=r(29020);function Ke(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function He(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ke(Object(r),!0).forEach((function(t){Ze(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ke(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ze(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ye(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i=[],o=!0,s=!1;try{for(r=r.call(e);!(o=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);o=!0);}catch(e){s=!0,a=e}finally{try{o||null==r.return||r.return()}finally{if(s)throw a}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return qe(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?qe(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function qe(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var We={title:void 0,offairTitle:void 0,duration:void 0,trimmedDuration:void 0,initialSeekTimeInMs:void 0,initialApiSeekTimeInMs:void 0,audioOnly:!1,videoOnly:!1,mediaId:"",streamInfo:{},mediaType:void 0,isReplay:!1,thumbnails:{},trimInfo:void 0,defaultLang:void 0,liveStatus:void 0,is360Video:void 0,fov360Video:void 0,offairContent:void 0,currentOffairVideoId:void 0,channelContentAvailable:void 0,countryCode:void 0,regionCode:void 0,cluster:void 0,isAudioOnlyPlaybackAvailable:!1,sourceMedia:void 0};function ze(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,1],r=Ye(t,2),n=r[0],a=r[1];return e*(a-n)}function Xe(e){return e.startsWith("channel")}var Qe=r(25790);function $e(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Je(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?$e(Object(r),!0).forEach((function(t){et(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$e(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function et(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var tt={showHiddenContextMenuItems:!1},rt=r(38891);function nt(e){return function(e){if(Array.isArray(e))return at(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return at(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?at(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function at(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function it(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ot(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?it(Object(r),!0).forEach((function(t){st(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):it(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function st(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ut={keyFrameInterval:"N/A",INIT:{groupId:"FLOT",status:N.Q.LOADING,data:[]},TIMING:{groupId:"FLOT",status:N.Q.LOADING,data:[],timeToStartInMs:null},DISCONNECTS:{groupId:"FLOT",status:N.Q.SUCCESS,data:[]},REJECTS:{groupId:"FLOT",status:N.Q.SUCCESS,data:[]},EMPTY_MODULE:{groupId:"FLOT",status:N.Q.SUCCESS,data:[]},DOWNLOAD:{groupId:"QOS",isEcdn:!1,status:N.Q.SUCCESS,data:[],highestTotal:0},EMPTY_CHUNK:{groupId:"PLAYBACK",status:N.Q.SUCCESS,data:[]},PLAYBACK_RECOVERABLE:{groupId:"PLAYBACK",status:N.Q.SUCCESS,data:[]},PLAYBACK_NON_RECOVERABLE:{groupId:"PLAYBACK",status:N.Q.SUCCESS,data:[]}},ct=function(e,t){var r=nt(e),n=r.length,a=r[n-1],i=a&&a[a.length-1],o=function(e){return e.msg===t.msg&&t.timeStamp-e.timeStamp<3e3};return Array.isArray(a)&&o(i)?r[n-1]=[].concat(nt(a),[t]):a&&o(a)?r[n-1]=[a,t]:r=[].concat(nt(e),[t]),r},lt=r(97399);function dt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ft(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?dt(Object(r),!0).forEach((function(t){ht(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ht(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var pt={};function gt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function vt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?gt(Object(r),!0).forEach((function(t){mt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function mt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var yt={};function bt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function St(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?bt(Object(r),!0).forEach((function(t){Et(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Et(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Tt(e){return"secureUrl"in e}function wt(e){var t=e.find(Tt);if(!t)return null;var r=t.secureUrl,n=t.clickUrl;return n?{url:r,clickUrl:n}:{url:r}}var Ot={showDefaultLogo:!1,customLogo:null},At=r(23353),_t=r(65529);function Rt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function kt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Rt(Object(r),!0).forEach((function(t){Pt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Rt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Pt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Ct={visible:!1,message:"",icon:"",isPermanent:!1,timeoutInMs:null},Lt={fullScreen:!1,volume:100,speed:1,theaterMode:{visible:function(){if((0,Y.j)("theaterVisible"))return!0;var e=document.querySelector(".ve-container"),t=e&&!e.classList.contains("no-rightbar")&&!e.classList.contains("no-socialstream");return!(!(0,Y.j)("sitemode")||!t)}(),enabled:!1},statsOverlayVisible:!1,debugOverlayVisible:!1,assistedReportingOverlayVisible:!1,playerSize:{width:0,height:0},isBrowserOldNotificationVisible:!1,isAssistedReportingNotificationVisible:!1,isAssistedReportingNotificationClosedByUser:!1,loading:!1,messageScreens:Object.values(_t.Oh).reduce((function(e,t){return kt(kt({},e),{},Pt({},t,Ct))}),{})};function Dt(e){var t=e;return e>100?t=100:e<0&&(t=0),t}function It(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function xt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?It(Object(r),!0).forEach((function(t){Mt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):It(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Mt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Ut={},jt=r(81984),Ft=r(76741);function Nt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Bt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Nt(Object(r),!0).forEach((function(t){Gt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Nt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Gt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Vt={isBufferEmpty:!0,webkitSupportsFullscreen:!1,audioTracks:[],closedCaptionTracks:[],selectedAudio:-1,selectedClosedCaption:-2,closedCaptionSelection:null,closedCaptionVisible:!0,captionPosition:-4,stats:{storages:{},buffers:{}},statsLastUpdatedAt:0,videoResolution:"",playing:!!(0,Y.j)("autoplay"),currentTime:0,initPTS:void 0,ended:!1,firstTimeUpdateReceived:!1,ready:!1,videoTagDuration:void 0,canPlay:!1,videoTrackDisabled:!1};function Kt(e){var t=e.prevTracks,r=e.nextTracks,n=e.selectedTrack,a=t.find((function(e){return e.id===n}));if(!a)return-1;var i=r.filter((function(e){var t=e.language,r=e.country;return t===a.language&&r===a.country})),s=i.find((function(e){return e.id===a.id}));return s?s.id:(0,o.default)(i,"0.id",-1)}var Ht=r(40576);function Zt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Yt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Zt(Object(r),!0).forEach((function(t){qt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Zt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function qt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Wt={finalResult:[],fallback:"",location:"",preferredLocation:[],cdnConfig:{},currentProvider:void 0,forcedUrl:"",contentAccess:{masterPlaylist:null,providerQueryParam:"cdnHost",isLive:void 0}};function zt(e){return e.startsWith("channel")}var Xt=r(70875);function Qt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function $t(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Qt(Object(r),!0).forEach((function(t){Jt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Qt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Jt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var er={selectedId:-1,qualities:[],loading:!1,stats:{},statsLastUpdatedAt:0};function tr(e){var t=20*Math.round(e.height/20);return{text:"".concat(t,"p"),suffix:t>=720?" HD":"",bitrate:function(e){var t=e/1e3;if(t>=1e3){var r=t/1e3,n=Math.round(10*r)/10;return" @ ".concat(n," Mbps")}return" @ ".concat(Math.round(t)," kbps")}(e.bitrate)}}var rr=r(3515);function nr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ar(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?nr(Object(r),!0).forEach((function(t){ir(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ir(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var or={activeMarker:void 0},sr=r(47157),ur=r(81);function cr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function lr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?cr(Object(r),!0).forEach((function(t){dr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function dr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fr(){return{debug:ur.ZP.get(ur.Bx)||!!(0,Y.j)("debug"),isTitleVisible:!0}}function hr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function pr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?hr(Object(r),!0).forEach((function(t){gr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function gr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var vr={facebook:void 0,twitter:void 0,mail:void 0,embed:void 0,copyLink:void 0,enabled:!1},mr=r(45663);function yr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function br(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?yr(Object(r),!0).forEach((function(t){Sr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Sr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Er={isEnabled:!1,slides:[],currentSlide:null,slideIndexPanelVisible:!1,onboarding:!1,module:null};function Tr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function wr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Tr(Object(r),!0).forEach((function(t){Or(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Tr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Or(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Ar={initialLoadingTime:void 0,umsConnectionStartTime:void 0,umsConnectionConnectedTime:void 0,streamModuleReceivedTime:void 0,firstFrameTime:void 0,bufferingStartTime:void 0,qualityChangeStartTime:void 0},_r=r(8834),Rr=(0,l.w)("shared/ui/screen/hashlockadvanced");function kr(){var e=(0,j.V4)(ii.getState())===m.w_.recorded?Ue.Z.cId:(0,j.lB)(ii.getState()).id;return"c:token-".concat(e)}function Pr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,j.lB)(ii.getState()).id;return"v:token-".concat(e)}function Cr(e){var t=e.hash,r="video"===e.mediaType?Pr():kr();ur.ZP.set(r,t,{expires:Ir(t)})}function Lr(){var e=(0,j.V4)(ii.getState()),t=e===m.w_.recorded,r=e===m.w_.offairVideo;if(t||r){var n=ur.ZP.get(kr());if(n)return n;var a=(0,j.nu)(ii.getState());return a?ur.ZP.get(Pr(a)):void 0}}function Dr(){var e=(0,j.V4)(ii.getState())===m.w_.recorded;return"ustreamEmbedHash-".concat(e?Ue.Z.cId:(0,j.lB)(ii.getState()).id)}function Ir(e){var t=function(e){var t;try{t=JSON.parse(e)}catch(t){return void Rr.error("Failed to parse hash",e)}return t}(e);if(!t)return 14;var r=function(e){var t=function(e){var t=e.find((function(e){return Object.keys(e).includes("hashExpire")}));if(t)return Object.values(t).pop()}(e);return new Date(1e3*t)}(t);return isNaN(r.getTime())?14:r}var xr={saveHashToLocalStorage:Cr,getHashFromLocalStorage:function(){var e=(0,o.default)(Ue.Z,"hash"),t=(0,j.V4)(ii.getState())===m.w_.recorded;if(e)return e;var r=t?Pr():kr(),n=ur.ZP.get(r);if(n)return n;var a=Lr();if(a)return a;var i=ur.ZP.get(Dr());return i&&Cr({hash:i}),i},getFallbackHash:Lr,removeCurrentHashFromLocalStorage:function(){if(ur.ZP.set(Dr(),null),(0,j.V4)(ii.getState())===m.w_.recorded){var e=Pr();if(ur.ZP.get(e))return void ur.ZP.set(e,null)}ur.ZP.set(kr(),null)},getPasswordFromSessionStorage:function(){var e=((0,j.V4)(ii.getState())===m.w_.recorded?"v:":"c:")+(0,j.lB)(ii.getState()).id,t="c:".concat(Ue.Z.cId),r="ustreamContentPw-".concat(e),n="ustreamContentPw-".concat(t);try{var a=window.sessionStorage.getItem(r);if(a)return JSON.parse(a).value;var i=window.sessionStorage.getItem(n);return JSON.parse(i).value}catch(e){return}}};function Mr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ur(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Mr(Object(r),!0).forEach((function(t){jr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Mr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function jr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Fr={hash:void 0,password:void 0,info:{},id:null,lock:{type:"",data:{}},viewerAuthToken:(0,Y.j)("viewerToken")};function Nr(e){return"false"!==e}function Br(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Gr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Br(Object(r),!0).forEach((function(t){Vr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Br(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Vr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Kr={allTimeTotal:null,allViewers:null,viewers:null},Hr=r(26879);function Zr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Yr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Zr(Object(r),!0).forEach((function(t){qr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Zr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function qr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Wr={ibmCookie:void 0},zr=r(90271);function Xr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Qr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Xr(Object(r),!0).forEach((function(t){$r(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Xr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function $r(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Jr={panelVisible:!1,markersVisible:!0,chapters:[]};function en(e){return e.startsWith("channel")}var tn={key:"root",storage:Z.Z,whitelist:[]},rn={key:"captionSettings",storage:Z.Z,whitelist:["options"]},nn={key:"mte_viewer_volume",storage:Z.Z,whitelist:["volume"],transforms:[{in:function(e){return e},out:function(e,t){if("volume"===t){var r=(0,Y.j)("volume");return void 0!==r?r:e}return e}}]},an=(0,G.UY)({ads:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:he,t=arguments.length>1?arguments[1]:void 0,r=t.type,n=t.payload;switch(r){case q:return de(de({},e),{},{adsPlaying:n.adsPlaying});case W:return de(de({},e),{},{ruleset:n.ruleset});case $:var a=n.module.adIntegration;return de(de({},e),{},{enabled:!!a&&a.hasBenefit&&a.hasSettings});default:return e}},broadcaster:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:me,t=arguments.length>1?arguments[1]:void 0,r=t.type,n=t.payload;switch(r){case $:var a=n.module,i=ge({},e),s=(0,o.default)(a,"userName",null);i.userName=s;var u=(0,o.default)(a,"broadcaster.benefits");return Array.isArray(u)&&(i.benefits=u),i;case ae:var c=n.module,l=(0,o.default)(c,"benefits",[]);return ge(ge({},e),{},{benefits:l});default:return e}},captionSearch:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ae,t=arguments.length>1?arguments[1]:void 0,r=t.type,n=t.payload;switch(r){case ye.Z.toggleCaptionSearchPanel:return we(we({},e),{},{panelVisibility:n.panelVisibility});case ye.Z.setSearchText:return we(we({},e),{},{searchText:n.searchText});case ue:var a=n.module,i=!1;return"boolean"==typeof a?i=a:a.token&&(i=!0),we(we({},e),{},{module:a,visibility:i});case ye.Z.setSearchResult:var o=n.searchResult;return Array.isArray(o)?we(we({},e),{},{searchResult:o.slice().sort((function(e,t){return e.start_sec-t.start_sec}))}):we(we({},e),{},{searchResult:o});case ye.Z.toggleCaptionSearchComponent:return we(we({},e),{},{visibility:n.visibility});case be:var s=n.type;return s===Se.mediaChange?Ae:we(we({},Ae),{},{panelVisibility:e.panelVisibility,searchText:e.searchText});default:return e}},captionSettings:(0,K.OJ)(rn,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ce,t=arguments.length>1?arguments[1]:void 0,r=t.type,n=t.payload;switch(r){case _e.Z.setActiveCues:return ke(ke({},e),{},{activeCues:n});case _e.Z.setOptions:var a=(0,Y.j)("externalvtt")?e.options:ke(ke({},e.options),n);return a.live?(a.textAlignLive=a.textAlign,delete a.textAlign):(a.textAlignVod=a.textAlign,delete a.textAlign),ke(ke({},e),{},{options:a});case _e.Z.resetOptions:return ke(ke({},e),{},{options:{}});case be:return ke(ke({},e),{},{activeCues:[]});default:return e}})),chapters:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Jr,t=arguments.length>1?arguments[1]:void 0,r=t.type,n=t.payload;switch(r){case zr.Z.setChapterMarkersVisibility:return Qr(Qr({},e),{},{markersVisible:n});case zr.Z.setChaptersPanelVisibility:return Qr(Qr({},e),{},{panelVisible:n});case $:var a=n.module.chapters,i=n.mediaId;if("string"==typeof i&&en(i))return e;if(!a||0===a.length)return Qr(Qr({},e),{},{chapters:[]});var o=a.map((function(e){return{position:e.position,title:e.title}})).sort((function(e,t){return e.position-t.position}));return Qr(Qr({},e),{},{chapters:o});default:return e}},content:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:We,t=arguments.length>1?arguments[1]:void 0,r=t.type,n=t.payload;switch(r){case De.Z.setStreamInfo:return He(He({},e),{},{streamInfo:n.streamInfo});case De.Z.setMediaType:return He(He({},e),{},{mediaType:n});case De.Z.setCurrentOffairVideoId:return He(He({},e),{},{currentOffairVideoId:n});case $:var a=n.module,i=n.mediaId,s=a.cluster,u=a.video360,c=a.video360Fov,l=a.live360,d=a.live360Fov,f=a.isReplay,h=a.cut,p=a.highlight,g=a.videoLength,v=a.defaultLang,y=h||p,b=c||d;b=b?(0,Le.Z)(parseInt(b,10),{lower:0,upper:360}):void 0;var S,E,T,w=e.duration,O=e.trimmedDuration,A=e.trimInfo;return g&&(O=ze(w=g,y),A=y),Xe(i)||e.mediaType!==m.w_.offairVideo?(S=a.offairContent,E=(0,o.default)(a,"title",""),T=e.offairTitle):(S=e.offairContent,E=e.title,T=(0,o.default)(a,"title","")),He(He({},e),{},{isReplay:f,title:E,offairTitle:T,countryCode:(0,o.default)(a,"countryCode",e.countryCode),regionCode:(0,o.default)(a,"regionCode",e.regionCode),is360Video:u||l,fov360Video:b,offairContent:S,duration:w,trimmedDuration:O,trimInfo:A,initialSeekTimeInMs:Ge(e),cluster:s,defaultLang:v?v.replace("-00",""):void 0});case Q:var _=n.module,R=n.mediaId,k=e.isAudioOnlyPlaybackAvailable,P=e.sourceMedia;(0,Ve.M)(_)||(k=(0,o.default)(_,"streamFormats.hls/mp4/rfc.contentAccess.accessList.0.data.hasAudioOnlyPlaylist",!1),_.contentAvailable&&(P=_.sourceMedia));var C=Xe(R)?_.contentAvailable:e.channelContentAvailable;return He(He({},e),{},{sourceMedia:P,channelContentAvailable:C,isAudioOnlyPlaybackAvailable:k});case oe:return He(He({},e),{},{thumbnails:n.module});case De.Z.setLiveStatus:return He(He({},e),{},{liveStatus:n});case De.Z.setDuration:return He(He({},e),{},{duration:n});case De.Z.setTrimmedDuration:return He(He({},e),{},{trimmedDuration:n});case Ie:return He(He({},e),{},{initialSeekTimeInMs:n.initialSeekTimeInMs});case xe:return He(He({},e),{},{initialApiSeekTimeInMs:n});case Me:return He(He({},e),{},{mediaType:n.mediaType,mediaId:n.mediaId,liveStatus:void 0,offairContent:void 0,currentOffairVideoId:void 0,channelContentAvailable:void 0,initialSeekTimeInMs:void 0,setInitialApiSeekTimeInMs:void 0});case De.Z.toggleAudioOnly:return He(He({},e),{},{audioOnly:n});case De.Z.toggleVideoOnly:return He(He({},e),{},{videoOnly:n});case be:var L=n.type,D=L===Se.mediaChange?We.title:e.title;return He(He({},We),{},{mediaId:e.mediaId,mediaType:e.mediaType,offairContent:e.offairContent,liveStatus:e.liveStatus,currentOffairVideoId:e.currentOffairVideoId,channelContentAvailable:e.channelContentAvailable,title:D});default:return e}},contextMenu:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:tt,t=arguments.length>1?arguments[1]:void 0,r=t.type,n=t.payload;if(r===Qe.Z.toggleHiddenContextMenuItems){var a=n.isVisible;return Je(Je({},e),{},{showHiddenContextMenuItems:a})}return e},debug:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ut,t=arguments.length>1?arguments[1]:void 0,r=t.type,n=t.payload;switch(r){case rt.Z.addFlotInitDiagnostics:return ot(ot({},e),{},{INIT:ot(ot({},e.INIT),{},{status:n.inited?N.Q.SUCCESS:N.Q.ERROR})});case rt.Z.addFlotDisconnectError:return ot(ot({},e),{},{DISCONNECTS:ot(ot({},e.DISCONNECTS),{},{status:N.Q.WARNING,data:[].concat(nt(e.DISCONNECTS.data),[n])})});case rt.Z.addFlotRejectError:return ot(ot({},e),{},{REJECTS:ot(ot({},e.REJECTS),{},{status:N.Q.ERROR,data:[].concat(nt(e.REJECTS.data),[n])})});case rt.Z.addFlotTimingDiagnostics:return ot(ot({},e),{},{TIMING:ot(ot({},e.TIMING),{},{status:n.timeToStartInMs<=5e3?N.Q.SUCCESS:N.Q.WARNING,timeToStartInMs:n.timeToStartInMs})});case rt.Z.addFlotEmptyStreamModuleError:var a=n.isEmpty,i=!!e.EMPTY_MODULE.data.length;return i||a?ot(ot({},e),{},{EMPTY_MODULE:ot(ot({},e.EMPTY_MODULE),{},{status:N.Q.WARNING,data:[].concat(nt(e.EMPTY_MODULE.data),[n])})}):e;case rt.Z.addKeyFrameDiagnostics:return ot(ot({},e),{},{keyFrameInterval:n.keyFrameInterval>=0?n.keyFrameInterval:"N/A"});case rt.Z.addFrameAndDropRate:var o=n.frameRate,s=void 0===o?"N/A":o,u=n.dropRate,c=void 0===u?"N/A":u;return ot(ot({},e),{},{frameRate:s,dropRate:c});case rt.Z.addSlowChunkWarning:return ot(ot({},e),{},{DOWNLOAD:ot(ot({},e.DOWNLOAD),{},{status:N.Q.WARNING,data:[].concat(nt(e.DOWNLOAD.data),[n]),isEcdn:!!n.isEcdn,highestTotal:e.DOWNLOAD.highestTotal<n.total?n.total:e.DOWNLOAD.highestTotal})});case rt.Z.addChunkEmptyWarning:return ot(ot({},e),{},{EMPTY_CHUNK:ot(ot({},e.EMPTY_CHUNK),{},{status:N.Q.WARNING,data:[].concat(nt(e.EMPTY_CHUNK.data),[n])})});case rt.Z.addPlaybackWarning:case rt.Z.addPlaybackError:var l=r===rt.Z.addPlaybackError,d=l?N.Q.ERROR:N.Q.WARNING,f=l?"PLAYBACK_NON_RECOVERABLE":"PLAYBACK_RECOVERABLE";return ot(ot({},e),{},st({},f,ot(ot({},e[f]),{},{status:d,data:ct(e[f].data,n)})));case be:var h=n.type;return h===Se.mediaChange?ut:e;default:return e}},externalVtt:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pt,t=arguments.length>1?arguments[1]:void 0,r=t.type,n=t.payload;if(r===lt.Z.addExternalVtt){var a=n.vtt;return ft(ft({},e),{},{hasExternalVtt:!!a.length,vtt:a})}return e},liveCTA:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:yt,t=arguments.length>1?arguments[1]:void 0,r=t.type,n=t.payload;switch(r){case ie:var a=n.module,i=a.remove;if(i)return{};var o=a.activate;return o?vt({},o):e;case be:var s=n.type;return s===Se.mediaChange?yt:e;default:return e}},logo:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ot,t=arguments.length>1?arguments[1]:void 0,r=t.type,n=t.payload;switch(r){case re:var a=n.module,i=a&&a.some((function(e){return!Tt(e)})),o=a?wt(a):null;return St(St({},e),{},{showDefaultLogo:i,customLogo:o});case be:var s=n.type;return s===Se.mediaChange?Ot:e;default:return e}},playback:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Vt,t=arguments.length>1?arguments[1]:void 0,r=t.type,n=t.payload;switch(r){case Ft.Z.togglePlaying:return Bt(Bt({},e),{},{playing:n});case Ft.Z.selectAudio:var a=n.index,i=e.audioTracks.some((function(e){return e.id===a}));return i?Bt(Bt({},e),{},{selectedAudio:a}):e;case Ft.Z.selectClosedCaption:var s=e.closedCaptionTracks,u=n.index;return Bt(Bt({},e),{},{selectedClosedCaption:u,closedCaptionTracks:s.map((function(e){return Bt(Bt({},e),{},{active:e.id===u})})),closedCaptionVisible:-1!==u});case Ft.Z.setClosedCaptionTracks:var c=n.tracks,l=n.closedCaptionActiveFromLocalStorage,d=e.selectedClosedCaption,f=e.closedCaptionSelection;if(-2===d){var m=(0,o.default)(c.find((function(e){return e.default})),"id",null);m||0===m?(d=m,f="broadcaster"):l?(d=0,f="history"):(d=-1,f="manual")}return Bt(Bt({},e),{},{closedCaptionTracks:c,selectedClosedCaption:d,closedCaptionSelection:f});case Ft.Z.setAudioTracks:var y,b=n.tracks,S=Kt({prevTracks:e.audioTracks,nextTracks:b,selectedTrack:e.selectedAudio});if(-1===S){var E=b.find((function(e){return e.active}));y=E?E.id:-1}else y=S;return Bt(Bt({},e),{},{selectedAudio:y,audioTracks:b});case Ft.Z.setBufferEmpty:return Bt(Bt({},e),{},{isBufferEmpty:n.isBufferEmpty});case Ft.Z.setCurrentTime:return Bt(Bt({},e),{},{currentTime:n.currentTime});case Ft.Z.setEnded:return Bt(Bt({},e),{},{ended:n});case Ft.Z.setFirstTimeUpdateReceived:return Bt(Bt({},e),{},{firstTimeUpdateReceived:n});case Ft.Z.setPlaybackStats:return Bt(Bt({},e),{},{stats:{storages:{},buffers:n.stats},statsLastUpdatedAt:n.currentTime});case Ft.Z.setCodecInfo:var T=n.codec,w=T.width,O=T.height,A=T.audioCodec,_=T.videoCodec;return Bt(Bt({},e),{},{audio:{codec:A},video:{width:w,height:O,codec:_},videoResolution:w&&O?"".concat(w,"x").concat(O):""});case p:var R=n.initPTS;return Bt(Bt({},e),{},{initPTS:R});case Ft.Z.setReady:return Bt(Bt({},e),{},{ready:n});case h:var k=n.durationInSec,P=(0,jt.Z)(k)?void 0:k;return Bt(Bt({},e),{},{videoTagDuration:P});case g:var C=n.canPlay;return Bt(Bt({},e),{},{canPlay:C});case v:var L=n.captionPosition;return Bt(Bt({},e),{},{captionPosition:L});case Ft.Z.toggleVideoTrack:return Bt(Bt({},e),{},{videoTrackDisabled:n});case be:return Bt(Bt({},Vt),{},{ready:e.ready});default:return e}},player:(0,K.OJ)(nn,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Lt,t=arguments.length>1?arguments[1]:void 0,r=t.type,n=t.payload;switch(r){case At.Z.toggleFullScreen:return kt(kt({},e),{},{fullScreen:n});case At.Z.setVolume:return kt(kt({},e),{},{volume:Dt(n)});case At.Z.setPlaybackSpeed:return kt(kt({},e),{},{speed:n});case At.Z.toggleTheaterMode:var a=kt(kt({},e.theaterMode),n);return kt(kt({},e),{},{theaterMode:a});case At.Z.toggleStatsOverlay:return kt(kt({},e),{},{statsOverlayVisible:n,debugOverlayVisible:!1});case At.Z.toggleDebugOverlay:return kt(kt({},e),{},{debugOverlayVisible:n,statsOverlayVisible:!1});case At.Z.resize:return kt(kt({},e),{},{playerSize:n});case At.Z.toggleAssistedReportingOverlay:return kt(kt({},e),{},{debugOverlayVisible:!1,statsOverlayVisible:!1,assistedReportingOverlayVisible:n});case At.Z.showNotification:var i=n===_t.GT.oldBrowser||e.isBrowserOldNotificationVisible,o=n===_t.GT.assistedReporting||e.isAssistedReportingNotificationVisible,u=kt(kt({},e),{},{isBrowserOldNotificationVisible:i,isAssistedReportingNotificationVisible:o});return kt(kt({},e),u);case At.Z.hideNotification:var c=n!==_t.GT.oldBrowser&&e.isBrowserOldNotificationVisible,l=n!==_t.GT.assistedReporting&&e.isAssistedReportingNotificationVisible,d=kt(kt({},e),{},{isBrowserOldNotificationVisible:c,isAssistedReportingNotificationVisible:l});return kt(kt({},e),d);case At.Z.closeAssistedReportingNotificationByUser:var f=kt(kt({},e),{},{isAssistedReportingNotificationVisible:!1,isAssistedReportingNotificationClosedByUser:!0});return kt(kt({},e),f);case At.Z.toggleLoading:return kt(kt({},e),{},{loading:n});case be:return kt(kt({},e),(0,s.Z)(Lt,["speed","statsOverlayVisible","debugOverlayVisible","loading"]));case At.Z.showMessageScreen:var h=n.type,p=e.messageScreens,g=Object.keys(p).reduce((function(e,t){var r=t===h?kt(kt({},p[h]),{},{visible:!0},n):Ct;return kt(kt({},e),{},Pt({},t,r))}),{});return kt(kt({},e),{},{messageScreens:kt({},g)});case At.Z.hideMessageScreen:var v=n.type,m=e.messageScreens,y=kt(kt({},Ct),{},{visible:!1});return kt(kt({},e),{},{messageScreens:kt(kt({},m),{},Pt({},v,y))});default:return e}})),poll:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ut,t=arguments.length>1?arguments[1]:void 0,r=t.type,n=t.payload;switch(r){case se:var a=xt({},e),i=n.module,s=(0,o.default)(i,"pollStart");s&&(a=xt({},s));var u=(0,o.default)(i,"pollStop.stoppedAt");return u&&Object.assign(a,{stoppedAt:u}),a;case be:var c=n.type;return c===Se.mediaChange?Ut:e;default:return e}},privacy:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Wr,t=arguments.length>1?arguments[1]:void 0,r=t.type,n=t.payload;return r===Hr.Z.updatePrivacyCookie?Yr(Yr({},e),{},{ibmCookie:n}):e},provider:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Wt,t=arguments.length>1?arguments[1]:void 0,r=t.type,n=t.payload;switch(r){case Ht.Z.setProvidersStats:var a=(0,o.default)(n.stats,"finalResult",e.finalResult),i=(0,o.default)(n.stats,"fallback",e.fallback),s=(0,o.default)(n.stats,"location",e.location),u=(0,o.default)(n.stats,"preferredLocation",e.preferredLocation),c=(0,o.default)(n.stats,"cdnConfig",e.cdnConfig);return Yt(Yt({},e),{},{finalResult:a,fallback:i,location:s,preferredLocation:u,cdnConfig:c});case Ht.Z.setCurrentProvider:var l=n.provider;return Yt(Yt({},e),{},{currentProvider:l});case Ht.Z.setForcedProviderUrl:return Yt(Yt({},e),{},{forcedUrl:n.url});case Q:var d=n.module,f=n.mediaId,h=(0,o.default)(e,"contentAccess.isLive",!1),p=d.contentAvailable,g=void 0!==p&&p;if(!g&&h)return Yt(Yt({},e),{},{contentAccess:Wt.contentAccess});var v=(0,o.default)(d,"streamFormats.hls/mp4/rfc");if(!v)return e;var m=zt(f);if(h&&!m)return e;var y=(0,o.default)(v,"contentAccess.accessList.0.data",{}),b=y.url,S=y.parameter;return Yt(Yt({},e),{},{contentAccess:{masterPlaylist:b,providerQueryParam:S,isLive:m}});case be:var E=n.type,T=(0,o.default)(e,"contentAccess.isLive",!1);return E===Se.offAir&&T?Yt(Yt({},Wt),{},{contentAccess:e.contentAccess}):Wt;default:return e}},qos:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:er,t=arguments.length>1?arguments[1]:void 0,r=t.type,n=t.payload;switch(r){case S:return $t($t({},e),{},{selectedId:n.id});case E:return $t($t({},e),{},{loading:n.loading});case T:var a=n.qualities.map((function(e){return $t($t({},e),{},{label:tr(e)})}));return $t($t({},e),{},{qualities:a});case Xt.Z.setStatsData:return $t($t({},e),{},{stats:n.stats,statsLastUpdatedAt:n.currentTime});default:return e}},seekbar:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:or,t=arguments.length>1?arguments[1]:void 0,r=t.type,n=t.payload;switch(r){case rr.Z.setActiveMarker:return ar(ar({},e),{},{activeMarker:n.activeMarker});case rr.Z.clearActiveMarker:return or;default:return e}},settings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:fr(),t=arguments.length>1?arguments[1]:void 0,r=t.type,n=t.payload;switch(r){case sr.Z.toggleDebug:return lr(lr({},e),{},{debug:n});case sr.Z.toggleTitleVisibility:return lr(lr({},e),{},{isTitleVisible:n});default:return e}},share:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:vr,t=arguments.length>1?arguments[1]:void 0,r=t.type,n=t.payload;switch(r){case ne:var a=n.module,i=(0,s.Z)(a,["facebook","twitter","mail","embed","copy-link"]),o=i.facebook,u=i.twitter,c=i.mail,l=i.embed,d=i["copy-link"];return pr(pr({},e),{},{facebook:o,twitter:u,mail:c,embed:l,copyLink:d,enabled:!!a});case be:var f=n.type;return f===Se.mediaChange?vr:e;default:return e}},slideDeck:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Er,t=arguments.length>1?arguments[1]:void 0,r=t.type,n=t.payload;switch(r){case mr.Z.disable:return Er;case mr.Z.setSlides:var a=n.slides.slice().sort((function(e,t){return(0,o.default)(e,"start",-1)-(0,o.default)(t,"start",-1)}));return br(br({},e),{},{slides:a,isEnabled:!0});case mr.Z.setCurrentSlide:var i=(0,o.default)(n,"slide.url",""),s=i.length?n.slide:null;return br(br({},e),{},{currentSlide:s,isEnabled:!0});case mr.Z.setOnboarding:return br(br({},e),{},{onboarding:n.onboarding});case mr.Z.toggleSlideIndexPanel:return br(br({},e),{},{slideIndexPanelVisible:n});case ce:return br(br({},e),{},{module:n.module});default:return e}},tracking:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ar,t=arguments.length>1?arguments[1]:void 0,r=t.type,n=t.payload;switch(r){case _:return wr(wr({},e),{},{initialLoadingTime:n});case R:return wr(wr({},e),{},{umsConnectionStartTime:n});case k:return wr(wr({},e),{},{umsConnectionConnectedTime:n});case P:return wr(wr({},e),{},{streamModuleReceivedTime:n});case C:return wr(wr({},e),{},{firstFrameTime:n});case L:return wr(wr({},e),{},{bufferingStartTime:n});case D:return wr(wr({},e),{},{qualityChangeStartTime:n});case be:return wr(wr({},Ar),{},{initialLoadingTime:e.initialLoadingTime});default:return e}},ums:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Fr,t=arguments.length>1?arguments[1]:void 0,r=t.type,n=t.payload;switch(r){case _r.Z.addPassword:return Ur(Ur({},e),{},{password:n.password,lock:{type:"",data:{}}});case _r.Z.addHash:var a=!Nr(n.hash);return Ur(Ur({},e),{},{hashInvalid:a,hash:n.hash,lock:{type:"",data:{}}});case _r.Z.setLockInfo:return Ur(Ur({},e),{},{lock:{type:n.type,data:n.data}});case _r.Z.setUmsInfo:return Ur(Ur({},e),{},{info:n.info});case $:var i=n.module;return Ur(Ur({},e),{},{id:i.umsId});case _r.Z.removeHash:return Ur(Ur({},e),{},{hash:null});case be:return Ur(Ur({},Fr),{},{hash:e.hash,password:e.password});case De.Z.setMediaChange:return Ur(Ur({},e),{},{hash:xr.getHashFromLocalStorage(),password:xr.getPasswordFromSessionStorage(),lock:{type:"",data:{}}});default:return e}},viewers:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Kr,t=arguments.length>1?arguments[1]:void 0,r=t.type,n=t.payload;switch(r){case J:return Gr(Gr({},e),{},{allTimeTotal:n.module});case ee:return Gr(Gr({},e),{},{allViewers:n.module});case te:return Gr(Gr({},e),{},{viewers:n.module});case be:var a=n.type;return a===Se.mediaChange?Kr:e;default:return e}}}),on=(0,K.OJ)(tn,(function(e,t){return t.type===be?an({player:e.player,playback:e.playback,content:e.content,ums:e.ums,tracking:e.tracking,share:e.share,debug:e.debug,viewers:e.viewers,liveCTA:e.liveCTA,poll:e.poll,logo:e.logo,captionSearch:e.captionSearch,captionSettings:e.captionSettings,privacy:e.privacy,provider:e.provider},t):an(e,t)})),sn=Object.freeze({audio:"audio",cc:"cc",content:"content",contentAvailable:"contentAvailable",duration:"duration",error:"error",finished:"finished",live:"live",liveCtaUpdate:"liveCtaUpdate",mediaReject:"mediaReject",meta:"meta",playing:"playing",poll:"poll",quality:"quality",ready:"ready",size:"size",seekStarted:"seekStarted",seekCompleted:"seekCompleted",share:"share",theaterMode:"theaterMode",thumbnail:"thumbnail",title:"title",trimmedDuration:"trimmedDuration"}),un=Object.freeze({audio:"audio",cc:"cc",load:"load",pause:"pause",play:"play",probe:"probe",pollAnswer:"pollAnswer",pollTracking:"pollTracking",quality:"quality",seek:"seek",setExternalVtt:"setExternalVtt",setTitleVisibility:"setTitleVisibility",stop:"stop",theater:"theater",volume:"volume",sendLog:"sendLog",webkitEnterFullscreen:"webkitEnterFullscreen"}),cn=Object.freeze({allTimeTotalViewers:"allTimeTotalViewers",content:"content",duration:"duration",playingContent:"playingContent",progress:"progress",stats:"stats",trimmedDuration:"trimmedDuration",viewers:"viewers",volume:"volume"}),ln=Object.freeze({autoplayRejected:"autoplayRejected",webkitEnterFullscreenRejected:"webkitEnterFullscreenRejected"});function dn(e){try{return new URL(e).host}catch(e){return""}}function fn(e){var t=parseInt(e,10);return(0,jt.Z)(t)?{error:!0,value:void 0}:{error:!1,value:t}}function hn(e){if("boolean"==typeof e)return{error:!1,value:e};if("true"===e||"false"===e||""===e)return{error:!1,value:"true"===e};var t=fn(e),r=t.error,n=t.value;return r||1!==n&&0!==n?{error:r,value:void 0}:{error:!1,value:!!n}}var pn=r(4469);function gn(e){return{type:Me,payload:e}}var vn=r(26451),mn=r(83685),yn=r(40202),bn=r.n(yn);function Sn(e){var t=ii.getState(),r=(0,F.EG)(t);if(!r)return e;var n=1e3*r.start,a=1e3*r.end,i=e-n;return(0,Le.Z)(i,{lower:0,upper:a-n})}function En(e){var t=ii.getState(),r=(0,F.EG)(t);if(!r)return e;var n=1e3*r.start,a=1e3*r.end,i=n+e;return(0,Le.Z)(i,{lower:n,upper:a})}function Tn(e){return En(1e3*e)/1e3}function wn(){var e=ii.getState(),t=(0,F.EG)(e),r=(0,o.default)(t,"start",0),n=(0,mn.uv)(e),a=(0,mn.yB)(e);return(!bn().safari||a)&&!(!n||n===1/0||n<r)}var On=r(63647);function An(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i=[],o=!0,s=!1;try{for(r=r.call(e);!(o=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);o=!0);}catch(e){s=!0,a=e}finally{try{o||null==r.return||r.return()}finally{if(s)throw a}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return _n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_n(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Rn=(0,l.w)("embedApi/proxy");function kn(e,t){(function(e,t){var r=t.ui,n=t.playback;switch(e.cmd){case un.probe:(0,F.DK)(ii.getState())&&Gn(sn.ready,!0);break;case un.play:var a=ii.getState();(0,j.yB)(a)?n.play():ii.dispatch((0,f.OH)(!0));break;case un.pause:n.pause();break;case un.stop:n.pause(),n.seek(Tn(0));break;case un.volume:var i=fn(An(e.args,1)[0]),o=i.error,s=i.value;o||ii.dispatch((0,_t.jA)((0,Le.Z)(s,{lower:0,upper:100})));break;case un.seek:var u=function(e){var t=parseFloat(e);return(0,jt.Z)(t)||!Number.isFinite(t)?{error:!0,value:void 0}:{error:!1,value:t}}(An(e.args,1)[0]),c=u.error,l=u.value;if(!c){var d=(0,Le.Z)(l,{lower:0}),h=Tn(d);wn()?(n.seek(h),ii.dispatch({type:Ie,payload:{initialSeekTimeInMs:void 0}})):ii.dispatch(function(e){return{type:xe,payload:e}}(1e3*d));var p=(0,j.hB)(ii.getState()).id;Fe.Z.removeProgressForVideoId(p)}break;case un.load:var g=An(e.args,2),v=g[0],y=g[1],b="video"===v?m.w_.recorded:m.w_.live,S="".concat("channel"===v?v:"recorded",".").concat(y);ii.dispatch(gn({mediaId:S,mediaType:b}));break;case un.quality:var E=fn(An(e.args,1)[0]),T=E.error,w=E.value;T||n.setQuality(w);break;case un.pollAnswer:var O=An(e.args,1)[0];r.setPollAnswer(O);break;case un.pollTracking:var A=An(e.args,1)[0];r.setPollTracking(A);break;case un.theater:var _=hn(An(e.args,1)[0]),R=_.error,k=_.value;R||ii.dispatch((0,_t.Eu)({visible:k}));break;case un.requestWebkitEnterFullscreen:n.webkitEnterFullscreen();break;case un.setTitleVisibility:var P=hn(An(e.args,1)[0]),C=P.error,L=P.value;C||ii.dispatch((0,pn.w)(L));break;case un.setExternalVtt:var D=An(e.args,1),I=An(D[0],1)[0].forVTTCue;ii.dispatch((0,vn.R)(I));break;case un.cc:var x=fn(An(e.args,1)[0]),M=x.error,U=x.value;M||ii.dispatch((0,f.JM)(U));break;case un.audio:var N=fn(An(e.args,1)[0]),B=N.error,G=N.value;B||ii.dispatch((0,f.Ft)(G));break;case un.sendLog:r.setLogSendingStarted(),(0,On.Z)({onProgress:r.setLogSendingProgress}).then((function(e){r.setLogSendingCompleted(e)})).catch((function(e){Rn.error(e.message),r.setLogSendingCompleted()}))}})(e,t),function(e){switch(e.cmd){case cn.volume:if(null==An(e.args,1)[0]){var t=(0,o.default)(ii.getState(),"player.volume",0);Vn(e.cmd,t)}break;case cn.duration:var r=(0,o.default)(ii.getState(),"content.duration",0);Vn(e.cmd,r);break;case cn.trimmedDuration:var n=(0,o.default)(ii.getState(),"content.trimmedDuration",0);Vn(e.cmd,n);break;case cn.viewers:var a=(0,o.default)(ii.getState(),"viewers.viewers");Vn(e.cmd,a||0);break;case cn.allTimeTotalViewers:var i=(0,o.default)(ii.getState(),"viewers.allTimeTotal");Vn(e.cmd,i||0);break;case cn.content:var s=An((0,j.r8)(ii.getState()),2),u=s[0],c=s[1];Vn(e.cmd,u?[u,parseInt(c,10)]:[]);break;case cn.playingContent:var l=(0,j.hB)(ii.getState()),d=l.type,f=l.id;Vn(e.cmd,d?[d,parseInt(f,10)]:[]);break;case cn.progress:var h=ii.getState();if((0,j.gx)(h))return void Vn(e.cmd,0);var p=Sn(1e3*(0,F.Xn)(ii.getState()))/1e3;Vn(e.cmd,parseFloat(p.toFixed(3)));break;case cn.stats:var g=(0,F.af)(ii.getState());Vn(e.cmd,g)}}(e)}function Pn(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Cn(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Ln,Dn=null,In=!1,xn="api-target-origin",Mn={},Un=(0,l.w)("cronus/embedApi");function jn(e){var t,r,n=e.origin,a=window.location,i=document.referrer||a.href;if(i){if(n===Fn(i)||(t=n,r=a.href,dn(t)===dn(r))){var o=function(e){try{return JSON.parse(e)}catch(e){return{}}}(e.data);o.cmd&&(Un.debug("message event received ",[e.origin,o]),kn(o,Dn))}}else Un.debug("message event handler error: no referrer ")}function Fn(e){return Ln||function(e){try{return new URL(e).origin}catch(e){return""}}(e)}function Nn(e){return function(t,r){var n=document.referrer||window.location.href,a=window.parent;if((window===window.parent||/^(\/internal)?\/combined-embed\//.test(window.location.pathname))&&(n=window.location.href,a=window),n){var i=Fn(n);if(i){"progress"!==t&&Un.debug("property"===e?"send property":"send event",[t,r]);var o=Pn({},e,Pn({},t,r));a.postMessage(JSON.stringify(o),i)}}}}function Bn(e){if(In&&(Object.values(Mn).forEach((function(e){return e()})),window.removeEventListener("message",jn),Dn=null,In=!1),Dn=e,Mn.title=ii.subscribe("content.title",(function(e){"string"==typeof e&&Gn(sn.title,e)})),Mn.thumbnails=ii.subscribe("content.thumbnails",(function(e){return Gn(sn.thumbnail,e)})),Mn.mediaId=ii.subscribe("content.mediaId",(function(){var e,t,r=(e=(0,j.r8)(ii.getState()),t=2,function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i=[],o=!0,s=!1;try{for(r=r.call(e);!(o=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);o=!0);}catch(e){s=!0,a=e}finally{try{o||null==r.return||r.return()}finally{if(s)throw a}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Cn(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Cn(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),n=r[0],a=r[1];n&&Gn(sn.content,[n,parseInt(a,10)])})),Mn.duration=ii.subscribe("content.duration",(function(e){"number"==typeof e&&Number.isFinite(e)&&Gn(sn.duration,e)})),Mn.trimmedDuration=ii.subscribe("content.trimmedDuration",(function(e){"number"==typeof e&&Number.isFinite(e)&&Gn(sn.trimmedDuration,e)})),Mn.liveStatus=ii.subscribe("content.liveStatus",(function(e){void 0!==e&&Gn(sn.live,e)})),Mn.size=ii.subscribe("player.playerSize",(function(e){return Gn(sn.size,[e.width,e.height])})),Mn.share=ii.subscribe("share",(function(e){return Gn(sn.share,e)})),Mn.liveCTA=ii.subscribe("liveCTA",(function(e){return Gn(sn.liveCtaUpdate,e)})),Mn.qualities=ii.subscribe("qos.qualities",(function(){Gn(sn.quality,(0,j.M1)(ii.getState()))})),Mn.qualitySelected=ii.subscribe("qos.selectedId",(function(){Gn(sn.quality,(0,j.M1)(ii.getState()))})),(0,Y.j)(xn)){var t=decodeURIComponent((0,Y.j)(xn));try{var r=new URL(t);Ln=r.origin}catch(e){Un.error("api-target-origin is not a valid URL")}}window.addEventListener("message",jn),In=!0}var Gn=Nn("event"),Vn=Nn("property"),Kn=[Ft.Z.selectAudio,Ft.Z.setAudioTracks];function Hn(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Zn(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Hn(Object(r),!0).forEach((function(t){Yn(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Hn(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Yn(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qn(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Wn=[Ft.Z.setAudioTracks,Ft.Z.setClosedCaptionTracks];function zn(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Xn(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?zn(Object(r),!0).forEach((function(t){Qn(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zn(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Qn(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var $n,Jn="is_cc_active",ea=r(26448),ta=r.n(ea),ra=r(49612),na=Object.freeze({initialLoadingStarted:"initialLoadingStarted",initialLoadingCompleted:"initialLoadingCompleted",umsConnectionStarted:"umsConnectionStarted",umsConnectionCompleted:"umsConnectionCompleted",streamModuleReceived:"streamModuleReceived",firstTimeUpdate:"firstTimeUpdate",bufferingStarted:"bufferingStarted",bufferingCompleted:"bufferingCompleted",streamTypeSelected:"streamTypeSelected",playbackRequestedWithAutoplay:"playbackRequestedWithAutoplay",playbackStarted:"playbackStarted",turnOnCC:"turnOnCC",turnOffCC:"turnOffCC",playbackStartedWithCC:"playbackStartedWithCC",liveStatusChanged:"liveStatusChanged",offairContentDisplayed:"offairContentDisplayed",playerClosed:"playerClosed",umsConnectionLost:"umsConnectionLost",qualityChangeStarted:"qualityChangeStarted",qualityChangeCompleted:"qualityChangeCompleted",qualityChangeCanceled:"qualityChangeCanceled",seekStarted:"seekStarted",seekCompleted:"seekCompleted",endOfStream:"endOfStream",offairContentChanged:"offairContentChanged",errorLoggerLoaded:"errorLoggerLoaded",heartbeat:"heartbeat",reload:"reload",zeroStreamModule:"zeroStreamModule",emptyStreamModule:"emptyStreamModule",unhandledException:"unhandledException",providerChange:"providerChange",notAllowed:"notAllowed",unsupportedContent:"unsupportedContent",manifestParsingError:"manifestParsingError",manifestEmptyError:"manifestEmptyError",manifestLoadingError:"manifestLoadingError",manifestLoadingTimeout:"manifestLoadingTimeout",segmentLoadingError:"segmentLoadingError",segmentLoadingTimeout:"segmentLoadingTimeout",segmentParsingError:"segmentParsingError",progressStalled:"progressStalled",playbackHasNotBegun:"playbackHasNotBegun",longBuffering:"longBuffering",mediaError:"mediaError",prerollStarted:"prerollStarted",prerollFinished:"prerollFinished",audioChunkAppendError:"audioChunkAppendError"}),aa=200,ia=300;function oa(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sa(e){if("string"==typeof e)try{var t=new URL(e),r=t.protocol,n=t.hostname;return"".concat(r,"//").concat(n)}catch(e){return}}var ua=(oa($n={},na.initialLoadingStarted,(function(e){return{message:"Initial loading started",data:{category:"Loading",item:"initial loading",action:"started",width:e.width,height:e.height}}})),oa($n,na.initialLoadingCompleted,(function(){return{message:"Initial loading completed",data:{category:"Loading",item:"initial loading",action:"completed"}}})),oa($n,na.umsConnectionStarted,(function(e){return{message:"UMS connection started",data:{category:"Loading",item:"UMS connection",action:"connected",autoplay:e.autoplay,time_spent_from_init:e.timeSpentFromInit}}})),oa($n,na.umsConnectionCompleted,(function(e){return{message:"UMS connection completed",data:{category:"Loading",item:"UMS connection",action:"connected",autoplay:e.autoplay,time_spent:e.timeSpent,time_spent_from_init:e.timeSpentFromInit}}})),oa($n,na.streamModuleReceived,(function(e){return{message:"Stream module received",data:{category:"Loading",item:"stream module",action:"received",autoplay:e.autoplay,time_spent:e.timeSpent,time_spent_from_init:e.timeSpentFromInit}}})),oa($n,na.firstTimeUpdate,(function(e){return{message:"First time update",data:{category:"Playback",item:"playback",action:"started",autoplay:e.autoplay,time_spent:e.timeSpent,time_spent_from_init:e.timeSpentFromInit}}})),oa($n,na.bufferingStarted,(function(e){return{message:"Buffering started",data:{category:"Loading",item:"buffering",action:"started",segment_size:e.segmentSize,net_speed:e.netSpeed,current_kbps:e.currentBitrateInKbps,current_height:e.currentHeight}}})),oa($n,na.bufferingCompleted,(function(e){return{message:"Buffering completed",data:{category:"Loading",item:"buffering",action:"completed",time_spent:e.timeSpent,segment_size:e.segmentSize,net_speed:e.netSpeed,current_kbps:e.currentBitrateInKbps,current_height:e.currentHeight}}})),oa($n,na.streamTypeSelected,(function(){return{message:"Streamtype selected",data:{category:"Playback",item:"initial loading",action:"selected"}}})),oa($n,na.playbackRequestedWithAutoplay,(function(){return{message:"Playback requested",data:{category:"Playback",item:"playback",action:"requested - autoplay"}}})),oa($n,na.playbackStarted,(function(e){return{message:"Playback started",data:{category:"Playback",item:"playback",action:"started",stream_type:e.streamType}}})),oa($n,na.turnOnCC,(function(e){return{message:"Turn on CC",data:{category:"Interaction",item:"CC",action:"turn_on",type:e.mediaType,language:e.language}}})),oa($n,na.turnOffCC,(function(e){return{message:"Turn off CC",data:{category:"Interaction",item:"CC",action:"turn_off",type:e.mediaType,language:e.language}}})),oa($n,na.playbackStartedWithCC,(function(e){return{message:"Playback started with CC",data:{category:"Playback",item:"CC",action:"displayed",cc_type:e.isBroadcasterSelection?"from_broadcaster":"from_viewer",language:e.language}}})),oa($n,na.liveStatusChanged,(function(e){return{message:"Live status changed",data:{category:"Playback",item:"live status",action:"changed",status:e.isLive?"live":"off air"}}})),oa($n,na.offairContentDisplayed,(function(e){return{message:"Offair content displayed",data:{category:"Playback",item:"off air content",action:"displayed",offair_content_type:e.offairContentType}}})),oa($n,na.umsConnectionLost,(function(e){return{message:"UMS connection lost",data:{category:"Playback",item:"UMS connection",action:"lost",reason:e.reason}}})),oa($n,na.playerClosed,(function(){return{message:"Player closed",data:{category:"Playback",item:"playback",action:"player closed"}}})),oa($n,na.qualityChangeStarted,(function(e){return{message:"quality change",data:{category:"Playback",item:"quality change",action:"started",from_kbps:e.fromBitrateInKbps,from_height:e.fromHeight}}})),oa($n,na.qualityChangeCompleted,(function(e){return{message:"quality change",data:{category:"Playback",item:"quality change",action:"completed",to_kbps:e.toBitrateInKbps,to_height:e.toHeight,time_spent:e.timeSpent,buffer_spent:e.bufferSpent}}})),oa($n,na.qualityChangeCanceled,(function(e){return{message:"quality change",data:{category:"Playback",item:"quality change",action:"canceled",time_spent:e.timeSpent,buffer_spent:e.bufferSpent}}})),oa($n,na.seekStarted,(function(){return{message:"Seek started",data:{category:"Playback",item:"playback",action:"started"}}})),oa($n,na.seekCompleted,(function(){return{message:"Seek completed",data:{category:"Playback",item:"playback",action:"completed"}}})),oa($n,na.endOfStream,(function(){return{message:"End of stream",data:{category:"Playback",item:"end of stream",action:""}}})),oa($n,na.offairContentChanged,(function(e){return{message:"Offair content changed",data:{category:"Playback",item:"off air content",action:"change",prevId:e.prevId,nextId:e.nextId}}})),oa($n,na.errorLoggerLoaded,(function(){return{message:"Error logger loaded",data:{category:"Error",item:"load",action:"",level:400}}})),oa($n,na.heartbeat,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.position,r=void 0===t?-1:t,n=e.provider,a=e.videoHeight,i=e.videoWidth;return{message:"heartbeat",data:{category:"Error",item:"heartbeat",action:"",level:400,position:r,provider:sa(n),videoHeight:a,videoWidth:i}}})),oa($n,na.reload,(function(){return{message:"reload",data:{category:"Error",item:"reload",action:"",level:ia}}})),oa($n,na.zeroStreamModule,(function(){return{message:"zero stream module received",data:{category:"Error",item:"zero_stream_module",action:"",level:ia}}})),oa($n,na.emptyStreamModule,(function(){return{message:"empty stream module received",data:{category:"Error",item:"empty_stream_module",action:"",level:ia}}})),oa($n,na.unhandledException,(function(e){return{message:"Unhandled exception",data:{category:"Unhandled exception",item:"unhandled exception",action:"",message:e.message,stack:e.stack}}})),oa($n,na.providerChange,(function(e){var t=e.reason;return{message:void 0===t?"unknown":t,data:{category:"Error",item:"provider_change",action:"",provider:sa(e.provider)}}})),oa($n,na.notAllowed,(function(e){var t=e.errorMessage;return{message:"Playback not allowed",data:{category:"Error",item:"hlsjs not allowed",action:"",level:ia,error_message:t}}})),oa($n,na.unsupportedContent,(function(){return{message:"Unsupported content",data:{category:"Error",item:"hlsjs unsupported content",action:"",level:100}}})),oa($n,na.manifestParsingError,(function(){return{message:"Manifest parsing error",data:{category:"Error",item:"hlsjs manifest parsing error",action:"",level:aa}}})),oa($n,na.manifestEmptyError,(function(){return{message:"Manifest empty error",data:{category:"Error",item:"hlsjs manifest empty error",action:"",level:ia}}})),oa($n,na.manifestLoadingError,(function(e){var t=e.errorCode,r=e.errorMessage,n=e.errorDetail;return{message:"Manifest loading error",data:{category:"Error",item:"hlsjs manifest loading error",action:"",level:aa,error_code:t,error_message:r,error_type:n}}})),oa($n,na.manifestLoadingTimeout,(function(e){var t=e.errorDetail;return{message:"Manifest loading timeout",data:{category:"Error",item:"hlsjs manifest loading timeout",action:"",level:aa,error_type:t}}})),oa($n,na.segmentLoadingError,(function(e){var t=e.errorCode,r=e.errorMessage;return{message:"Segment loading error",data:{category:"Error",item:"hlsjs segment loading error",action:"",level:aa,error_code:t,error_message:r}}})),oa($n,na.segmentLoadingTimeout,(function(){return{message:"Segment loading timeout",data:{category:"Error",item:"hlsjs segment loading timeout",action:"",level:aa}}})),oa($n,na.segmentParsingError,(function(e){return{message:e.reason,data:{category:"Error",item:"hlsjs segment parsing error",action:"",level:aa}}})),oa($n,na.progressStalled,(function(e){var t=e.timeout;return{message:"Progress stalled",data:{category:"Error",item:"hlsjs progress stalled",action:"",level:aa,timeout:t}}})),oa($n,na.playbackHasNotBegun,(function(e){return{message:"Playback has not begun",data:{category:"Error",item:"hlsjs playback has not begun",action:"",level:100,timeout:e.timeout}}})),oa($n,na.longBuffering,(function(e){var t=e.timeout;return{message:"Long buffering",data:{category:"Error",item:"hlsjs long buffering",action:"",level:ia,timeout:t}}})),oa($n,na.mediaError,(function(e){var t,r=e.errorCode,n=e.provider;switch(r){case 1:t="aborted";break;case 2:t="network";break;case 3:t="decode";break;case 4:t="unsupported";break;default:t="unknown"}return{message:t,data:{category:"Error",item:"hlsjs media error",action:"",level:aa,provider:sa(n)}}})),oa($n,na.prerollStarted,(function(){return{message:"Preroll started",data:{category:"Ad",item:"Preroll",action:"started"}}})),oa($n,na.prerollFinished,(function(){return{message:"Preroll finished",data:{category:"Ad",item:"Preroll",action:"finished"}}})),oa($n,na.audioChunkAppendError,(function(e){var t=e.start,r=e.end;return{message:"Audio chunk append error",data:{category:"Debug",item:"audio chunk append error",action:"",error_message:"frag.start: ".concat(t,", frag.end: ").concat(r)}}})),$n);function ca(){return"video"===(0,Y.j)("contentType")}function la(){return"channel"===(0,Y.j)("contentType")}function da(){return la()?"channel":"recorded"}function fa(){var e=!window.location.pathname.includes("/embed/")&&Ue.Z.player?Ue.Z.player.contentId:window.location.pathname.match(/(\d+)/g)[0];return parseInt(e,10)}var ha={isCid:la,isVid:ca,isHLS:function(){return!1},getUrl:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=(0,o.default)(window,"location.protocol","https:"),n=(0,o.default)(ra.Z,"config.contentUrl","video.ibm.com"),a=new URL("".concat(r,"//").concat(n)),i=[{predicate:t,value:"embed/"},{predicate:!t&&la(),value:"channel/"},{predicate:ca(),value:"recorded/"},{predicate:!0,value:fa()},{predicate:e,value:"/pop-out"}];return a.pathname+=i.filter((function(e){return!0===e.predicate})).map((function(e){return e.value})).join(""),a.toString()},getId:fa,getApp:da,getMid:function(){return"".concat(da(),".").concat(fa())},getMidForVideoId:function(e){return"recorded.".concat(e)}};function pa(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var ga=(0,l.w)("cronus/tracking/watcher"),va={},ma={},ya=!1,ba="reloadTime",Sa={progress:void 0,buffer:void 0,playing:void 0,heartbeat:void 0,streamModule:void 0},Ea={PAYLOADS:{},TYPES:{},send:function(){},isEnabled:function(){return!0}};function Ta(e,t){if(Ea.isEnabled()){Object.prototype.hasOwnProperty.call(va,e)||(va[e]=0);var r=Date.now();r-va[e]<29e3||(va[e]=r,Ea.send(e,t))}}function wa(){var e,t,r=ii.getState(),n=(0,F.C5)(r).video,a=(0,j.U5)(r),i={position:-1,provider:(0,o.default)(a,"url"),videoHeight:null!==(e=null==n?void 0:n.height)&&void 0!==e?e:0,videoWidth:null!==(t=null==n?void 0:n.width)&&void 0!==t?t:0};Ta(Ea.TYPES.heartbeat,i),Sa.heartbeat=setTimeout(wa,3e4)}function Oa(){Da()}function Aa(e){var t=e.data,r=t[t.length-1];r&&r.isEmpty?La(Ea.TYPES.emptyStreamModule):Da()}function _a(){ya&&(Sa.buffer=clearTimeout(Sa.buffer),Sa.progress=clearTimeout(Sa.progress),Sa.playing=clearTimeout(Sa.playing),Sa.progress=setTimeout((function(){Ta(Ea.TYPES.progressStalled,{timeout:7e3}),ga.error("progress stalled")}),7e3))}function Ra(e){if(ya=e,!e)return Sa.progress=clearTimeout(Sa.progress),Sa.buffer=clearTimeout(Sa.buffer),void(Sa.playing=clearTimeout(Sa.playing));Sa.playing=setTimeout((function(){Ta(Ea.TYPES.playbackHasNotBegun,{timeout:15e3}),ga.fatal("playback has not begun")}),15e3)}function ka(){Sa.buffer=setTimeout((function(){Ta(Ea.TYPES.longBuffering,{timeout:1e4}),ga.fatal("long buffer empty")}),1e4)}function Pa(){Ea.send(Ea.TYPES.playerClosed)}function Ca(){ur.ZP.set(ba,{time:Date.now(),mid:ha.getMid()})}function La(e){void 0!==Sa.streamModule&&Da(),Sa.streamModule=setTimeout((function(){Ta(e),ga.fatal(e)}),5e3)}function Da(){Sa.streamModule=clearTimeout(Sa.streamModule)}function Ia(){Object.values(ma).forEach((function(e){return e()})),Object.entries(Sa).forEach((function(e){var t,r,n=(r=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i=[],o=!0,s=!1;try{for(r=r.call(e);!(o=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);o=!0);}catch(e){s=!0,a=e}finally{try{o||null==r.return||r.return()}finally{if(s)throw a}}return i}}(t,r)||function(e,t){if(e){if("string"==typeof e)return pa(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?pa(e,t):void 0}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a=n[0],i=n[1];Sa[a]=clearTimeout(i)})),window.removeEventListener("beforeunload",Ca),window.removeEventListener("unload",Pa),va={},ma={}}var xa=function(e){var t,r=e.send,n=e.PAYLOADS,a=e.TYPES,i=e.isEnabled;i||Ia(),Ea.PAYLOADS=n,Ea.TYPES=a,Ea.send=r,Ea.isEnabled=i,Ta(Ea.TYPES.errorLoggerLoaded),(t=ur.ZP.get(ba))&&Date.now()-t.time<3e4&&t.mid===ha.getMid()&&Ta(Ea.TYPES.reload),window.addEventListener("beforeunload",Ca),wa(),La(Ea.TYPES.zeroStreamModule),ma.contentAccess=ii.subscribe("provider.contentAccess",Oa),ma.emptyModule=ii.subscribe("debug.EMPTY_MODULE",Aa),ma.timeUpdate=ii.subscribe("playback.currentTime",_a),ma.playing=ii.subscribe("playback.playing",Ra),ma.bufferStart=ii.subscribe("tracking.bufferingStartTime",ka),window.addEventListener("unload",Pa)};function Ma(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ua(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ma(Object(r),!0).forEach((function(t){ja(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ma(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ja(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Fa(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Na=(0,l.w)("cronus/tracking/index"),Ba={},Ga=function(){var e,t,r,n,a={subdomain:"eventtracking-log",protocol:"localhost"===(null===(e=window)||void 0===e||null===(t=e.location)||void 0===t?void 0:t.hostname)?"https:":"",tag:"eventtracking.web.player",type:"web",callback:function(e,t){e?Na.debug("error:",e):t.forEach((function(e){Na.debug("sent:",e)}))}},i=(0,o.default)(ra.Z.config,"eventtrackingUrl","").match(/^([^.]+)\.(.+)$/);if(i){var s=(n=3,function(e){if(Array.isArray(e))return e}(r=i)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i=[],o=!0,s=!1;try{for(r=r.call(e);!(o=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);o=!0);}catch(e){s=!0,a=e}finally{try{o||null==r.return||r.return()}finally{if(s)throw a}}return i}}(r,n)||function(e,t){if(e){if("string"==typeof e)return Fa(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Fa(e,t):void 0}}(r,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),u=s[1],c=s[2];a.subdomain=u,a.domain=c}return ta().create(a)}();function Va(){return!!bn().storage}function Ka(e){switch((0,j.V4)(e)){case m.w_.live:return"live";case m.w_.recorded:return"video";case m.w_.offairImage:return"offairimage";case m.w_.offairSlide:return"offairslide";case m.w_.offairVideo:return"offairvideo";case m.w_.offairScreen:return"offairscreen";default:return"unknown"}}function Ha(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;if(Va()){var a=e?ua[e](r):n,i=bn().swf?bn().swf.join("."):"none",o="channel"===(0,Y.j)("contentType")?"channel_id":"recorded_id",s=ii.getState(),u=(0,j.SY)(s),c=Ka(s);a.data=Ua((ja(t={cluster:u},o,ha.getId()),ja(t,"branch_name",(0,Y.j)("branchName")),ja(t,"player_version","v6_hlsjs"),ja(t,"flash_version",i),ja(t,"buildNumber",Ne.Z.BUILD_NUMBER),ja(t,"broadcaster_user_id",(0,Y.j)("ownerId")),ja(t,"contentType",c),t),a.data),Ga.send(a)}}var Za={init:function(){xa({send:Ha,PAYLOADS:ua,TYPES:na,isEnabled:Va})},reset:function(){Ba={}},send:Ha,once:function(e){return Ba[e]?{send:function(){}}:(Ba[e]=!0,{send:Ha.bind(this,e)})},transport:function(e){return{send:Ha.bind(this,void 0,{},e)}},isEnabled:Va,TYPES:na,PAYLOADS:ua},Ya=[Ft.Z.selectClosedCaption,Ft.Z.setClosedCaptionTracks];function qa(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Wa(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?qa(Object(r),!0).forEach((function(t){za(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qa(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function za(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Xa(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i=[],o=!0,s=!1;try{for(r=r.call(e);!(o=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);o=!0);}catch(e){s=!0,a=e}finally{try{o||null==r.return||r.return()}finally{if(s)throw a}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Qa(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Qa(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Qa(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var $a=function(e){return function(t){var r;return function(n){return function(a){var i=a.type,o=a.payload;if(i===e.type){r=clearTimeout(r);var s=t.getState(),u=e.getValueFromState(s),c=e.getValueFromPayload(o);return"number"==typeof u&&"number"==typeof c&&Math.abs(c-u)<e.threshold?void(r=setTimeout((function(){r=void 0,n(a)}),e.delay)):n(a)}return n(a)}}}},Ja=r(38557);function ei(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ti(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ei(Object(r),!0).forEach((function(t){ri(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ei(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ri(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ni=[se,re,ie,ne,J,ee,te],ai=(0,G.MT)(on,{},(0,V.U)((0,G.md)((function(e){return function(t){return function(r){if(ni.includes(r.type)){var n=r.payload.mediaId,a=e.getState(),i=(0,j.V4)(a)===m.w_.offairVideo,o=(0,j.GE)(a)===n;if(i&&!o)return}return t(r)}}}),(function(){return function(e){return function(t){if(Wn.includes(t.type)){var r=t.payload.tracks.map((function(e,t){var r=e.id,n=e.name,a=e.lang,i=e.audioCodec,o=e.default,s=e.autoselect,u=e.forced,c=e.targetduration,l=e.active,d=function(e){if(!e)return{};var t=e.match(/(\w+)-(\w+)/);if(!t)return{language:e};var r,n,a=(n=3,function(e){if(Array.isArray(e))return e}(r=t)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i=[],o=!0,s=!1;try{for(r=r.call(e);!(o=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);o=!0);}catch(e){s=!0,a=e}finally{try{o||null==r.return||r.return()}finally{if(s)throw a}}return i}}(r,n)||function(e,t){if(e){if("string"==typeof e)return qn(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?qn(e,t):void 0}}(r,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());return{language:a[1],country:a[2]}}(a),f=d.language,h=void 0===f?"mis":f,p=d.country;return{id:void 0===r?t:r,label:n,language:h,country:void 0===p?"00":p,codec:i,default:o,autoselect:s,forced:u,targetDuration:c,active:l}})),n=Zn(Zn({},t.payload),{},{tracks:r});return e(Zn(Zn({},t),{},{payload:n}))}return e(t)}}}),(function(e){return function(t){return function(r){var n=t(r);if(Kn.includes(r.type)){var a=e.getState().playback,i=a.selectedAudio,o=a.audioTracks;if(o.length>0){var s=o.map((function(e){var t=e.id;return{index:t,label:e.label,language:e.language,country:e.country,active:i===t}}));Gn("audio",s)}}return n}}}),(function(e){return function(t){return function(r){var n=t(r);if(Ya.includes(r.type)){var a=e.getState().playback,i=a.selectedClosedCaption,o=a.closedCaptionTracks;if(o.length>0){var s=o.map((function(e){var t=e.id;return{index:t,label:e.label,language:e.language,country:e.country,active:i===t}}));Gn("cc",s)}}return n}}}),(function(e){return function(t){return function(r){if(r.type===Ft.Z.selectClosedCaption){var n=r.payload.index>=0;ur.ZP.set(Jn,n,{expires:3650})}if(r.type===Ft.Z.setClosedCaptionTracks&&-2===e.getState().playback.selectedClosedCaption){var a=ur.ZP.get(Jn),i=Xn(Xn({},r.payload),{},{closedCaptionActiveFromLocalStorage:a});return t(Xn(Xn({},r),{},{payload:i}))}return t(r)}}}),(function(e){return function(t){return function(r){if(r.type===Ft.Z.selectClosedCaption){var n=e.getState(),a=(0,F.xs)(n),i=(0,o.default)(r,"payload.index");if(a!==i){var s=(0,j.V4)(n)===m.w_.live?"live":"vod";if(i>-1){var u=(0,F.vw)(n,i);if(u){var c=u.language,l=u.country;Za.send(Za.TYPES.turnOnCC,{mediaType:s,language:"".concat(c,"-").concat(l)})}}else{var d=(0,F.vw)(n,a);if(d){var f=d.language,h=d.country;Za.send(Za.TYPES.turnOffCC,{mediaType:s,language:"".concat(f,"-").concat(h)})}}}}return t(r)}}}),(function(){return function(e){return function(t){if(t.type===oe){var r=t.payload,n=r.mediaId,a=r.module,i=function(e){return/SecureUrl$/.test(e)},o=Object.fromEntries(Object.entries(a).filter((function(e){var t=Xa(e,1)[0];return bn().ssl&&i(t)||!bn().ssl&&!i(t)})).map((function(e){var t=Xa(e,2),r=t[0],n=t[1];return[r.replace(/(?:Secure)?Url$/,""),n]})));return e(Wa(Wa({},t),{},{payload:{mediaId:n,module:o}}))}return e(t)}}}),(function(e){return function(e){return function(t){return t.type===_r.Z.addHash&&("false"!==t.payload.hash?xr.saveHashToLocalStorage(t.payload):xr.removeCurrentHashFromLocalStorage()),t.type===_r.Z.removeHash&&xr.removeCurrentHashFromLocalStorage(),e(t)}}}),Ja.Z,(function(e){return function(t){return function(r){if(r.type===h){var n=r.payload,a=e.getState(),i=(0,j.V4)(a),o=(0,j.hB)(a).id,s=Fe.Z.getSavedProgressToVideoId(o);if(!Be(i))return t(r);if(void 0===n||!s)return t(r);var u=s.progress,c=s.cut,l=a.content.trimInfo,d=c?Sn(u):u,f=c&&!l,p=c&&l&&(c[0]!==l[0]||c[1]!==l[1]),g=1e3*r.payload,v=d-Ne.Z.CONTINUE_WATCHING_OFFSET_IN_MS,m=v<0||v>=g-Ne.Z.CONTINUE_WATCHING_OFFSET_IN_MS;(f||p||m)&&Fe.Z.removeProgressForVideoId(o)}if(r.type===Ft.Z.setCurrentTime){var y=e.getState();if(!Be((0,j.V4)(y)))return t(r);var b=y.content.trimInfo,S=(0,j.hB)(y).id,E=r.payload.currentTime,T=Math.round(1e3*E);Fe.Z.saveProgressToCurrentVideoId(T,S,b)}return t(r)}}}),(function(e){return function(t){return function(r){var n=t(r);if(r.type===sr.Z.toggleDebug){var a=e.getState().settings.debug;ur.ZP.set(ur.Bx,a)}return n}}}),(function(){return function(e){return function(t){if(t.type===ne){var r=t.payload,n={mediaId:r.mediaId,module:(a=r.module,"boolean"==typeof a?a:a.reduce((function(e,t){return ti(ti({},e),{},ri({},t.name,t))}),{}))};return e(ti(ti({},t),{},{payload:n}))}var a;return e(t)}}}),(function(){return function(e){return function(t){var r=e(t);return t.type===At.Z.hideNotification&&t.payload===_t.GT.oldBrowser&&ur.ZP.set(ur.n,!0,{expires:7}),r}}}),$a({type:Ft.Z.setPlaybackStats,getValueFromPayload:function(e){return e.currentTime},getValueFromState:function(e){return e.playback.statsLastUpdatedAt},threshold:1,delay:1e3}),$a({type:Xt.Z.setStatsData,getValueFromPayload:function(e){return e.currentTime},getValueFromState:function(e){return e.qos.statsLastUpdatedAt},threshold:2,delay:2e3}))));(0,K.p5)(ai);var ii=(0,H.Z)(ai),oi=ai,si=r(40126),ui=r(62549),ci=r(50420),li=r(51361),di=r(37722),fi=r(40282),hi=r.n(fi);function pi(e){return pi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pi(e)}var gi=["advert","allTimeTotal","allViewers","broadcaster","caption","livecta","logo","meta","poll","qos","share","slides","stream","tcdn","thumbnail","viewers","caption"],vi=function(e,t){gi.forEach((function(r){void 0!==t[r]&&function(e){var t=e.module,r=e.mediaId;switch(e.name){case"stream":return oi.dispatch(function(e,t){return{type:Q,payload:{mediaId:e,module:t}}}(r,t));case"meta":return Gn(sn.meta,t),oi.dispatch(function(e,t){return{type:$,payload:{mediaId:e,module:t}}}(r,t));case"allTimeTotal":return oi.dispatch(function(e,t){return{type:J,payload:{mediaId:e,module:t}}}(r,t));case"allViewers":default:return null;case"viewers":return oi.dispatch(function(e,t){return{type:te,payload:{mediaId:e,module:t}}}(r,t));case"logo":return oi.dispatch(function(e,t){return{type:re,payload:{mediaId:e,module:t}}}(r,t));case"share":return oi.dispatch(function(e,t){return{type:ne,payload:{mediaId:e,module:t}}}(r,t));case"broadcaster":return oi.dispatch(function(e,t){return{type:ae,payload:{mediaId:e,module:t}}}(r,t));case"livecta":return oi.dispatch(function(e,t){return{type:ie,payload:{mediaId:e,module:t}}}(r,t));case"thumbnail":return oi.dispatch(function(e,t){return{type:oe,payload:{mediaId:e,module:t}}}(r,t));case"poll":if(function(e){return null===e||(Array.isArray(e)?0===e.length:"object"===pi(e)&&0===Object.keys(e).length)}(t))return;return oi.dispatch(function(e,t){return{type:se,payload:{mediaId:e,module:t}}}(r,t));case"caption":return oi.dispatch(function(e,t){return{type:ue,payload:{mediaId:e,module:t}}}(r,t));case"slides":oi.dispatch(function(e,t){return{type:ce,payload:{mediaId:e,module:t}}}(r,t))}}({name:r,module:t[r],mediaId:e})}))};function mi(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function yi(e,t){return Ti(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i=[],o=!0,s=!1;try{for(r=r.call(e);!(o=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);o=!0);}catch(e){s=!0,a=e}finally{try{o||null==r.return||r.return()}finally{if(s)throw a}}return i}}(e,t)||Si(e,t)||bi()}function bi(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Si(e,t){if(e){if("string"==typeof e)return Ei(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ei(e,t):void 0}}function Ei(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ti(e){if(Array.isArray(e))return e}var wi={CLOSE_NORMAL:1e3,CLOSE_GOING_AWAY:1001,CLOSE_PROTOCOL_ERROR:1002,CLOSE_UNSUPPORTED:1003,CLOSE_NO_STATUS:1005,CLOSE_ABNORMAL:1006,CLOSE_INCONSISTENT_DATA_RECEIVED:1007,CLOSE_POLICY_VIOLATE:1008,CLOSE_TOO_LARGE:1009,CLOSE_MISSING_EXTENSION:1010,CLOSE_UNEXPECTED_CONDITION:1011,CLOSE_FAILED_TLS_HANDSHAKE:1015},Oi=null,Ai=null,_i=null,Ri=!1,ki=null,Pi=null,Ci=0,Li=[],Di=(0,l.w)("ums/debug");function Ii(e,t){var r,n=Ti(r=t)||mi(r)||Si(r)||bi(),a=n[0],i=n.slice(2);"url"===(0,o.default)(i,"0")&&function(e){var t=new URL(e),r=t.protocol,n=t.hostname;if(!/https?/.test(r)&&!(Li=Li.filter((function(e){var t=e.checkedAt;return Math.abs(Date.now()-t)<6e4}))).some((function(e){return e.hostname===n}))){Li.push({hostname:n,checkedAt:Date.now()}),Di.debug("Download connection info",{hostname:n});var a=/wss/.test(r)?"https:":"http:",i="".concat(a,"//").concat(n,"/connectioncheck");fetch(i).then((function(e){return e.json()})).then((function(e){return Di.debug("Connection info received",{hostname:n,info:e})})).catch((function(e){return Di.error("Connection info failed",{hostname:n,error:e.message})}))}}(i[1]),Di.debug("ums.log ".concat(e),i);var s=[a].concat(function(e){return function(e){if(Array.isArray(e))return Ei(e)}(e)||mi(e)||Si(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(i));!function(e){var t=yi(e,2)[1],r=Date.now();"string"==typeof t&&"opened"===t.trim()&&(r-Pi<5e3&&clearTimeout(ki),ii.dispatch((0,U.pq)({inited:!0})))}(s),function(e){var t=yi(e,3),r=t[0],n=t[1],a=t[2];if("string"!=typeof n||"opening"!==n.trim()||Oi||(Oi=r),"string"==typeof n&&n.includes("message")){var i=(0,o.default)(a,"1.0",{});!Ai&&i.meta&&(Ai=r),_i||!i.stream||(0,Ve.M)(i.stream)||(_i=r)}if(!Ri&&Ai&&_i&&Oi){Ri=!0;var s=Math.max(Ai,_i)-Oi;ii.dispatch((0,U.mE)({timeToStartInMs:s}))}}(s),function(e){var t=yi(e,3),r=t[1],n=t[2];if("string"==typeof r&&"closed"===r.trim()&&n){var a=yi(n,2),i=a[0],o=a[1],s="".concat(wi[i]," ").concat(i);o&&(s="".concat(s," ").concat(o)),ii.dispatch((0,U.Lv)({level:N.Q.WARNING,timeStamp:Date.now(),msg:s}))}}(s),function(e){var t=yi(e,3),r=t[1],n=t[2];if("string"==typeof r&&"message"===r.trim()&&"reject"===(0,o.default)(n,"cmd")){Ci+=1;var a=n&&n.args?Object.keys(n.args[0])[0]:"unknown";"cluster"===a.trim()&&ii.dispatch((0,U.Vl)({level:N.Q.ERROR,timeStamp:Date.now(),msg:a})),Ci>3&&ii.dispatch((0,U.Vl)({level:N.Q.ERROR,timeStamp:Date.now(),msg:a}))}}(s),function(e){var t=yi(e,3),r=t[0],n=t[1],a=t[2];if("string"==typeof n&&n.includes("message")){var i=(0,o.default)(a,"1.0",{});if(i.stream){var s=(0,Ve.M)(i.stream);ii.dispatch((0,U.H$)({level:N.Q.WARNING,timeStamp:r,msg:s?"Stream module empty":"Stream module found",isEmpty:s}))}}}(s)}function xi(){Oi=null,Ai=null,_i=null,Ri=!1,null!==ki&&clearTimeout(ki),ki=null,Pi=null,Ci=0}var Mi=r(20917),Ui=r(26193),ji=(0,l.w)("lockManager"),Fi=function(){},Ni=["reject","ipLock","geoLock","hashLock","passwordLock","referrerLock","sessionAuthLock","viewerHourLimitLock","viewerAuth","nonexistent"];function Bi(e){!e||Ue.Z.isDashboard||Ue.Z.align||(Fi(),function(e){var t,r=ii.getState().ums.hash;if(!e||!r||!e.watchedUrl)return null;try{t=JSON.parse(r)}catch(e){return ji.error("Parsing hash data failed",r),null}var n=(0,o.default)(t.find((function(e){return e.hash})),"hash",null),a=function(e,t){var r=(0,j.lB)(ii.getState()).id,n=(0,j.V4)(ii.getState())===m.w_.live;return decodeURIComponent(e).replace("@@channelId@@",r).replace("@@contentType@@",n?"channel":"recorded").replace("@@contentId@@",r).replace("@@hash@@",t)}(e.watchedUrl,n);fetch(a).then((function(e){return e.json()})).then((function(e){return ji.info("WatchedUrl successfully called",e)})).catch((function(e){return ji.warn(e.message)}))}(Ue.Z.hashLockData))}var Gi=r(27685);function Vi(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ki(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Vi(Object(r),!0).forEach((function(t){Hi(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Vi(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Hi(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Zi(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Yi=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.queue={meta:null,stream:null},this.done=!1}var t,r;return t=e,r=[{key:"process",value:function(e){if(this.done)return e;var t=e.meta,r=e.stream,n=!!t,a=r&&!(0,Ve.M)(r);return n&&a?(this.done=!0,e):n&&!a?this.queue.stream?(this.done=!0,Ki(Ki({},e),{},{stream:this.queue.stream})):(this.queue.meta=t,Ki(Ki({},e),{},{meta:void 0})):!n&&a?this.queue.meta?(this.done=!0,Ki(Ki({},e),{},{meta:this.queue.meta})):(this.queue.stream=r,Ki(Ki({},e),{},{stream:void 0})):e}}],r&&Zi(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function qi(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Wi={},zi={},Xi=(0,l.w)("logic/ums/umsHandler");function Qi(e){switch(e.type){case"overlay":ii.dispatch((0,Gi.SX)(e.data));break;case"report":Uo.aggregate(Uo.TYPES.ecdnTest,{data:e.data});break;default:Xi.debug("Unexpected command from sdcdn stats reporting",e.type)}}function $i(e,t){var r=zi[e];if(r){var n=r.process(t);vi(e,n)}}function Ji(e,t){var r=t[0];Ss.onStat=Qi,Ss.onComplete=$i,Ss.update(e,r)}function eo(e){return Wi[e]}function to(e,t){var r;Xi.debug("ums reject",{reason:t}),(0,j.GE)(ii.getState()),r=!1,t.forEach((function(e){e.embedLimitExceeded&&r||(Gn(sn.mediaReject,!0),r=!0);var t=function(e){return Object.keys(e).find((function(e){return Ni.includes(e)}))||"default"}(e),n=t.toLowerCase(),a=e[t];if("viewerAuth"!==t){if("hashLock"===t){ii.dispatch((0,Ui.lm)());var i=xr.getFallbackHash();if(i)return void ii.dispatch((0,Ui.t_)(i))}var o=ii.getState().ums;"passwordLock"===t&&o.password&&ii.dispatch((0,Ui.dM)(null)),ii.dispatch((0,Ui.N6)({type:n,data:a}))}else{var s=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=new URL(window.location);r.searchParams.delete("vt");var n=r.toString(),a=new URL(null===(e=t.viewerAuth)||void 0===e?void 0:e.authUrl);return a.searchParams.set("ref",n),a.toString()}(e);window.location.replace(s)}})),ii.dispatch(I(void 0)),ii.dispatch(x(void 0))}function ro(e){Uo.onUmsOpen(e);var t=ii.getState(),r=performance.now(),n=r-(0,j.xs)(t);Za.send(Za.TYPES.umsConnectionCompleted,{autoplay:!!(0,Y.j)("autoplay"),timeSpentFromInit:r-(0,j.sP)(t),timeSpent:n}),ii.dispatch(x(r)),Uo.aggregate(Uo.TYPES.umsConnected,{timeSpent:n}),Uo.aggregate(Uo.TYPES.branchName,{branchName:(0,Y.j)("branchName")})}function no(e){var t={code:(0,o.default)(e,"closeEvent.code",-1),closeReason:(0,o.default)(e,"closeEvent.reason",-1)};Za.send(Za.TYPES.umsConnectionLost,{reason:t})}function ao(e){var t=Wi[e];t&&(t.destroy(),delete Wi[e],delete zi[e],xi())}var io,oo,so={init:function(e){if(void 0===Wi[e]){xi(),Pi=Date.now(),ki=setTimeout((function(){ii.dispatch((0,U.pq)({inited:!1}))}),5e3);var t=performance.now();Za.send(Za.TYPES.umsConnectionStarted,{timeSpentFromInit:t-(0,j.sP)(ii.getState()),autoplay:!!(0,Y.j)("autoplay")}),ii.dispatch(I(t));var r=function(e){var t,r,n=(t=e.split("."),r=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i=[],o=!0,s=!1;try{for(r=r.call(e);!(o=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);o=!0);}catch(e){s=!0,a=e}finally{try{o||null==r.return||r.return()}finally{if(s)throw a}}return i}}(t,r)||function(e,t){if(e){if("string"==typeof e)return qi(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?qi(e,t):void 0}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a=n[0],i=n[1],o=(0,Y.j)("useLongpoll"),s=(0,Y.j)("sessionId"),u=(0,Y.j)("flot"),c=(0,Y.j)("bdtools"),l=ii.getState(),d=l.content.mediaType,f={app:a,id:i,referrer:Mi.Z,connectParams:{appId:7,appVersion:1},longpoll:o,sessionId:s,ignoreTrim:!0,flotAddress:!!u&&decodeURI(u),bdtools:c,buildNumber:Ne.Z.BUILD_NUMBER,clusterHost:ra.Z.config.ums,isOffairRecorded:d===m.w_.offairVideo,password:(0,F.Ij)(l)},h=(0,F.my)(l);return h?f.viewerAuthToken=h:f.hash=(0,F.XR)(l),Xi.debug("create ums connection. mid: ".concat(e),{umsParams:f}),f}(e),n=hi()(r);n.on(n.event.OPEN,ro.bind(null,e)),n.on(n.event.CLOSE,no),n.on(n.event.REJECT,to.bind(null,e)),n.on(n.event.UPDATE,Ji.bind(null,e)),n.on(n.event.LOG,Ii.bind(null,e)),n.connect(),Wi[e]=n,zi[e]=new Yi}},getInstance:eo,getInfo:function(e){var t=eo(e);return t&&t.internals||{}},destroy:ao,destroyAll:function(){Object.keys(Wi).forEach((function(e){return ao(e)})),Wi={},zi={}},destroyAllOthers:function(e){Object.keys(Wi).filter((function(t){return t!==e})).forEach((function(e){return ao(e)}))}},uo=r(37255),co=r(38172),lo=(0,l.w)("cronus/reporting/aggregator"),fo={},ho={};function po(){if((0,uo.Z)(fo)){for(var e in fo){var t=fo[e];if((0,o.default)(t,"common.bufempty.length")){var r=t.common.bufempty.pop();t.common.bufempty=r.value}Uo.send(Uo.TYPES.stats,{data:t},e)}fo={}}}function go(){if((0,uo.Z)(ho)){for(var e in ho){var t=ho[e];Uo.send(Uo.TYPES.stats,{data:t},e)}ho={}}}function vo(){fo={},ho={},io=clearInterval(io),oo=clearInterval(oo)}var mo,yo=function(){vo(),io=window.setInterval(po,1e3),oo=window.setInterval(go,5e3)},bo=function(e,t){if(lo.debug("aggregator feed",{mediaId:e,data:t}),t.common&&void 0!==t.common.bufempty)return fo[e]=fo[e]||{common:{bufempty:[]}},void fo[e].common.bufempty.push({value:t.common.bufempty,time:Date.now()});(0,uo.Z)(t)&&(ho[e]?(0,co.Z)(t,ho[e]):ho[e]=t)};function So(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Eo,To,wo=Object.freeze({bandwidthChange:"bandwidthChange",branchName:"branchName",bufferingStarted:"bufferingStarted",bufferingCompleted:"bufferingCompleted",ecdnTest:"ecdnTest",error:"error",firstModuleInfo:"firstModuleInfo",playingChange:"playingChange",providerChange:"providerChange",seek:"seek",stats:"stats",umsConnected:"umsConnected"}),Oo=Object.freeze((So(mo={},wo.bandwidthChange,"bwrpt"),So(mo,wo.ecdnTest,"ecdnt"),So(mo,wo.firstModuleInfo,"fmi"),So(mo,wo.playingChange,"playing"),So(mo,wo.seek,"seek"),So(mo,wo.stats,"stats"),So(mo,wo.umsConnected,"ucd"),mo));function Ao(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ao(Object(r),!0).forEach((function(t){Ro(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ao(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ro(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ko=(Ro(Eo={},wo.playingChange,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,r=e.playing,n=e.reason,a=void 0===n?"":n,i=e.multiaudio,o=Oo[wo.playingChange],s=[t,r,{reason:a}];return i&&i.language&&(s[2]=_o(_o({},s[2]),{},{multiaudio:i})),{cmd:o,data:s}})),Ro(Eo,wo.seek,(function(e){var t=e.fromInSec,r=e.toInSec;return{cmd:Oo[wo.seek],data:[Math.round(t),Math.round(r)]}})),Ro(Eo,wo.stats,(function(e){var t=e.data;return{cmd:Oo[wo.stats],data:[t]}})),Eo),Po=(Ro(To={},wo.bandwidthChange,(function(e){var t=e.time,r=e.size,n=e.url,a=e.isEcdn;return{benchmark:Ro({},Oo[wo.bandwidthChange],[{time:Math.round(t),size:r,url:n,ecdn:a}])}})),Ro(To,wo.firstModuleInfo,(function(e){var t=e.timeSpent;return{benchmark:Ro({},Oo[wo.firstModuleInfo],t)}})),Ro(To,wo.umsConnected,(function(e){var t=e.timeSpent;return{benchmark:Ro({},Oo[wo.umsConnected],t)}})),Ro(To,wo.ecdnTest,(function(e){var t=e.data;return{benchmark:Ro({},Oo[wo.ecdnTest],t)}})),Ro(To,wo.bufferingStarted,(function(){return{common:{bufempty:!0}}})),Ro(To,wo.bufferingCompleted,(function(){return{common:{bufempty:!1}}})),Ro(To,wo.providerChange,(function(e){return{common:{cdnProviderType:e.cdnProviderType,cdnProviderHostname:e.cdnProviderHostname}}})),Ro(To,wo.branchName,(function(e){return{branchName:e.branchName}})),Ro(To,wo.error,(function(e){var t=e.mediaId,r=e.type,n=e.details,a=t.type,i=t.id,o="channel"===a?"cid":"vid";return{error:[{type:r,details:_o(_o({},n),{},Ro({},o,i))}]}})),To);function Co(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Lo=(0,l.w)("cronus/reporting/index"),Do={},Io={},xo={};function Mo(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,n=ko[e](t),a=n.cmd,i=n.data,o=r||(0,j.Ys)(ii.getState());if(!Do[o])return Lo.debug("cache data",{mediaId:o,data:i}),Io[o]=Io[o]||[],void Io[o].push([e,t]);var s=so.getInstance(o);s?(Lo.debug("report to ums",{cmd:a,data:i}),s.send(a,i)):Lo.warn("umsInstance not available!",{cmd:a,data:i})}var Uo={init:function(){yo()},send:Mo,sendWithDelay:function(e,t,r){xo[e]=clearTimeout(xo[e]),xo[e]=setTimeout((function(){return Mo(e,t)}),r)},aggregate:function(e,t){var r=(0,j.Ys)(ii.getState()),n=Po[e](t);bo(r,n)},TYPES:wo,onUmsOpen:function(e){Do[e]=!0,function(e){if(Io[e]){for(;Io[e].length;)Mo.apply(void 0,(t=Io[e].shift(),function(e){if(Array.isArray(e))return Co(e)}(t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return Co(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Co(e,t):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).concat([e]));var t;delete Io[e]}}(e)}};function jo(e){return function(e){if(Array.isArray(e))return No(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Fo(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Fo(e,t){if(e){if("string"==typeof e)return No(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?No(e,t):void 0}}function No(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Bo,Go,Vo,Ko,Ho,Zo,Yo,qo,Wo,zo,Xo=3e5,Qo="ecdnPreferredLocation",$o=0,Jo={pingPath:"/ping",pingThreads:6,pingRounds:1,pingTimeout:400,addRndParam:!0,locationPriority:[]},es={},ts={},rs={},ns=0,as=ur.ZP.get(Qo)||[],is=!0,os=(0,l.w)("cronus/logic/sdcdnHandler"),ss=(0,l.w)("sdcdn"),us=ii.getState().provider.forcedUrl,cs=(0,li.default)(us)?us:null;function ls(e){var t=e&&e.result&&e.result.time>-1;os.debug("Ping result",e),t&&((!Wo||Wo.time>e.result.time)&&(Wo=e.result),!Go&&es[Yo]&&(Go=!0,os.debug("Send first result"),ps([e.result],Yo))),zo.onStat({type:"overlay",data:{pingResult:e}})}function ds(e){var t,r;ns=(new Date).getTime(),rs[Yo]=e,os.debug("Pings finished",{duration:ns-Ho,data:rs[Yo]}),ps(rs[Yo],Yo),Ko=Yo,Yo=!1,ts[r=Ko]&&(!rs[r]&&ts[r]||!rs[r].some((function(e){return gs(e.url)}))&&ts[r].data.some((function(e){return e.useBestSite})))?(t=$o?1e3:0,t=Math.min(Xo,t*Math.pow(2,$o-1))+Math.floor(5e3*Math.random()),os.debug("Retry ecdn pings in ".concat(Math.round(t/1e3),"sec")),clearTimeout(Bo),Bo=setTimeout((function(){$o+=1,ys()}),t)):$o=0,zo.onStat({type:"report",data:ns-Ho})}function fs(e){ss.debug(e.line,e.data)}function hs(e){ss.error("SDCDN lib error:",e)}function ps(e,t){if(es[t]&&e)if(cs)!function(e,t){os.debug("Send forced providers",{mid:t,results:cs});var r=e.find((function(e){return e.url===cs}));if(r){var n=[{url:r.url,location:r.location}];es[t].providers=n,zo.onComplete(t,{stream:es[t]}),zo.onStat({type:"overlay",data:{finalResult:rs[t],fallback:"not available",location:"not available",preferredLocation:as,forcedProvider:cs,cdnConfig:ts[Ko]}})}}(e,t);else{var r=e,n=function(e){var t=vs(e);if(!t)return!0;var r=function(e){var t=[];return e.forEach((function(e){e.data.forEach((function(r){Object.prototype.hasOwnProperty.call(r,"cdnFallbackEnabled")&&t.push({location:r.location,cdnFallbackEnabled:r.cdnFallbackEnabled,group:e.name})}))})),t}(t);if(!r.length)return!0;if((0,ci.Z)(as)&&as.length){var n=r.filter((function(e){return as.includes("".concat(e.group,"/").concat(e.location))}));if(n.length)return n[0].cdnFallbackEnabled}return r.some((function(e){return e.cdnFallbackEnabled}))}(t),a=Wo&&Wo.location;os.debug("use cdn fallback: ".concat(n)),a&&function(e){if(as&&(0,ci.Z)(as)){var t=as.indexOf(e);t>-1&&as.splice(t,1),as.unshift(e),as=as.slice(0,5)}else as=[e];ur.ZP.set(Qo,as)}(a),n||(r=e.filter((function(e){return e.location===a}))),r=function(e){var t,r,n=e.reduce((function(e,t){return function(e){var t=e.location||"";return/^fallback\//i.test(t)}(t)?e[1].push(t):e[0].push(t),e}),[[],[]]),a=(r=2,function(e){if(Array.isArray(e))return e}(t=n)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i=[],o=!0,s=!1;try{for(r=r.call(e);!(o=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);o=!0);}catch(e){s=!0,a=e}finally{try{o||null==r.return||r.return()}finally{if(s)throw a}}return i}}(t,r)||Fo(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=a[0],o=a[1];return[].concat(jo(i),jo(o))}(r),es[t].providers=(0,si.Z)(r),os.debug("Send results",{mid:t,results:es[t].providers}),zo.onComplete(t,{stream:es[t]}),zo.onStat({type:"overlay",data:{finalResult:r,fallback:n,location:a,preferredLocation:as,forcedProvider:cs,cdnConfig:ts[Ko]}}),clearTimeout(Zo),Zo=setTimeout(ms,Xo)}}function gs(e){var t,r=decodeURIComponent(e).toLowerCase();for(var n in ts)if(Object.prototype.hasOwnProperty.call(ts,n))return(t=ts[n].data,t.filter((function(e){return e.useBestSite})).reduce((function(e,t){var r=t.data.reduce((function(e,t){return e.concat(t.sites)}),[]);return e.concat(r)}),[])).some((function(e){var t=e.host.toLowerCase();return r.indexOf(t)>-1||t.indexOf(r)>-1}));return!1}function vs(e){var t;return ts[e]&&(t=ts[e].data.filter((function(e){return e.useBestSite})).map((function(e){return(0,si.Z)(e)}))),t&&t.length?t:null}function ms(e){var t=e||Ko;(new Date).getTime()-ns>=Xo&&es[t]&&ts[t]&&!Yo&&(Zo=clearTimeout(Zo),as&&(Jo.locationPriority=as),(-1===t.indexOf("recorded")||t.indexOf("recorded")>-1&&!rs[t])&&(Ho=(new Date).getTime(),Yo=t,di.Z.test(ts[t],Jo)))}function ys(){Yo||(ns=0,os.debug("Force tests"),ms())}function bs(e){os.debug("force provider ",e||"off"),cs=cs===e?null:e,ps(rs[Ko],Ko)}zo={update:function(e,t){e!==Ko&&(ns=0);var r=(0,si.Z)(t);if(r.stream&&r.stream.version){if(os.debug("Stream module received"),is){var n=performance.now(),a=ii.getState();Za.send(Za.TYPES.streamModuleReceived,{autoplay:!!(0,Y.j)("autoplay"),timeSpentFromInit:n-(0,j.sP)(a),timeSpent:n-(0,j.uf)(a)}),ii.dispatch({type:P,payload:n}),Uo.aggregate(Uo.TYPES.firstModuleInfo,{timeSpent:n-(0,j.uf)(a)}),is=!1}r.stream.contentAvailable?(es[e]=(0,si.Z)(r.stream),es[e].mid=e,delete r.stream):(Zo=clearTimeout(Zo),Yo&&di.Z.test(),qo=null,Yo=!1,ns=0,rs={},es={},Go=!1,cs=null,is=!0),ps(rs[e],e)}r.cdnConfig&&(Vo||(di.Z.on(di.Z.events.PING_RESULT,ls),di.Z.on(di.Z.events.FINISHED,ds),di.Z.on(di.Z.events.ERROR,hs),di.Z.on(di.Z.events.LOG,fs),Vo=!0),Ko=Ko||e,ns=0,ts[e]=(0,si.Z)(r.cdnConfig),ts[e].mid=e,os.debug("CDN config received"),delete r.cdnConfig),(0,ui.Z)(r)||zo.onComplete(e,r),function(e){return e&&e.streamFormats&&(e.streamFormats.mp4||e.streamFormats.flv)&&!(e.streamFormats.hasOwnProperty("flv/segmented")||e.streamFormats.hasOwnProperty("mp4/segmented")||e.streamFormats.hasOwnProperty("hls/mp4/rfc")||e.streamFormats.hasOwnProperty("hls/improved"))}(es[e])?(os.debug("Mp4 or Flv movie, cdn tests skipped!"),zo.onComplete(e,{stream:es[e]})):ms(e)},onStat:function(){},onComplete:function(){},onProviderChange:function(e){os.debug("Provider changed");var t=e&&Object.prototype.hasOwnProperty.call(e,"to")&&!gs(e.to),r=qo&&gs(qo)||!qo&&vs(Ko);t&&r&&ys(),qo=e.to},onProviderFailure:function(e){os.debug("Provider failure",e),(e&&Object.prototype.hasOwnProperty.call(e,"url")&&gs(e.url)||vs(Ko))&&ys()},isEcdnProvider:gs,getEcdnConfig:vs,forceProvider:bs},ii.subscribe("provider.forcedUrl",bs);var Ss=zo,Es=r(36320),Ts=bn().ff,ws=bn().ff;function Os(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i=[],o=!0,s=!1;try{for(r=r.call(e);!(o=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);o=!0);}catch(e){s=!0,a=e}finally{try{o||null==r.return||r.return()}finally{if(s)throw a}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return As(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?As(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function As(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _s(e){return function(e){var t=e.matchAll(/^#EXT-X-MEDIA:.+$/gm);return Array.from(t,(function(e){return Os(e,1)[0]}))}(e).filter((function(e){return"AUDIO"===function(e){return function(e,t){var r=e.matchAll(/([A-Z-]+)=(.+?)(?:,|$)/gm),n=Array.from(r,(function(e){var t=Os(e,3);return{name:t[1],value:t[2]}})).find((function(e){return"TYPE"===e.name}));if(n)return n.value}(e)}(e)}))}function Rs(e){var t=e.matchAll(/^#EXTINF:.+\n(.+)$/gm);return Array.from(t,(function(e){return Os(e,2)[1]}))}function ks(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ps(e){return"".concat(e,"h")}function Cs(e,t){var r=e;return t===Bs.manifest?(r=function(e){var t=_s(e);if(t.length<=1)return e;var r={};return t.forEach((function(t){var n=function(e,t){var r=e.matchAll(/([A-Z-]+)="(.+?)"(?:,|$)/gm),n=Array.from(r,(function(e){var t=Os(e,3);return{name:t[1],value:t[2]}})).find((function(e){return"NAME"===e.name}));if(n)return n.value}(t);r[n]?e=e.replace("".concat(t,"\n"),""):r[n]=!0})),e}(r),r):(/#EXT-X-MAP/.test(e)||(r=function(e){var t,r,n=(t=Rs(e),r=1,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i=[],o=!0,s=!1;try{for(r=r.call(e);!(o=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);o=!0);}catch(e){s=!0,a=e}finally{try{o||null==r.return||r.return()}finally{if(s)throw a}}return i}}(t,r)||function(e,t){if(e){if("string"==typeof e)return ks(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ks(e,t):void 0}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0];return n?e.replace("#EXTINF",'#EXT-X-MAP:URI="'.concat(Ps(n),'"\n#EXTINF')):e}(r)),function(e){return!/^#EXT-X-PLAYLIST-TYPE:\s*VOD/m.test(e)}(e)&&(r=function(e){var t=Rs(e),r=t[t.length-1];return r?e.replace(/#EXT-X-MAP:URI=.*/,'#EXT-X-MAP:URI="'.concat(Ps(r),'"')):e}(r)),r)}function Ls(e){return Ls="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ls(e)}function Ds(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Is(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ds(Object(r),!0).forEach((function(t){xs(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ds(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function xs(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ms(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Us(e,t){return Us=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Us(e,t)}function js(e,t){if(t&&("object"===Ls(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Fs(e)}function Fs(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ns(e){return Ns=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ns(e)}var Bs=Object.freeze({manifest:"manifest",level:"level",audioTrack:"audioTrack",subtitleTrack:"subtitleTrack"}),Gs=function(e){return function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Us(e,t)}(s,t);var r,n,a,i,o=(a=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ns(a);if(i){var r=Ns(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return js(this,e)});function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=o.call(this,e)).originalLoad=t.load.bind(Fs(t)),t.load=t.customLoad.bind(Fs(t)),t}return r=s,n=[{key:"customLoad",value:function(t,r,n){var a=(0,Es.Z)(4),i=t.url,o=t.id,s=t.level,u=t.type,c="number"==typeof s?s:o,l=n.onSuccess,d=n.onError,f=n.onTimeout,h=Is(Is({},n),{},{onSuccess:function(r,n,o,s){var d=u===Bs.manifest?r.data:void 0;e.debug("playlist loaded",{requestId:a,url:i,type:u,level:c,response:{code:200,text:"OK"},data:d,stats:n});var f=Is(Is({},r),{},{data:Cs(r.data,t.type)});l(f,n,o,s)},onError:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var o=r[0];e.debug("playlist loading failed",{requestId:a,url:i,type:u,level:c,response:{code:o.code,text:o.text}}),d.apply(void 0,r)},onTimeout:function(){e.debug("playlist loading failed",{requestId:a,url:i,type:u,level:c,response:{code:0,text:""}}),f.apply(void 0,arguments)}});e.debug("playlist loading started",{requestId:a,url:i,type:u,level:c}),this.originalLoad(t,r,h)}}],n&&Ms(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),s}(a().DefaultConfig.loader)};function Vs(e){var t;if(e.response instanceof ArrayBuffer)t=new TextDecoder("utf-8").decode(e.response);else{if("string"!=typeof e.response)return;t=e.response}try{return JSON.parse(t).error}catch(e){return}}var Ks,Hs=Math.pow(2,32)-1;function Zs(e,t){var r=0,n=Math.pow(2,32);return r=e.getUint32(t),(r*=n)+e.getUint32(t+4)}function Ys(e,t,r){var n=new Uint8Array(e);return n[t+0]=r>>24,n[t+1]=r>>16&255,n[t+2]=r>>8&255,n[t+3]=255&r,n.buffer}function qs(e,t,r){var n=Math.floor(r/(Hs+1)),a=Math.floor(r%(Hs+1));Ys(e,t,n),Ys(e,t+4,a)}function Ws(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var zs=Object.freeze((Ws(Ks={ftyp:"ftyp",pdin:"pdin",moov:"moov",mvhd:"mvhd",trak:"trak",tkhd:"tkhd",tref:"tref",trgr:"trgr",edts:"edts",elst:"elst",mdia:"mdia",mdhd:"mdhd",hdlr:"hdlr",minf:"minf",vmhd:"vmhd",smhd:"smhd",hmhd:"hmhd",nmhd:"nmhd",dinf:"dinf",dref:"dref",stbl:"stbl",stsd:"stsd",stts:"stts",ctts:"ctts",cslg:"cslg",stsc:"stsc",stsz:"stsz",stz2:"stz2",stco:"stco",co64:"co64",stss:"stss",stsh:"stsh",padb:"padb",stdp:"stdp",sdtp:"sdtp",sbgp:"sbgp",sgpd:"sgpd",subs:"subs",saiz:"saiz",saio:"saio",udta:"udta",mvex:"mvex",mehd:"mehd",trex:"trex",leva:"leva",iods:"iods",moof:"moof",mfhd:"mfhd",traf:"traf",tfhd:"tfhd",trun:"trun"},"sbgp","sbgp"),Ws(Ks,"sgpd","sgpd"),Ws(Ks,"subs","subs"),Ws(Ks,"saiz","saiz"),Ws(Ks,"saio","saio"),Ws(Ks,"tfdt","tfdt"),Ws(Ks,"mfra","mfra"),Ws(Ks,"tfra","tfra"),Ws(Ks,"mfro","mfro"),Ws(Ks,"mdat","mdat"),Ws(Ks,"free","free"),Ws(Ks,"ustm","ustm"),Ws(Ks,"fmov","fmov"),Ws(Ks,"idta","idta"),Ws(Ks,"skip","skip"),Ws(Ks,"udta","udta"),Ws(Ks,"cprt","cprt"),Ws(Ks,"tsel","tsel"),Ws(Ks,"strk","strk"),Ws(Ks,"stri","stri"),Ws(Ks,"strd","strd"),Ws(Ks,"meta","meta"),Ws(Ks,"hdlr","hdlr"),Ws(Ks,"dinf","dinf"),Ws(Ks,"dref","dref"),Ws(Ks,"iloc","iloc"),Ws(Ks,"ipro","ipro"),Ws(Ks,"sinf","sinf"),Ws(Ks,"frma","frma"),Ws(Ks,"schm","schm"),Ws(Ks,"schi","schi"),Ws(Ks,"iinf","iinf"),Ws(Ks,"xml","xml"),Ws(Ks,"bxml","bxml"),Ws(Ks,"pitm","pitm"),Ws(Ks,"fiin","fiin"),Ws(Ks,"paen","paen"),Ws(Ks,"fire","fire"),Ws(Ks,"fpar","fpar"),Ws(Ks,"fecr","fecr"),Ws(Ks,"segr","segr"),Ws(Ks,"gitn","gitn"),Ws(Ks,"idat","idat"),Ws(Ks,"iref","iref"),Ws(Ks,"meco","meco"),Ws(Ks,"mere","mere"),Ws(Ks,"styp","styp"),Ws(Ks,"sidx","sidx"),Ws(Ks,"ssix","ssix"),Ks));function Xs(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4;return new Array(r).fill().map((function(r,n){var a=e.getUint8(t+n);return String.fromCharCode(a.toString())})).join("")}function Qs(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function $s(e,t,r){return t&&Qs(e.prototype,t),r&&Qs(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var Js=$s((function e(t){var r=t.size,n=t.type,a=t.data,i=t.start;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.size=r,this.type=n,this.data=a,this.start=i}));function eu(e){return eu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},eu(e)}function tu(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ru(e,t){return ru=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ru(e,t)}function nu(e,t){if(t&&("object"===eu(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function au(e){return au=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},au(e)}var iu=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ru(e,t)}(o,e);var t,r,n,a,i=(n=o,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=au(n);if(a){var r=au(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return nu(this,e)});function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.call(this,e)).major_brand="",t.minor_version="",t.compatible_brands="",t.parse(),t}return t=o,(r=[{key:"parse",value:function(){var e=new DataView(this.data),t=this.size-4-4-4-4;this.major_brand=Xs(e,0,4),this.minor_version=Xs(e,4,4),this.compatible_brands=Xs(e,8,t)}}])&&tu(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(Js);function ou(e){return ou="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ou(e)}function su(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function uu(e,t){return uu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},uu(e,t)}function cu(e,t){if(t&&("object"===ou(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function lu(e){return lu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},lu(e)}var du=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&uu(e,t)}(o,e);var t,r,n,a,i=(n=o,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=lu(n);if(a){var r=lu(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return cu(this,e)});function o(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),t=i.call(this,e);var r=new DataView(t.data);return t.version=r.getUint8(0),t.flags=o.getFlags(r),t.data=t.data.slice(4),t.start+=4,t}return t=o,r=[{key:"getFlags",value:function(e){return function(e,t){var r=0,n=Math.pow(2,16);return r=e.getUint8(1),(r*=n)+e.getUint16(2)}(e).toString(2).padStart(24,"0").split("").map((function(e){return parseInt(e,10)}))}}],null&&su(t.prototype,null),r&&su(t,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(Js);function fu(e){return fu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fu(e)}function hu(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function pu(e,t){return pu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},pu(e,t)}function gu(e,t){if(t&&("object"===fu(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function vu(e){return vu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},vu(e)}var mu=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pu(e,t)}(o,e);var t,r,n,a,i=(n=o,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=vu(n);if(a){var r=vu(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return gu(this,e)});function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.call(this,e)).parse(),t}return t=o,(r=[{key:"parse",value:function(){var e=new DataView(this.data);1===this.version?(this.creationTime=Zs(e,0),this.modificationTime=Zs(e,8),this.timescale=e.getUint32(16),this.duration=Zs(e,20)):(this.creationTime=e.getUint32(0),this.modificationTime=e.getUint32(4),this.timescale=e.getUint32(8),this.duration=e.getUint32(12))}}])&&hu(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(du);function yu(e){return yu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yu(e)}function bu(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Su(e,t){return Su=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Su(e,t)}function Eu(e,t){if(t&&("object"===yu(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Tu(e){return Tu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Tu(e)}var wu=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Su(e,t)}(o,e);var t,r,n,a,i=(n=o,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Tu(n);if(a){var r=Tu(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return Eu(this,e)});function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.call(this,e)).parse(),t}return t=o,(r=[{key:"parse",value:function(){var e=new DataView(this.data);1===this.version?this.baseMediaDecodeTime=Zs(e,0):this.baseMediaDecodeTime=e.getUint32(0)}}])&&bu(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(du);function Ou(e){return!!zs[e]}function Au(e,t){for(var r=new DataView(e),n=0,a={};n<e.byteLength;){var i,o=r.getUint32(n),s=Xs(r,n+4,4);if(!Ou(s))throw new Error("unusual type: ".concat(s));var u=n+8,c=n+o,l=e.slice(u,c),d=null!==(i=null==t?void 0:t.start)&&void 0!==i?i:0;a[s]={type:s,size:o,data:l,start:d+u},n+=o}return a}function _u(e,t){if(!Array.isArray(e)||e.some((function(e){return!zs[e]})))throw new TypeError("types must be an array of blockTypes");if(!(t instanceof ArrayBuffer))throw new TypeError("buffer must be an instance of ArrayBuffer");for(var r={},n={},a=t,i=0;i<e.length;i+=1){var o=e[i];if(!(n=Au(a,r))[o])throw new Error("type was not found during parse: ".concat(o));a=n[o].data,r=n[o]}return function(e){var t=e.type;switch(t){case zs.ftyp:return new iu(e);case zs.mdhd:return new mu(e);case zs.tfdt:return new wu(e);default:throw new Error("unsupported block type: ".concat(t))}}(n[e[e.length-1]])}function Ru(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,a)}function ku(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){Ru(i,n,a,o,s,"next",e)}function s(e){Ru(i,n,a,o,s,"throw",e)}o(void 0)}))}}var Pu=/^(\d{2,}:\d{2}:\d{2}[.,]\d{3})\s-->\s(\d{2,}:\d{2}:\d{2}[.,]\d{3})/,Cu=/ line:-?\d{1,}%?/,Lu=9e4;function Du(e){return e.replace(/[0-9:.]+\s-->\s[0-9.:]+.*\n(?:\n|$)/g,"")}function Iu(e){var t="X-TIMESTAMP-MAP=MPEGTS=0,LOCAL:00:00:00.000\n\n";return e.replace("\0".concat(t).concat(t),"").replace("\0".concat(t),"")}function xu(e){if("number"!=typeof e||e<0)return"00:00:00.000";var t=Math.round(1e3*e),r=t%1e3;t-=r;var n=(t/=1e3)%60;t-=n;var a=(t/=60)%60;t-=a;var i=t/=60,o=i<=10?i.toString().padStart(2,"0"):i,s=a.toString().padStart(2,"0"),u=n.toString().padStart(2,"0"),c=r.toString().padStart(3,"0");return"".concat(o,":").concat(s,":").concat(u,".").concat(c)}function Mu(e,t){if(/X-TIMESTAMP-MAP/.test(e))return e.replace(/(X-TIMESTAMP-MAP=MPEGTS:)(0)(,LOCAL:).*/,(function(e,r,n,a){return"".concat(r).concat(t).concat(a).concat(xu(t))}));var r="X-TIMESTAMP-MAP=MPEGTS:".concat(t,",LOCAL:").concat(xu(t));return e.replace(/(WEBVTT.*)/,(function(e){return"".concat(e,"\n").concat(r)}))}function Uu(e){return e.split("\n").map((function(e){if(!e.match(Pu))return e;var t=ii.getState(),r=(0,j.c2)(t),n=" line:".concat(r);return Cu.test(e)?e.replace(Cu,n):e+n})).join("\n")}function ju(){var e=ii.getState(),t=(0,j.I7)(e);return void 0!==t?Promise.resolve(t):new Promise((function(e){var t=ii.subscribe("playback.initPTS",(function(r){t(),e(r)}))}))}function Fu(e){return Nu.apply(this,arguments)}function Nu(){return(Nu=ku(regeneratorRuntime.mark((function e(t){var r,n,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.fragment,n=Iu(n=Du(n=new TextDecoder("utf-8").decode(r))),e.next=7,ju();case 7:a=e.sent,n=Mu(n,a);case 9:return n=Uu(n),e.abrupt("return",new TextEncoder("utf-8").encode(n));case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Bu(e){var t=e.fragment;if(e.type===tc.audio)try{var r=_u([zs.moov,zs.trak,zs.mdia,zs.mdhd],t);Lu=r.timescale}catch(e){}return t}function Gu(e){return Vu.apply(this,arguments)}function Vu(){return(Vu=ku(regeneratorRuntime.mark((function e(t){var r,n,a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.fragment,e.next=3;break;case 3:e.prev=3,n=_u([zs.moof,zs.traf,zs.tfdt],r),e.next=10;break;case 7:return e.prev=7,e.t0=e.catch(3),e.abrupt("return",r);case 10:return e.next=12,ju();case 12:return a=e.sent,i=a*Lu,n.baseMediaDecodeTime-i<0&&(0===n.version?Ys(r,n.start,i):qs(r,n.start,i)),e.abrupt("return",r);case 17:case"end":return e.stop()}}),e,null,[[3,7]])})))).apply(this,arguments)}function Ku(e){return Hu.apply(this,arguments)}function Hu(){return(Hu=ku(regeneratorRuntime.mark((function e(t){var r,n,a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.fragment,n=t.url,a=t.type,"initSegment"!==(i=t.sn)){e.next=3;break}return e.abrupt("return",Bu({fragment:r,url:n,type:a,sn:i}));case 3:if(a!==tc.audio){e.next=5;break}return e.abrupt("return",Gu({fragment:r,url:n,type:a,sn:i}));case 5:if(a!==tc.subtitle){e.next=7;break}return e.abrupt("return",Fu({fragment:r,url:n,type:a,sn:i}));case 7:return e.abrupt("return",r);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Zu(e){return Zu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zu(e)}function Yu(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,a)}function qu(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Wu(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?qu(Object(r),!0).forEach((function(t){zu(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qu(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function zu(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Xu(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Qu(e,t){return Qu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Qu(e,t)}function $u(e,t){if(t&&("object"===Zu(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Ju(e)}function Ju(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ec(e){return ec=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ec(e)}var tc=Object.freeze({main:"main",audio:"audio",subtitle:"subtitle"}),rc=function(e,t){return function(r){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Qu(e,t)}(u,r);var n,a,i,o,s=(i=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ec(i);if(o){var r=ec(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return $u(this,e)});function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=s.call(this,e)).originalLoad=t.load.bind(Ju(t)),t.load=t.customLoad.bind(Ju(t)),t}return n=u,a=[{key:"customLoad",value:function(r,n,a){var i=(0,Es.Z)(4),o=r.frag,s=o.type,u=o.sn,c=o.level,l=e(r.url),d=Wu(Wu({},r),{},{url:l}),f=a.onSuccess,h=a.onError,p=a.onTimeout,g=Wu(Wu({},a),{},{onSuccess:function(e,r,n,a){return(o=regeneratorRuntime.mark((function o(){var d;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return t.debug("fragment loaded",{requestId:i,url:l,type:s,sn:u,level:c,response:{code:200,text:"OK"},stats:r}),o.t0=Wu,o.t1=Wu({},e),o.t2={},o.next=6,Ku({fragment:e.data,url:l,type:s,sn:u});case 6:o.t3=o.sent,o.t4={data:o.t3},d=(0,o.t0)(o.t1,o.t2,o.t4),f(d,r,n,a);case 10:case"end":return o.stop()}}),o)})),function(){var e=this,t=arguments;return new Promise((function(r,n){var a=o.apply(e,t);function i(e){Yu(a,r,n,i,s,"next",e)}function s(e){Yu(a,r,n,i,s,"throw",e)}i(void 0)}))})();var o},onError:function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];var a=r[0],o=r[2];t.debug("fragment loading failed",{requestId:i,url:l,type:s,sn:u,level:c,response:{code:a.code,text:a.text,reason:Vs(o)}}),h.apply(void 0,r)},onTimeout:function(){t.debug("fragment loading failed",{requestId:i,url:l,type:s,sn:u,level:c,response:{code:0,text:"",reason:"TIMEOUT"}}),p.apply(void 0,arguments)}});t.debug("fragment loading started",{requestId:i,url:l,type:s,sn:u,level:c}),this.originalLoad(d,n,g)}}],a&&Xu(n.prototype,a),Object.defineProperty(n,"prototype",{writable:!1}),u}(a().DefaultConfig.loader)};function nc(e){return nc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nc(e)}function ac(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ic(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function oc(){return oc="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=sc(e,t);if(n){var a=Object.getOwnPropertyDescriptor(n,t);return a.get?a.get.call(arguments.length<3?e:r):a.value}},oc.apply(this,arguments)}function sc(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=lc(e)););return e}function uc(e,t){return uc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},uc(e,t)}function cc(e,t){if(t&&("object"===nc(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function lc(e){return lc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},lc(e)}var dc=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&uc(e,t)}(s,e);var t,r,n,i,o=(n=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=lc(n);if(i){var r=lc(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return cc(this,e)});function s(){return ac(this,s),o.apply(this,arguments)}return t=s,r=[{key:"flushLiveBackBuffer",value:function(){if(!ws)return oc(lc(s.prototype),"flushLiveBackBuffer",this).call(this);this._live;var e=this.config.liveBackBufferLength;if(isFinite(e)&&!(e<0)&&this.media)for(var t=this.media.currentTime,r=this.sourceBuffer,n=Object.keys(r),i=t-Math.max(e,this._levelTargetDuration),o=n.length-1;o>=0;o--){var u=n[o],c=r[u];if(c){var l=c.buffered;l.length>0&&i>l.start(0)&&this.removeBufferRange(u,c,0,i)&&this.hls.trigger(a().Events.LIVE_BACK_BUFFER_REACHED,{bufferEnd:i})}}}},{key:"updateMediaElementDuration",value:function(){if(!Ts)return oc(lc(s.prototype),"updateMediaElementDuration",this).call(this);var e=this.config,t=this._levelDuration,r=this._live;if(null!==t&&this.media&&this.mediaSource&&this.sourceBuffer&&0!==this.media.readyState&&"open"===this.mediaSource.readyState&&!Object.values(this.sourceBuffer).some((function(e){return e&&e.updating}))){var n=this.media.duration,a=this.mediaSource.duration;!0===r&&!0===e.liveDurationInfinity||!(t>a&&t>n)&&Number.isFinite(n)||Object.values(this.sourceBuffer).forEach((function(e){if(e){var r=e.buffered;if(0!==r.length){var n=r.end(r.length-1);n<=t||e.remove(t,n)}}})),oc(lc(s.prototype),"updateMediaElementDuration",this).call(this)}}}],r&&ic(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),s}(a().DefaultConfig.bufferController),fc=r(21807);function hc(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var pc={intersection:[],text:[]};function gc(e){return e&&(pc.intersection=(0,fc._Q)(e)),pc}function vc(e,t){var r=t.frag,n=(r=void 0===r?{}:r).start,a=r.duration;void 0!==n&&void 0!==a&&yc("text",n,n+a)}function mc(e,t){var r=pc[e];if(r){var n=(0,fc._Q)(t);pc[e]=(0,fc.jV)(n,r)}}function yc(e,t,r){var n=pc[e];pc[e]=n.concat({start:t,end:r}).sort((function(e,t){return e.start-t.start})).reduce((function(e,t){var r,n,a,i=e[e.length-1];if(!(i&&(r=i,n=t,n.start-r.end<.01)))return[].concat(function(e){if(Array.isArray(e))return hc(e)}(a=e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(a)||function(e,t){if(e){if("string"==typeof e)return hc(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?hc(e,t):void 0}}(a)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[t]);var o={start:i.start,end:t.end};return e[e.length-1]=o,e}),[])}var bc=[];var Sc=[];function Ec(e){if(!e.length)return 0;var t=e.reduce(Tc,0);return 0===t?0:e.length/t}function Tc(e,t){return 0!==t?e+1/t:e}var wc=r(76931);function Oc(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ac(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Oc(Object(r),!0).forEach((function(t){_c(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Oc(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Rc(e){return function(e){if(Array.isArray(e))return Pc(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||kc(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function kc(e,t){if(e){if("string"==typeof e)return Pc(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Pc(e,t):void 0}}function Pc(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Cc=(0,l.w)("playback/index"),Lc="hls.js",Dc=null,Ic=null,xc={},Mc=!1,Uc={},jc=null,Fc="__host__",Nc=function(e){var t=new URL(jc.url),r="".concat(t.host).concat(t.pathname);return e.replace(Fc,r.replace(/\/$/,""))},Bc={top:2},Gc={},Vc=null,Kc=null,Hc=null,Zc=null;function Yc(e){return Gc[e]||[]}function qc(){var e=ii.getState();if((0,j.gx)(e))return ii.dispatch((0,m.gg)(0)),void ii.dispatch((0,m.uM)(0));var t=Dc.duration;ii.dispatch({type:h,payload:{durationInSec:t}})}function Wc(){ii.dispatch((0,f.Bt)(!1)),xc.onLoadingChange(!1);var e=ii.getState();(0,j.yB)(e)||ii.dispatch({type:g,payload:{canPlay:!0}})}function zc(){var e=ii.getState(),t=(0,j.hB)(e).id,r=(0,F.Km)(e);return{id:t,playing:!Dc.paused,multiaudio:{language:(0,o.default)(r,"language",void 0),country:(0,o.default)(r,"country","00")}}}function Xc(){var e=ii.getState();(0,j.yA)(e)||ii.dispatch((0,f.OH)(!0)),function(){if(Ic&&Dc){var e=Ic.liveSyncPosition;!e||e-Dc.currentTime<.5||(Dc.currentTime=e)}}(),Gn(sn.playing,!0),Uo.send(Uo.TYPES.playingChange,zc())}function Qc(){var e=ii.getState();(0,j.yA)(e)&&ii.dispatch((0,f.OH)(!1)),Gn(sn.playing,!1),Uo.send(Uo.TYPES.playingChange,zc())}function $c(){ii.dispatch((0,f.Bt)(!0)),xc.onLoadingChange(!0);var e=el().quality;Za.send(Za.TYPES.bufferingStarted,{currentBitrateInKbps:(0,o.default)(e,"bitrate",0)/1e3,currentHeight:(0,o.default)(e,"height",0)}),Uo.aggregate(Uo.TYPES.bufferingStarted),ii.dispatch(M(performance.now()))}function Jc(){ii.dispatch((0,f.Bt)(!1)),xc.onLoadingChange(!1),Za.once(Za.TYPES.playbackStarted).send({streamType:"hls/fmp4"});var e=ii.getState(),t=(0,F.z)(e);if(t){var r="broadcaster"===(0,F.SS)(e);Za.once(Za.TYPES.playbackStartedWithCC).send({isBroadcasterSelection:r,language:"".concat(t.language,"-").concat(t.country)})}var n=Date.now(),a=el().quality,i=(0,j.XK)(e);void 0!==i&&(Za.send(Za.TYPES.bufferingCompleted,{currentBitrateInKbps:(0,o.default)(a,"bitrate",0)/1e3,currentHeight:(0,o.default)(a,"height",0),timeSpent:n-i}),Uo.aggregate(Uo.TYPES.bufferingCompleted),ii.dispatch(M(void 0)))}function el(){var e=Ic.currentLevel;return{id:e,quality:-1!==e?Ic.levels[e]:{}}}function tl(){return Ic?Ic.levels.filter((function(e){return!!e.videoCodec})).map((function(e,t){return{id:t,codec:e.videoCodec,width:e.width,height:e.height,bitrate:e.bitrate,active:Ic.currentLevel===t}})).sort((function(e,t){return t.height-e.height})):[]}function rl(){return Ic&&0!==Ic.audioTracks.length?Ic.audioTracks.filter((function(e){return"main"!==e.name})).map((function(e){return Ac(Ac({},e),{},{active:e.id===Ic.audioTrack})})):[]}function nl(e){Dc.volume=e/100}function al(e){e<.5&&e>2||(Dc.playbackRate=e)}function il(e){void 0!==e&&Za.send(Za.TYPES.liveStatusChanged,{isLive:e})}function ol(e){var t=e.hasExternalVtt,r=e.vtt;Ic&&t&&(Ic.enableWebVTT=!1,function(e,t){Gc.external=t}(0,r.map((function(e){var t,r,n=(r=3,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i=[],o=!0,s=!1;try{for(r=r.call(e);!(o=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);o=!0);}catch(e){s=!0,a=e}finally{try{o||null==r.return||r.return()}finally{if(s)throw a}}return i}}(t,r)||kc(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a=n[0],i=n[1],o=n[2];return new VTTCue(a,i,o)}))),_l())}function sl(){var e=ii.getState();(0,j.Vl)(e)||ii.dispatch((0,f.uy)(!0)),Cc.debug("timeupdate",Dc.currentTime),Sl(),_l(),ii.dispatch((0,f.yR)(Dc.currentTime))}function ul(){Cc.info("unload"),jc=null,Object.keys(pc).forEach((function(e){["intersection","text"].includes(e)?pc[e]=[]:delete pc[e]})),Dc&&(Dc.removeEventListener("timeupdate",sl),Dc.removeEventListener("durationchange",qc),Dc.removeEventListener("canplay",Wc),Dc.removeEventListener("play",Xc),Dc.removeEventListener("pause",Qc),Dc.removeEventListener("playing",Jc),Dc.removeEventListener("waiting",$c),Dc.removeEventListener("seeked",cl),Dc.removeEventListener("ended",ll),Dc.removeEventListener("error",dl)),Ic&&(Ic.off(a().Events.INIT_PTS_FOUND,fl),Ic.off(a().Events.MANIFEST_LOADED,pl),Ic.off(a().Events.LEVEL_SWITCHED,gl),Ic.off(a().Events.AUDIO_TRACK_SWITCHED,xc.onAudioChangeEnd),Ic.off(a().Events.FRAG_BUFFERED,ml),Ic.off(a().Events.SUBTITLE_FRAG_PROCESSED,vc),Ic.off(a().Events.SUBTITLE_TRACK_SWITCH,Ol),Ic.off(a().Events.ERROR,xc.onError),Ic.off(a().Events.FRAG_PARSING_DATA,yl),Ic.off(a().Events.FRAG_LOADED,bl),Ic.off(a().Events.BUFFER_APPENDED,Tl),Ic.off(a().Events.BUFFER_FLUSHED,wl),Ic.off(a().Events.CUES_PARSED,Al),Ic.destroy(),Ic=null),Gc={}}function cl(){(0,j.V4)(ii.getState())!==m.w_.live&&Za.send(Za.TYPES.seekCompleted),Gn(sn.seekCompleted,!0)}function ll(){Za.send(Za.TYPES.endOfStream),Gn(sn.finished,!0),ii.dispatch((0,f.OH)(!1)),ii.dispatch((0,f.lZ)(!0))}function dl(){if(Dc&&Dc.error){var e=Dc.error,t=e.code,r=e.message;Za.send(Za.TYPES.mediaError,{errorCode:t,errorMessage:r,provider:(0,o.default)(jc,"url")}),Cc.error("videotag error",{code:t,message:r}),t===MediaError.MEDIA_ERR_DECODE&&setTimeout(xc.onVideoTagDecodeError,2e3)}}function fl(e,t){var r=t.id,n=t.initPTS;"main"===r&&ii.dispatch(function(e){return{type:p,payload:{initPTS:e}}}(n))}function hl(e,t){var r=t.length;switch(e){case"high":return t[0];case"med":return t[Math.floor(r/2)];case"low":return t[r-1]}}function pl(){Za.once(Za.TYPES.streamTypeSelected).send();var e=!(0,o.default)(Ic,"levels.0.videoCodec",!1);ii.dispatch((0,m.zp)(e));var t=0===(0,o.default)(Ic,"audioTracks",[]).length;if(ii.dispatch((0,m.Sc)(t)),Cc.debug("start loading",{savedQuality:Kc,savedSubtitle:Hc,savedAudio:Zc,savedSeekPosition:Vc}),"number"==typeof Kc)Ic.startLevel=Kc,Ic.currentLevel=Kc,Kc=null;else{var r=(0,Y.j)("initialquality");if(r){var n=hl(r,tl()).id;Ic.startLevel=n}var a=(0,Y.j)("forcedquality");if(a){var i=hl(a,tl()).id;Ic.startLevel=i,Ic.currentLevel=i,ii.dispatch(w(i))}}"number"==typeof Hc&&(Ic.subtitleTrack=Hc,Hc=null),"number"==typeof Zc&&(Ic.audioTrack=Zc,Zc=null),Ic.startLoad(Vc||-1),Vc=null}function gl(e,t){var r=t.level,n=Ic.levels[r];xc.onPlaybackInfo(n),xc.onQualityChangeEnd();var a=Date.now(),i=(0,j.g2)(ii.getState()),s=(0,j.XK)(ii.getState());void 0!==i&&Za.send(Za.TYPES.qualityChangeCompleted,{toBitrateInKbps:(0,o.default)(n,"bitrate",0)/1e3,toHeight:(0,o.default)(n,"height",0),timeSpent:a-i,bufferSpent:s>i?a-s:-1})}function vl(){var e;(e=xc).onAudioChangeEnd.apply(e,arguments),Uo.send(Uo.TYPES.playingChange,zc())}function ml(e,t){!function(e,t,r){var n=e.id,a=e.frag,i=a.startPTS,o=a.endPTS,s=a.level;if(void 0!==i&&void 0!==o)try{switch(n){case"main":var u=t[s];if(!u||!u.height)break;var c="video_".concat(u.height);pc[c]||(pc[c]=[]),yc(c,i,o);break;case"audio":var l=r.find((function(e){return e.id===s}));if(!l||!l.lang)break;var d="audio_".concat(l.lang);pc[d]||(pc[d]=[]),yc(d,i,o)}}catch(e){console.log(e)}}(t,Ic.levels,rl()),function(e){var t=e.id,r=e.stats,n=r.bwEstimate,a=r.tfirst,i=r.trequest;"main"!==t&&"audio"!==t||!n||(Sc=Sc.concat({bandwidth:n/1e3,waitingTimeInSec:(a-i)/1e3}).slice(-5))}(t)}function yl(e,t){var r,n,a,i=t.id,o=t.data1,s=t.frag;try{var u=(r=o,n=(0,wc.parse)(r),0===(a=(0,wc.getFragments)(n)).length?{start:0,end:0,keyFrames:[]}:{start:a[0].start/1e3,end:a[a.length-1].end/1e3,keyFrames:a.filter((function(e){return e.containsRAP})).map((function(e){return e.start/1e3}))});Cc.debug("Segment parsed",Ac({type:s.type,level:s.level,sn:s.sn,url:s.url,expectedDuration:s.duration},u)),"main"===i&&(function(e){bc=bc.concat(e).sort((function(e,t){return e.start-t.start})).splice(-5)}(u),xc.onKeyframeInterval(0===bc.length?0:bc.map((function(e){return e.keyFrames})).flat().map((function(e,t,r){return r[t+1]?r[t+1]-e:0})).filter((function(e){return e>.1})).reduce((function(e,t,r){return(e*r+t)/(r+1)}),0))),"audio"===s.type&&0===s.sn&&u.start>4e3&&u.end>4e3&&Za.send(Za.TYPES.audioChunkAppendError,{start:u.start,end:u.end})}catch(e){Cc.warn("Segment parse error",{error:e.message,url:s.url})}}function bl(e,t){var r=t.stats,n=t.frag,a=t.networkDetails,i=(0,o.default)(a,"responseURL",""),s=Ss.isEcdnProvider(i),u=r.trequest,c=r.tfirst,l=r.tload,d=r.total,f=parseInt(c-u,10),h=parseInt(l-c,10),p=f+h;p>=5e3&&function(e){var t=e.request,r=e.response,n=e.total,a=e.isEcdn,i="Total: ".concat(n,"ms Req: ").concat(t,"ms Res: ").concat(r,"ms");ii.dispatch((0,U.Xw)({level:N.Q.WARNING,timeStamp:Date.now(),msg:i,request:t,response:r,total:n,isEcdn:a}))}({response:h,request:f,total:p,isEcdn:s}),Uo.aggregate(Uo.TYPES.bandwidthChange,{time:l-u,size:d,url:i,isEcdn:s}),xc.onDownload(n)}function Sl(){if(Dc){var e=Dc,t=e.currentTime,r=e.buffered;ii.dispatch((0,f.x4)(gc(r),t)),ii.dispatch((0,y.N)((n=0===Sc.length?{shortMean:0,longMean:0,waitingTimeInSec:0}:{shortMean:Ec(Sc.slice(-3).map((function(e){return e.bandwidth}))),longMean:Ec(Sc.map((function(e){return e.bandwidth}))),waitingTimeInSec:Ec(Sc.map((function(e){return e.waitingTimeInSec})))},a=n.shortMean,i=n.longMean,s=n.waitingTimeInSec,u=el(),c=u.quality,{throughput:{shortMean:a,longMean:i,waitingTimeInSec:s},sourceStreamVersion:u.id,bitrate:(0,o.default)(c,"bitrate",0)/1e3,filters:{names:["N/A"]}}),t))}var n,a,i,s,u,c}function El(e){var t=(0,o.default)(e,"details.startSN",0),r=(0,o.default)(e,"details.fragments",[]).find((function(e){return e.sn===t}));return(0,o.default)(r,"start",0)}function Tl(e,t){var r,n,a;r=t.timeRanges,n=r.audio,a=r.video,n&&Object.keys(pc).filter((function(e){return e.includes("audio")})).forEach((function(e){return mc(e,n)})),a&&Object.keys(pc).filter((function(e){return e.includes("video")})).forEach((function(e){return mc(e,a)})),Sl();var i=ii.getState();(0,j.V4)(i)!==m.w_.live&&function(){if(Dc){var e=Dc,t=e.duration,r=e.seeking;if(t&&t!==1/0&&r){var n,a,i=Dc.currentTime,o=(n=El(rl().find((function(e){return e.active}))),a=El(tl().find((function(e){return e.active}))),Math.max(n,a));i<o&&(Cc.info("initial gap recovery",{currentTime:i,contentStart:o}),Dc.currentTime=o)}}}()}function wl(){Sl()}function Ol(){pc.text=[]}function Al(e,t){var r=t.cues;Ic&&(function(e,t){Gc[e]=[].concat(Rc(Yc(e)),Rc(t)).filter((function(e,t,r){return r.findIndex((function(t){return t.id===e.id}))===t}))}(Ic.subtitleTrack,r),_l())}function _l(){if(Ic&&Ic.media){var e=(0,Y.j)("externalvtt")?"external":Ic.subtitleTrack,t=Ic.media.currentTime,r=Yc(e).filter((function(e){var r=e.startTime,n=e.endTime;return r<=t&&n>=t})),n=ii.getState();0===r.length&&0===n.captionSettings.activeCues.length||ii.dispatch((0,b._r)(r))}}function Rl(e){if("NotAllowedError"===e.name){Za.send(Za.TYPES.notAllowed,{errorMessage:e.message}),Gn(sn.error,{name:ln.autoplayRejected,message:e.message});var t=ii.getState();(0,j.Vl)(t)||ii.dispatch((0,f.uy)(!0))}}var kl={play:function(){return(0,j.X3)(ii.getState())&&ii.dispatch((0,f.lZ)(!1)),ii.dispatch((0,f.OH)(!0)),Dc.play().catch(Rl)},pause:function(){ii.dispatch((0,f.OH)(!1)),Dc.pause()},seek:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:B._.USER;(0,j.X3)(ii.getState())&&ii.dispatch((0,f.lZ)(!1)),(0,j.V4)(ii.getState())!==m.w_.live&&(Za.send(Za.TYPES.seekStarted),Gn(sn.seekStarted,{from:Sn(1e3*Dc.currentTime)/1e3,to:Sn(1e3*e)/1e3,initiator:t})),Dc.currentTime=e},load:function(e){var t=e.masterPlaylist,r=e.providerQueryParam,n=e.provider;Cc.info("load",{masterPlaylist:t,providerQueryParam:r,provider:n}),jc=n;var i=ii.getState();return(0,j.Vl)(i)&&ii.dispatch((0,f.uy)(!1)),function(){if(!Ic){var e=Ts||ws;(Ic=new(a())({bufferController:e?dc:a().DefaultConfig.bufferController,manifestLoadingMaxRetry:1/0,levelLoadingMaxRetry:1/0,manifestLoadingMaxRetryTimeout:16e3,levelLoadingMaxRetryTimeout:16e3,debug:{debug:function(e){l.Z.debug({line:e,source:Lc})},log:function(e){l.Z.info({line:e,source:Lc})},info:function(e){l.Z.info({line:e,source:Lc})},warn:function(e){l.Z.warn({line:e,source:Lc})},error:function(e){l.Z.error({line:e,source:Lc})}},pLoader:Gs(Cc),fLoader:rc(Nc,Cc),enableWebVTT:!(0,Y.j)("externalvtt"),autoStartLoad:!1,liveBackBufferLength:10,renderTextTracksNatively:!1})).on(a().Events.INIT_PTS_FOUND,fl),Ic.on(a().Events.MANIFEST_LOADED,pl),Ic.on(a().Events.LEVEL_SWITCHED,gl),Ic.on(a().Events.AUDIO_TRACK_SWITCHED,vl),Ic.on(a().Events.FRAG_BUFFERED,ml),Ic.on(a().Events.SUBTITLE_FRAG_PROCESSED,vc),Ic.on(a().Events.SUBTITLE_TRACK_SWITCH,Ol),Ic.on(a().Events.ERROR,xc.onError),Ic.on(a().Events.FRAG_PARSING_DATA,yl),Ic.on(a().Events.FRAG_LOADED,bl),Ic.on(a().Events.BUFFER_APPENDED,Tl),Ic.on(a().Events.BUFFER_FLUSHED,wl),Ic.on(a().Events.CUES_PARSED,Al)}}(),Dc&&(Dc.addEventListener("timeupdate",sl),Dc.addEventListener("durationchange",qc),Dc.addEventListener("canplay",Wc),Dc.addEventListener("play",Xc),Dc.addEventListener("pause",Qc),Dc.addEventListener("playing",Jc),Dc.addEventListener("waiting",$c),Dc.addEventListener("seeked",cl),Dc.addEventListener("ended",ll),Dc.addEventListener("error",dl)),new Promise((function(e){Ic.once(a().Events.MEDIA_ATTACHED,(function(){Ic.once(a().Events.MANIFEST_PARSED,(function(){setTimeout((function(){var e=Ic,t=e.url,r=e.levels,n=void 0===r?[]:r,a=e.audioTracks,i=void 0===a?[]:a,o=e.subtitleTracks,u=void 0===o?[]:o;Cc.debug("master manifest parsed",{url:t,levels:n.map((function(e,t){return Ac({id:t},(0,s.Z)(e,["bitrate","height","width","audioCodec","videoCodec"]))})),audioTracks:i.map((function(e,t){return Ac({id:t},(0,s.Z)(e,["audioCodec","autoselect","default","lang","name","type"]))})),subtitleTracks:u.map((function(e,t){return Ac({id:t},(0,s.Z)(e,["autoselect","default","lang","name","type"]))}))},!0)}),0),e()}));var n=new URL(t);n.searchParams.set(r,Fc);var i=ii.getState();(0,F.Mr)(i)&&n.searchParams.set("audioOnly",!0),Ic.loadSource(n.toString())})),Ic.attachMedia(Dc)}))},init:function(e,t){var r=t.onNetworkChange,n=t.onPlaybackInfo,a=t.onKeyframeInterval,i=t.onQualityChangeEnd,o=t.onAudioChangeEnd,s=t.onLoadingChange,u=t.onError,c=t.onDownload,l=t.onVideoTagDecodeError;Mc||(Dc=e,xc={onNetworkChange:r,onPlaybackInfo:n,onKeyframeInterval:a,onQualityChangeEnd:i,onAudioChangeEnd:o,onLoadingChange:s,onError:u,onDownload:c,onVideoTagDecodeError:l},Uc.volume=ii.subscribe("player.volume",nl),Uc.speed=ii.subscribe("player.speed",al),Uc.externalVtt=ii.subscribe("externalVtt",ol),Uc.liveStatus=ii.subscribe("content.liveStatus",il),nl((0,j.FC)(ii.getState())),Mc=!0)},version:function(){return a().version},getQualities:tl,setQuality:function(e){if(Ic){var t,r=Ic.currentLevel;if(-1!==r){var n=Ic.levels[r];Za.send(Za.TYPES.qualityChangeStarted,{fromBitrateInKbps:(0,o.default)(n,"bitrate",0)/1e3,fromHeight:(0,o.default)(n,"height",0)}),ii.dispatch((t=performance.now(),{type:D,payload:t}))}Ic.currentLevel=e,ii.dispatch(w(e))}},getSubtitleTracks:function(){return(0,Y.j)("externalvtt")||!Ic?[]:Ic.subtitleTracks},setSubtitleTrack:function(e){Ic&&(Ic.subtitleTrack=e)},disableSubtitles:function(){Ic&&(Ic.subtitleTrack=-1)},getAudioTracks:rl,setAudioTrack:function(e){Ic&&(Ic.audioTrack=e)},changeProvider:function(e){Cc.info("change provider",{prev:jc,next:e}),jc=e},getCurrentProvider:function(){return jc},getSource:function(){if(Ic)return Ic.url},unload:ul,destroy:function(){Mc&&(Object.values(Uc).forEach((function(e){return e()})),Uc={},ul(),Dc=null,xc={},Mc=!1)},setCCPosition:function(e){var t,r="default"!==(t=e)&&Bc[t]?Bc[t]:-4;ii.dispatch(function(e){return{type:v,payload:{captionPosition:e}}}(r)),function(e){Dc&&Array.from(Dc.textTracks).forEach((function(t){t.cues&&Array.from(t.cues).forEach((function(t){t.line=e}))}))}(r)},startLoad:function(e){Ic&&Ic.startLoad(e)},saveSeekPosition:function(){Vc=Dc.currentTime},saveQuality:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ic.currentLevel;Kc=e},saveSubtitle:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ic.subtitleTrack;Hc=e},saveAudio:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ic.audioTrack;Zc=e},webkitEnterFullscreen:function(){try{(0,d.g)(Dc)}catch(e){Gn(sn.error,{name:ln.webkitEnterFullscreenRejected,message:e.message})}}},Pl=r(46403),Cl={debug:function(){}};function Ll(e){var t=e.date,r=e.source,n=e.line,a=e.data,i=e.level;if(void 0!==window.console){var o=function(){switch(i){case Pl.Z.FATAL:case Pl.Z.ERROR:return{logger:console.error,color:"red"};case Pl.Z.WARN:return{logger:console.warn,color:"brown"};case Pl.Z.INFO:return{logger:console.info};case Pl.Z.DEBUG:default:return{logger:console.debug}}}(),s=o.logger,u=o.color,c=void 0===u?"black":u,l=["%c[".concat(new Date(t).toISOString().slice(-13,-1),"] %c").concat(r,": %c").concat(n),"color: #cecece","font-weight: 600; color: ".concat(c),"font-weight: 300"];void 0!==a&&l.push(a),s.apply(void 0,l)}}function Dl(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";Za.send(Za.TYPES.unhandledException,{message:e,stack:t.substring(0,2e3)})}var Il=r(46060),xl=r(72912),Ml=r(84457),Ul=r(91823),jl=r(88775),Fl=ra.Z.config.api||ra.Z.fallbackConfig.api,Nl=(0,l.w)("logic/captionSearchService");function Bl(e){Nl.error("searchOnError",e),ii.dispatch((0,jl.KU)())}function Gl(e,t){if(t)if(void 0!==t.token){var r=t.token;e?function(e,t){var r=new XMLHttpRequest;function n(){return Bl("".concat(r.status," ").concat(r.statusText))}r.addEventListener("load",(function(){if(200===r.status)try{e=JSON.parse(r.responseText),Nl.debug("searchOnSuccess",e.caption_matches),ii.dispatch((0,jl.KU)(e.caption_matches))}catch(e){Bl("Response JSON parse failed")}else n();var e})),r.addEventListener("error",n),r.open("GET",function(e){var t=new URL("https://".concat(Fl)),r=(0,j.hB)(ii.getState()).id;return t.pathname="videos/".concat(r,"/captions/search.json"),t.searchParams.set("q",function(e){return e.replace(/\s/g,"+")}(e)),t.searchParams.set("highlight",!0),t.toString()}(e),!0),r.setRequestHeader("Authorization","Bearer ".concat(t)),r.send()}(e,r):Bl("Cannot call search api with empty search text.")}else Nl.error("There is no token for search api.");else Nl.error("There is no module for search api")}var Vl=r(49166);function Kl(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Hl(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Kl(Object(r),!0).forEach((function(t){Zl(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Kl(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Zl(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Yl(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,a)}function ql(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){Yl(i,n,a,o,s,"next",e)}function s(e){Yl(i,n,a,o,s,"throw",e)}o(void 0)}))}}var Wl,zl=(0,l.w)("cronus/logic/slideDeck/slideDeckHandler"),Xl=!bn().ie||bn().ie[0]&&bn().ie[0]>9,Ql=(Wl=[],function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=e.map((function(e){return(0,o.default)(e,"url","")})),r=Wl.filter((function(e){return!t.includes(e)}));r.forEach(URL.revokeObjectURL),Wl=t});function $l(e){var t=new Blob([e],{type:"image/jpeg"});return URL.createObjectURL(t)}var Jl=function(){if(!Xl)return function(){var e=new Error("Browser not supported");return Promise.reject(e)};var e=null,t=null;function n(){return a.apply(this,arguments)}function a(){return(a=ql(regeneratorRuntime.mark((function n(){var a,i;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e=new Map,n.next=3,Promise.all([r.e(142),r.e(251)]).then(r.bind(r,95744));case 3:a=n.sent,i=a.default,(t=new i).addEventListener("message",(function(t){var r=t.data,n=r.url,a=r.error,i=r.buffer,o=e.get(n);o&&(e.delete(n),a?o(new Error(a),null):o(null,i))})),t.addEventListener("error",(function(e){e.preventDefault(),zl.error(e.message)}));case 8:case"end":return n.stop()}}),n)})))).apply(this,arguments)}return function(){var r=ql(regeneratorRuntime.mark((function r(a){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(null!==t){r.next=3;break}return r.next=3,n();case 3:return r.abrupt("return",new Promise((function(r,n){var i=a.url,o=a.secret;e.set(i,(function(e,t){if(e)n(e);else{var i=Hl(Hl({},a),{},{url:$l(t)});r(i)}})),t.postMessage({url:i,secret:o})})));case 4:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()}();function ed(e){return Hl({start:-1/0,end:1/0},e)}function td(e){if(Xl&&(!Array.isArray(e)||e.length>0))if(e){var t=function(e){if(Array.isArray(e))return e.map(ed);if(e.show){var t=e.show;return[ed({url:t.url,secret:t.secret})]}return[]}(e);!function(e){if(0!==e.length){var t=[];e.forEach((function(e){Promise.resolve().then((function(){return function(e){return!!(0,o.default)(e,"url")}(e)?Jl(e):e})).then((function(e){t.push(e),ii.dispatch((0,Vl.Yw)(t))})).catch((function(e){zl.error('Decoding error: "'.concat(e.message,'"'))}))}))}else ii.dispatch((0,Vl.Yw)([]))}(t)}else ii.dispatch((0,Vl.h$)())}function rd(e){var t=1e3*e,r=ii.getState().slideDeck,n=r.slides.find((function(e){var r=e.start,n=e.end;return r<=t&&t<=n}));(0,o.default)(n,"url")!==(0,o.default)(r.currentSlide,"url")&&(zl.info("slide update",n),ii.dispatch((0,Vl.sO)(n)))}var nd=function(){ii.subscribe("slideDeck.slides",Ql),ii.subscribe("slideDeck.module",td),ii.subscribe("playback.currentTime",rd)},ad=r(88820);function id(e){return{type:q,payload:{adsPlaying:e}}}function od(e){return{type:W,payload:{ruleset:e}}}function sd(e){var t;try{var r=new URL(e);t=/ustream\.tv(?:\.lh)?$/.test(r.hostname)}catch(e){t=!1}return t}function ud(e){var t;try{var r=new URL(e);t=/ibm\.com$/.test(r.hostname)}catch(e){t=!1}return t}var cd="http://".concat(ra.Z.config.cdngwPlain),ld="https://".concat(ra.Z.config.cdngwSecure),dd=bn().ssl?ld:cd;function fd(e,t){if(!e.adTag)return e;var r=function(e,t){var r=Ue.Z.cId,n=ii.getState().content.title,a=(0,j.hB)(ii.getState()).id,i=(0,j.V4)(ii.getState()),o=e.adTag;if(o=hd(o,"REFERRER",Mi.Z),o=hd(o,"CHANNEL_PAGE_URL",Mi.Z),o=hd(o,"CHANNEL",r),o=hd(o,"CACHE_BREAKER",Math.round(1e7*Math.random())),n){var s=encodeURI(n.substr(0,100));o=hd(o,"TITLE",s)}return i!==m.w_.live&&(o=hd(o,"VIDEOID",a)),t&&Object.keys(t).forEach((function(e){var r="CUSTOM_META-ID".concat(e),n=t[e],a="".concat(n.displayName,"=").concat(n.value);o=hd(o,r,a)})),o}(e,t),n=new URL(r);return(ud(Mi.Z)||sd(Mi.Z)||"unknown"===Mi.Z)&&n.searchParams.set("npa","1"),Object.assign(e,{adTag:n.href})}function hd(e,t,r){return r?e.replace(new RegExp("__".concat(t,"__"),"g"),r):e}var pd,gd=function(e){var t=e.mediaId,r=e.mediaType,n=e.countryCode,a=Ue.Z.locale,i={brandId:1,mediaId:t,mediaType:r===m.w_.live?"channel":"recorded",countryCode:n,locale:a,device:"web",pageUrl:encodeURIComponent(Mi.Z)},o="".concat(dd,"/rgwjson/Viewer.getAdverts/").concat(encodeURIComponent(JSON.stringify(i)));return fetch(o,{mode:"cors"}).then((function(e){if(!e.ok)throw new Error("".concat(e.status," ").concat(e.statusText));return e})).then((function(e){return e.json()})).then((function(e){return e.ads}))},vd=function(e){return!!e&&Object.values(z).some((function(t){return(e[t]||[]).length>0}),[])},md=function(e){for(var t=Object.values(z),r={},n=0;n<t.length;n+=1){var a=t[n];Object.prototype.hasOwnProperty.call(e,a)&&e[a].length?function(){var t=(0,o.default)(e,a),n=Object.values(X),i=t.filter((function(e){return-1!==n.indexOf(e.provider)}));r[a]=i.map((function(t){return fd(t,e.metadata)}))}():r[a]=[]}return r},yd=r(89645),bd=["AT","BE","BG","CH","HR","CY","CZ","DE","DK","EE","ES","FI","FR","GB","GR","HU","IE","IS","IT","LT","LU","LV","MT","NO","NL","PO","PT","RO","SE","SI","SK"],Sd=function(e){return-1!==bd.indexOf(e)},Ed=(0,l.w)("privacyCookieChecker");function Td(){var e=ii.getState().privacy.ibmCookie,t=ur.ZP.get("truste.eu.cookie.notice_preferences");t&&t!==e&&ii.dispatch((0,yd.X)(t))}function wd(){pd&&clearInterval(pd),pd=null}function Od(e){return!e||Sd(e)}var Ad={startCheck:function(){wd(),Td(),pd=setInterval(Td,1e3)},stopCheck:wd,isGDPRUser:Od,canStartAutoplay:function(){var e=ud(Mi.Z)||sd(Mi.Z)||"unknown"===Mi.Z,t=ii.getState().content,r=t.countryCode,n=t.regionCode;if(Ed.debug("canStartAutoplay",{needsCheckOnThisDomain:e,referrer:Mi.Z,countryCode:r,regionCode:n}),e&&(Od(r)||function(e){return!e||"CA"===e}(n))){var a=ii.getState().privacy.ibmCookie;if(Ed.debug("canStartAutoplay",{cookieConsentConfirmed:a}),!a)return!1}return!0},areAdsEnabled:function(e){var t=ii.getState().privacy.ibmCookie;return t&&-1===t.indexOf("0:")&&-1===t.indexOf("1:")||!t&&e&&!Sd(e)}};function _d(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,a)}function Rd(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){_d(i,n,a,o,s,"next",e)}function s(e){_d(i,n,a,o,s,"throw",e)}o(void 0)}))}}var kd=(0,l.w)("cronus/advert"),Pd="//imasdk.googleapis.com/js/sdkloader/ima3.js",Cd=null,Ld=null,Dd=null,Id=null,xd=!1,Md=!1;function Ud(){kd.debug("sdk loaded")}function jd(){throw new Error("sdk load failed")}function Fd(e,t){(Id=t.getAdsManager(e)).addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,Vd),Id.addEventListener(google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,Nd),Id.addEventListener(google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,Bd),Id.addEventListener(google.ima.AdEvent.Type.STARTED,$d),Id.addEventListener(google.ima.AdEvent.Type.COMPLETE,Jd);try{var r=(0,F.hz)(ii.getState()),n=r.width,a=r.height;Id.init(n,a,google.ima.ViewMode.NORMAL),Id.start()}catch(e){ii.dispatch(id(!1)),Cd.ui.setAdvertVisibility(!1),kl.play()}}function Nd(){var e=Cd.ui;ii.dispatch(id(!0)),e.setAdvertVisibility(!0),kl.pause()}function Bd(){Kd()}function Gd(){Dd&&Dd.contentComplete()}function Vd(e){kd.debug("onAdError",e.getError()),Id&&Id.destroy(),Kd()}function Kd(){ii.dispatch(id(!1)),Cd.ui.setAdvertVisibility(!1),kl.play()}function Hd(e){var t=(0,j.c4)(ii.getState());if(t&&t.adTag){var r=(0,F.hz)(ii.getState()),n=r.width,a=r.height,i=(0,j.FC)(ii.getState()),o=new google.ima.AdsRequest;o.adTagUrl=t.adTag,o.linearAdSlotWidth=n,o.linearAdSlotHeight=a,o.nonLinearAdSlotWidth=n,o.nonLinearAdSlotHeight=a,o.setAdWillAutoPlay(e),o.setAdWillPlayMuted(!i),Dd.requestAds(o)}}function Zd(){return Yd.apply(this,arguments)}function Yd(){return(Yd=Rd(regeneratorRuntime.mark((function e(){var t,r,n,a,i,o,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=ii.getState().content,r=t.mediaType,n=t.countryCode,a=(0,j.hB)(ii.getState()),i=a.id,e.next=4,gd({mediaId:i,mediaType:r,countryCode:n});case 4:if(o=e.sent,vd(o)){e.next=7;break}throw new Error("there is no ruleset in the result");case 7:s=md(o),ii.dispatch(od(s));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function qd(){return Wd.apply(this,arguments)}function Wd(){return(Wd=Rd(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ad.Z.js(Pd).then(Ud,jd);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function zd(){var e=ii.getState().ads.enabled;return Ad.areAdsEnabled()&&e&&!Ue.Z.isDashboard}function Xd(){return Xd=Rd(regeneratorRuntime.mark((function e(t){var r,n,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.videoTag,n=t.adContainerId,a=t.autoplay,Cd=t,Md=!0,zd()){e.next=7;break}return Qd(),Kd(),e.abrupt("return");case 7:return kl.pause(),e.prev=8,e.next=11,Zd();case 11:return e.next=13,qd();case 13:ii.subscribe("playback.ended",Gd),xd||ef(r,n),Hd(a),e.next=23;break;case 18:e.prev=18,e.t0=e.catch(8),kd.error("there was an error initializing adverts.",e.t0),Qd(),Kd();case 23:case"end":return e.stop()}}),e,null,[[8,18]])}))),Xd.apply(this,arguments)}function Qd(){kd.debug("destroy"),Id&&(Id.removeEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,Vd),Id.removeEventListener(google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,Nd),Id.removeEventListener(google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,Bd),Id.removeEventListener(google.ima.AdEvent.Type.STARTED,$d),Id.removeEventListener(google.ima.AdEvent.Type.COMPLETE,Jd),Id.destroy(),Id=null),Dd&&(Dd.removeEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,Fd),Dd.removeEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,Vd),Dd.destroy(),Dd=null),Ld&&(Ld.destroy(),Ld=null),xd=!1}function $d(){Za.send(Za.TYPES.prerollStarted)}function Jd(){Za.send(Za.TYPES.prerollFinished)}function ef(e,t){(Ld=new google.ima.AdDisplayContainer(document.getElementById(t),e)).initialize(),Dd=new google.ima.AdsLoader(Ld),kd.debug("google IMA sdk version",Dd.getVersion()),Dd.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,Fd.bind(null,e),!1),Dd.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,Vd,!1),xd=!0}var tf,rf={init:function(e){return Xd.apply(this,arguments)},isInitialized:function(){return Md},reset:function(){Qd(),Md&&(ii.dispatch(id(!1)),Cd.ui.setAdvertVisibility(!1),Md=!1)}};function nf(){var e=ii.getState().content.offairContent;return(0,o.default)(e,"videos",[]).length>0}function af(){var e=ii.getState(),t=(0,j.gx)(e),r=e.content,n=r.offairContent;r.mediaType;if(void 0!==t&&void 0!==n){var a=function(e,t,r,n){var a;return a=r?m.w_.live:void 0===t&&nf()?m.w_.offairVideo:function(){var e=ii.getState().content.offairContent;return(0,o.default)(e,"pictures",[]).length>0}()?m.w_.offairSlide:m.w_.offairScreen,a}(0,tf,t);tf=t,function(e){ii.dispatch((0,m.y5)(e))}(a)}}function of(){af()}function sf(){if(ii.getState().content.mediaType!==m.w_.offairVideo||!nf())return null;var e=ii.getState().content,t=e.currentOffairVideoId,r=e.offairContent.videos,n=void 0===r?[]:r,a=(t?n.indexOf(t):-1)+1;return a>=n.length?null:n[a]}function uf(){tf=void 0}var cf=function(){ii.subscribe("content.offairContent",(function(e,t){var r,n;r=e,n=t,JSON.stringify(n)===JSON.stringify(r)||af()})),ii.subscribe("content.liveStatus",of),ii.subscribe("content.mediaId",uf)},lf=function(){var e=sf();e&&ii.dispatch((0,m.C1)(e))},df=function(){return!!sf()},ff=!1;function hf(){var e=ii.getState(),t=(0,j.gx)(e);e.content.channelContentAvailable?ii.dispatch((0,m.Gz)(!0)):void 0===t?ii.dispatch((0,m.Gz)(!1)):ff=!0}function pf(){ii.getState().content.mediaType===m.w_.live&&(ff&&ii.dispatch((0,m.Gz)(!1)),ff=!1)}function gf(){ff=!1}var vf=function(){ii.subscribe("content.channelContentAvailable",hf),ii.subscribe("content.mediaId",gf),ii.subscribe("playback.ended",pf)},mf=new Blob([new Uint8Array([255,227,24,196,0,0,0,3,72,1,64,0,0,4,132,16,31,227,192,225,76,255,67,12,255,221,27,255,228,97,73,63,255,195,131,69,192,232,223,255,255,207,102,239,255,255,255,101,158,206,70,20,59,255,254,95,70,149,66,4,16,128,0,2,2,32,240,138,255,36,106,183,255,227,24,196,59,11,34,62,80,49,135,40,0,253,29,191,209,200,141,71,7,255,252,152,74,15,130,33,185,6,63,255,252,195,70,203,86,53,15,255,255,247,103,76,121,64,32,47,255,34,227,194,209,138,76,65,77,69,51,46,57,55,170,170,170,170,170,170,170,170,170,170,255,227,24,196,73,13,153,210,100,81,135,56,0,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170])],{type:"audio/mpeg"}),yf=new Blob([new Uint8Array([0,0,0,28,102,116,121,112,105,115,111,109,0,0,2,0,105,115,111,109,105,115,111,50,109,112,52,49,0,0,0,8,102,114,101,101,0,0,2,239,109,100,97,116,33,16,5,32,164,27,255,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,55,167,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,112,33,16,5,32,164,27,255,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,55,167,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,112,0,0,2,194,109,111,111,118,0,0,0,108,109,118,104,100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,232,0,0,0,47,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,1,236,116,114,97,107,0,0,0,92,116,107,104,100,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,47,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,36,101,100,116,115,0,0,0,28,101,108,115,116,0,0,0,0,0,0,0,1,0,0,0,47,0,0,0,0,0,1,0,0,0,0,1,100,109,100,105,97,0,0,0,32,109,100,104,100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,172,68,0,0,8,0,85,196,0,0,0,0,0,45,104,100,108,114,0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0,0,0,1,15,109,105,110,102,0,0,0,16,115,109,104,100,0,0,0,0,0,0,0,0,0,0,0,36,100,105,110,102,0,0,0,28,100,114,101,102,0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1,0,0,0,211,115,116,98,108,0,0,0,103,115,116,115,100,0,0,0,0,0,0,0,1,0,0,0,87,109,112,52,97,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,2,0,16,0,0,0,0,172,68,0,0,0,0,0,51,101,115,100,115,0,0,0,0,3,128,128,128,34,0,2,0,4,128,128,128,20,64,21,0,0,0,0,1,244,0,0,1,243,249,5,128,128,128,2,18,16,6,128,128,128,1,2,0,0,0,24,115,116,116,115,0,0,0,0,0,0,0,1,0,0,0,2,0,0,4,0,0,0,0,28,115,116,115,99,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,2,0,0,0,1,0,0,0,28,115,116,115,122,0,0,0,0,0,0,0,0,0,0,0,2,0,0,1,115,0,0,1,116,0,0,0,20,115,116,99,111,0,0,0,0,0,0,0,1,0,0,0,44,0,0,0,98,117,100,116,97,0,0,0,90,109,101,116,97,0,0,0,0,0,0,0,33,104,100,108,114,0,0,0,0,0,0,0,0,109,100,105,114,97,112,112,108,0,0,0,0,0,0,0,0,0,0,0,0,45,105,108,115,116,0,0,0,37,169,116,111,111,0,0,0,29,100,97,116,97,0,0,0,1,0,0,0,0,76,97,118,102,53,54,46,52,48,46,49,48,49])],{type:"video/mp4"});function bf(e){return Object.assign({muted:!1,timeout:250,inline:!1},e)}function Sf(e,t){var r=e.muted,n=e.timeout,a=e.inline,i=t(),o=i.element,s=i.source,u=void 0,c=void 0,l=void 0;return o.muted=r,!0===r&&o.setAttribute("muted","muted"),!0===a&&o.setAttribute("playsinline","playsinline"),o.src=s,new Promise((function(e){u=o.play(),c=setTimeout((function(){l(!1,new Error("Timeout "+n+" ms has been reached"))}),n),l=function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;o.remove(),o.srcObject=null,clearTimeout(c),e({result:t,error:r})},void 0!==u?u.then((function(){return l(!0)})).catch((function(e){return l(!1,e)})):l(!0)}))}var Ef={audio:function(e){return Sf(e=bf(e),(function(){return{element:document.createElement("audio"),source:URL.createObjectURL(mf)}}))},video:function(e){return Sf(e=bf(e),(function(){return{element:document.createElement("video"),source:URL.createObjectURL(yf)}}))}},Tf=Ef,wf=function(e,t){return 1024*(e-55296)+t-56320+65536},Of=function(e){return[Math.floor((e-65536)/1024)+55296,(e-65536)%1024+56320]},Af=function(e){return 55296==(63488&e)};function _f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Rf(){}Rf.prototype.decode=function(e){for(var t=e instanceof ArrayBuffer?new Uint8Array(e):e,r="",n=0,a=function(){var e,a=[240,224,192],i=t[n],o=i,s=0,u=a.findIndex((function(e){return i>=e}));if(-1!==u){s=3-u,o=i-a[u];for(var c=1;c<=s;c++)o=o<<6|t[n+c]-128}if(0===u){var l=Of(o);r+=String.fromCharCode.apply(String,function(e){if(Array.isArray(e))return _f(e)}(e=l)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return _f(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_f(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())}else r+=String.fromCharCode(o);n+=s+1};n<t.length;)a();return r};var kf=window.TextDecoder;function Pf(){}Pf.prototype.encode=function(e){for(var t=[7,11,16,22],r=[0,192,224,240],n=[],a=e.length,i=0,o=function(a){var o=e[a].charCodeAt();Af(o)&&(o=wf(o,e.charCodeAt(++a)),i-=1);var u=o.toString(2).length,c=t.findIndex((function(e){return e>=u}));i+=c;var l=[];if(c){for(var d=0;d<c;d++){var f=128|63&o;o>>=6,l[c-d]=f}l[0]=r[c]|o}else l[0]=o;n.push.apply(n,l),s=a},s=0;s<a;s++)o(s);var u=new Uint8Array(a+i);return n.forEach((function(e,t){u[t]=e})),u};var Cf=window.TextEncoder;window.TextDecoder=kf||Rf,window.TextEncoder=Cf||Pf;var Lf=r(66533),Df=r(13535);function If(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i=[],o=!0,s=!1;try{for(r=r.call(e);!(o=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);o=!0);}catch(e){s=!0,a=e}finally{try{o||null==r.return||r.return()}finally{if(s)throw a}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return xf(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?xf(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xf(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Mf(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,a)}function Uf(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){Mf(i,n,a,o,s,"next",e)}function s(e){Mf(i,n,a,o,s,"throw",e)}o(void 0)}))}}var jf,Ff=(0,l.w)("index"),Nf=null,Bf={},Gf=!1,Vf=!0,Kf=function(){},Hf=[];function Zf(){Lf.S1(c().playerState.get(),(function(e){e?oi.dispatch((0,_t.c0)(_t.GT.assistedReporting)):oi.dispatch((0,_t.yK)(_t.GT.assistedReporting))}),{recovery:5e3})}function Yf(){var e={waiting:(0,j.V4)(ii.getState())===m.w_.live?1e4:2e4,stalled:1e4};c().playerState.init(e);var t=(0,o.default)(ra.Z,"config.crt","crt-event-ingest.services.video.ibm.com");c().sender.init({ingestURL:"https://".concat(t,"/ingest"),clockSyncURL:"https://".concat(t,"/time"),getEnv:function(){function e(e){var t=(0,s.Z)(e,["label","language","country"]),r=t.label,n=t.language,a=t.country;return r&&n&&a?{languageCode:"".concat(n,"-").concat(a),name:r}:{}}var t=ii.getState(),r=function(){var e=c().playerState.STATES;switch(c().playerState.get().state){case e.playing:return"playing";case e.buffering:case e.stalled:return"buffering";case e.init:case e.waiting:case e.ready:default:return"stopped"}}(),n=e((0,F.z)(t)),a=n.languageCode,i=n.name,u=e((0,F.Km)(t)),l=u.languageCode,d=u.name,f=function(){var e=(0,F.C5)(t),r=e.width,n=e.height;if(r&&n)return"".concat(r,"x").concat(n)}(),h=(0,j.Ys)(t)||(0,j.GE)(t),p=so.getInstance(h),g=(0,s.Z)(p,["rpin","rsid","appId","appVersion"]),v=g.rpin,y=g.rsid,b=g.appId,S=g.appVersion,E=(0,o.default)(t,"debug.frameRate");"N/A"===E&&(E=0);var T=(0,j.uf)(t)-(0,j.xs)(t),w=(0,j.Qf)(t)-(0,j.uf)(t),O=(0,j.l9)(t)-(0,j.Qf)(t),A=(0,o.default)(t,"content.sourceMedia"),_=(0,F.my)(t)||(0,F.XR)(t);return{playbackState:r,mediaType:[m.w_.recorded,m.w_.offairVideo].includes((0,j.V4)(t))?"recorded":"live",mediaId:(0,o.default)(h.split("."),"1",A),playbackMedia:A,rpin:v,rsid:y,pageUrl:Mi.Z,appId:b,appVersion:S,userAgent:navigator.userAgent,buildNumber:Ne.Z.BUILD_NUMBER,playbackVersion:"".concat(kl.version()," (Hls.js)"),cdnProviderName:(0,j.aW)(t),cdnServerHost:(0,j.ic)(t),authToken:_,resolution:f,framerate:E,bitrate:(0,o.default)(t,"qos.stats.bitrate",0),audioLanguageCode:l,audioName:d,closedCaptionLanguageCode:a,closedCaptionName:i,speed:(0,F.r6)(t),position:1e3*(0,F.Xn)(t),flotConnectionTime:T||0,firstStreamModuleTime:w||0,firstFrameTime:O||0}}}),c().watcher.init(c().playerState.get(),c().sender.get())}function qf(){c().watcher.destroy(),c().sender.destroy(),c().playerState.destroy()}function Wf(){var e=ii.getState();return(0,Y.j)("directHlsUri")||(0,j.LP)(e)}function zf(){var e=ii.getState(),t=Wf(),r=(0,j.Rt)(e),n=(0,j.U5)(e);return kl.load({masterPlaylist:t,providerQueryParam:r,provider:n})}function Xf(){var e=ii.getState(),t=(0,F.Lf)(e);if(void 0!==t)return 1e3*t}function Qf(){return void 0!==(0,j.Ys)(ii.getState())}function $f(){var e=kl.getQualities();ii.dispatch(A(e))}function Jf(e){var t=e.width,r=e.height,n=e.videoCodec,a=e.audioCodec;ii.dispatch((0,f.h3)({width:t,height:r,videoCodec:n,audioCodec:a}))}function eh(e){ii.dispatch((0,U.bG)({keyFrameInterval:e}))}function th(){var e=ii.getState();(0,j.C_)(e)||function(){var e=ii.getState(),t=(0,j.Rd)(e),r=kl.getQualities().find((function(e){return e.active}));return r&&t===r.id}()||ii.dispatch(O(!0)),rh()}function rh(){var e=ii.getState();jf.setQuality((0,j.WX)(e))}function nh(){ii.dispatch(O(!1))}function ah(){jf&&jf.setAudioLoading(!1)}function ih(e){jf&&jf.setLoading(e)}function oh(){ii.dispatch((0,f.lZ)(!0))}function sh(e){var t=ii.getState(),r=(0,j.V4)(t);if(e&&r!==m.w_.live){var n=(0,j.hB)(t).id;if(Fe.Z.removeProgressForVideoId(n),r===m.w_.offairVideo&&df())lf();else{if(!(0,Y.j)("disableEosSeek")){var a=(0,F.EG)(t),i=(0,o.default)(a,"start",0);kl.seek(i)}kl.pause()}}}function uh(e){var t=ii.getState(),r=(0,j.U5)(t);if(!r)return!1;var n=e.networkDetails?(0,o.default)(e,"networkDetails.responseURL"):(0,o.default)(e,"frag.loader.context.url");try{var a=new URL(n),i="".concat(a.protocol,"//").concat(a.host);return r.url.includes(i)}catch(e){return!1}}function ch(e){!window.navigator.onLine||uh(e)&&gh({reason:"server error"})}function lh(e){if(uh(e)){var t=e.response;if(t.code>=400&&t.code<=499){var r=ii.getState(),n=(0,o.default)((0,j.U5)(r),"url");return Object.prototype.hasOwnProperty.call(Bf,n)||(Bf[n]=0),Bf[n]+=1,void(Bf[n]>=5&&(Bf[n]=0,gh({reason:"multiple segment not found error"})))}(0===t.code||t.code>=500&&t.code<=599)&&gh({reason:"server error"})}}function dh(){return dh=Uf(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=(0,j.lB)(ii.getState()),e.t0=t.details,e.next=e.t0===a().ErrorDetails.FRAG_LOAD_TIMEOUT?4:e.t0===a().ErrorDetails.FRAG_LOAD_ERROR?6:e.t0===a().ErrorDetails.LEVEL_LOAD_ERROR?9:17;break;case 4:return ch(t),e.abrupt("break",18);case 6:return lh(t),Uo.aggregate(Uo.TYPES.error,{mediaId:r,type:"segmentNotFound",details:{url:(0,o.default)(t,"networkDetails.responseURL",""),status:(0,o.default)(t,"response.code",-1),reason:Vs(t.networkDetails)}}),e.abrupt("break",18);case 9:if(!Vf){e.next=16;break}return kl.unload(),e.next=13,zf();case 13:kl.startLoad(),(0,j.yA)(ii.getState())&&kl.play(),Vf=!1;case 16:return e.abrupt("break",18);case 17:Uo.aggregate(Uo.TYPES.error,{mediaId:r,type:t.details});case 18:case"end":return e.stop()}}),e)}))),dh.apply(this,arguments)}function fh(e,t){switch(Ff.error("hls.js error",t),function(e){switch(e.details){case a().ErrorDetails.MANIFEST_PARSING_ERROR:ii.dispatch((0,U.XR)({level:N.Q.ERROR,timeStamp:Date.now(),msg:"Manifest parse error"}));break;case a().ErrorDetails.LEVEL_EMPTY_ERROR:ii.dispatch((0,U.UG)({level:N.Q.WARNING,timeStamp:Date.now(),msg:"Manifest parse error (empty manifest)"}));break;case a().ErrorDetails.MANIFEST_LOAD_TIMEOUT:case a().ErrorDetails.LEVEL_LOAD_TIMEOUT:case a().ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:ii.dispatch((0,U.XR)({level:N.Q.ERROR,timeStamp:Date.now(),msg:"Manifest loading error (timeout)"}));break;case a().ErrorDetails.MANIFEST_LOAD_ERROR:case a().ErrorDetails.LEVEL_LOAD_ERROR:case a().ErrorDetails.AUDIO_TRACK_LOAD_ERROR:var t=e.response;ii.dispatch((0,U.XR)({level:N.Q.ERROR,timeStamp:Date.now(),msg:"Manifest loading error (".concat(t.code," ").concat(t.text,")")}));break;case a().ErrorDetails.FRAG_LOAD_ERROR:var r=e.response;ii.dispatch((0,U.UG)({level:N.Q.WARNING,timeStamp:Date.now(),msg:"Segment loading error (".concat(r.code," ").concat(r.text,")")}));break;case a().ErrorDetails.FRAG_LOAD_TIMEOUT:ii.dispatch((0,U.UG)({level:N.Q.WARNING,timeStamp:Date.now(),msg:"Segment loading error (timeout)"}))}}(t),function(e){switch(e.details){case a().ErrorDetails.MANIFEST_PARSING_ERROR:Za.send(Za.TYPES.manifestParsingError);break;case a().ErrorDetails.LEVEL_EMPTY_ERROR:Za.send(Za.TYPES.manifestEmptyError);break;case a().ErrorDetails.MANIFEST_LOAD_TIMEOUT:case a().ErrorDetails.LEVEL_LOAD_TIMEOUT:case a().ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:Za.send(Za.TYPES.manifestLoadingTimeout,{errorDetail:e.details});break;case a().ErrorDetails.MANIFEST_LOAD_ERROR:case a().ErrorDetails.LEVEL_LOAD_ERROR:case a().ErrorDetails.AUDIO_TRACK_LOAD_ERROR:var t=e.response;Za.send(Za.TYPES.manifestLoadingError,{errorCode:t.code,errorMessage:t.text,errorDetail:e.details});break;case a().ErrorDetails.FRAG_LOAD_ERROR:var r=e.response;Za.send(Za.TYPES.segmentLoadingError,{errorCode:r.code,errorMessage:r.text});break;case a().ErrorDetails.FRAG_LOAD_TIMEOUT:Za.send(Za.TYPES.segmentLoadingTimeout);break;case a().ErrorDetails.FRAG_PARSING_ERROR:var n=e.reason,i=void 0===n?"":n;Za.send(Za.TYPES.segmentParsingError,{reason:i})}}(t),t.type){case a().ErrorTypes.NETWORK_ERROR:return function(e){return dh.apply(this,arguments)}(t);case a().ErrorTypes.MEDIA_ERROR:return function(e){switch(e.details){case a().ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR:Za.send(Za.TYPES.unsupportedContent),kl.unload(),Bf={},Gf=!1,ii.dispatch(Ee()),jf.setContentAvailable(!1),ii.dispatch((0,Ui.N6)({type:"unsupported"}));break;case a().ErrorDetails.BUFFER_STALLED_ERROR:!function(){var e=ii.getState(),t=Nf.buffered;if(!(0,j.Vl)(e)&&t.length>0){var r=t.start(0);Ff.info("initial gap recovery",{bufferStart:r}),kl.seek(r)}}()}}(t);case a().ErrorTypes.MUX_ERROR:case a().ErrorTypes.OTHER_ERROR:return}}function hh(e){var t=ii.getState(),r=(0,o.default)((0,j.U5)(t),"url");Bf[r]=0}function ph(e){Hf.includes(e.url)||Hf.push(e.url),ii.dispatch((0,Gi.DJ)(e))}function gh(e){var t=e.reason,r=void 0===t?"unknown":t,n=ii.getState(),a=(0,j.SZ)(n);if(!(a.length<2)){var i=(0,j.U5)(n);Za.send(Za.TYPES.providerChange,{reason:r,provider:(0,o.default)(i,"url")});var s=a.findIndex((function(e){return e.url===(0,o.default)(i,"url")})),u=a.findIndex((function(e,t){return t!==s&&!Hf.includes(e.url)}));ph(a[-1!==u?u:(s+1)%a.length])}}function vh(){Nf&&Nf.parentNode.removeChild(Nf),Nf=document.createElement("video"),document.querySelector("#ViewerContainer").appendChild(Nf)}function mh(){return yh.apply(this,arguments)}function yh(){return(yh=Uf(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return kl.unload(),e.next=3,zf();case 3:kl.play();case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function bh(){Bf={},kl.init(Nf,{onNetworkChange:$f,onPlaybackInfo:Jf,onKeyframeInterval:eh,onQualityChangeEnd:nh,onAudioChangeEnd:ah,onLoadingChange:ih,onError:fh,onDownload:hh,onVideoTagDecodeError:mh})}function Sh(e,t){var r=new URL(ha.getUrl(e,t)),n=ii.getState(),a=(0,j.V4)(n);if(e&&a!==m.w_.live){var i=Sn(1e3*(0,F.Xn)(ii.getState())),o=Math.ceil(i/1e3);o>0&&(r.hash="to".concat(o))}return r.toString()}function Eh(e){var t,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"other";Za.transport({message:"Troubleshoot playback issue sent",data:{category:"Troubleshoot Playback Issue",item:"troubleshoot playback issue",action:"send",issue_type:n||"other",assisted_reporting_shown:r}}).send();var a=function(){var e=n.match(/(other): (.*)/);if(!e)return{type:n,text:""};var t=If(e,3);return{type:t[1],text:t[2]}}(),i=a.type,o=a.text;null===(t=c().sender.get())||void 0===t||t.send(c().sender.EVENTS.error,{errorType:i,errorText:o,logId:e})}function Th(e){if(e<0)kl.disableSubtitles();else{var t=ii.getState(),r=(0,F.vw)(t,e);if(r){var n=r.id;kl.setSubtitleTrack(n)}}}function wh(){var e=(0,Y.j)("defaultlang");if(e){var t=(0,F.Y_)(ii.getState()),r=(0,Il.Z)(t,e);r&&ii.dispatch((0,f.Ft)(r.id))}}function Oh(e){var t=ii.getState(),r=(0,F.qU)(t,e);if(r){jf&&jf.setAudioLoading(!0);var n=r.id;kl.setAudioTrack(n)}}function Ah(e,t){var r=ii.getState(),n=(0,j.GE)(r),a=ii.getState().content.offairContent;switch(Ff.debug("onMediaTypeChange",{newMediaType:e,mediaId:n,offairContent:a}),kl.unload(),Bf={},Gf=!1,jf.stopSlideShow(),[m.w_.offairVideo,m.w_.recorded,m.w_.live].includes(e)?(Yf(),Zf()):(Lf.ob(),qf()),e){case m.w_.offairSlide:ii.dispatch(Ee(Se.offAir)),jf.startSlideShow(a.pictures),Za.send(Za.TYPES.offairContentDisplayed,{offairContentType:"image"});break;case m.w_.offairVideo:lf(),Za.send(Za.TYPES.offairContentDisplayed,{offairContentType:"video"});break;case m.w_.offairScreen:ii.dispatch(Ee(Se.offAir)),ii.dispatch((0,Ui.N6)({type:"offair"})),jf.setContentAvailable(!1);break;case m.w_.live:n&&t&&(so.destroyAllOthers(n),t===m.w_.offairVideo||t===m.w_.offairScreen||t===m.w_.offairImage||t===m.w_.offairSlide?(Wh(n,!0),ii.dispatch((0,f.OH)(!0)),Xh()):Wh(n)),ii.dispatch((0,Ui.N6)({type:""}))}}function _h(e,t){Ff.debug("media id change from:".concat(t," to:").concat(e)),null!==t&&(so.destroyAll(),Za.reset(),rf.reset(),kl.unload()),Yf(),Zf(),function(){var e=xr.getHashFromLocalStorage();e&&ii.dispatch((0,Ui.t_)(e));var t=xr.getPasswordFromSessionStorage();t&&ii.dispatch((0,Ui.dM)(t))}(),Wh(e)}function Rh(e){var t=ii.getState().content.offairContent;if(e){var r=t.videos.indexOf(e),n=t.videos[r-1];Ff.debug("offair video change from:".concat(n," to:").concat(e)),n&&so.destroy(ha.getMidForVideoId(n)),Za.send(Za.TYPES.offairContentChanged,{prevId:n,nextId:e}),kl.unload(),Wh(ha.getMidForVideoId(e),!0),ii.dispatch((0,f.OH)(!0)),Yf(),Zf(),Gn(sn.content,["recorded",parseInt(e,10)])}}function kh(e){e&&Ch()}function Ph(e){e&&Ch()}function Ch(){so.destroyAll();var e=ii.getState(),t=(0,j.GE)(e);Ff.debug("retry loading media id ".concat(t)),Wh(t)}function Lh(){return Dh.apply(this,arguments)}function Dh(){return Dh=Uf(regeneratorRuntime.mark((function e(){var t,r,n,a,i,s,u,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=ii.getState(),0!==(r=(0,j.SZ)(t)).length){e.next=4;break}return e.abrupt("return");case 4:if(n=(0,j.U5)(t),!(a=(0,j.c)(t))||a===(0,o.default)(n,"url")){e.next=11;break}if(!(i=r.find((function(e){return e.url===a})))){e.next=11;break}return ph(i),e.abrupt("return");case 11:if(n&&r.some((function(e){return e.url===n.url}))){e.next=15;break}return ph(If(r,1)[0]),e.abrupt("return");case 15:if(s=Wf()){e.next=18;break}return e.abrupt("return");case 18:if(kl.getCurrentProvider()){e.next=31;break}return e.next=21,zf();case 21:return Uo.aggregate(Uo.TYPES.providerChange,{cdnProviderType:(0,j.aW)(t),cdnProviderHostname:(0,j.ic)(t)}),ii.dispatch((0,m.Ab)({format:"mp4/segmented",url:s.split("?")[0]})),u=kl.getQualities(),ii.dispatch(A(u)),(c=kl.getSubtitleTracks())&&c.length>0&&ii.dispatch((0,f.kY)(c)),(l=kl.getAudioTracks())&&l.length>0&&ii.dispatch((0,f.KS)(l)),Xh(),e.abrupt("return");case 31:if(!(0,j.Hc)(kl.getCurrentProvider(),n)){e.next=33;break}return e.abrupt("return");case 33:Uo.aggregate(Uo.TYPES.providerChange,{cdnProviderType:(0,j.aW)(t),cdnProviderHostname:(0,j.ic)(t)}),kl.changeProvider(n);case 35:case"end":return e.stop()}}),e)}))),Dh.apply(this,arguments)}function Ih(){Gf||(Gn(sn.contentAvailable,!0),Mh())}function xh(){if(!Gf){var e=ii.getState();(0,j.yB)(e)&&Mh()}}function Mh(){wn()&&(Gf=!0,jf.setDuration(),jf.setContentAvailable(!0))}function Uh(){return jh.apply(this,arguments)}function jh(){return jh=Uf(regeneratorRuntime.mark((function e(){var t,r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=ii.getState(),r=(0,j.LP)(t),n=kl.getSource(),Ff.info("The token query parameter in the master manifest URL has changed",{currentMasterPlaylist:n,nextMasterPlaylist:r}),kl.saveSeekPosition(),kl.unload(),e.next=8,zf();case 8:(0,j.yA)(t)&&kl.play();case 9:case"end":return e.stop()}}),e)}))),jh.apply(this,arguments)}function Fh(){return Nh.apply(this,arguments)}function Nh(){return Nh=Uf(regeneratorRuntime.mark((function e(){var t,r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=ii.getState(),r=(0,j.LP)(t),n=kl.getSource(),Ff.info("Stream switch detected",{currentMasterPlaylist:n,nextMasterPlaylist:r}),kl.unload(),e.next=7,zf();case 7:(0,j.yA)(t)&&kl.play();case 8:case"end":return e.stop()}}),e)}))),Nh.apply(this,arguments)}function Bh(){return Gh.apply(this,arguments)}function Gh(){return Gh=Uf(regeneratorRuntime.mark((function e(){var t,r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,Y.j)("directHlsUri")){e.next=2;break}return e.abrupt("return");case 2:if(t=ii.getState(),r=(0,j.LP)(t),n=kl.getSource(),r&&n){e.next=7;break}return e.abrupt("return");case 7:if((0,j.T2)(t,n)){e.next=12;break}return e.next=11,Uh();case 11:return e.abrupt("return");case 12:if((0,j.hq)(t,n)){e.next=16;break}return e.next=16,Fh();case 16:case"end":return e.stop()}}),e)}))),Gh.apply(this,arguments)}function Vh(){return Kh.apply(this,arguments)}function Kh(){return(Kh=Uf(regeneratorRuntime.mark((function e(){var t,r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(kl.getSource()){e.next=2;break}return e.abrupt("return");case 2:return t=(0,F.Mr)(ii.getState()),ii.dispatch((0,m.zp)(t)),kl.saveSeekPosition(),(r=(0,j.Rd)(ii.getState()))>-1&&kl.saveQuality(r),(n=(0,F.xs)(ii.getState()))>-1&&kl.saveSubtitle(n),(0,F.Fn)(ii.getState())>-1&&kl.saveAudio(),kl.unload(),e.next=14,zf();case 14:(0,j.yA)(ii.getState())&&kl.play();case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Hh(){var e=ii.getState();if((0,j.Vl)(e)){var t=performance.now();ii.dispatch({type:C,payload:t}),Za.send(Za.TYPES.firstTimeUpdate,{autoplay:!!(0,Y.j)("autoplay"),timeSpentFromInit:t-(0,j.sP)(e),timeSpent:t-(0,j.Qf)(e)})}}function Zh(){var e=ii.getState(),t=c().playerState.get();t&&(t.setProps({playing:(0,j.yA)(e)}),(0,j.yA)(e)&&e.playback.isBufferEmpty&&t.setProps({waiting:!0}))}function Yh(){var e=c().sender.get();if(e&&e.firstStartEvent){var t=ii.getState(),r=(0,o.default)(t,"playback.closedCaptionTracks",[]),n=(0,o.default)(t,"playback.audioTracks",[]);(r.length>0||n.length>0)&&e.send(c().sender.EVENTS.heartbeat)}}function qh(){var e=ii.getState(),t=(0,F.xC)(e);jf.setProgress(t);var r=c().playerState.get();if(r&&r.setProps({currentTime:(0,F.Xn)(e)}),(0,j.V4)(e)===m.w_.live&&!1===(0,j.eK)(e)&&!(0,j.X3)(e)){var n=Nf,a=n.buffered,i=n.currentTime;a.length>0&&i>=a.end(a.length-1)-.2&&ii.dispatch((0,f.lZ)(!0))}}function Wh(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Ff.info("load media",{mediaId:e},!0),kl.destroy(),vh(),bh(),Kf(),Kf=(0,i.Z)(Nf,(function(e){ii.dispatch((0,U.qo)(e))})),jf.setContentAvailable(!1),jf.setContentUpdate(),Bf={},Gf=!1;var r=t?Se.offAir:Se.mediaChange;ii.dispatch(Ee(r)),so.init(e),ii.dispatch((0,Ui.hD)({umsInfo:so.getInfo(e)}))}function zh(){ii.dispatch((0,f.OH)(!0)),Xh()}function Xh(){var e=ii.getState().playback.playing;Ff.debug("checkAutoplay",{playing:e});var t=c().playerState.get();if(t&&(t.setProps({contentAvailable:!0}),e&&t.setProps({playing:!0})),jf.setContentAvailable(!0),!Ad.canStartAutoplay())return Ff.debug("autoplay not allowed from privacy cookie settings"),ii.dispatch((0,f.OH)(!1)),jf.showPlayScreen(),void ii.subscribe("privacy.ibmCookie",zh);var r=!(0,j.FC)(ii.getState());e?Tf.video({muted:r,timeout:500}).then((function(e){var t=e.result,r=e.error;!0===t?Qh({autoplay:!0}):(Ff.debug("autoplay not allowed in browser",(0,o.default)(r,"message")),ii.dispatch((0,f.OH)(!1)),jf.showPlayScreen())})):jf.showPlayScreen()}function Qh(e){return $h.apply(this,arguments)}function $h(){return $h=Uf(regeneratorRuntime.mark((function e(t){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.autoplay,Ad.stopCheck(),rf.isInitialized()){e.next=7;break}return n={ui:jf,videoTag:Nf,adContainerId:"AdHolder",autoplay:r},e.next=6,rf.init(n);case 6:return e.abrupt("return");case 7:kl.play();case 8:case"end":return e.stop()}}),e)}))),$h.apply(this,arguments)}c().logger.onLog((function(e){var t=e.type,r=e.module,n=e.message,a=e.data;l.Z.log({level:t,source:r,line:n,data:a})}));var Jh={init:function(){var e;Ff.debug("environment variables",bn(),!0),Ff.debug("playback type selected",{playerVersion:Ne.Z.BUILD_NUMBER,playbackType:"hls.js",playbackVersion:kl.version()},!0),Mi.Z.includes("".concat(ra.Z.config.siteLocal,"/embed/test"))&&l.Z.addTransport((function(e){var t,r=e.date,n=e.source,a=e.line,i=e.data,o=e.level;try{t=new URL(Mi.Z).origin}catch(e){t=""}window.parent.postMessage(JSON.stringify({mte:[r,n,a,i,o]}),t)})),ii.getState().settings.debug&&l.Z.addTransport(Ll),e=window.onerror,window.onerror=function(t,r,n,a,i){return l.Z.fatal({source:"jserror",line:"".concat(t," Cannot continue."),data:{url:r,lineNumber:n}}),Dl((0,o.default)(i,"message",t),(0,o.default)(i,"stack","")),!!e&&e(t,r,n)},window.addEventListener("unhandledrejection",(function(e){var t=(0,o.default)(e,"reason",""),r=(0,o.default)(e,"promise");r?r.catch((function(e){Dl((0,o.default)(e,"message",t),(0,o.default)(e,"stack",""))})):Dl(t)})),Cl.debug=ii.subscribe("settings.debug",(function(e){e?l.Z.addTransport(Ll):l.Z.removeTransport(Ll)})),window.getPlayerLog||(window.getPlayerLog=function(){return l.Z.getLogs()}),Fe.Z.init("hlsjs"),nd(),cf(),vf(),Fi=ii.subscribe("playback.firstTimeUpdateReceived",Bi),Za.init(),Uo.init();var t,r=If((0,xl.Z)(),2),n=r[0],a=r[1];Za.send(Za.TYPES.initialLoadingStarted,{width:n,height:a}),ii.dispatch((t=performance.now(),{type:_,payload:t})),jf=new Ul.Z({reduxStore:oi,wrappedStore:ii,exposedVars:Ue.Z,domainMapping:ra.Z,playbackVersion:"".concat(kl.version()," (Hls.js)"),getUrl:Sh,getId:ha.getId,getApp:ha.getApp,isHLS:ha.isHLS,isCid:ha.isCid,isVid:ha.isVid,isLive:function(){var e=ii.getState();return(0,j.gx)(e)},isContentPlayable:Qf,getAbsoluteSeekPositionInMs:En,getRelativeSeekPositionInMs:Sn,getTrimmedDurationInMillisec:Xf,searchCaptions:Gl,saveHashToLocalStorage:xr.saveHashToLocalStorage,getHashFromLocalStorage:xr.getHashFromLocalStorage,isPollAnswered:Ml.Z.isAnswered,setHighlight:function(){},getByContent:function(e){if("startAt"===e)return(0,Y.j)("to")},getCutStart:function(){var e=ii.getState(),t=(0,F.EG)(e);return(0,o.default)(t,"start",0)},getPlayerState:function(){var e=c().playerState.get();if(e)return e.state},getInitialConfig:function(e){return(0,Y.j)(e)}}),Ad.startCheck(),Bn({ui:jf,playback:kl}),Za.send(Za.TYPES.initialLoadingCompleted),ii.subscribe("qos.selectedId",th),ii.subscribe("qos.qualities",rh),ii.subscribe("content.mediaType",Ah),ii.subscribe("content.mediaId",_h),ii.subscribe("playback.ended",sh),ii.subscribe("playback.selectedClosedCaption",Th),ii.subscribe("playback.audioTracks",wh),ii.subscribe("playback.selectedAudio",Oh),ii.subscribe("content.currentOffairVideoId",Rh),ii.subscribe("provider",Lh),ii.subscribe("content.liveStatus",Lh),ii.subscribe("playback.currentTime",qh),ii.subscribe("playback.videoTagDuration",Ih),ii.subscribe("playback.canPlay",xh),ii.subscribe("provider.contentAccess.masterPlaylist",Bh),ii.subscribe("playback.videoTrackDisabled",Vh),ii.subscribe("playback.firstTimeUpdateReceived",Hh),ii.subscribe("playback.playing",Zh),ii.subscribe("playback.isBufferEmpty",(function(e){var t=c().playerState.get();t&&t.setProps({waiting:e})})),ii.subscribe("playback.selectedAudio",Yh),ii.subscribe("playback.selectedClosedCaption",Yh),jf.addEventListener(B.Z.COMMAND.play,(function(){return Qh({autoplay:!0})})),jf.addEventListener(B.Z.COMMAND.playScreenClicked,(function(){return Qh({autoplay:!1})})),jf.addEventListener(B.Z.COMMAND.pause,(function(){kl.pause()})),jf.addEventListener(B.Z.COMMAND.seek,(function(e){var t=e.detail,r=t.position,n=t.initiator,a=If(r,1)[0];kl.seek(a,n);var i=ii.getState(),o=(0,F.xC)(i)*(0,F.Lf)(i),s=Sn(1e3*a)/1e3;Uo.sendWithDelay(Uo.TYPES.seek,{fromInSec:o,toInSec:s},1e3)})),jf.addEventListener(B.Z.COMMAND.qualityChange,(function(e){var t=e.detail.qualityId;kl.setQuality(t)})),jf.addEventListener(B.Z.COMMAND.theaterMode,(function(e){var t=e.detail.enabled;Gn(sn.theaterMode,t)})),jf.addEventListener(B.Z.COMMAND.poll,(function(e){var t=e.detail;Gn(sn.poll,t)})),jf.addEventListener(B.Z.COMMAND.sendLog,(function(e){var t=e.detail,r=t.reason,n=t.logSendingFromAssistedReporting;Ff.info("Report playback issue",{reason:r}),jf.setLogSendingStarted(),(0,On.Z)({onProgress:jf.setLogSendingProgress}).then((function(e){jf.setLogSendingCompleted(e),Eh(e,n,r)})).catch((function(e){Ff.error(e.message),jf.setLogSendingCompleted()}))})),jf.addEventListener(B.Z.COMMAND.videoFinished,oh),jf.addEventListener(B.Z.COMMAND.sendPollAnswer,(function(e){var t=e.detail,r=(0,j.Ys)(ii.getState());so.getInstance(r).send("api/poll/vote",[t]),Ml.Z.setPollAnswered(t.pollInstanceId)})),jf.addEventListener(B.Z.REPORT.centralLog,(function(e){var t=e.detail,r=t.message,n=t.data;Za.transport({message:r,data:n}).send()})),jf.addEventListener(B.Z.COMMAND.setCaptionPosition,(function(e){var t=e.detail.captionPosition;kl.setCCPosition(t)}));var i=ha.getMid(),s=ha.isVid()?m.w_.recorded:m.w_.live;ii.dispatch(gn({mediaType:s,mediaId:i})),ii.dispatch((0,f.Uc)(!0)),ii.subscribe("ums.password",Ph),ii.subscribe("ums.hash",kh),ii.subscribe("ums.lock.type",(function(e){e&&(Lf.ob(),qf())})),Gn(sn.ready,!0),window.sendPlayerLog=function(){return jf.setLogSendingStarted(),(0,On.Z)({onProgress:jf.setLogSendingProgress}).then((function(e){return jf.setLogSendingCompleted(e),Eh(e),e})).catch((function(e){throw Ff.error(e.message),jf.setLogSendingCompleted(),e}))},(0,Y.j)("findText")&&(ii.dispatch((0,jl.FD)(decodeURIComponent((0,Y.j)("findText")))),ii.dispatch((0,jl.Q3)(!0))),(0,Df.a)()&&oi.dispatch((0,_t.c0)(_t.GT.oldBrowser))}}},82971:function(e){"undefined"!=typeof window&&(e.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/dist/",r(r.s=13)}([function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return d}));var n=r(5);function a(){}var i={trace:a,debug:a,log:a,warn:a,info:a,error:a},o=i;function s(e,t){return"["+e+"] > "+t}var u=Object(n.a)();function c(e){var t=u.console[e];return t?function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];n[0]&&(n[0]=s(e,n[0])),t.apply(u.console,n)}:a}var l=function(e){if(u.console&&!0===e||"object"==typeof e){!function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];r.forEach((function(t){o[t]=e[t]?e[t].bind(e):c(t)}))}(e,"debug","log","info","warn","error");try{o.log()}catch(e){o=i}}else o=i},d=o},function(e,t,r){"use strict";t.a={MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_DETACHING:"hlsMediaDetaching",MEDIA_DETACHED:"hlsMediaDetached",BUFFER_RESET:"hlsBufferReset",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_CREATED:"hlsBufferCreated",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_APPENDED:"hlsBufferAppended",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_FLUSHED:"hlsBufferFlushed",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_PARSED:"hlsManifestParsed",LEVEL_SWITCHING:"hlsLevelSwitching",LEVEL_SWITCHED:"hlsLevelSwitched",LEVEL_LOADING:"hlsLevelLoading",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_UPDATED:"hlsLevelUpdated",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",LEVELS_UPDATED:"hlsLevelsUpdated",AUDIO_TRACKS_UPDATED:"hlsAudioTracksUpdated",AUDIO_TRACK_SWITCHING:"hlsAudioTrackSwitching",AUDIO_TRACK_SWITCHED:"hlsAudioTrackSwitched",AUDIO_TRACK_LOADING:"hlsAudioTrackLoading",AUDIO_TRACK_LOADED:"hlsAudioTrackLoaded",SUBTITLE_TRACKS_UPDATED:"hlsSubtitleTracksUpdated",SUBTITLE_TRACK_SWITCH:"hlsSubtitleTrackSwitch",SUBTITLE_TRACK_LOADING:"hlsSubtitleTrackLoading",SUBTITLE_TRACK_LOADED:"hlsSubtitleTrackLoaded",SUBTITLE_FRAG_PROCESSED:"hlsSubtitleFragProcessed",CUES_PARSED:"hlsCuesParsed",NON_NATIVE_TEXT_TRACKS_FOUND:"hlsNonNativeTextTracksFound",INIT_PTS_FOUND:"hlsInitPtsFound",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_LOADED:"hlsFragLoaded",FRAG_DECRYPTED:"hlsFragDecrypted",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSED:"hlsFragParsed",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FPS_DROP:"hlsFpsDrop",FPS_DROP_LEVEL_CAPPING:"hlsFpsDropLevelCapping",ERROR:"hlsError",DESTROYING:"hlsDestroying",KEY_LOADING:"hlsKeyLoading",KEY_LOADED:"hlsKeyLoaded",STREAM_STATE_TRANSITION:"hlsStreamStateTransition",LIVE_BACK_BUFFER_REACHED:"hlsLiveBackBufferReached"}},function(e,t,r){"use strict";var n,a;r.d(t,"b",(function(){return n})),r.d(t,"a",(function(){return a})),function(e){e.NETWORK_ERROR="networkError",e.MEDIA_ERROR="mediaError",e.KEY_SYSTEM_ERROR="keySystemError",e.MUX_ERROR="muxError",e.OTHER_ERROR="otherError"}(n||(n={})),function(e){e.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",e.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",e.KEY_SYSTEM_NO_SESSION="keySystemNoSession",e.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",e.KEY_SYSTEM_NO_INIT_DATA="keySystemNoInitData",e.MANIFEST_LOAD_ERROR="manifestLoadError",e.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",e.MANIFEST_PARSING_ERROR="manifestParsingError",e.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",e.LEVEL_EMPTY_ERROR="levelEmptyError",e.LEVEL_LOAD_ERROR="levelLoadError",e.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",e.LEVEL_SWITCH_ERROR="levelSwitchError",e.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",e.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",e.FRAG_LOAD_ERROR="fragLoadError",e.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",e.FRAG_DECRYPT_ERROR="fragDecryptError",e.FRAG_PARSING_ERROR="fragParsingError",e.REMUX_ALLOC_ERROR="remuxAllocError",e.KEY_LOAD_ERROR="keyLoadError",e.KEY_LOAD_TIMEOUT="keyLoadTimeOut",e.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",e.BUFFER_APPEND_ERROR="bufferAppendError",e.BUFFER_APPENDING_ERROR="bufferAppendingError",e.BUFFER_STALLED_ERROR="bufferStalledError",e.BUFFER_FULL_ERROR="bufferFullError",e.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",e.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",e.INTERNAL_EXCEPTION="internalException"}(a||(a={}))},function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=Number.isFinite||function(e){return"number"==typeof e&&isFinite(e)};Number.MAX_SAFE_INTEGER},function(e,t,r){"use strict";r.d(t,"b",(function(){return s}));var n,a=r(5),i=function(){function e(){}return e.isHeader=function(e,t){return t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},e.isFooter=function(e,t){return t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},e.getID3Data=function(t,r){for(var n=r,a=0;e.isHeader(t,r);)a+=10,a+=e._readSize(t,r+6),e.isFooter(t,r+10)&&(a+=10),r+=a;if(a>0)return t.subarray(n,n+a)},e._readSize=function(e,t){var r=0;return r=(127&e[t])<<21,r|=(127&e[t+1])<<14,(r|=(127&e[t+2])<<7)|127&e[t+3]},e.getTimeStamp=function(t){for(var r=e.getID3Frames(t),n=0;n<r.length;n++){var a=r[n];if(e.isTimeStampFrame(a))return e._readTimeStamp(a)}},e.isTimeStampFrame=function(e){return e&&"PRIV"===e.key&&"com.apple.streaming.transportStreamTimestamp"===e.info},e._getFrameData=function(t){var r=String.fromCharCode(t[0],t[1],t[2],t[3]),n=e._readSize(t,4);return{type:r,size:n,data:t.subarray(10,10+n)}},e.getID3Frames=function(t){for(var r=0,n=[];e.isHeader(t,r);){for(var a=e._readSize(t,r+6),i=(r+=10)+a;r+8<i;){var o=e._getFrameData(t.subarray(r)),s=e._decodeFrame(o);s&&n.push(s),r+=o.size+10}e.isFooter(t,r)&&(r+=10)}return n},e._decodeFrame=function(t){return"PRIV"===t.type?e._decodePrivFrame(t):"W"===t.type[0]?e._decodeURLFrame(t):e._decodeTextFrame(t)},e._readTimeStamp=function(e){if(8===e.data.byteLength){var t=new Uint8Array(e.data),r=1&t[3],n=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return n/=45,r&&(n+=47721858.84),Math.round(n)}},e._decodePrivFrame=function(t){if(!(t.size<2)){var r=e._utf8ArrayToStr(t.data,!0),n=new Uint8Array(t.data.subarray(r.length+1));return{key:t.type,info:r,data:n.buffer}}},e._decodeTextFrame=function(t){if(!(t.size<2)){if("TXXX"===t.type){var r=1,n=e._utf8ArrayToStr(t.data.subarray(r),!0);r+=n.length+1;var a=e._utf8ArrayToStr(t.data.subarray(r));return{key:t.type,info:n,data:a}}var i=e._utf8ArrayToStr(t.data.subarray(1));return{key:t.type,data:i}}},e._decodeURLFrame=function(t){if("WXXX"===t.type){if(t.size<2)return;var r=1,n=e._utf8ArrayToStr(t.data.subarray(r),!0);r+=n.length+1;var a=e._utf8ArrayToStr(t.data.subarray(r));return{key:t.type,info:n,data:a}}var i=e._utf8ArrayToStr(t.data);return{key:t.type,data:i}},e._utf8ArrayToStr=function(e,t){void 0===t&&(t=!1);var r=o();if(r){var n=r.decode(e);if(t){var a=n.indexOf("\0");return-1!==a?n.substring(0,a):n}return n.replace(/\0/g,"")}for(var i,s,u,c=e.length,l="",d=0;d<c;){if(0===(i=e[d++])&&t)return l;if(0!==i&&3!==i)switch(i>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:l+=String.fromCharCode(i);break;case 12:case 13:s=e[d++],l+=String.fromCharCode((31&i)<<6|63&s);break;case 14:s=e[d++],u=e[d++],l+=String.fromCharCode((15&i)<<12|(63&s)<<6|(63&u)<<0)}}return l},e}();function o(){var e=Object(a.a)();return n||void 0===e.TextDecoder||(n=new e.TextDecoder("utf-8")),n}var s=i._utf8ArrayToStr;t.a=i},function(e,t,r){"use strict";function n(){return"undefined"==typeof window?self:window}r.d(t,"a",(function(){return n}))},function(e,t,r){var n,a,i,o,s;n=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/?#]*\/)*[^;?#]*)?(;[^?#]*)?(\?[^#]*)?(#.*)?$/,a=/^([^\/?#]*)(.*)$/,i=/(?:\/|^)\.(?=\/)/g,o=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,s={buildAbsoluteURL:function(e,t,r){if(r=r||{},e=e.trim(),!(t=t.trim())){if(!r.alwaysNormalize)return e;var n=s.parseURL(e);if(!n)throw new Error("Error trying to parse base URL.");return n.path=s.normalizePath(n.path),s.buildURLFromParts(n)}var i=s.parseURL(t);if(!i)throw new Error("Error trying to parse relative URL.");if(i.scheme)return r.alwaysNormalize?(i.path=s.normalizePath(i.path),s.buildURLFromParts(i)):t;var o=s.parseURL(e);if(!o)throw new Error("Error trying to parse base URL.");if(!o.netLoc&&o.path&&"/"!==o.path[0]){var u=a.exec(o.path);o.netLoc=u[1],o.path=u[2]}o.netLoc&&!o.path&&(o.path="/");var c={scheme:o.scheme,netLoc:i.netLoc,path:null,params:i.params,query:i.query,fragment:i.fragment};if(!i.netLoc&&(c.netLoc=o.netLoc,"/"!==i.path[0]))if(i.path){var l=o.path,d=l.substring(0,l.lastIndexOf("/")+1)+i.path;c.path=s.normalizePath(d)}else c.path=o.path,i.params||(c.params=o.params,i.query||(c.query=o.query));return null===c.path&&(c.path=r.alwaysNormalize?s.normalizePath(i.path):i.path),s.buildURLFromParts(c)},parseURL:function(e){var t=n.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(i,"");e.length!==(e=e.replace(o,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}},e.exports=s},function(e,t,r){"use strict";var n=function(){function e(e,t){this.subtle=e,this.aesIV=t}return e.prototype.decrypt=function(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)},e}(),a=function(){function e(e,t){this.subtle=e,this.key=t}return e.prototype.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},e}(),i=function(){function e(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.initTable()}var t=e.prototype;return t.uint8ArrayToUint32Array_=function(e){for(var t=new DataView(e),r=new Uint32Array(4),n=0;n<4;n++)r[n]=t.getUint32(4*n);return r},t.initTable=function(){var e=this.sBox,t=this.invSBox,r=this.subMix,n=r[0],a=r[1],i=r[2],o=r[3],s=this.invSubMix,u=s[0],c=s[1],l=s[2],d=s[3],f=new Uint32Array(256),h=0,p=0,g=0;for(g=0;g<256;g++)f[g]=g<128?g<<1:g<<1^283;for(g=0;g<256;g++){var v=p^p<<1^p<<2^p<<3^p<<4;v=v>>>8^255&v^99,e[h]=v,t[v]=h;var m=f[h],y=f[m],b=f[y],S=257*f[v]^16843008*v;n[h]=S<<24|S>>>8,a[h]=S<<16|S>>>16,i[h]=S<<8|S>>>24,o[h]=S,S=16843009*b^65537*y^257*m^16843008*h,u[v]=S<<24|S>>>8,c[v]=S<<16|S>>>16,l[v]=S<<8|S>>>24,d[v]=S,h?(h=m^f[f[f[b^m]]],p^=f[f[p]]):h=p=1}},t.expandKey=function(e){for(var t=this.uint8ArrayToUint32Array_(e),r=!0,n=0;n<t.length&&r;)r=t[n]===this.key[n],n++;if(!r){this.key=t;var a=this.keySize=t.length;if(4!==a&&6!==a&&8!==a)throw new Error("Invalid aes key size="+a);var i,o,s,u,c=this.ksRows=4*(a+6+1),l=this.keySchedule=new Uint32Array(c),d=this.invKeySchedule=new Uint32Array(c),f=this.sBox,h=this.rcon,p=this.invSubMix,g=p[0],v=p[1],m=p[2],y=p[3];for(i=0;i<c;i++)i<a?s=l[i]=t[i]:(u=s,i%a==0?(u=f[(u=u<<8|u>>>24)>>>24]<<24|f[u>>>16&255]<<16|f[u>>>8&255]<<8|f[255&u],u^=h[i/a|0]<<24):a>6&&i%a==4&&(u=f[u>>>24]<<24|f[u>>>16&255]<<16|f[u>>>8&255]<<8|f[255&u]),l[i]=s=(l[i-a]^u)>>>0);for(o=0;o<c;o++)i=c-o,u=3&o?l[i]:l[i-4],d[o]=o<4||i<=4?u:g[f[u>>>24]]^v[f[u>>>16&255]]^m[f[u>>>8&255]]^y[f[255&u]],d[o]=d[o]>>>0}},t.networkToHostOrderSwap=function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24},t.decrypt=function(e,t,r,n){for(var a,i,o,s,u,c,l,d,f,h,p,g,v,m,y,b,S,E=this.keySize+6,T=this.invKeySchedule,w=this.invSBox,O=this.invSubMix,A=O[0],_=O[1],R=O[2],k=O[3],P=this.uint8ArrayToUint32Array_(r),C=P[0],L=P[1],D=P[2],I=P[3],x=new Int32Array(e),M=new Int32Array(x.length),U=this.networkToHostOrderSwap;t<x.length;){for(f=U(x[t]),h=U(x[t+1]),p=U(x[t+2]),g=U(x[t+3]),u=f^T[0],c=g^T[1],l=p^T[2],d=h^T[3],v=4,m=1;m<E;m++)a=A[u>>>24]^_[c>>16&255]^R[l>>8&255]^k[255&d]^T[v],i=A[c>>>24]^_[l>>16&255]^R[d>>8&255]^k[255&u]^T[v+1],o=A[l>>>24]^_[d>>16&255]^R[u>>8&255]^k[255&c]^T[v+2],s=A[d>>>24]^_[u>>16&255]^R[c>>8&255]^k[255&l]^T[v+3],u=a,c=i,l=o,d=s,v+=4;a=w[u>>>24]<<24^w[c>>16&255]<<16^w[l>>8&255]<<8^w[255&d]^T[v],i=w[c>>>24]<<24^w[l>>16&255]<<16^w[d>>8&255]<<8^w[255&u]^T[v+1],o=w[l>>>24]<<24^w[d>>16&255]<<16^w[u>>8&255]<<8^w[255&c]^T[v+2],s=w[d>>>24]<<24^w[u>>16&255]<<16^w[c>>8&255]<<8^w[255&l]^T[v+3],v+=3,M[t]=U(a^C),M[t+1]=U(s^L),M[t+2]=U(o^D),M[t+3]=U(i^I),C=f,L=h,D=p,I=g,t+=4}return n?(S=(b=(y=M.buffer).byteLength)&&new DataView(y).getUint8(b-1))?y.slice(0,b-S):y:M.buffer},t.destroy=function(){this.key=void 0,this.keySize=void 0,this.ksRows=void 0,this.sBox=void 0,this.invSBox=void 0,this.subMix=void 0,this.invSubMix=void 0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.rcon=void 0},e}(),o=r(2),s=r(0),u=r(1),c=r(5),l=Object(c.a)(),d=function(){function e(e,t,r){var n=(void 0===r?{}:r).removePKCS7Padding,a=void 0===n||n;if(this.logEnabled=!0,this.observer=e,this.config=t,this.removePKCS7Padding=a,a)try{var i=l.crypto;i&&(this.subtle=i.subtle||i.webkitSubtle)}catch(e){}this.disableWebCrypto=!this.subtle}var t=e.prototype;return t.isSync=function(){return this.disableWebCrypto&&this.config.enableSoftwareAES},t.decrypt=function(e,t,r,o){var u=this;if(this.disableWebCrypto&&this.config.enableSoftwareAES){this.logEnabled&&(s.b.log("JS AES decrypt"),this.logEnabled=!1);var c=this.decryptor;c||(this.decryptor=c=new i),c.expandKey(t),o(c.decrypt(e,0,r,this.removePKCS7Padding))}else{this.logEnabled&&(s.b.log("WebCrypto AES decrypt"),this.logEnabled=!1);var l=this.subtle;this.key!==t&&(this.key=t,this.fastAesKey=new a(l,t)),this.fastAesKey.expandKey().then((function(a){new n(l,r).decrypt(e,a).catch((function(n){u.onWebCryptoError(n,e,t,r,o)})).then((function(e){o(e)}))})).catch((function(n){u.onWebCryptoError(n,e,t,r,o)}))}},t.onWebCryptoError=function(e,t,r,n,a){this.config.enableSoftwareAES?(s.b.log("WebCrypto Error, disable WebCrypto API"),this.disableWebCrypto=!0,this.logEnabled=!0,this.decrypt(t,r,n,a)):(s.b.error("decrypting error : "+e.message),this.observer.trigger(u.a.ERROR,{type:o.b.MEDIA_ERROR,details:o.a.FRAG_DECRYPT_ERROR,fatal:!0,reason:e.message}))},t.destroy=function(){var e=this.decryptor;e&&(e.destroy(),this.decryptor=void 0)},e}();t.a=d},function(e,t,r){"use strict";var n=Object.prototype.hasOwnProperty,a="~";function i(){}function o(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function s(e,t,r,n,i){if("function"!=typeof r)throw new TypeError("The listener must be a function");var s=new o(r,n||e,i),u=a?a+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],s]:e._events[u].push(s):(e._events[u]=s,e._eventsCount++),e}function u(e,t){0==--e._eventsCount?e._events=new i:delete e._events[t]}function c(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(a=!1)),c.prototype.eventNames=function(){var e,t,r=[];if(0===this._eventsCount)return r;for(t in e=this._events)n.call(e,t)&&r.push(a?t.slice(1):t);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},c.prototype.listeners=function(e){var t=a?a+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var n=0,i=r.length,o=new Array(i);n<i;n++)o[n]=r[n].fn;return o},c.prototype.listenerCount=function(e){var t=a?a+e:e,r=this._events[t];return r?r.fn?1:r.length:0},c.prototype.emit=function(e,t,r,n,i,o){var s=a?a+e:e;if(!this._events[s])return!1;var u,c,l=this._events[s],d=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),d){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,r),!0;case 4:return l.fn.call(l.context,t,r,n),!0;case 5:return l.fn.call(l.context,t,r,n,i),!0;case 6:return l.fn.call(l.context,t,r,n,i,o),!0}for(c=1,u=new Array(d-1);c<d;c++)u[c-1]=arguments[c];l.fn.apply(l.context,u)}else{var f,h=l.length;for(c=0;c<h;c++)switch(l[c].once&&this.removeListener(e,l[c].fn,void 0,!0),d){case 1:l[c].fn.call(l[c].context);break;case 2:l[c].fn.call(l[c].context,t);break;case 3:l[c].fn.call(l[c].context,t,r);break;case 4:l[c].fn.call(l[c].context,t,r,n);break;default:if(!u)for(f=1,u=new Array(d-1);f<d;f++)u[f-1]=arguments[f];l[c].fn.apply(l[c].context,u)}}return!0},c.prototype.on=function(e,t,r){return s(this,e,t,r,!1)},c.prototype.once=function(e,t,r){return s(this,e,t,r,!0)},c.prototype.removeListener=function(e,t,r,n){var i=a?a+e:e;if(!this._events[i])return this;if(!t)return u(this,i),this;var o=this._events[i];if(o.fn)o.fn!==t||n&&!o.once||r&&o.context!==r||u(this,i);else{for(var s=0,c=[],l=o.length;s<l;s++)(o[s].fn!==t||n&&!o[s].once||r&&o[s].context!==r)&&c.push(o[s]);c.length?this._events[i]=1===c.length?c[0]:c:u(this,i)}return this},c.prototype.removeAllListeners=function(e){var t;return e?(t=a?a+e:e,this._events[t]&&u(this,t)):(this._events=new i,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=a,c.EventEmitter=c,e.exports=c},function(e,t,r){"use strict";var n=r(1),a=r(2),i=r(7),o=r(3),s=r(0),u=r(5);function c(e,t){return 255===e[t]&&240==(246&e[t+1])}function l(e,t){return 1&e[t+1]?7:9}function d(e,t){return(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5}function f(e,t){return!!(t+1<e.length&&c(e,t))}function h(e,t){if(f(e,t)){var r=l(e,t);if(t+r>=e.length)return!1;var n=d(e,t);if(n<=r)return!1;var a=t+n;if(a===e.length||a+1<e.length&&c(e,a))return!0}return!1}function p(e,t,r,i,o){if(!e.samplerate){var u=function(e,t,r,i){var o,u,c,l,d,f=navigator.userAgent.toLowerCase(),h=i,p=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];if(o=1+((192&t[r+2])>>>6),!((u=(60&t[r+2])>>>2)>p.length-1))return l=(1&t[r+2])<<2,l|=(192&t[r+3])>>>6,s.b.log("manifest codec:"+i+",ADTS data:type:"+o+",sampleingIndex:"+u+"["+p[u]+"Hz],channelConfig:"+l),/firefox/i.test(f)?u>=6?(o=5,d=new Array(4),c=u-3):(o=2,d=new Array(2),c=u):-1!==f.indexOf("android")?(o=2,d=new Array(2),c=u):(o=5,d=new Array(4),i&&(-1!==i.indexOf("mp4a.40.29")||-1!==i.indexOf("mp4a.40.5"))||!i&&u>=6?c=u-3:((i&&-1!==i.indexOf("mp4a.40.2")&&(u>=6&&1===l||/vivaldi/i.test(f))||!i&&1===l)&&(o=2,d=new Array(2)),c=u)),d[0]=o<<3,d[0]|=(14&u)>>1,d[1]|=(1&u)<<7,d[1]|=l<<3,5===o&&(d[1]|=(14&c)>>1,d[2]=(1&c)<<7,d[2]|=8,d[3]=0),{config:d,samplerate:p[u],channelCount:l,codec:"mp4a.40."+o,manifestCodec:h};e.trigger(n.a.ERROR,{type:a.b.MEDIA_ERROR,details:a.a.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+u})}(t,r,i,o);e.config=u.config,e.samplerate=u.samplerate,e.channelCount=u.channelCount,e.codec=u.codec,e.manifestCodec=u.manifestCodec,s.b.log("parsed codec:"+e.codec+",rate:"+u.samplerate+",nb channel:"+u.channelCount)}}function g(e){return 9216e4/e}function v(e,t,r,n,a){var i=function(e,t,r,n,a){var i,o,s=e.length;if(i=l(e,t),o=d(e,t),(o-=i)>0&&t+i+o<=s)return{headerLength:i,frameLength:o,stamp:r+n*a}}(t,r,n,a,g(e.samplerate));if(i){var o=i.stamp,s=i.headerLength,u=i.frameLength,c={unit:t.subarray(r+s,r+s+u),pts:o,dts:o};return e.samples.push(c),{sample:c,length:u+s}}}var m=r(4),y=function(){function e(e,t,r){this.observer=e,this.config=r,this.remuxer=t}var t=e.prototype;return t.resetInitSegment=function(e,t,r,n){this._audioTrack={container:"audio/adts",type:"audio",id:0,sequenceNumber:0,isAAC:!0,samples:[],len:0,manifestCodec:t,duration:n,inputTimeScale:9e4}},t.resetTimeStamp=function(){},e.probe=function(e){if(!e)return!1;for(var t=(m.a.getID3Data(e,0)||[]).length,r=e.length;t<r;t++)if(h(e,t))return s.b.log("ADTS sync word found !"),!0;return!1},t.append=function(e,t,r,n){for(var a=this._audioTrack,i=m.a.getID3Data(e,0)||[],u=m.a.getTimeStamp(i),c=Object(o.a)(u)?90*u:9e4*t,l=0,d=c,h=e.length,g=i.length,y=[{pts:d,dts:d,data:i}];g<h-1;)if(f(e,g)&&g+5<h){p(a,this.observer,e,g,a.manifestCodec);var b=v(a,e,g,c,l);if(!b){s.b.log("Unable to parse AAC frame");break}g+=b.length,d=b.sample.pts,l++}else m.a.isHeader(e,g)?(i=m.a.getID3Data(e,g),y.push({pts:d,dts:d,data:i}),g+=i.length):g++;this.remuxer.remux(a,{samples:[]},{samples:y,inputTimeScale:9e4},{samples:[]},t,r,n)},t.destroy=function(){},e}(),b=r(10),S={BitratesMap:[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap:[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],SamplesCoefficients:[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],BytesInSlot:[0,1,1,4],appendFrame:function(e,t,r,n,a){if(!(r+24>t.length)){var i=this.parseHeader(t,r);if(i&&r+i.frameLength<=t.length){var o=n+a*(9e4*i.samplesPerFrame/i.sampleRate),s={unit:t.subarray(r,r+i.frameLength),pts:o,dts:o};return e.config=[],e.channelCount=i.channelCount,e.samplerate=i.sampleRate,e.samples.push(s),{sample:s,length:i.frameLength}}}},parseHeader:function(e,t){var r=e[t+1]>>3&3,n=e[t+1]>>1&3,a=e[t+2]>>4&15,i=e[t+2]>>2&3,o=e[t+2]>>1&1;if(1!==r&&0!==a&&15!==a&&3!==i){var s=3===r?3-n:3===n?3:4,u=1e3*S.BitratesMap[14*s+a-1],c=3===r?0:2===r?1:2,l=S.SamplingRateMap[3*c+i],d=e[t+3]>>6==3?1:2,f=S.SamplesCoefficients[r][n],h=S.BytesInSlot[n],p=8*f*h;return{sampleRate:l,channelCount:d,frameLength:parseInt(f*u/l+o,10)*h,samplesPerFrame:p}}},isHeaderPattern:function(e,t){return 255===e[t]&&224==(224&e[t+1])&&0!=(6&e[t+1])},isHeader:function(e,t){return!!(t+1<e.length&&this.isHeaderPattern(e,t))},probe:function(e,t){if(t+1<e.length&&this.isHeaderPattern(e,t)){var r=this.parseHeader(e,t),n=4;r&&r.frameLength&&(n=r.frameLength);var a=t+n;if(a===e.length||a+1<e.length&&this.isHeaderPattern(e,a))return!0}return!1}},E=S,T=function(){function e(e){this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}var t=e.prototype;return t.loadWord=function(){var e=this.data,t=this.bytesAvailable,r=e.byteLength-t,n=new Uint8Array(4),a=Math.min(4,t);if(0===a)throw new Error("no bytes available");n.set(e.subarray(r,r+a)),this.word=new DataView(n.buffer).getUint32(0),this.bitsAvailable=8*a,this.bytesAvailable-=a},t.skipBits=function(e){var t;this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,e-=(t=e>>3)>>3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)},t.readBits=function(e){var t=Math.min(this.bitsAvailable,e),r=this.word>>>32-t;return e>32&&s.b.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0?this.word<<=t:this.bytesAvailable>0&&this.loadWord(),(t=e-t)>0&&this.bitsAvailable?r<<t|this.readBits(t):r},t.skipLZ=function(){var e;for(e=0;e<this.bitsAvailable;++e)if(0!=(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()},t.skipUEG=function(){this.skipBits(1+this.skipLZ())},t.skipEG=function(){this.skipBits(1+this.skipLZ())},t.readUEG=function(){var e=this.skipLZ();return this.readBits(e+1)-1},t.readEG=function(){var e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)},t.readBoolean=function(){return 1===this.readBits(1)},t.readUByte=function(){return this.readBits(8)},t.readUShort=function(){return this.readBits(16)},t.readUInt=function(){return this.readBits(32)},t.skipScalingList=function(e){var t,r=8,n=8;for(t=0;t<e;t++)0!==n&&(n=(r+this.readEG()+256)%256),r=0===n?r:n},t.readSPS=function(){var e,t,r,n,a,i,o,s=0,u=0,c=0,l=0,d=this.readUByte.bind(this),f=this.readBits.bind(this),h=this.readUEG.bind(this),p=this.readBoolean.bind(this),g=this.skipBits.bind(this),v=this.skipEG.bind(this),m=this.skipUEG.bind(this),y=this.skipScalingList.bind(this);if(d(),e=d(),f(5),g(3),d(),m(),100===e||110===e||122===e||244===e||44===e||83===e||86===e||118===e||128===e){var b=h();if(3===b&&g(1),m(),m(),g(1),p())for(i=3!==b?8:12,o=0;o<i;o++)p()&&y(o<6?16:64)}m();var S=h();if(0===S)h();else if(1===S)for(g(1),v(),v(),t=h(),o=0;o<t;o++)v();m(),g(1),r=h(),n=h(),0===(a=f(1))&&g(1),g(1),p()&&(s=h(),u=h(),c=h(),l=h());var E=[1,1];if(p()&&p())switch(d()){case 1:E=[1,1];break;case 2:E=[12,11];break;case 3:E=[10,11];break;case 4:E=[16,11];break;case 5:E=[40,33];break;case 6:E=[24,11];break;case 7:E=[20,11];break;case 8:E=[32,11];break;case 9:E=[80,33];break;case 10:E=[18,11];break;case 11:E=[15,11];break;case 12:E=[64,33];break;case 13:E=[160,99];break;case 14:E=[4,3];break;case 15:E=[3,2];break;case 16:E=[2,1];break;case 255:E=[d()<<8|d(),d()<<8|d()]}return{width:Math.ceil(16*(r+1)-2*s-2*u),height:(2-a)*(n+1)*16-(a?2:4)*(c+l),pixelRatio:E}},t.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},e}(),w=function(){function e(e,t,r,n){this.decryptdata=r,this.discardEPB=n,this.decrypter=new i.a(e,t,{removePKCS7Padding:!1})}var t=e.prototype;return t.decryptBuffer=function(e,t){this.decrypter.decrypt(e,this.decryptdata.key.buffer,this.decryptdata.iv.buffer,t)},t.decryptAacSample=function(e,t,r,n){var a=e[t].unit,i=a.subarray(16,a.length-a.length%16),o=i.buffer.slice(i.byteOffset,i.byteOffset+i.length),s=this;this.decryptBuffer(o,(function(i){i=new Uint8Array(i),a.set(i,16),n||s.decryptAacSamples(e,t+1,r)}))},t.decryptAacSamples=function(e,t,r){for(;;t++){if(t>=e.length)return void r();if(!(e[t].unit.length<32)){var n=this.decrypter.isSync();if(this.decryptAacSample(e,t,r,n),!n)return}}},t.getAvcEncryptedData=function(e){for(var t=16*Math.floor((e.length-48)/160)+16,r=new Int8Array(t),n=0,a=32;a<=e.length-16;a+=160,n+=16)r.set(e.subarray(a,a+16),n);return r},t.getAvcDecryptedUnit=function(e,t){t=new Uint8Array(t);for(var r=0,n=32;n<=e.length-16;n+=160,r+=16)e.set(t.subarray(r,r+16),n);return e},t.decryptAvcSample=function(e,t,r,n,a,i){var o=this.discardEPB(a.data),s=this.getAvcEncryptedData(o),u=this;this.decryptBuffer(s.buffer,(function(s){a.data=u.getAvcDecryptedUnit(o,s),i||u.decryptAvcSamples(e,t,r+1,n)}))},t.decryptAvcSamples=function(e,t,r,n){for(;;t++,r=0){if(t>=e.length)return void n();for(var a=e[t].units;!(r>=a.length);r++){var i=a[r];if(!(i.data.length<=48||1!==i.type&&5!==i.type)){var o=this.decrypter.isSync();if(this.decryptAvcSample(e,t,r,n,i,o),!o)return}}}},e}(),O={video:1,audio:2,id3:3,text:4},A=function(){function e(e,t,r,n){this.observer=e,this.config=r,this.typeSupported=n,this.remuxer=t,this.sampleAes=null,this.pmtUnknownTypes={}}var t=e.prototype;return t.setDecryptData=function(e){null!=e&&null!=e.key&&"SAMPLE-AES"===e.method?this.sampleAes=new w(this.observer,this.config,e,this.discardEPB):this.sampleAes=null},e.probe=function(t){var r=e._syncOffset(t);return!(r<0||(r&&s.b.warn("MPEG2-TS detected but first sync word found @ offset "+r+", junk ahead ?"),0))},e._syncOffset=function(e){for(var t=Math.min(1e3,e.length-564),r=0;r<t;){if(71===e[r]&&71===e[r+188]&&71===e[r+376])return r;r++}return-1},e.createTrack=function(e,t){return{container:"video"===e||"audio"===e?"video/mp2t":void 0,type:e,id:O[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:"video"===e?0:void 0,isAAC:"audio"===e||void 0,duration:"audio"===e?t:void 0}},t.resetInitSegment=function(t,r,n,a){this.pmtParsed=!1,this._pmtId=-1,this.pmtUnknownTypes={},this._avcTrack=e.createTrack("video",a),this._audioTrack=e.createTrack("audio",a),this._id3Track=e.createTrack("id3",a),this._txtTrack=e.createTrack("text",a),this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=r,this.videoCodec=n,this._duration=a},t.resetTimeStamp=function(){},t.append=function(t,r,i,o){var u,c,l,d,f,h=t.length,p=!1;this.pmtUnknownTypes={},this.contiguous=i;var g=this.pmtParsed,v=this._avcTrack,m=this._audioTrack,y=this._id3Track,b=v.pid,S=m.pid,E=y.pid,T=this._pmtId,w=v.pesData,O=m.pesData,A=y.pesData,_=this._parsePAT,R=this._parsePMT.bind(this),k=this._parsePES,P=this._parseAVCPES.bind(this),C=this._parseAACPES.bind(this),L=this._parseMPEGPES.bind(this),D=this._parseID3PES.bind(this),I=e._syncOffset(t);for(h-=(h+I)%188,u=I;u<h;u+=188)if(71===t[u]){if(c=!!(64&t[u+1]),l=((31&t[u+1])<<8)+t[u+2],(48&t[u+3])>>4>1){if((d=u+5+t[u+4])===u+188)continue}else d=u+4;switch(l){case b:c&&(w&&(f=k(w))&&P(f,!1),w={data:[],size:0}),w&&(w.data.push(t.subarray(d,u+188)),w.size+=u+188-d);break;case S:c&&(O&&(f=k(O))&&(m.isAAC?C(f):L(f)),O={data:[],size:0}),O&&(O.data.push(t.subarray(d,u+188)),O.size+=u+188-d);break;case E:c&&(A&&(f=k(A))&&D(f),A={data:[],size:0}),A&&(A.data.push(t.subarray(d,u+188)),A.size+=u+188-d);break;case 0:c&&(d+=t[d]+1),T=this._pmtId=_(t,d);break;case T:c&&(d+=t[d]+1);var x=R(t,d,!0===this.typeSupported.mpeg||!0===this.typeSupported.mp3,null!=this.sampleAes);(b=x.avc)>0&&(v.pid=b),(S=x.audio)>0&&(m.pid=S,m.isAAC=x.isAAC),(E=x.id3)>0&&(y.pid=E),p&&!g&&(s.b.log("reparse from beginning"),p=!1,u=I-188),g=this.pmtParsed=!0;break;case 17:case 8191:break;default:p=!0}}else this.observer.trigger(n.a.ERROR,{type:a.b.MEDIA_ERROR,details:a.a.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});w&&(f=k(w))?(P(f,!0),v.pesData=null):v.pesData=w,O&&(f=k(O))?(m.isAAC?C(f):L(f),m.pesData=null):(O&&O.size&&s.b.log("last AAC PES packet truncated,might overlap between fragments"),m.pesData=O),A&&(f=k(A))?(D(f),y.pesData=null):y.pesData=A,null==this.sampleAes?this.remuxer.remux(m,v,y,this._txtTrack,r,i,o):this.decryptAndRemux(m,v,y,this._txtTrack,r,i,o)},t.decryptAndRemux=function(e,t,r,n,a,i,o){if(e.samples&&e.isAAC){var s=this;this.sampleAes.decryptAacSamples(e.samples,0,(function(){s.decryptAndRemuxAvc(e,t,r,n,a,i,o)}))}else this.decryptAndRemuxAvc(e,t,r,n,a,i,o)},t.decryptAndRemuxAvc=function(e,t,r,n,a,i,o){if(t.samples){var s=this;this.sampleAes.decryptAvcSamples(t.samples,0,0,(function(){s.remuxer.remux(e,t,r,n,a,i,o)}))}else this.remuxer.remux(e,t,r,n,a,i,o)},t.destroy=function(){this._initPTS=this._initDTS=void 0,this._duration=0},t._parsePAT=function(e,t){return(31&e[t+10])<<8|e[t+11]},t._trackUnknownPmt=function(e,t,r){var n=this.pmtUnknownTypes[e]||0;return 0===n&&(this.pmtUnknownTypes[e]=0,t.call(s.b,r)),this.pmtUnknownTypes[e]++,n},t._parsePMT=function(e,t,r,n){var a,i,o={audio:-1,avc:-1,id3:-1,isAAC:!0};for(a=t+3+((15&e[t+1])<<8|e[t+2])-4,t+=12+((15&e[t+10])<<8|e[t+11]);t<a;){switch(i=(31&e[t+1])<<8|e[t+2],e[t]){case 207:if(!n){this._trackUnknownPmt(e[t],s.b.warn,"ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:-1===o.audio&&(o.audio=i);break;case 21:-1===o.id3&&(o.id3=i);break;case 219:if(!n){this._trackUnknownPmt(e[t],s.b.warn,"H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:-1===o.avc&&(o.avc=i);break;case 3:case 4:r?-1===o.audio&&(o.audio=i,o.isAAC=!1):this._trackUnknownPmt(e[t],s.b.warn,"MPEG audio found, not supported in this browser");break;case 36:this._trackUnknownPmt(e[t],s.b.warn,"Unsupported HEVC stream type found");break;default:this._trackUnknownPmt(e[t],s.b.log,"Unknown stream type:"+e[t])}t+=5+((15&e[t+3])<<8|e[t+4])}return o},t._parsePES=function(e){var t,r,n,a,i,o,u,c,l=0,d=e.data;if(!e||0===e.size)return null;for(;d[0].length<19&&d.length>1;){var f=new Uint8Array(d[0].length+d[1].length);f.set(d[0]),f.set(d[1],d[0].length),d[0]=f,d.splice(1,1)}if(1===((t=d[0])[0]<<16)+(t[1]<<8)+t[2]){if((n=(t[4]<<8)+t[5])&&n>e.size-6)return null;if(192&(r=t[7])&&(o=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2,64&r?o-(u=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2)>54e5&&(s.b.warn(Math.round((o-u)/9e4)+"s delta between PTS and DTS, align them"),o=u):u=o),c=(a=t[8])+9,e.size<=c)return null;e.size-=c,i=new Uint8Array(e.size);for(var h=0,p=d.length;h<p;h++){var g=(t=d[h]).byteLength;if(c){if(c>g){c-=g;continue}t=t.subarray(c),g-=c,c=0}i.set(t,l),l+=g}return n&&(n-=a+3),{data:i,pts:o,dts:u,len:n}}return null},t.pushAccesUnit=function(e,t){if(e.units.length&&e.frame){var r=t.samples,n=r.length;if(isNaN(e.pts)){if(!n)return void t.dropped++;var a=r[n-1];e.pts=a.pts,e.dts=a.dts}!this.config.forceKeyFrameOnDiscontinuity||!0===e.key||t.sps&&(n||this.contiguous)?(e.id=n,r.push(e)):t.dropped++}e.debug.length&&s.b.log(e.pts+"/"+e.dts+":"+e.debug)},t._parseAVCPES=function(e,t){var r,n,a,i=this,o=this._avcTrack,s=this._parseAVCNALu(e.data),u=this.avcSample,c=!1,l=this.pushAccesUnit.bind(this),d=function(e,t,r,n){return{key:e,pts:t,dts:r,units:[],debug:n}};e.data=null,u&&s.length&&!o.audFound&&(l(u,o),u=this.avcSample=d(!1,e.pts,e.dts,"")),s.forEach((function(t){switch(t.type){case 1:n=!0,u||(u=i.avcSample=d(!0,e.pts,e.dts,"")),u.frame=!0;var s=t.data;if(c&&s.length>4){var f=new T(s).readSliceType();2!==f&&4!==f&&7!==f&&9!==f||(u.key=!0)}break;case 5:n=!0,u||(u=i.avcSample=d(!0,e.pts,e.dts,"")),u.key=!0,u.frame=!0;break;case 6:n=!0,(r=new T(i.discardEPB(t.data))).readUByte();for(var h=0,p=0,g=!1,v=0;!g&&r.bytesAvailable>1;){h=0;do{h+=v=r.readUByte()}while(255===v);p=0;do{p+=v=r.readUByte()}while(255===v);if(4===h&&0!==r.bytesAvailable){if(g=!0,181===r.readUByte()&&49===r.readUShort()&&1195456820===r.readUInt()&&3===r.readUByte()){var y=r.readUByte(),b=31&y,S=[y,r.readUByte()];for(a=0;a<b;a++)S.push(r.readUByte()),S.push(r.readUByte()),S.push(r.readUByte());i._insertSampleInOrder(i._txtTrack.samples,{type:3,pts:e.pts,bytes:S})}}else if(5===h&&0!==r.bytesAvailable){if(g=!0,p>16){var E=[];for(a=0;a<16;a++)E.push(r.readUByte().toString(16)),3!==a&&5!==a&&7!==a&&9!==a||E.push("-");var w=p-16,O=new Uint8Array(w);for(a=0;a<w;a++)O[a]=r.readUByte();i._insertSampleInOrder(i._txtTrack.samples,{pts:e.pts,payloadType:h,uuid:E.join(""),userDataBytes:O,userData:Object(m.b)(O.buffer)})}}else if(p<r.bytesAvailable)for(a=0;a<p;a++)r.readUByte()}break;case 7:if(n=!0,c=!0,!o.sps){var A=(r=new T(t.data)).readSPS();o.width=A.width,o.height=A.height,o.pixelRatio=A.pixelRatio,o.sps=[t.data],o.duration=i._duration;var _=t.data.subarray(1,4),R="avc1.";for(a=0;a<3;a++){var k=_[a].toString(16);k.length<2&&(k="0"+k),R+=k}o.codec=R}break;case 8:n=!0,o.pps||(o.pps=[t.data]);break;case 9:n=!1,o.audFound=!0,u&&l(u,o),u=i.avcSample=d(!1,e.pts,e.dts,"");break;case 12:n=!1;break;default:n=!1,u&&(u.debug+="unknown NAL "+t.type+" ")}u&&n&&u.units.push(t)})),t&&u&&(l(u,o),this.avcSample=null)},t._insertSampleInOrder=function(e,t){var r=e.length;if(r>0){if(t.pts>=e[r-1].pts)e.push(t);else for(var n=r-1;n>=0;n--)if(t.pts<e[n].pts){e.splice(n,0,t);break}}else e.push(t)},t._getLastNalUnit=function(){var e,t=this.avcSample;if(!t||0===t.units.length){var r=this._avcTrack.samples;t=r[r.length-1]}if(t){var n=t.units;e=n[n.length-1]}return e},t._parseAVCNALu=function(e){var t,r,n,a,i=0,o=e.byteLength,s=this._avcTrack,u=s.naluState||0,c=u,l=[],d=-1;for(-1===u&&(d=0,a=31&e[0],u=0,i=1);i<o;)if(t=e[i++],u)if(1!==u)if(t)if(1===t){if(d>=0)n={data:e.subarray(d,i-u-1),type:a},l.push(n);else{var f=this._getLastNalUnit();if(f&&(c&&i<=4-c&&f.state&&(f.data=f.data.subarray(0,f.data.byteLength-c)),(r=i-u-1)>0)){var h=new Uint8Array(f.data.byteLength+r);h.set(f.data,0),h.set(e.subarray(0,r),f.data.byteLength),f.data=h}}i<o?(d=i,a=31&e[i],u=0):u=-1}else u=0;else u=3;else u=t?0:2;else u=t?0:1;if(d>=0&&u>=0&&(n={data:e.subarray(d,o),type:a,state:u},l.push(n)),0===l.length){var p=this._getLastNalUnit();if(p){var g=new Uint8Array(p.data.byteLength+e.byteLength);g.set(p.data,0),g.set(e,p.data.byteLength),p.data=g}}return s.naluState=u,l},t.discardEPB=function(e){for(var t,r,n=e.byteLength,a=[],i=1;i<n-2;)0===e[i]&&0===e[i+1]&&3===e[i+2]?(a.push(i+2),i+=2):i++;if(0===a.length)return e;t=n-a.length,r=new Uint8Array(t);var o=0;for(i=0;i<t;o++,i++)o===a[0]&&(o++,a.shift()),r[i]=e[o];return r},t._parseAACPES=function(e){var t,r,i,o,u,c,l,d=this._audioTrack,h=e.data,m=e.pts,y=this.aacOverFlow,b=this.aacLastPTS;if(y){var S=new Uint8Array(y.byteLength+h.byteLength);S.set(y,0),S.set(h,y.byteLength),h=S}for(i=0,u=h.length;i<u-1&&!f(h,i);i++);if(!i||(i<u-1?(c="AAC PES did not start with ADTS header,offset:"+i,l=!1):(c="no ADTS header found in AAC PES",l=!0),s.b.warn("parsing error:"+c),this.observer.trigger(n.a.ERROR,{type:a.b.MEDIA_ERROR,details:a.a.FRAG_PARSING_ERROR,fatal:l,reason:c}),!l)){if(p(d,this.observer,h,i,this.audioCodec),r=0,t=g(d.samplerate),y&&b){var E=b+t;Math.abs(E-m)>1&&(s.b.log("AAC: align PTS for overlapping frames by "+Math.round((E-m)/90)),m=E)}for(;i<u;){if(f(h,i)){if(i+5<u){var T=v(d,h,i,m,r);if(T){i+=T.length,o=T.sample.pts,r++;continue}}break}i++}y=i<u?h.subarray(i,u):null,this.aacOverFlow=y,this.aacLastPTS=o}},t._parseMPEGPES=function(e){for(var t=e.data,r=t.length,n=0,a=0,i=e.pts;a<r;)if(E.isHeader(t,a)){var o=E.appendFrame(this._audioTrack,t,a,i,n);if(!o)break;a+=o.length,n++}else a++},t._parseID3PES=function(e){this._id3Track.samples.push(e)},e}(),_=function(){function e(e,t,r){this.observer=e,this.config=r,this.remuxer=t}var t=e.prototype;return t.resetInitSegment=function(e,t,r,n){this._audioTrack={container:"audio/mpeg",type:"audio",id:-1,sequenceNumber:0,isAAC:!1,samples:[],len:0,manifestCodec:t,duration:n,inputTimeScale:9e4}},t.resetTimeStamp=function(){},e.probe=function(e){var t,r,n=m.a.getID3Data(e,0);if(n&&void 0!==m.a.getTimeStamp(n))for(t=n.length,r=Math.min(e.length-1,t+100);t<r;t++)if(E.probe(e,t))return s.b.log("MPEG Audio sync word found !"),!0;return!1},t.append=function(e,t,r,n){for(var a=m.a.getID3Data(e,0)||[],i=m.a.getTimeStamp(a),o=void 0!==i?90*i:9e4*t,s=a.length,u=e.length,c=0,l=0,d=this._audioTrack,f=[{pts:o,dts:o,data:a}];s<u;)if(E.isHeader(e,s)){var h=E.appendFrame(d,e,s,o,c);if(!h)break;s+=h.length,l=h.sample.pts,c++}else m.a.isHeader(e,s)?(a=m.a.getID3Data(e,s),f.push({pts:l,dts:l,data:a}),s+=a.length):s++;this.remuxer.remux(d,{samples:[]},{samples:f,inputTimeScale:9e4},{samples:[]},t,r,n)},t.destroy=function(){},e}(),R=function(){function e(){}return e.getSilentFrame=function(e,t){if("mp4a.40.2"===e){if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},e}(),k=Math.pow(2,32)-1,P=function(){function e(){}return e.init=function(){var t;for(t in e.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},e.types)e.types.hasOwnProperty(t)&&(e.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);var r=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);e.HDLR_TYPES={video:r,audio:n};var a=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),i=new Uint8Array([0,0,0,0,0,0,0,0]);e.STTS=e.STSC=e.STCO=i,e.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),e.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),e.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),e.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var o=new Uint8Array([105,115,111,109]),s=new Uint8Array([97,118,99,49]),u=new Uint8Array([0,0,0,1]);e.FTYP=e.box(e.types.ftyp,o,u,o,s),e.DINF=e.box(e.types.dinf,e.box(e.types.dref,a))},e.box=function(e){for(var t,r=Array.prototype.slice.call(arguments,1),n=8,a=r.length,i=a;a--;)n+=r[a].byteLength;for((t=new Uint8Array(n))[0]=n>>24&255,t[1]=n>>16&255,t[2]=n>>8&255,t[3]=255&n,t.set(e,4),a=0,n=8;a<i;a++)t.set(r[a],n),n+=r[a].byteLength;return t},e.hdlr=function(t){return e.box(e.types.hdlr,e.HDLR_TYPES[t])},e.mdat=function(t){return e.box(e.types.mdat,t)},e.mdhd=function(t,r){r*=t;var n=Math.floor(r/(k+1)),a=Math.floor(r%(k+1));return e.box(e.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,n>>24,n>>16&255,n>>8&255,255&n,a>>24,a>>16&255,a>>8&255,255&a,85,196,0,0]))},e.mdia=function(t){return e.box(e.types.mdia,e.mdhd(t.timescale,t.duration),e.hdlr(t.type),e.minf(t))},e.mfhd=function(t){return e.box(e.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))},e.minf=function(t){return"audio"===t.type?e.box(e.types.minf,e.box(e.types.smhd,e.SMHD),e.DINF,e.stbl(t)):e.box(e.types.minf,e.box(e.types.vmhd,e.VMHD),e.DINF,e.stbl(t))},e.moof=function(t,r,n){return e.box(e.types.moof,e.mfhd(t),e.traf(n,r))},e.moov=function(t){for(var r=t.length,n=[];r--;)n[r]=e.trak(t[r]);return e.box.apply(null,[e.types.moov,e.mvhd(t[0].timescale,t[0].duration)].concat(n).concat(e.mvex(t)))},e.mvex=function(t){for(var r=t.length,n=[];r--;)n[r]=e.trex(t[r]);return e.box.apply(null,[e.types.mvex].concat(n))},e.mvhd=function(t,r){r*=t;var n=Math.floor(r/(k+1)),a=Math.floor(r%(k+1)),i=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,n>>24,n>>16&255,n>>8&255,255&n,a>>24,a>>16&255,a>>8&255,255&a,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return e.box(e.types.mvhd,i)},e.sdtp=function(t){var r,n,a=t.samples||[],i=new Uint8Array(4+a.length);for(n=0;n<a.length;n++)r=a[n].flags,i[n+4]=r.dependsOn<<4|r.isDependedOn<<2|r.hasRedundancy;return e.box(e.types.sdtp,i)},e.stbl=function(t){return e.box(e.types.stbl,e.stsd(t),e.box(e.types.stts,e.STTS),e.box(e.types.stsc,e.STSC),e.box(e.types.stsz,e.STSZ),e.box(e.types.stco,e.STCO))},e.avc1=function(t){var r,n,a,i=[],o=[];for(r=0;r<t.sps.length;r++)a=(n=t.sps[r]).byteLength,i.push(a>>>8&255),i.push(255&a),i=i.concat(Array.prototype.slice.call(n));for(r=0;r<t.pps.length;r++)a=(n=t.pps[r]).byteLength,o.push(a>>>8&255),o.push(255&a),o=o.concat(Array.prototype.slice.call(n));var s=e.box(e.types.avcC,new Uint8Array([1,i[3],i[4],i[5],255,224|t.sps.length].concat(i).concat([t.pps.length]).concat(o))),u=t.width,c=t.height,l=t.pixelRatio[0],d=t.pixelRatio[1];return e.box(e.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,u>>8&255,255&u,c>>8&255,255&c,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),s,e.box(e.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),e.box(e.types.pasp,new Uint8Array([l>>24,l>>16&255,l>>8&255,255&l,d>>24,d>>16&255,d>>8&255,255&d])))},e.esds=function(e){var t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))},e.mp4a=function(t){var r=t.samplerate;return e.box(e.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,r>>8&255,255&r,0,0]),e.box(e.types.esds,e.esds(t)))},e.mp3=function(t){var r=t.samplerate;return e.box(e.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,r>>8&255,255&r,0,0]))},e.stsd=function(t){return"audio"===t.type?t.isAAC||"mp3"!==t.codec?e.box(e.types.stsd,e.STSD,e.mp4a(t)):e.box(e.types.stsd,e.STSD,e.mp3(t)):e.box(e.types.stsd,e.STSD,e.avc1(t))},e.tkhd=function(t){var r=t.id,n=t.duration*t.timescale,a=t.width,i=t.height,o=Math.floor(n/(k+1)),s=Math.floor(n%(k+1));return e.box(e.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,r>>24&255,r>>16&255,r>>8&255,255&r,0,0,0,0,o>>24,o>>16&255,o>>8&255,255&o,s>>24,s>>16&255,s>>8&255,255&s,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,a>>8&255,255&a,0,0,i>>8&255,255&i,0,0]))},e.traf=function(t,r){var n=e.sdtp(t),a=t.id,i=Math.floor(r/(k+1)),o=Math.floor(r%(k+1));return e.box(e.types.traf,e.box(e.types.tfhd,new Uint8Array([0,0,0,0,a>>24,a>>16&255,a>>8&255,255&a])),e.box(e.types.tfdt,new Uint8Array([1,0,0,0,i>>24,i>>16&255,i>>8&255,255&i,o>>24,o>>16&255,o>>8&255,255&o])),e.trun(t,n.length+16+20+8+16+8+8),n)},e.trak=function(t){return t.duration=t.duration||4294967295,e.box(e.types.trak,e.tkhd(t),e.mdia(t))},e.trex=function(t){var r=t.id;return e.box(e.types.trex,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},e.trun=function(t,r){var n,a,i,o,s,u,c=t.samples||[],l=c.length,d=12+16*l,f=new Uint8Array(d);for(r+=8+d,f.set([0,0,15,1,l>>>24&255,l>>>16&255,l>>>8&255,255&l,r>>>24&255,r>>>16&255,r>>>8&255,255&r],0),n=0;n<l;n++)i=(a=c[n]).duration,o=a.size,s=a.flags,u=a.cts,f.set([i>>>24&255,i>>>16&255,i>>>8&255,255&i,o>>>24&255,o>>>16&255,o>>>8&255,255&o,s.isLeading<<2|s.dependsOn,s.isDependedOn<<6|s.hasRedundancy<<4|s.paddingValue<<1|s.isNonSync,61440&s.degradPrio,15&s.degradPrio,u>>>24&255,u>>>16&255,u>>>8&255,255&u],12+16*n);return e.box(e.types.trun,f)},e.initSegment=function(t){e.types||e.init();var r,n=e.moov(t);return(r=new Uint8Array(e.FTYP.byteLength+n.byteLength)).set(e.FTYP),r.set(n,e.FTYP.byteLength),r},e}();function C(e,t,r,n){void 0===r&&(r=1),void 0===n&&(n=!1);var a=e*t*r;return n?Math.round(a):a}function L(e,t){return void 0===t&&(t=!1),C(e,1e3,1/9e4,t)}function D(e,t){return void 0===t&&(t=1),C(e,9e4,1/t)}var I=D(10),x=D(.2),M=null;function U(e,t){var r;if(void 0===t)return e;for(r=t<e?-8589934592:8589934592;Math.abs(e-t)>4294967296;)e+=r;return e}var j,F=function(){function e(e,t,r,n){if(this.observer=e,this.config=t,this.typeSupported=r,this.ISGenerated=!1,null===M){var a=navigator.userAgent.match(/Chrome\/(\d+)/i);M=a?parseInt(a[1]):0}}var t=e.prototype;return t.destroy=function(){},t.resetTimeStamp=function(e){this._initPTS=this._initDTS=e},t.resetInitSegment=function(){this.ISGenerated=!1},t.getVideoStartPts=function(e){var t=!1,r=e.reduce((function(e,r){var n=r.pts-e;return n<-4294967296?(t=!0,U(e,r.pts)):n>0?e:r.pts}),e[0].pts);return t&&s.b.debug("PTS rollover detected"),r},t.remux=function(e,t,r,a,i,o,u){if(this.ISGenerated||this.generateIS(e,t,i),this.ISGenerated){var c=e.samples.length,l=t.samples.length,d=i,f=i;if(c&&l){var h=this.getVideoStartPts(t.samples),p=(U(e.samples[0].pts,h)-h)/t.inputTimeScale;d+=Math.max(0,p),f+=Math.max(0,-p)}if(c){e.timescale||(s.b.warn("regenerate InitSegment as audio detected"),this.generateIS(e,t,i));var g,v=this.remuxAudio(e,d,o,u);l&&(v&&(g=v.endPTS-v.startPTS),t.timescale||(s.b.warn("regenerate InitSegment as video detected"),this.generateIS(e,t,i)),this.remuxVideo(t,f,o,g))}else if(l){var m=this.remuxVideo(t,f,o,0,u);m&&e.codec&&this.remuxEmptyAudio(e,d,o,m)}}r.samples.length&&this.remuxID3(r,i),a.samples.length&&this.remuxText(a,i),this.observer.trigger(n.a.FRAG_PARSED)},t.generateIS=function(e,t,r){var i,o,u=this.observer,c=e.samples,l=t.samples,d=this.typeSupported,f="audio/mp4",h={},p={tracks:h},g=void 0===this._initPTS;if(g&&(i=o=1/0),e.config&&c.length&&(e.timescale=e.samplerate,s.b.log("audio sampling rate : "+e.samplerate),e.isAAC||(d.mpeg?(f="audio/mpeg",e.codec=""):d.mp3&&(e.codec="mp3")),h.audio={container:f,codec:e.codec,initSegment:!e.isAAC&&d.mpeg?new Uint8Array:P.initSegment([e]),metadata:{channelCount:e.channelCount}},g&&(i=o=c[0].pts-Math.round(e.inputTimeScale*r))),t.sps&&t.pps&&l.length){var v=t.inputTimeScale;if(t.timescale=v,h.video={container:"video/mp4",codec:t.codec,initSegment:P.initSegment([t]),metadata:{width:t.width,height:t.height}},g){var m=this.getVideoStartPts(l),y=Math.round(v*r);o=Math.min(o,U(l[0].dts,m)-y),i=Math.min(i,m-y),this.observer.trigger(n.a.INIT_PTS_FOUND,{initPTS:i})}}else g&&h.audio&&this.observer.trigger(n.a.INIT_PTS_FOUND,{initPTS:i});Object.keys(h).length?(u.trigger(n.a.FRAG_PARSING_INIT_SEGMENT,p),this.ISGenerated=!0,g&&(this._initPTS=i,this._initDTS=o)):u.trigger(n.a.ERROR,{type:a.b.MEDIA_ERROR,details:a.a.FRAG_PARSING_ERROR,fatal:!1,reason:"no audio/video samples found"})},t.remuxVideo=function(e,t,r,i){var o,u,c,l,d,f=e.timescale,h=e.samples,p=[],g=h.length,v=this._initPTS,m=8,y=Number.POSITIVE_INFINITY,b=Number.NEGATIVE_INFINITY,S=0,E=!1,T=this.nextAvcDts;if(0!==g){r||(T=t*f-(h[0].pts-U(h[0].dts,h[0].pts)));for(var w=0;w<g;w++){var O=h[w];O.pts=U(O.pts-v,T),O.dts=U(O.dts-v,T),O.dts>O.pts&&(S=Math.max(Math.min(S,O.pts-O.dts),-1*x)),O.dts<h[w>0?w-1:w].dts&&(E=!0)}E&&h.sort((function(e,t){var r=e.dts-t.dts,n=e.pts-t.pts;return r||n||e.id-t.id})),l=h[0].dts,d=h[g-1].dts;var A=Math.round((d-l)/(g-1));if(S<0){if(S<-2*A){s.b.warn("PTS < DTS detected in video samples, offsetting DTS from PTS by "+L(-A,!0)+" ms");for(var _=S,R=0;R<g;R++)h[R].dts=_=Math.max(_,h[R].pts-A),h[R].pts=Math.max(_,h[R].pts)}else{s.b.warn("PTS < DTS detected in video samples, shifting DTS by "+L(S,!0)+" ms to overcome this issue");for(var k=0;k<g;k++)h[k].dts=h[k].dts+S}l=h[0].dts,d=h[g-1].dts}if(r){var C=l-T,D=C>A;if(D||C<-1){D?s.b.warn("AVC: "+L(C,!0)+" ms ("+C+"dts) hole between fragments detected, filling it"):s.b.warn("AVC: "+L(-C,!0)+" ms ("+C+"dts) overlapping between fragments detected"),l=T;var I=h[0].pts-C;h[0].dts=l,h[0].pts=I,s.b.log("Video: First PTS/DTS adjusted: "+L(I,!0)+"/"+L(l,!0)+", delta: "+L(C,!0)+" ms")}}M&&M<75&&(l=Math.max(0,l));for(var j=0,F=0,N=0;N<g;N++){for(var B=h[N],G=B.units,V=G.length,K=0,H=0;H<V;H++)K+=G[H].data.length;F+=K,j+=V,B.length=K,B.dts=Math.max(B.dts,l),B.pts=Math.max(B.pts,B.dts,0),y=Math.min(B.pts,y),b=Math.max(B.pts,b)}d=h[g-1].dts;var Z=F+4*j+8;try{u=new Uint8Array(Z)}catch(e){return void this.observer.trigger(n.a.ERROR,{type:a.b.MUX_ERROR,details:a.a.REMUX_ALLOC_ERROR,fatal:!1,bytes:Z,reason:"fail allocating video mdat "+Z})}var Y=new DataView(u.buffer);Y.setUint32(0,Z),u.set(P.types.mdat,4);for(var q=0;q<g;q++){for(var W,z=h[q],X=z.units,Q=0,$=0,J=X.length;$<J;$++){var ee=X[$],te=ee.data,re=ee.data.byteLength;Y.setUint32(m,re),m+=4,u.set(te,m),m+=re,Q+=4+re}if(q<g-1)o=h[q+1].dts-z.dts;else{var ne=this.config,ae=z.dts-h[q>0?q-1:q].dts;if(ne.stretchShortVideoTrack){var ie=ne.maxBufferHole,oe=Math.floor(ie*f),se=(i?y+i*f:this.nextAudioPts)-z.pts;se>oe?((o=se-ae)<0&&(o=ae),s.b.log("It is approximately "+L(se,!1)+" ms to the next segment; using duration "+L(o,!1)+" ms for the last video frame.")):o=ae}else o=ae}W=Math.round(z.pts-z.dts),p.push({size:Q,duration:o,cts:W,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:z.key?2:1,isNonSync:z.key?0:1}})}this.nextAvcDts=d+o;var ue=e.dropped;if(e.nbNalu=0,e.dropped=0,p.length&&navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var ce=p[0].flags;ce.dependsOn=2,ce.isNonSync=0}e.samples=p,c=P.moof(e.sequenceNumber++,l,e),e.samples=[];var le={data1:c,data2:u,startPTS:y/f,endPTS:(b+o)/f,startDTS:l/f,endDTS:this.nextAvcDts/f,type:"video",hasAudio:!1,hasVideo:!0,nb:p.length,dropped:ue};return this.observer.trigger(n.a.FRAG_PARSING_DATA,le),le}},t.remuxAudio=function(e,t,r,i){var o,u,c,l,d,f,h=e.inputTimeScale,p=e.timescale,g=h/p,v=(e.isAAC?1024:1152)*g,m=this._initPTS,y=!e.isAAC&&this.typeSupported.mpeg,b=y?0:8,S=e.samples,E=[],T=this.nextAudioPts;if(r|=S.length&&T&&(i&&Math.abs(t-T/h)<.1||Math.abs(S[0].pts-T-m)<20*v),S.forEach((function(e){e.pts=e.dts=U(e.pts-m,t*h)})),0!==(S=S.filter((function(e){return e.pts>=0}))).length){if(r||(T=i?Math.max(0,t*h):S[0].pts),e.isAAC)for(var w=this.config.maxAudioFramesDrift,O=0,A=T;O<S.length;){var _=S[O],k=_.pts,C=k-A;if(C<=-w*v)r||O>0?(s.b.warn("Dropping 1 audio frame @ "+L(A,!0)/1e3+"s due to "+L(C,!0)+" ms overlap."),S.splice(O,1)):(s.b.warn("Audio frame @ "+L(k,!0)/1e3+"s overlaps nextAudioPts by "+L(C,!0)+" ms."),A=k+v,O++);else if(C>=w*v&&C<I&&A){var D=Math.round(C/v);s.b.warn("Injecting "+D+" audio frames @ "+L(A,!0)/1e3+"s due to "+L(C,!0)+" ms gap.");for(var x=0;x<D;x++){var M=Math.max(A,0);(u=R.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(s.b.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),u=_.unit.subarray()),S.splice(O,0,{unit:u,pts:M,dts:M}),A+=v,O++}_.pts=_.dts=A,A+=v,O++}else Math.abs(C),_.pts=_.dts=A,A+=v,O++}for(var j=S.length,F=0;j--;)F+=S[j].unit.byteLength;for(var N=0,B=S.length;N<B;N++){var G=S[N],V=G.unit,K=G.pts;if(void 0!==f&&o)o.duration=Math.round((K-f)/g);else{var H=K-T,Z=0;if(r&&e.isAAC&&H){if(H>0&&H<I)Z=Math.round((K-T)/v),s.b.log(L(H,!0)+" ms hole between AAC samples detected,filling it"),Z>0&&((u=R.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(u=V.subarray()),F+=Z*u.length);else if(H<-12){s.b.log("drop overlapping AAC sample, expected/parsed/delta: "+L(T,!0)+" ms / "+L(K,!0)+" ms / "+L(-H,!0)+" ms"),F-=V.byteLength;continue}K=T}if(d=K,!(F>0))return;F+=b;try{c=new Uint8Array(F)}catch(e){return void this.observer.trigger(n.a.ERROR,{type:a.b.MUX_ERROR,details:a.a.REMUX_ALLOC_ERROR,fatal:!1,bytes:F,reason:"fail allocating audio mdat "+F})}y||(new DataView(c.buffer).setUint32(0,F),c.set(P.types.mdat,4));for(var Y=0;Y<Z;Y++)(u=R.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(s.b.log("Unable to get silent frame for given audio codec; duplicating this frame instead."),u=V.subarray()),c.set(u,b),b+=u.byteLength,o={size:u.byteLength,cts:0,duration:1024,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},E.push(o)}c.set(V,b);var q=V.byteLength;b+=q,o={size:q,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},E.push(o),f=K}var W=0;if((j=E.length)>=2&&(W=E[j-2].duration,o.duration=W),j){this.nextAudioPts=T=f+g*W,e.samples=E,l=y?new Uint8Array:P.moof(e.sequenceNumber++,d/g,e),e.samples=[];var z=d/h,X=T/h,Q={data1:l,data2:c,startPTS:z,endPTS:X,startDTS:z,endDTS:X,type:"audio",hasAudio:!0,hasVideo:!1,nb:j};return this.observer.trigger(n.a.FRAG_PARSING_DATA,Q),Q}return null}},t.remuxEmptyAudio=function(e,t,r,n){var a=e.inputTimeScale,i=a/(e.samplerate?e.samplerate:a),o=this.nextAudioPts,u=(void 0!==o?o:n.startDTS*a)+this._initDTS,c=n.endDTS*a+this._initDTS,l=1024*i,d=Math.ceil((c-u)/l),f=R.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(s.b.warn("remux empty Audio"),f){for(var h=[],p=0;p<d;p++){var g=u+p*l;h.push({unit:f,pts:g,dts:g})}e.samples=h,this.remuxAudio(e,t,r)}else s.b.trace("Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!")},t.remuxID3=function(e,t){var r=e.samples.length;if(r){for(var a=e.inputTimeScale,i=this._initPTS,o=this._initDTS,s=0;s<r;s++){var u=e.samples[s];u.pts=U(u.pts-i,t*a)/a,u.dts=U(u.dts-o,t*a)/a}this.observer.trigger(n.a.FRAG_PARSING_METADATA,{samples:e.samples}),e.samples=[]}},t.remuxText=function(e,t){var r=e.samples.length,a=e.inputTimeScale,i=this._initPTS;if(r){for(var o=0;o<r;o++){var s=e.samples[o];s.pts=U(s.pts-i,t*a)/a}e.samples.sort((function(e,t){return e.pts-t.pts})),this.observer.trigger(n.a.FRAG_PARSING_USERDATA,{samples:e.samples})}e.samples=[]},e}(),N=function(){function e(e){this.observer=e}var t=e.prototype;return t.destroy=function(){},t.resetTimeStamp=function(){},t.resetInitSegment=function(){},t.remux=function(e,t,r,a,i,o,s,u){var c=this.observer,l="";e&&(l+="audio"),t&&(l+="video"),c.trigger(n.a.FRAG_PARSING_DATA,{data1:u,startPTS:i,startDTS:i,type:l,hasAudio:!!e,hasVideo:!!t,nb:1,dropped:0}),c.trigger(n.a.FRAG_PARSED)},e}(),B=Object(u.a)();try{j=B.performance.now.bind(B.performance)}catch(e){s.b.debug("Unable to use Performance API on this environment"),j=B.Date.now}var G=function(){function e(e,t,r,n){this.observer=e,this.typeSupported=t,this.config=r,this.vendor=n}var t=e.prototype;return t.destroy=function(){var e=this.demuxer;e&&e.destroy()},t.push=function(e,t,r,a,o,s,u,c,l,d,f,h){var p=this;if(e.byteLength>0&&null!=t&&null!=t.key&&"AES-128"===t.method){var g=this.decrypter;null==g&&(g=this.decrypter=new i.a(this.observer,this.config));var v=j();g.decrypt(e,t.key.buffer,t.iv.buffer,(function(e){var i=j();p.observer.trigger(n.a.FRAG_DECRYPTED,{stats:{tstart:v,tdecrypt:i}}),p.pushDecrypted(new Uint8Array(e),t,new Uint8Array(r),a,o,s,u,c,l,d,f,h)}))}else this.pushDecrypted(new Uint8Array(e),t,new Uint8Array(r),a,o,s,u,c,l,d,f,h)},t.pushDecrypted=function(e,t,r,i,o,s,u,c,l,d,f,h){var p=this.demuxer,g=this.remuxer;if(!p||u||c){for(var v,m=this.observer,S=this.typeSupported,E=this.config,T=[{demux:A,remux:F},{demux:b.a,remux:N},{demux:y,remux:F},{demux:_,remux:F}],w=0,O=T.length;w<O&&!(v=T[w]).demux.probe(e);w++);if(!v)return void m.trigger(n.a.ERROR,{type:a.b.MEDIA_ERROR,details:a.a.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"});g&&g instanceof v.remux||(g=new v.remux(m,E,S,this.vendor)),p&&p instanceof v.demux||(p=new v.demux(m,g,E,S),this.probe=v.demux.probe),this.demuxer=p,this.remuxer=g}(u||c)&&(p.resetInitSegment(r,i,o,d),g.resetInitSegment()),u&&(p.resetTimeStamp(h),g.resetTimeStamp(h)),"function"==typeof p.setDecryptData&&p.setDecryptData(t),p.append(e,s,l,f)},e}();t.a=G},function(e,t,r){"use strict";var n=r(0),a=r(1),i=Math.pow(2,32)-1,o=function(){function e(e,t){this.observer=e,this.remuxer=t}var t=e.prototype;return t.resetTimeStamp=function(e){this.initPTS=e},t.resetInitSegment=function(t,r,n,i){if(t&&t.byteLength){var o=this.initData=e.parseInitSegment(t);null==r&&(r="mp4a.40.5"),null==n&&(n="avc1.42e01e");var s={};o.audio&&o.video?s.audiovideo={container:"video/mp4",codec:r+","+n,initSegment:i?t:null}:(o.audio&&(s.audio={container:"audio/mp4",codec:r,initSegment:i?t:null}),o.video&&(s.video={container:"video/mp4",codec:n,initSegment:i?t:null})),this.observer.trigger(a.a.FRAG_PARSING_INIT_SEGMENT,{tracks:s})}else r&&(this.audioCodec=r),n&&(this.videoCodec=n)},e.probe=function(t){return e.findBox({data:t,start:0,end:Math.min(t.length,16384)},["moof"]).length>0},e.bin2str=function(e){return String.fromCharCode.apply(null,e)},e.readUint16=function(e,t){e.data&&(t+=e.start,e=e.data);var r=e[t]<<8|e[t+1];return r<0?65536+r:r},e.readUint32=function(e,t){e.data&&(t+=e.start,e=e.data);var r=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3];return r<0?4294967296+r:r},e.writeUint32=function(e,t,r){e.data&&(t+=e.start,e=e.data),e[t]=r>>24,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=255&r},e.findBox=function(t,r){var n,a,i,o,s,u,c=[];if(t.data?(s=t.start,i=t.end,t=t.data):(s=0,i=t.byteLength),!r.length)return null;for(n=s;n<i;)u=(a=e.readUint32(t,n))>1?n+a:i,e.bin2str(t.subarray(n+4,n+8))===r[0]&&(1===r.length?c.push({data:t,start:n+8,end:u}):(o=e.findBox({data:t,start:n+8,end:u},r.slice(1))).length&&(c=c.concat(o))),n=u;return c},e.parseSegmentIndex=function(t){var r,n=e.findBox(t,["moov"])[0],a=n?n.end:null,i=0,o=e.findBox(t,["sidx"]);if(!o||!o[0])return null;r=[];var s=(o=o[0]).data[0];i=0===s?8:16;var u=e.readUint32(o,i);i+=4,i+=0===s?8:16,i+=2;var c=o.end+0,l=e.readUint16(o,i);i+=2;for(var d=0;d<l;d++){var f=i,h=e.readUint32(o,f);f+=4;var p=2147483647&h;if(1==(2147483648&h)>>>31)return void console.warn("SIDX has hierarchical references (not supported)");var g=e.readUint32(o,f);f+=4,r.push({referenceSize:p,subsegmentDuration:g,info:{duration:g/u,start:c,end:c+p-1}}),c+=p,i=f+=4}return{earliestPresentationTime:0,timescale:u,version:s,referencesCount:l,references:r,moovEndOffset:a}},e.parseInitSegment=function(t){var r=[];return e.findBox(t,["moov","trak"]).forEach((function(t){var a=e.findBox(t,["tkhd"])[0];if(a){var i=a.data[a.start],o=0===i?12:20,s=e.readUint32(a,o),u=e.findBox(t,["mdia","mdhd"])[0];if(u){o=0===(i=u.data[u.start])?12:20;var c=e.readUint32(u,o),l=e.findBox(t,["mdia","hdlr"])[0];if(l){var d={soun:"audio",vide:"video"}[e.bin2str(l.data.subarray(l.start+8,l.start+12))];if(d){var f=e.findBox(t,["mdia","minf","stbl","stsd"]);if(f.length){f=f[0];var h=e.bin2str(f.data.subarray(f.start+12,f.start+16));n.b.log("MP4Demuxer:"+d+":"+h+" found")}r[s]={timescale:c,type:d},r[d]={timescale:c,id:s}}}}}})),r},e.getStartDTS=function(t,r){var n,a,i;return n=e.findBox(r,["moof","traf"]),a=[].concat.apply([],n.map((function(r){return e.findBox(r,["tfhd"]).map((function(n){var a,i;return a=e.readUint32(n,4),i=t[a].timescale||9e4,e.findBox(r,["tfdt"]).map((function(t){var r,n;return r=t.data[t.start],n=e.readUint32(t,4),1===r&&(n*=Math.pow(2,32),n+=e.readUint32(t,8)),n}))[0]/i}))}))),i=Math.min.apply(null,a),isFinite(i)?i:0},e.offsetStartDTS=function(t,r,n){e.findBox(r,["moof","traf"]).map((function(r){return e.findBox(r,["tfhd"]).map((function(a){var o=e.readUint32(a,4),s=t[o].timescale||9e4;e.findBox(r,["tfdt"]).map((function(t){var r=t.data[t.start],a=e.readUint32(t,4);if(0===r)e.writeUint32(t,4,a-n*s);else{a*=Math.pow(2,32),a+=e.readUint32(t,8),a-=n*s,a=Math.max(a,0);var o=Math.floor(a/(i+1)),u=Math.floor(a%(i+1));e.writeUint32(t,4,o),e.writeUint32(t,8,u)}}))}))}))},t.append=function(t,r,n,i){var o=this.initData;o||(this.resetInitSegment(t,this.audioCodec,this.videoCodec,!1),o=this.initData);var s,u=this.initPTS;if(void 0===u){var c=e.getStartDTS(o,t);this.initPTS=u=c-r,this.observer.trigger(a.a.INIT_PTS_FOUND,{initPTS:u})}e.offsetStartDTS(o,t,u),s=e.getStartDTS(o,t),this.remuxer.remux(o.audio,o.video,null,null,s,n,i,t)},t.destroy=function(){},e}();t.a=o},function(e,t,r){function n(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=t,r.i=function(e){return e},r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/",r.oe=function(e){throw console.error(e),e};var n=r(r.s=ENTRY_MODULE);return n.default||n}function a(e){return(e+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function i(e,t,n){var i={};i[n]=[];var o=t.toString(),s=o.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!s)return i;for(var u,c=s[1],l=new RegExp("(\\\\n|\\W)"+a(c)+"\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)","g");u=l.exec(o);)"dll-reference"!==u[3]&&i[n].push(u[3]);for(l=new RegExp("\\("+a(c)+'\\("(dll-reference\\s([\\.|\\-|\\+|\\w|/|@]+))"\\)\\)\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)',"g");u=l.exec(o);)e[u[2]]||(i[n].push(u[1]),e[u[2]]=r(u[1]).m),i[u[2]]=i[u[2]]||[],i[u[2]].push(u[4]);for(var d,f=Object.keys(i),h=0;h<f.length;h++)for(var p=0;p<i[f[h]].length;p++)d=i[f[h]][p],isNaN(1*d)||(i[f[h]][p]=1*i[f[h]][p]);return i}function o(e){return Object.keys(e).reduce((function(t,r){return t||e[r].length>0}),!1)}e.exports=function(e,t){t=t||{};var a={main:r.m},s=t.all?{main:Object.keys(a.main)}:function(e,t){for(var r={main:[t]},n={main:[]},a={main:{}};o(r);)for(var s=Object.keys(r),u=0;u<s.length;u++){var c=s[u],l=r[c].pop();if(a[c]=a[c]||{},!a[c][l]&&e[c][l]){a[c][l]=!0,n[c]=n[c]||[],n[c].push(l);for(var d=i(e,e[c][l],c),f=Object.keys(d),h=0;h<f.length;h++)r[f[h]]=r[f[h]]||[],r[f[h]]=r[f[h]].concat(d[f[h]])}}return n}(a,e),u="";Object.keys(s).filter((function(e){return"main"!==e})).forEach((function(e){for(var t=0;s[e][t];)t++;s[e].push(t),a[e][t]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",u=u+"var "+e+" = ("+n.toString().replace("ENTRY_MODULE",JSON.stringify(t))+")({"+s[e].map((function(t){return JSON.stringify(t)+": "+a[e][t].toString()})).join(",")+"});\n"})),u=u+"new (("+n.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+s.main.map((function(e){return JSON.stringify(e)+": "+a.main[e].toString()})).join(",")+"}))(self);";var c=new window.Blob([u],{type:"text/javascript"});if(t.bare)return c;var l=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(c),d=new window.Worker(l);return d.objectURL=l,d}},function(e,t,r){"use strict";r.r(t);var n=r(9),a=r(1),i=r(0),o=r(8);t.default=function(e){var t=new o.EventEmitter;t.trigger=function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];t.emit.apply(t,[e,e].concat(n))},t.off=function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];t.removeListener.apply(t,[e].concat(n))};var r=function(t,r){e.postMessage({event:t,data:r})};e.addEventListener("message",(function(a){var o=a.data;switch(o.cmd){case"init":var s=JSON.parse(o.config);e.demuxer=new n.a(t,o.typeSupported,s,o.vendor),Object(i.a)(s.debug),r("init",null);break;case"demux":e.demuxer.push(o.data,o.decryptdata,o.initSegment,o.audioCodec,o.videoCodec,o.timeOffset,o.discontinuity,o.trackSwitch,o.contiguous,o.duration,o.accurateTimeOffset,o.defaultInitPTS)}})),t.on(a.a.FRAG_DECRYPTED,r),t.on(a.a.FRAG_PARSING_INIT_SEGMENT,r),t.on(a.a.FRAG_PARSED,r),t.on(a.a.ERROR,r),t.on(a.a.FRAG_PARSING_METADATA,r),t.on(a.a.FRAG_PARSING_USERDATA,r),t.on(a.a.INIT_PTS_FOUND,r),t.on(a.a.FRAG_PARSING_DATA,(function(t,r){var n=[],a={event:t,data:r};r.data1&&(a.data1=r.data1.buffer,n.push(r.data1.buffer),delete r.data1),r.data2&&(a.data2=r.data2.buffer,n.push(r.data2.buffer),delete r.data2),e.postMessage(a,n)}))}},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return ir}));var n={};r.r(n),r.d(n,"newCue",(function(){return ht}));var a,i,o=r(6),s=r(2),u=r(3),c=r(1),l=r(0),d={hlsEventGeneric:!0,hlsHandlerDestroying:!0,hlsHandlerDestroyed:!0},f=function(){function e(e){this.hls=void 0,this.handledEvents=void 0,this.useGenericHandler=void 0,this.hls=e,this.onEvent=this.onEvent.bind(this);for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];this.handledEvents=r,this.useGenericHandler=!0,this.registerListeners()}var t=e.prototype;return t.destroy=function(){this.onHandlerDestroying(),this.unregisterListeners(),this.onHandlerDestroyed()},t.onHandlerDestroying=function(){},t.onHandlerDestroyed=function(){},t.isEventHandler=function(){return"object"==typeof this.handledEvents&&this.handledEvents.length&&"function"==typeof this.onEvent},t.registerListeners=function(){this.isEventHandler()&&this.handledEvents.forEach((function(e){if(d[e])throw new Error("Forbidden event-name: "+e);this.hls.on(e,this.onEvent)}),this)},t.unregisterListeners=function(){this.isEventHandler()&&this.handledEvents.forEach((function(e){this.hls.off(e,this.onEvent)}),this)},t.onEvent=function(e,t){this.onEventGeneric(e,t)},t.onEventGeneric=function(e,t){try{(function(e,t){var r="on"+e.replace("hls","");if("function"!=typeof this[r])throw new Error("Event "+e+" has no generic handler in this "+this.constructor.name+" class (tried "+r+")");return this[r].bind(this,t)}).call(this,e,t).call()}catch(t){l.b.error("An internal error happened while handling event "+e+'. Error message: "'+t.message+'". Here is a stacktrace:',t),this.hls.trigger(c.a.ERROR,{type:s.b.OTHER_ERROR,details:s.a.INTERNAL_EXCEPTION,fatal:!1,event:e,err:t})}},e}();!function(e){e.MANIFEST="manifest",e.LEVEL="level",e.AUDIO_TRACK="audioTrack",e.SUBTITLE_TRACK="subtitleTrack"}(a||(a={})),function(e){e.MAIN="main",e.AUDIO="audio",e.SUBTITLE="subtitle"}(i||(i={}));var h=r(10);function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var g,v=function(){function e(e,t){this._uri=null,this.baseuri=void 0,this.reluri=void 0,this.method=null,this.key=null,this.iv=null,this.baseuri=e,this.reluri=t}var t,r;return t=e,(r=[{key:"uri",get:function(){return!this._uri&&this.reluri&&(this._uri=Object(o.buildAbsoluteURL)(this.baseuri,this.reluri,{alwaysNormalize:!0})),this._uri}}])&&p(t.prototype,r),e}();function m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}!function(e){e.AUDIO="audio",e.VIDEO="video"}(g||(g={}));var y=function(){function e(){var e;this._url=null,this._byteRange=null,this._decryptdata=null,this._elementaryStreams=((e={})[g.AUDIO]=!1,e[g.VIDEO]=!1,e),this.deltaPTS=0,this.rawProgramDateTime=null,this.programDateTime=null,this.title=null,this.tagList=[],this.cc=void 0,this.type=void 0,this.relurl=void 0,this.baseurl=void 0,this.duration=void 0,this.start=void 0,this.sn=0,this.urlId=0,this.level=0,this.levelkey=void 0,this.loader=void 0}var t,r,n=e.prototype;return n.setByteRange=function(e,t){var r=e.split("@",2),n=[];1===r.length?n[0]=t?t.byteRangeEndOffset:0:n[0]=parseInt(r[1]),n[1]=parseInt(r[0])+n[0],this._byteRange=n},n.addElementaryStream=function(e){this._elementaryStreams[e]=!0},n.hasElementaryStream=function(e){return!0===this._elementaryStreams[e]},n.createInitializationVector=function(e){for(var t=new Uint8Array(16),r=12;r<16;r++)t[r]=e>>8*(15-r)&255;return t},n.setDecryptDataFromLevelKey=function(e,t){var r=e;return(null==e?void 0:e.method)&&e.uri&&!e.iv&&((r=new v(e.baseuri,e.reluri)).method=e.method,r.iv=this.createInitializationVector(t)),r},t=e,(r=[{key:"url",get:function(){return!this._url&&this.relurl&&(this._url=Object(o.buildAbsoluteURL)(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url},set:function(e){this._url=e}},{key:"byteRange",get:function(){return this._byteRange?this._byteRange:[]}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"decryptdata",get:function(){if(!this.levelkey&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkey){var e=this.sn;"number"!=typeof e&&(this.levelkey&&"AES-128"===this.levelkey.method&&!this.levelkey.iv&&l.b.warn('missing IV for initialization segment with method="'+this.levelkey.method+'" - compliance issue'),e=0),this._decryptdata=this.setDecryptDataFromLevelKey(this.levelkey,e)}return this._decryptdata}},{key:"endProgramDateTime",get:function(){if(null===this.programDateTime)return null;if(!Object(u.a)(this.programDateTime))return null;var e=Object(u.a)(this.duration)?this.duration:0;return this.programDateTime+1e3*e}},{key:"encrypted",get:function(){return!(!this.decryptdata||null===this.decryptdata.uri||null!==this.decryptdata.key)}}])&&m(t.prototype,r),e}();function b(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var S=function(){function e(e){this.endCC=0,this.endSN=0,this.fragments=[],this.initSegment=null,this.live=!0,this.needSidxRanges=!1,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=e,this.version=null}var t,r;return t=e,(r=[{key:"hasProgramDateTime",get:function(){return!(!this.fragments[0]||!Object(u.a)(this.fragments[0].programDateTime))}}])&&b(t.prototype,r),e}(),E=/^(\d+)x(\d+)$/,T=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,w=function(){function e(t){for(var r in"string"==typeof t&&(t=e.parseAttrList(t)),t)t.hasOwnProperty(r)&&(this[r]=t[r])}var t=e.prototype;return t.decimalInteger=function(e){var t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t},t.hexadecimalInteger=function(e){if(this[e]){var t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;for(var r=new Uint8Array(t.length/2),n=0;n<t.length/2;n++)r[n]=parseInt(t.slice(2*n,2*n+2),16);return r}return null},t.hexadecimalIntegerAsNumber=function(e){var t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t},t.decimalFloatingPoint=function(e){return parseFloat(this[e])},t.enumeratedString=function(e){return this[e]},t.decimalResolution=function(e){var t=E.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}},e.parseAttrList=function(e){var t,r={};for(T.lastIndex=0;null!==(t=T.exec(e));){var n=t[2];0===n.indexOf('"')&&n.lastIndexOf('"')===n.length-1&&(n=n.slice(1,-1)),r[t[1]]=n}return r},e}(),O={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0}};function A(e,t){return MediaSource.isTypeSupported((t||"video")+'/mp4;codecs="'+e+'"')}var _=/(?:#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)|#EXT-X-SESSION-DATA:([^\n\r]*)[\r\n]+)/g,R=/#EXT-X-MEDIA:(.*)/g,k=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/|(?!#)([\S+ ?]+)/.source,/|#EXT-X-BYTERANGE:*(.+)/.source,/|#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/|#.*/.source].join(""),"g"),P=/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\d+))|(?:#EXT-X-(TARGETDURATION): *(\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\d+))|(?:#EXT-X-(MAP):(.+))|(?:(#)([^:]*):(.*))|(?:(#)(.*))(?:.*)\r?\n?/,C=/\.(mp4|m4s|m4v|m4a)$/i,L=function(){function e(){}return e.findGroup=function(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(n.id===t)return n}},e.convertAVC1ToAVCOTI=function(e){var t,r=e.split(".");return r.length>2?(t=r.shift()+".",t+=parseInt(r.shift()).toString(16),t+=("000"+parseInt(r.shift()).toString(16)).substr(-4)):t=e,t},e.resolve=function(e,t){return o.buildAbsoluteURL(t,e,{alwaysNormalize:!0})},e.parseMasterPlaylist=function(t,r){var n,a=[],i={},o=!1;function s(e,t){["video","audio"].forEach((function(r){var n=e.filter((function(e){return function(e,t){var r=O[t];return!!r&&!0===r[e.slice(0,4)]}(e,r)}));if(n.length){var a=n.filter((function(e){return 0===e.lastIndexOf("avc1",0)||0===e.lastIndexOf("mp4a",0)}));t[r+"Codec"]=a.length>0?a[0]:n[0],e=e.filter((function(e){return-1===n.indexOf(e)}))}})),t.unknownCodecs=e}for(_.lastIndex=0;null!=(n=_.exec(t));)if(n[1]){var u={},c=u.attrs=new w(n[1]);u.url=e.resolve(n[2],r);var l=c.decimalResolution("RESOLUTION");l&&(u.width=l.width,u.height=l.height),u.bitrate=c.decimalInteger("AVERAGE-BANDWIDTH")||c.decimalInteger("BANDWIDTH"),u.name=c.NAME,s([].concat((c.CODECS||"").split(/[ ,]+/)),u),u.videoCodec&&-1!==u.videoCodec.indexOf("avc1")&&(u.videoCodec=e.convertAVC1ToAVCOTI(u.videoCodec)),a.push(u)}else if(n[3]){var d=new w(n[3]);d["DATA-ID"]&&(o=!0,i[d["DATA-ID"]]=d)}return{levels:a,sessionData:o?i:null}},e.parseMasterPlaylistMedia=function(t,r,n,a){var i;void 0===a&&(a=[]);var o=[],s=0;for(R.lastIndex=0;null!==(i=R.exec(t));){var u=new w(i[1]);if(u.TYPE===n){var c={attrs:u,id:s++,groupId:u["GROUP-ID"],instreamId:u["INSTREAM-ID"],name:u.NAME||u.LANGUAGE,type:n,default:"YES"===u.DEFAULT,autoselect:"YES"===u.AUTOSELECT,forced:"YES"===u.FORCED,lang:u.LANGUAGE};if(u.URI&&(c.url=e.resolve(u.URI,r)),a.length){var l=e.findGroup(a,c.groupId);c.audioCodec=l?l.codec:a[0].codec}o.push(c)}}return o},e.parseLevelPlaylist=function(e,t,r,n,a){var i,o,s,c=0,d=0,f=new S(t),h=0,p=null,g=new y,m=null;for(k.lastIndex=0;null!==(i=k.exec(e));){var b=i[1];if(b){g.duration=parseFloat(b);var E=(" "+i[2]).slice(1);g.title=E||null,g.tagList.push(E?["INF",b,E]:["INF",b])}else if(i[3]){if(Object(u.a)(g.duration)){var T=c++;g.type=n,g.start=d,s&&(g.levelkey=s),g.sn=T,g.level=r,g.cc=h,g.urlId=a,g.baseurl=t,g.relurl=(" "+i[3]).slice(1),D(g,p),f.fragments.push(g),p=g,d+=g.duration,g=new y}}else if(i[4]){var O=(" "+i[4]).slice(1);p?g.setByteRange(O,p):g.setByteRange(O)}else if(i[5])g.rawProgramDateTime=(" "+i[5]).slice(1),g.tagList.push(["PROGRAM-DATE-TIME",g.rawProgramDateTime]),null===m&&(m=f.fragments.length);else{if(!(i=i[0].match(P))){l.b.warn("No matches on slow regex match for level playlist!");continue}for(o=1;o<i.length&&void 0===i[o];o++);var A=(" "+i[o+1]).slice(1),_=(" "+i[o+2]).slice(1);switch(i[o]){case"#":g.tagList.push(_?[A,_]:[A]);break;case"PLAYLIST-TYPE":f.type=A.toUpperCase();break;case"MEDIA-SEQUENCE":c=f.startSN=parseInt(A);break;case"TARGETDURATION":f.targetduration=parseFloat(A);break;case"VERSION":f.version=parseInt(A);break;case"EXTM3U":break;case"ENDLIST":f.live=!1;break;case"DIS":h++,g.tagList.push(["DIS"]);break;case"DISCONTINUITY-SEQ":h=parseInt(A);break;case"KEY":var R=new w(A),L=R.enumeratedString("METHOD"),I=R.URI,x=R.hexadecimalInteger("IV");if("com.apple.streamingkeydelivery"===(R.KEYFORMAT||"identity")){l.b.warn("Keyformat com.apple.streamingkeydelivery is not supported");continue}L&&(s=new v(t,I),I&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(L)>=0&&(s.method=L,s.key=null,s.iv=x));break;case"START":var M=new w(A).decimalFloatingPoint("TIME-OFFSET");Object(u.a)(M)&&(f.startTimeOffset=M);break;case"MAP":var U=new w(A);g.relurl=U.URI,U.BYTERANGE&&g.setByteRange(U.BYTERANGE),g.baseurl=t,g.level=r,g.type=n,g.sn="initSegment",f.initSegment=g,(g=new y).rawProgramDateTime=f.initSegment.rawProgramDateTime;break;default:l.b.warn("line parsed but not handled: "+i)}}}return(g=p)&&!g.relurl&&(f.fragments.pop(),d-=g.duration),f.totalduration=d,f.averagetargetduration=d/f.fragments.length,f.endSN=c-1,f.startCC=f.fragments[0]?f.fragments[0].cc:0,f.endCC=h,!f.initSegment&&f.fragments.length&&f.fragments.every((function(e){return C.test(e.relurl)}))&&(l.b.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),(g=new y).relurl=f.fragments[0].relurl,g.baseurl=t,g.level=r,g.type=n,g.sn="initSegment",f.initSegment=g,f.needSidxRanges=!0),m&&function(e,t){for(var r=e[t],n=t-1;n>=0;n--){var a=e[n];a.programDateTime=r.programDateTime-1e3*a.duration,r=a}}(f.fragments,m),f},e}();function D(e,t){e.rawProgramDateTime?e.programDateTime=Date.parse(e.rawProgramDateTime):(null==t?void 0:t.programDateTime)&&(e.programDateTime=t.endProgramDateTime),Object(u.a)(e.programDateTime)||(e.programDateTime=null,e.rawProgramDateTime=null)}var I=window.performance,x=function(e){var t,r;function n(t){var r;return(r=e.call(this,t,c.a.MANIFEST_LOADING,c.a.LEVEL_LOADING,c.a.AUDIO_TRACK_LOADING,c.a.SUBTITLE_TRACK_LOADING)||this).loaders={},r}r=e,(t=n).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,n.canHaveQualityLevels=function(e){return e!==a.AUDIO_TRACK&&e!==a.SUBTITLE_TRACK},n.mapContextToLevelType=function(e){switch(e.type){case a.AUDIO_TRACK:return i.AUDIO;case a.SUBTITLE_TRACK:return i.SUBTITLE;default:return i.MAIN}},n.getResponseUrl=function(e,t){var r=e.url;return void 0!==r&&0!==r.indexOf("data:")||(r=t.url),r};var o=n.prototype;return o.createInternalLoader=function(e){var t=this.hls.config,r=t.pLoader,n=t.loader,a=new(r||n)(t);return e.loader=a,this.loaders[e.type]=a,a},o.getInternalLoader=function(e){return this.loaders[e.type]},o.resetInternalLoader=function(e){this.loaders[e]&&delete this.loaders[e]},o.destroyInternalLoaders=function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}},o.destroy=function(){this.destroyInternalLoaders(),e.prototype.destroy.call(this)},o.onManifestLoading=function(e){this.load({url:e.url,type:a.MANIFEST,level:0,id:null,responseType:"text"})},o.onLevelLoading=function(e){this.load({url:e.url,type:a.LEVEL,level:e.level,id:e.id,responseType:"text"})},o.onAudioTrackLoading=function(e){this.load({url:e.url,type:a.AUDIO_TRACK,level:null,id:e.id,responseType:"text"})},o.onSubtitleTrackLoading=function(e){this.load({url:e.url,type:a.SUBTITLE_TRACK,level:null,id:e.id,responseType:"text"})},o.load=function(e){var t=this.hls.config;l.b.debug("Loading playlist of type "+e.type+", level: "+e.level+", id: "+e.id);var r,n,i,o,s=this.getInternalLoader(e);if(s){var u=s.context;if(u&&u.url===e.url)return l.b.trace("playlist request ongoing"),!1;l.b.warn("aborting previous loader for type: "+e.type),s.abort()}switch(e.type){case a.MANIFEST:r=t.manifestLoadingMaxRetry,n=t.manifestLoadingTimeOut,i=t.manifestLoadingRetryDelay,o=t.manifestLoadingMaxRetryTimeout;break;case a.LEVEL:r=0,o=0,i=0,n=t.levelLoadingTimeOut;break;default:r=t.levelLoadingMaxRetry,n=t.levelLoadingTimeOut,i=t.levelLoadingRetryDelay,o=t.levelLoadingMaxRetryTimeout}s=this.createInternalLoader(e);var c={timeout:n,maxRetry:r,retryDelay:i,maxRetryDelay:o},d={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};return l.b.debug("Calling internal loader delegate for URL: "+e.url),s.load(e,c,d),!0},o.loadsuccess=function(e,t,r,n){if(void 0===n&&(n=null),r.isSidxRequest)return this._handleSidxRequest(e,r),void this._handlePlaylistLoaded(e,t,r,n);if(this.resetInternalLoader(r.type),"string"!=typeof e.data)throw new Error('expected responseType of "text" for PlaylistLoader');var a=e.data;t.tload=I.now(),0===a.indexOf("#EXTM3U")?a.indexOf("#EXTINF:")>0||a.indexOf("#EXT-X-TARGETDURATION:")>0?this._handleTrackOrLevelPlaylist(e,t,r,n):this._handleMasterPlaylist(e,t,r,n):this._handleManifestParsingError(e,r,"no EXTM3U delimiter",n)},o.loaderror=function(e,t,r){void 0===r&&(r=null),this._handleNetworkError(t,r,!1,e)},o.loadtimeout=function(e,t,r){void 0===r&&(r=null),this._handleNetworkError(t,r,!0)},o._handleMasterPlaylist=function(e,t,r,a){var i=this.hls,o=e.data,s=n.getResponseUrl(e,r),u=L.parseMasterPlaylist(o,s),d=u.levels,f=u.sessionData;if(d.length){var h=d.map((function(e){return{id:e.attrs.AUDIO,codec:e.audioCodec}})),p=L.parseMasterPlaylistMedia(o,s,"AUDIO",h),g=L.parseMasterPlaylistMedia(o,s,"SUBTITLES"),v=L.parseMasterPlaylistMedia(o,s,"CLOSED-CAPTIONS");if(p.length){var m=!1;p.forEach((function(e){e.url||(m=!0)})),!1===m&&d[0].audioCodec&&!d[0].attrs.AUDIO&&(l.b.log("audio codec signaled in quality level, but no embedded audio track signaled, create one"),p.unshift({type:"main",name:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:{},url:""}))}i.trigger(c.a.MANIFEST_LOADED,{levels:d,audioTracks:p,subtitles:g,captions:v,url:s,stats:t,networkDetails:a,sessionData:f})}else this._handleManifestParsingError(e,r,"no level found in manifest",a)},o._handleTrackOrLevelPlaylist=function(e,t,r,i){var o=this.hls,l=r.id,d=r.level,f=r.type,h=n.getResponseUrl(e,r),p=Object(u.a)(l)?l:0,g=Object(u.a)(d)?d:p,v=n.mapContextToLevelType(r),m=L.parseLevelPlaylist(e.data,h,g,v,p);if(m.tload=t.tload,m.fragments.length){if(f===a.MANIFEST){var y={url:h,details:m};o.trigger(c.a.MANIFEST_LOADED,{levels:[y],audioTracks:[],url:h,stats:t,networkDetails:i,sessionData:null})}if(t.tparsed=I.now(),m.needSidxRanges){var b=m.initSegment.url;this.load({url:b,isSidxRequest:!0,type:f,level:d,levelDetails:m,id:l,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer"})}else r.levelDetails=m,this._handlePlaylistLoaded(e,t,r,i)}else o.trigger(c.a.ERROR,{type:s.b.NETWORK_ERROR,details:s.a.LEVEL_EMPTY_ERROR,fatal:!1,url:h,reason:"no fragments found in level",level:"number"==typeof r.level?r.level:void 0})},o._handleSidxRequest=function(e,t){if("string"==typeof e.data)throw new Error("sidx request must be made with responseType of array buffer");var r=h.a.parseSegmentIndex(new Uint8Array(e.data));if(r){var n=r.references,a=t.levelDetails;n.forEach((function(e,t){var r=e.info;if(a){var n=a.fragments[t];0===n.byteRange.length&&n.setByteRange(String(1+r.end-r.start)+"@"+String(r.start))}})),a&&a.initSegment.setByteRange(String(r.moovEndOffset)+"@0")}},o._handleManifestParsingError=function(e,t,r,n){this.hls.trigger(c.a.ERROR,{type:s.b.NETWORK_ERROR,details:s.a.MANIFEST_PARSING_ERROR,fatal:!0,url:e.url,reason:r,networkDetails:n})},o._handleNetworkError=function(e,t,r,n){var i,o;void 0===r&&(r=!1),void 0===n&&(n=null),l.b.info("A network error occured while loading a "+e.type+"-type playlist");var u=this.getInternalLoader(e);switch(e.type){case a.MANIFEST:i=r?s.a.MANIFEST_LOAD_TIMEOUT:s.a.MANIFEST_LOAD_ERROR,o=!0;break;case a.LEVEL:i=r?s.a.LEVEL_LOAD_TIMEOUT:s.a.LEVEL_LOAD_ERROR,o=!1;break;case a.AUDIO_TRACK:i=r?s.a.AUDIO_TRACK_LOAD_TIMEOUT:s.a.AUDIO_TRACK_LOAD_ERROR,o=!1;break;default:o=!1}u&&(u.abort(),this.resetInternalLoader(e.type));var d={type:s.b.NETWORK_ERROR,details:i,fatal:o,url:e.url,loader:u,context:e,networkDetails:t};n&&(d.response=n),this.hls.trigger(c.a.ERROR,d)},o._handlePlaylistLoaded=function(e,t,r,i){var o=r.type,s=r.level,u=r.id,l=r.levelDetails;if(l&&l.targetduration)if(n.canHaveQualityLevels(r.type))this.hls.trigger(c.a.LEVEL_LOADED,{details:l,level:s||0,id:u||0,stats:t,networkDetails:i});else switch(o){case a.AUDIO_TRACK:this.hls.trigger(c.a.AUDIO_TRACK_LOADED,{details:l,id:u,stats:t,networkDetails:i});break;case a.SUBTITLE_TRACK:this.hls.trigger(c.a.SUBTITLE_TRACK_LOADED,{details:l,id:u,stats:t,networkDetails:i})}else this._handleManifestParsingError(e,r,"invalid target duration",i)},n}(f),M=function(e){var t,r;function n(t){var r;return(r=e.call(this,t,c.a.FRAG_LOADING)||this).loaders={},r}r=e,(t=n).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var a=n.prototype;return a.destroy=function(){var t=this.loaders;for(var r in t){var n=t[r];n&&n.destroy()}this.loaders={},e.prototype.destroy.call(this)},a.onFragLoading=function(e){var t=e.frag,r=t.type,n=this.loaders,a=this.hls.config,i=a.fLoader,o=a.loader;t.loaded=0;var s,c,d,f=n[r];f&&(l.b.warn("abort previous fragment loader for type: "+r),f.abort()),f=n[r]=t.loader=a.fLoader?new i(a):new o(a),s={url:t.url,frag:t,responseType:"arraybuffer",progressData:!1};var h=t.byteRangeStartOffset,p=t.byteRangeEndOffset;Object(u.a)(h)&&Object(u.a)(p)&&(s.rangeStart=h,s.rangeEnd=p),c={timeout:a.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:a.fragLoadingMaxRetryTimeout},d={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this),onProgress:this.loadprogress.bind(this)},f.load(s,c,d)},a.loadsuccess=function(e,t,r,n){void 0===n&&(n=null);var a=e.data,i=r.frag;i.loader=void 0,this.loaders[i.type]=void 0,this.hls.trigger(c.a.FRAG_LOADED,{payload:a,frag:i,stats:t,networkDetails:n})},a.loaderror=function(e,t,r){void 0===r&&(r=null);var n=t.frag,a=n.loader;a&&a.abort(),this.loaders[n.type]=void 0,this.hls.trigger(c.a.ERROR,{type:s.b.NETWORK_ERROR,details:s.a.FRAG_LOAD_ERROR,fatal:!1,frag:t.frag,response:e,networkDetails:r})},a.loadtimeout=function(e,t,r){void 0===r&&(r=null);var n=t.frag,a=n.loader;a&&a.abort(),this.loaders[n.type]=void 0,this.hls.trigger(c.a.ERROR,{type:s.b.NETWORK_ERROR,details:s.a.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t.frag,networkDetails:r})},a.loadprogress=function(e,t,r,n){void 0===n&&(n=null);var a=t.frag;a.loaded=e.loaded,this.hls.trigger(c.a.FRAG_LOAD_PROGRESS,{frag:a,stats:e,networkDetails:n})},n}(f),U=function(e){var t,r;function n(t){var r;return(r=e.call(this,t,c.a.KEY_LOADING)||this).loaders={},r.decryptkey=null,r.decrypturl=null,r}r=e,(t=n).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var a=n.prototype;return a.destroy=function(){for(var t in this.loaders){var r=this.loaders[t];r&&r.destroy()}this.loaders={},e.prototype.destroy.call(this)},a.onKeyLoading=function(e){var t=e.frag,r=t.type,n=this.loaders[r];if(t.decryptdata){var a=t.decryptdata.uri;if(a!==this.decrypturl||null===this.decryptkey){var i=this.hls.config;if(n&&(l.b.warn("abort previous key loader for type:"+r),n.abort()),!a)return void l.b.warn("key uri is falsy");t.loader=this.loaders[r]=new i.loader(i),this.decrypturl=a,this.decryptkey=null;var o={url:a,frag:t,responseType:"arraybuffer"},s={timeout:i.fragLoadingTimeOut,maxRetry:0,retryDelay:i.fragLoadingRetryDelay,maxRetryDelay:i.fragLoadingMaxRetryTimeout},u={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};t.loader.load(o,s,u)}else this.decryptkey&&(t.decryptdata.key=this.decryptkey,this.hls.trigger(c.a.KEY_LOADED,{frag:t}))}else l.b.warn("Missing decryption data on fragment in onKeyLoading")},a.loadsuccess=function(e,t,r){var n=r.frag;n.decryptdata?(this.decryptkey=n.decryptdata.key=new Uint8Array(e.data),n.loader=void 0,delete this.loaders[n.type],this.hls.trigger(c.a.KEY_LOADED,{frag:n})):l.b.error("after key load, decryptdata unset")},a.loaderror=function(e,t){var r=t.frag,n=r.loader;n&&n.abort(),delete this.loaders[r.type],this.hls.trigger(c.a.ERROR,{type:s.b.NETWORK_ERROR,details:s.a.KEY_LOAD_ERROR,fatal:!1,frag:r,response:e})},a.loadtimeout=function(e,t){var r=t.frag,n=r.loader;n&&n.abort(),delete this.loaders[r.type],this.hls.trigger(c.a.ERROR,{type:s.b.NETWORK_ERROR,details:s.a.KEY_LOAD_TIMEOUT,fatal:!1,frag:r})},n}(f),j="NOT_LOADED",F="APPENDING",N="PARTIAL",B="OK",G=function(e){var t,r;function n(t){var r;return(r=e.call(this,t,c.a.BUFFER_APPENDED,c.a.FRAG_BUFFERED,c.a.FRAG_LOADED)||this).bufferPadding=.2,r.fragments=Object.create(null),r.timeRanges=Object.create(null),r.config=t.config,r}r=e,(t=n).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var a=n.prototype;return a.destroy=function(){this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.config=null,f.prototype.destroy.call(this),e.prototype.destroy.call(this)},a.getBufferedFrag=function(e,t){var r=this.fragments,n=Object.keys(r).filter((function(n){var a=r[n];if(a.body.type!==t)return!1;if(!a.buffered)return!1;var i=a.body;return i.startPTS<=e&&e<=i.endPTS}));if(0===n.length)return null;var a=n.pop();return r[a].body},a.detectEvictedFragments=function(e,t){var r=this;Object.keys(this.fragments).forEach((function(n){var a=r.fragments[n];if(a&&a.buffered){var i=a.range[e];if(i)for(var o=i.time,s=0;s<o.length;s++){var u=o[s];if(!r.isTimeBuffered(u.startPTS,u.endPTS,t)){r.removeFragment(a.body);break}}}}))},a.detectPartialFragments=function(e){var t=this,r=this.getFragmentKey(e),n=this.fragments[r];n&&(n.buffered=!0,Object.keys(this.timeRanges).forEach((function(r){if(e.hasElementaryStream(r)){var a=t.timeRanges[r];n.range[r]=t.getBufferedTimes(e.startPTS,e.endPTS,a)}})))},a.getBufferedTimes=function(e,t,r){for(var n,a,i=[],o=!1,s=0;s<r.length;s++){if(n=r.start(s)-this.bufferPadding,a=r.end(s)+this.bufferPadding,e>=n&&t<=a){i.push({startPTS:Math.max(e,r.start(s)),endPTS:Math.min(t,r.end(s))});break}if(e<a&&t>n)i.push({startPTS:Math.max(e,r.start(s)),endPTS:Math.min(t,r.end(s))}),o=!0;else if(t<=n)break}return{time:i,partial:o}},a.getFragmentKey=function(e){return e.type+"_"+e.level+"_"+e.urlId+"_"+e.sn},a.getPartialFragment=function(e){var t,r,n,a=this,i=null,o=0;return Object.keys(this.fragments).forEach((function(s){var u=a.fragments[s];a.isPartial(u)&&(r=u.body.startPTS-a.bufferPadding,n=u.body.endPTS+a.bufferPadding,e>=r&&e<=n&&(t=Math.min(e-r,n-e),o<=t&&(i=u.body,o=t)))})),i},a.getState=function(e){var t=this.getFragmentKey(e),r=this.fragments[t],n=j;return void 0!==r&&(n=r.buffered?!0===this.isPartial(r)?N:B:F),n},a.isPartial=function(e){return!0===e.buffered&&(void 0!==e.range.video&&!0===e.range.video.partial||void 0!==e.range.audio&&!0===e.range.audio.partial)},a.isTimeBuffered=function(e,t,r){for(var n,a,i=0;i<r.length;i++){if(n=r.start(i)-this.bufferPadding,a=r.end(i)+this.bufferPadding,e>=n&&t<=a)return!0;if(t<=n)return!1}return!1},a.onFragLoaded=function(e){var t=e.frag;Object(u.a)(t.sn)&&!t.bitrateTest&&(this.fragments[this.getFragmentKey(t)]={body:t,range:Object.create(null),buffered:!1})},a.onBufferAppended=function(e){var t=this;this.timeRanges=e.timeRanges,Object.keys(this.timeRanges).forEach((function(e){var r=t.timeRanges[e];t.detectEvictedFragments(e,r)}))},a.onFragBuffered=function(e){this.detectPartialFragments(e.frag)},a.hasFragment=function(e){var t=this.getFragmentKey(e);return void 0!==this.fragments[t]},a.removeFragment=function(e){var t=this.getFragmentKey(e);delete this.fragments[t]},a.removeAllFragments=function(){this.fragments=Object.create(null)},n}(f),V=function(e,t){for(var r=0,n=e.length-1,a=null,i=null;r<=n;){var o=t(i=e[a=(r+n)/2|0]);if(o>0)r=a+1;else{if(!(o<0))return i;n=a-1}}return null},K=function(){function e(){}return e.isBuffered=function(e,t){try{if(e)for(var r=e.buffered,n=0;n<r.length;n++)if(t>=r.start(n)&&t<=r.end(n))return!0}catch(e){}return!1},e.bufferInfo=function(e,t,r){try{if(e){var n,a=e.buffered,i=[];for(n=0;n<a.length;n++)i.push({start:a.start(n),end:a.end(n)});return this.bufferedInfo(i,t,r)}}catch(e){}return{len:0,start:t,end:t,nextStart:void 0}},e.bufferedInfo=function(e,t,r){e.sort((function(e,t){return e.start-t.start||t.end-e.end}));var n=[];if(r)for(var a=0;a<e.length;a++){var i=n.length;if(i){var o=n[i-1].end;e[a].start-o<r?e[a].end>o&&(n[i-1].end=e[a].end):n.push(e[a])}else n.push(e[a])}else n=e;for(var s,u=0,c=t,l=t,d=0;d<n.length;d++){var f=n[d].start,h=n[d].end;if(t+r>=f&&t<h)c=f,u=(l=h)-t;else if(t+r<f){s=f;break}}return{len:u,start:c,end:l,nextStart:s}},e}(),H=r(8),Z=r(11),Y=r(9);function q(){return window.MediaSource||window.WebKitMediaSource}var W=r(5),z=function(e){var t,r;function n(){return e.apply(this,arguments)||this}return r=e,(t=n).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,n.prototype.trigger=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];this.emit.apply(this,[e,e].concat(r))},n}(H.EventEmitter),X=Object(W.a)(),Q=q()||{isTypeSupported:function(){return!1}},$=function(){function e(e,t){var r=this;this.hls=e,this.id=t;var n=this.observer=new z,a=e.config,i=function(t,n){(n=n||{}).frag=r.frag,n.id=r.id,e.trigger(t,n)};n.on(c.a.FRAG_DECRYPTED,i),n.on(c.a.FRAG_PARSING_INIT_SEGMENT,i),n.on(c.a.FRAG_PARSING_DATA,i),n.on(c.a.FRAG_PARSED,i),n.on(c.a.ERROR,i),n.on(c.a.FRAG_PARSING_METADATA,i),n.on(c.a.FRAG_PARSING_USERDATA,i),n.on(c.a.INIT_PTS_FOUND,i);var o={mp4:Q.isTypeSupported("video/mp4"),mpeg:Q.isTypeSupported("audio/mpeg"),mp3:Q.isTypeSupported('audio/mp4; codecs="mp3"')},u=navigator.vendor;if(a.enableWorker&&"undefined"!=typeof Worker){var d;l.b.log("demuxing in webworker");try{d=this.w=Z(12),this.onwmsg=this.onWorkerMessage.bind(this),d.addEventListener("message",this.onwmsg),d.onerror=function(t){e.trigger(c.a.ERROR,{type:s.b.OTHER_ERROR,details:s.a.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",err:{message:t.message+" ("+t.filename+":"+t.lineno+")"}})},d.postMessage({cmd:"init",typeSupported:o,vendor:u,id:t,config:JSON.stringify(a)})}catch(e){l.b.warn("Error in worker:",e),l.b.error("Error while initializing DemuxerWorker, fallback on DemuxerInline"),d&&X.URL.revokeObjectURL(d.objectURL),this.demuxer=new Y.a(n,o,a,u),this.w=void 0}}else this.demuxer=new Y.a(n,o,a,u)}var t=e.prototype;return t.destroy=function(){var e=this.w;if(e)e.removeEventListener("message",this.onwmsg),e.terminate(),this.w=null;else{var t=this.demuxer;t&&(t.destroy(),this.demuxer=null)}var r=this.observer;r&&(r.removeAllListeners(),this.observer=null)},t.push=function(e,t,r,n,a,i,o,s){var c=this.w,d=Object(u.a)(a.startPTS)?a.startPTS:a.start,f=a.decryptdata,h=this.frag,p=!(h&&a.cc===h.cc),g=!(h&&a.level===h.level),v=h&&a.sn===h.sn+1,m=!g&&v;if(p&&l.b.log(this.id+":discontinuity detected"),g&&l.b.log(this.id+":switch detected"),this.frag=a,c)c.postMessage({cmd:"demux",data:e,decryptdata:f,initSegment:t,audioCodec:r,videoCodec:n,timeOffset:d,discontinuity:p,trackSwitch:g,contiguous:m,duration:i,accurateTimeOffset:o,defaultInitPTS:s},e instanceof ArrayBuffer?[e]:[]);else{var y=this.demuxer;y&&y.push(e,f,t,r,n,d,p,g,m,i,o,s)}},t.onWorkerMessage=function(e){var t=e.data,r=this.hls;switch(t.event){case"init":X.URL.revokeObjectURL(this.w.objectURL);break;case c.a.FRAG_PARSING_DATA:t.data.data1=new Uint8Array(t.data1),t.data2&&(t.data.data2=new Uint8Array(t.data2));default:t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,r.trigger(t.event,t.data)}},e}();function J(e,t,r){switch(t){case"audio":e.audioGroupIds||(e.audioGroupIds=[]),e.audioGroupIds.push(r);break;case"text":e.textGroupIds||(e.textGroupIds=[]),e.textGroupIds.push(r)}}function ee(e,t,r){var n=e[t],a=e[r],i=a.startPTS;if(Object(u.a)(i))r>t?(n.duration=i-n.start,n.duration<0&&l.b.warn("negative duration computed for frag "+n.sn+",level "+n.level+", there should be some duration drift between playlist and fragment!")):(a.duration=n.start-i,a.duration<0&&l.b.warn("negative duration computed for frag "+a.sn+",level "+a.level+", there should be some duration drift between playlist and fragment!"));else if(r>t){var o=n.cc===a.cc;a.start=n.start+(o&&n.minEndPTS?n.minEndPTS-n.start:n.duration)}else a.start=Math.max(n.start-a.duration,0)}function te(e,t,r,n,a,i){var o=r,s=n;if(Object(u.a)(t.startPTS)){var c=Math.abs(t.startPTS-r);Object(u.a)(t.deltaPTS)?t.deltaPTS=Math.max(c,t.deltaPTS):t.deltaPTS=c,o=Math.max(r,t.startPTS),r=Math.min(r,t.startPTS),s=Math.min(n,t.endPTS),n=Math.max(n,t.endPTS),a=Math.min(a,t.startDTS),i=Math.max(i,t.endDTS)}var l=r-t.start;t.start=t.startPTS=r,t.maxStartPTS=o,t.endPTS=n,t.minEndPTS=s,t.startDTS=a,t.endDTS=i,t.duration=n-r;var d,f,h,p=t.sn;if(!e||p<e.startSN||p>e.endSN)return 0;for(d=p-e.startSN,(f=e.fragments)[d]=t,h=d;h>0;h--)ee(f,h,h-1);for(h=d;h<f.length-1;h++)ee(f,h,h+1);return e.PTSKnown=!0,l}function re(e,t){t.initSegment&&e.initSegment&&(t.initSegment=e.initSegment);var r,n=0;if(ne(e,t,(function(e,a){n=e.cc-a.cc,Object(u.a)(e.startPTS)&&(a.start=a.startPTS=e.startPTS,a.endPTS=e.endPTS,a.duration=e.duration,a.backtracked=e.backtracked,a.dropped=e.dropped,r=a),t.PTSKnown=!0})),t.PTSKnown){if(n){l.b.log("discontinuity sliding from playlist, take drift into account");for(var a=t.fragments,i=0;i<a.length;i++)a[i].cc+=n}r?te(t,r,r.startPTS,r.endPTS,r.startDTS,r.endDTS):function(e,t){var r=t.startSN-e.startSN,n=e.fragments,a=t.fragments;if(!(r<0||r>n.length))for(var i=0;i<a.length;i++)a[i].start+=n[r].start}(e,t),t.PTSKnown=e.PTSKnown}}function ne(e,t,r){if(e&&t)for(var n=Math.max(e.startSN,t.startSN)-t.startSN,a=Math.min(e.endSN,t.endSN)-t.startSN,i=t.startSN-e.startSN,o=n;o<=a;o++){var s=e.fragments[i+o],u=t.fragments[o];if(!s||!u)break;r(s,u,o)}}function ae(e,t,r){var n=1e3*(t.averagetargetduration?t.averagetargetduration:t.targetduration),a=n/2;return e&&t.endSN===e.endSN&&(n=a),r&&(n=Math.max(a,n-(window.performance.now()-r))),Math.round(n)}var ie=function(e){for(var t="",r=e.length,n=0;n<r;n++)t+="["+e.start(n).toFixed(3)+","+e.end(n).toFixed(3)+"]";return t};function oe(e,t){t.fragments.forEach((function(t){if(t){var r=t.start+e;t.start=t.startPTS=r,t.endPTS=r+t.duration}})),t.PTSKnown=!0}function se(e,t,r){!function(e,t,r){if(function(e,t,r){var n=!1;return t&&t.details&&r&&(r.endCC>r.startCC||e&&e.cc<r.startCC)&&(n=!0),n}(e,r,t)){var n=function(e,t){var r=e.fragments,n=t.fragments;if(n.length&&r.length){var a=function(e,t){for(var r=null,n=0;n<e.length;n+=1){var a=e[n];if(a&&a.cc===t){r=a;break}}return r}(r,n[0].cc);if(a&&(!a||a.startPTS))return a;l.b.log("No frag in previous level to align on")}else l.b.log("No fragments to align")}(r.details,t);n&&(l.b.log("Adjusting PTS using last level due to CC increase within current level"),oe(n.start,t))}}(e,r,t),!r.PTSKnown&&t&&function(e,t){if(t&&t.fragments.length){if(!e.hasProgramDateTime||!t.hasProgramDateTime)return;var r=t.fragments[0].programDateTime,n=(e.fragments[0].programDateTime-r)/1e3+t.fragments[0].start;Object(u.a)(n)&&(l.b.log("adjusting PTS using programDateTime delta, sliding:"+n.toFixed(3)),oe(n,e))}}(r,t.details)}function ue(e,t,r){if(null===t||!Array.isArray(e)||!e.length||!Object(u.a)(t))return null;if(t<(e[0].programDateTime||0))return null;if(t>=(e[e.length-1].endProgramDateTime||0))return null;r=r||0;for(var n=0;n<e.length;++n){var a=e[n];if(de(t,r,a))return a}return null}function ce(e,t,r,n){void 0===r&&(r=0),void 0===n&&(n=0);var a=null;return e?a=t[e.sn-t[0].sn+1]:0===r&&0===t[0].start&&(a=t[0]),a&&0===le(r,n,a)?a:V(t,le.bind(null,r,n))||a}function le(e,t,r){void 0===e&&(e=0),void 0===t&&(t=0);var n=Math.min(t,r.duration+(r.deltaPTS?r.deltaPTS:0));return r.start+r.duration-n<=e?1:r.start-n>e&&r.start?-1:0}function de(e,t,r){var n=1e3*Math.min(t,r.duration+(r.deltaPTS?r.deltaPTS:0));return(r.endProgramDateTime||0)-n>e}var fe=function(){function e(e,t,r,n){this.config=e,this.media=t,this.fragmentTracker=r,this.hls=n,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1}var t=e.prototype;return t.poll=function(e){var t=this.config,r=this.media,n=this.stalled,a=r.currentTime,i=r.seeking,o=this.seeking&&!i,s=!this.seeking&&i;if(this.seeking=i,a===e){if((s||o)&&(this.stalled=null),!r.paused&&!r.ended&&0!==r.playbackRate&&r.buffered.length){var u=K.bufferInfo(r,a,0),c=u.len>0,d=u.nextStart||0;if(c||d){if(i){var f=u.len>2,h=!d||d-a>2&&!this.fragmentTracker.getPartialFragment(a);if(f||h)return;this.moved=!1}if(!this.moved&&this.stalled){var p=Math.max(d,u.start||0)-a;if(p>0&&p<=2)return void this._trySkipBufferHole(null)}var g=self.performance.now();if(null!==n){var v=g-n;!i&&v>=250&&this._reportStall(u.len);var m=K.bufferInfo(r,a,t.maxBufferHole);this._tryFixBufferStall(m,v)}else this.stalled=g}}}else if(this.moved=!0,null!==n){if(this.stallReported){var y=self.performance.now()-n;l.b.warn("playback not stuck anymore @"+a+", after "+Math.round(y)+"ms"),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}},t._tryFixBufferStall=function(e,t){var r=this.config,n=this.fragmentTracker,a=this.media.currentTime,i=n.getPartialFragment(a);i&&this._trySkipBufferHole(i)||e.len>r.maxBufferHole&&t>1e3*r.highBufferWatchdogPeriod&&(l.b.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())},t._reportStall=function(e){var t=this.hls,r=this.media;this.stallReported||(this.stallReported=!0,l.b.warn("Playback stalling at @"+r.currentTime+" due to low buffer (buffer="+e+")"),t.trigger(c.a.ERROR,{type:s.b.MEDIA_ERROR,details:s.a.BUFFER_STALLED_ERROR,fatal:!1,buffer:e}))},t._trySkipBufferHole=function(e){for(var t=this.config,r=this.hls,n=this.media,a=n.currentTime,i=0,o=0;o<n.buffered.length;o++){var u=n.buffered.start(o);if(a+t.maxBufferHole>=i&&a<u){var d=Math.max(u+.05,n.currentTime+.1);return l.b.warn("skipping hole, adjusting currentTime from "+a+" to "+d),this.moved=!0,this.stalled=null,n.currentTime=d,e&&r.trigger(c.a.ERROR,{type:s.b.MEDIA_ERROR,details:s.a.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+a+" to "+d,frag:e}),d}i=n.buffered.end(o)}return 0},t._tryNudgeBuffer=function(){var e=this.config,t=this.hls,r=this.media,n=r.currentTime,a=(this.nudgeRetry||0)+1;if(this.nudgeRetry=a,a<e.nudgeMaxRetry){var i=n+a*e.nudgeOffset;l.b.warn("Nudging 'currentTime' from "+n+" to "+i),r.currentTime=i,t.trigger(c.a.ERROR,{type:s.b.MEDIA_ERROR,details:s.a.BUFFER_NUDGE_ON_STALL,fatal:!1})}else l.b.error("Playhead still not moving while enough data buffered @"+n+" after "+e.nudgeMaxRetry+" nudges"),t.trigger(c.a.ERROR,{type:s.b.MEDIA_ERROR,details:s.a.BUFFER_STALLED_ERROR,fatal:!0})},e}();function he(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var pe=function(e){var t,r;function n(t){for(var r,n=arguments.length,a=new Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=arguments[i];return(r=e.call.apply(e,[this,t].concat(a))||this)._boundTick=void 0,r._tickTimer=null,r._tickInterval=null,r._tickCallCount=0,r._boundTick=r.tick.bind(he(r)),r}r=e,(t=n).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var a=n.prototype;return a.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},a.hasInterval=function(){return!!this._tickInterval},a.hasNextTick=function(){return!!this._tickTimer},a.setInterval=function(e){return!this._tickInterval&&(this._tickInterval=self.setInterval(this._boundTick,e),!0)},a.clearInterval=function(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)},a.clearNextTick=function(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)},a.tick=function(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&(this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)),this._tickCallCount=0)},a.doTick=function(){},n}(f),ge="STOPPED",ve="STARTING",me="IDLE",ye="PAUSED",be="KEY_LOADING",Se="FRAG_LOADING",Ee="FRAG_LOADING_WAITING_RETRY",Te="WAITING_TRACK",we="PARSING",Oe="PARSED",Ae="BUFFER_FLUSHING",_e="ENDED",Re="ERROR",ke="WAITING_INIT_PTS",Pe="WAITING_LEVEL",Ce=function(e){var t,r;function n(){return e.apply(this,arguments)||this}r=e,(t=n).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var a=n.prototype;return a.doTick=function(){},a.startLoad=function(){},a.stopLoad=function(){var e=this.fragCurrent;e&&(e.loader&&e.loader.abort(),this.fragmentTracker.removeFragment(e)),this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=ge},a._streamEnded=function(e,t){var r=this.fragCurrent,n=this.fragmentTracker;if(!t.live&&r&&!r.backtracked&&r.sn===t.endSN&&!e.nextStart){var a=n.getState(r);return a===N||a===B}return!1},a.onMediaSeeking=function(){var e=this.config,t=this.media,r=this.mediaBuffer,n=this.state,a=t?t.currentTime:null,i=K.bufferInfo(r||t,a,this.config.maxBufferHole);if(l.b.log("media seeking to "+(Object(u.a)(a)?a.toFixed(3):a)),n===Se){var o=this.fragCurrent;if(0===i.len&&o){var s=e.maxFragLookUpTolerance,c=o.start-s,d=o.start+o.duration+s;a<c||a>d?(o.loader&&(l.b.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),o.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.state=me):l.b.log("seeking outside of buffer but within currently loaded fragment range")}}else n===_e&&(0===i.len&&(this.fragPrevious=null,this.fragCurrent=null),this.state=me);t&&(this.lastCurrentTime=a),this.loadedmetadata||(this.nextLoadPosition=this.startPosition=a),this.tick()},a.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},a.onHandlerDestroying=function(){this.stopLoad(),e.prototype.onHandlerDestroying.call(this)},a.onHandlerDestroyed=function(){this.state=ge,this.fragmentTracker=null},a.computeLivePosition=function(e,t){var r=void 0!==this.config.liveSyncDuration?this.config.liveSyncDuration:this.config.liveSyncDurationCount*t.targetduration;return e+Math.max(0,t.totalduration-r)},n}(pe);function Le(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var De,Ie=function(e){var t,r;function n(t,r){var n;return(n=e.call(this,t,c.a.MEDIA_ATTACHED,c.a.MEDIA_DETACHING,c.a.MANIFEST_LOADING,c.a.MANIFEST_PARSED,c.a.LEVEL_LOADED,c.a.LEVELS_UPDATED,c.a.KEY_LOADED,c.a.FRAG_LOADED,c.a.FRAG_LOAD_EMERGENCY_ABORTED,c.a.FRAG_PARSING_INIT_SEGMENT,c.a.FRAG_PARSING_DATA,c.a.FRAG_PARSED,c.a.ERROR,c.a.AUDIO_TRACK_SWITCHING,c.a.AUDIO_TRACK_SWITCHED,c.a.BUFFER_CREATED,c.a.BUFFER_APPENDED,c.a.BUFFER_FLUSHED)||this).fragmentTracker=r,n.config=t.config,n.audioCodecSwap=!1,n._state=ge,n.stallReported=!1,n.gapController=null,n.altAudio=!1,n.audioOnly=!1,n.bitrateTest=!1,n}r=e,(t=n).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var a,o,d=n.prototype;return d.startLoad=function(e){if(this.levels){var t=this.lastCurrentTime,r=this.hls;if(this.stopLoad(),this.setInterval(100),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var n=r.startLevel;-1===n&&(r.config.testBandwidth?(n=0,this.bitrateTest=!0):n=r.nextAutoLevel),this.level=r.nextLoadLevel=n,this.loadedmetadata=!1}t>0&&-1===e&&(l.b.log("override startPosition with lastCurrentTime @"+t.toFixed(3)),e=t),this.state=me,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this.forceStartLoad=!0,this.state=ge},d.stopLoad=function(){this.forceStartLoad=!1,e.prototype.stopLoad.call(this)},d.doTick=function(){switch(this.state){case Ae:this.fragLoadError=0;break;case me:this._doTickIdle();break;case Pe:var e=this.levels[this.level];e&&e.details&&(this.state=me);break;case Ee:var t=window.performance.now(),r=this.retryDate;(!r||t>=r||this.media&&this.media.seeking)&&(l.b.log("mediaController: retryDate reached, switch back to IDLE state"),this.state=me)}this._checkBuffer(),this._checkFragmentChanged()},d._doTickIdle=function(){var e=this.hls,t=e.config,r=this.media;if(void 0!==this.levelLastLoaded&&(r||!this.startFragRequested&&t.startFragPrefetch))if(this.altAudio&&this.audioOnly)this.demuxer.frag=null;else{var n;n=this.loadedmetadata?r.currentTime:this.nextLoadPosition;var a=e.nextLoadLevel,i=this.levels[a];if(i){var o,s=i.bitrate;o=s?Math.max(8*t.maxBufferSize/s,t.maxBufferLength):t.maxBufferLength,o=Math.min(o,t.maxMaxBufferLength);var u=n<t.maxBufferHole?Math.max(2,t.maxBufferHole):t.maxBufferHole,d=K.bufferInfo(this.mediaBuffer?this.mediaBuffer:r,n,u),f=d.len;if(!(f>=o)){l.b.trace("buffer length of "+f.toFixed(3)+" is below max of "+o.toFixed(3)+". checking for more payload ..."),this.level=e.nextLoadLevel=a;var h=i.details;if(!h||h.live&&this.levelLastLoaded!==a)this.state=Pe;else{if(this._streamEnded(d,h)){var p={};return this.altAudio&&(p.type="video"),this.hls.trigger(c.a.BUFFER_EOS,p),void(this.state=_e)}this._fetchPayloadOrEos(n,d,h)}}}}},d._fetchPayloadOrEos=function(e,t,r){var n=this.fragPrevious,a=(this.level,r.fragments),i=a.length;if(0!==i){var o,s=a[0].start,u=a[i-1].start+a[i-1].duration,c=t.end;if(r.initSegment&&!r.initSegment.data)o=r.initSegment;else if(r.live){var d=this.config.initialLiveManifestSize;if(i<d)return void l.b.warn("Can not start playback of a level, reason: not enough fragments "+i+" < "+d);if(null===(o=this._ensureFragmentAtLivePoint(r,c,s,u,n,a)))return}else c<s&&(o=a[0]);o||(o=this._findFragment(s,n,i,a,c,u,r)),o&&(o.encrypted?this._loadKey(o,r):this._loadFragment(o,r,e,c))}},d._ensureFragmentAtLivePoint=function(e,t,r,n,a,i){var o,s=this.hls.config,c=this.media,d=1/0;if(void 0!==s.liveMaxLatencyDuration?d=s.liveMaxLatencyDuration:Object(u.a)(s.liveMaxLatencyDurationCount)&&(d=s.liveMaxLatencyDurationCount*e.targetduration),t<Math.max(r-s.maxFragLookUpTolerance,n-d)){var f=this.liveSyncPosition=this.computeLivePosition(r,e);t=f,c&&!c.paused&&c.readyState&&c.duration>f&&f>c.currentTime&&(l.b.log("buffer end: "+t.toFixed(3)+" is located too far from the end of live sliding playlist, reset currentTime to : "+f.toFixed(3)),c.currentTime=f),this.nextLoadPosition=f}if(e.PTSKnown&&t>n&&c&&c.readyState)return null;if(this.startFragRequested&&!e.PTSKnown&&a)if(e.hasProgramDateTime)l.b.log("live playlist, switching playlist, load frag with same PDT: "+a.programDateTime),o=ue(i,a.endProgramDateTime,s.maxFragLookUpTolerance);else{var h=a.sn+1;if(h>=e.startSN&&h<=e.endSN){var p=i[h-e.startSN];a.cc===p.cc&&(o=p,l.b.log("live playlist, switching playlist, load frag with next SN: "+o.sn))}o||(o=V(i,(function(e){return a.cc-e.cc})))&&l.b.log("live playlist, switching playlist, load frag with same CC: "+o.sn)}return o},d._findFragment=function(e,t,r,n,a,i,o){var s,u=this.hls.config;if(s=a<i?ce(t,n,a,a>i-u.maxFragLookUpTolerance?0:u.maxFragLookUpTolerance):n[r-1]){var c=s.sn-o.startSN,d=t&&s.level===t.level,f=n[c-1],h=n[c+1];if(t&&s.sn===t.sn)if(d&&!s.backtracked)if(s.sn<o.endSN){var p=t.deltaPTS;p&&p>u.maxBufferHole&&t.dropped&&c?(s=f,l.b.warn("Previous fragment was dropped with large PTS gap between audio and video. Maybe fragment is not starting with a keyframe? Loading previous one to try to overcome this")):(s=h,this.fragmentTracker.getState(s)!==B&&l.b.log("Re-loading fragment with SN: "+s.sn))}else s=null;else s.backtracked&&(h&&h.backtracked?(l.b.warn("Already backtracked from fragment "+h.sn+", will not backtrack to fragment "+s.sn+". Loading fragment "+h.sn),s=h):(l.b.warn("Loaded fragment with dropped frames, backtracking 1 segment to find a keyframe"),s.dropped=0,f?(s=f).backtracked=!0:c&&(s=null)))}return s},d._loadKey=function(e,t){l.b.log("Loading key for "+e.sn+" of ["+t.startSN+"-"+t.endSN+"], level "+this.level),this.state=be,this.hls.trigger(c.a.KEY_LOADING,{frag:e})},d._loadFragment=function(e,t,r,n){var a=this.fragmentTracker.getState(e);this.fragCurrent=e,"initSegment"!==e.sn&&(this.startFragRequested=!0),Object(u.a)(e.sn)&&!e.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),e.backtracked||a===j||a===N?(e.autoLevel=this.hls.autoLevelEnabled,e.bitrateTest=this.bitrateTest,l.b.log("Loading "+e.sn+" of ["+t.startSN+"-"+t.endSN+"], level "+this.level+", "+(this.loadedmetadata?"currentTime":"nextLoadPosition")+": "+parseFloat(r.toFixed(3))+", bufferEnd: "+parseFloat(n.toFixed(3))),this.hls.trigger(c.a.FRAG_LOADING,{frag:e}),this.demuxer||(this.demuxer=new $(this.hls,"main")),this.state=Se):a===F&&this._reduceMaxBufferLength(e.duration)&&this.fragmentTracker.removeFragment(e)},d.getBufferedFrag=function(e){return this.fragmentTracker.getBufferedFrag(e,i.MAIN)},d.followingBufferedFrag=function(e){return e?this.getBufferedFrag(e.endPTS+.5):null},d._checkFragmentChanged=function(){var e,t,r=this.media;if(r&&r.readyState&&!1===r.seeking&&((t=r.currentTime)>this.lastCurrentTime&&(this.lastCurrentTime=t),K.isBuffered(r,t)?e=this.getBufferedFrag(t):K.isBuffered(r,t+.1)&&(e=this.getBufferedFrag(t+.1)),e)){var n=e;if(n!==this.fragPlaying){this.hls.trigger(c.a.FRAG_CHANGED,{frag:n});var a=n.level;this.fragPlaying&&this.fragPlaying.level===a||this.hls.trigger(c.a.LEVEL_SWITCHED,{level:a}),this.fragPlaying=n}}},d.immediateLevelSwitch=function(){if(l.b.log("immediateLevelSwitch"),!this.immediateSwitch){this.immediateSwitch=!0;var e,t=this.media;t?(e=t.paused)||t.pause():e=!0,this.previouslyPaused=e}var r=this.fragCurrent;r&&r.loader&&r.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},d.immediateLevelSwitchEnd=function(){var e=this.media;e&&e.buffered.length&&(this.immediateSwitch=!1,e.currentTime>0&&K.isBuffered(e,e.currentTime)&&(e.currentTime-=1e-4),this.previouslyPaused||e.play())},d.nextLevelSwitch=function(){var e=this.media;if(e&&e.readyState){var t,r=this.getBufferedFrag(e.currentTime);if(r&&r.startPTS>1&&this.flushMainBuffer(0,r.startPTS-1),e.paused)t=0;else{var n=this.hls.nextLoadLevel,a=this.levels[n],i=this.fragLastKbps;t=i&&this.fragCurrent?this.fragCurrent.duration*a.bitrate/(1e3*i)+1:0}var o=this.getBufferedFrag(e.currentTime+t);if(o){var s=this.followingBufferedFrag(o);if(s){var u=this.fragCurrent;u&&u.loader&&u.loader.abort(),this.fragCurrent=null;var c=Math.max(o.endPTS,s.maxStartPTS+Math.min(this.config.maxFragLookUpTolerance,s.duration));this.flushMainBuffer(c,Number.POSITIVE_INFINITY)}}}},d.flushMainBuffer=function(e,t){this.state=Ae;var r={startOffset:e,endOffset:t};this.altAudio&&(r.type="video"),this.hls.trigger(c.a.BUFFER_FLUSHING,r)},d.onMediaAttached=function(e){var t=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener("seeking",this.onvseeking),t.addEventListener("seeked",this.onvseeked),t.addEventListener("ended",this.onvended);var r=this.config;this.levels&&r.autoStartLoad&&this.hls.startLoad(r.startPosition),this.gapController=new fe(r,t,this.fragmentTracker,this.hls)},d.onMediaDetaching=function(){var e=this.media;e&&e.ended&&(l.b.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var t=this.levels;t&&t.forEach((function(e){e.details&&e.details.fragments.forEach((function(e){e.backtracked=void 0}))})),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("seeked",this.onvseeked),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.fragmentTracker.removeAllFragments(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.stopLoad()},d.onMediaSeeked=function(){var e=this.media,t=e?e.currentTime:void 0;Object(u.a)(t)&&l.b.log("media seeked to "+t.toFixed(3)),this.tick()},d.onManifestLoading=function(){l.b.log("trigger BUFFER_RESET"),this.hls.trigger(c.a.BUFFER_RESET),this.fragmentTracker.removeAllFragments(),this.stalled=!1,this.startPosition=this.lastCurrentTime=0},d.onManifestParsed=function(e){var t,r=!1,n=!1;e.levels.forEach((function(e){(t=e.audioCodec)&&(-1!==t.indexOf("mp4a.40.2")&&(r=!0),-1!==t.indexOf("mp4a.40.5")&&(n=!0))})),this.audioCodecSwitch=r&&n,this.audioCodecSwitch&&l.b.log("both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.altAudio=e.altAudio,this.levels=e.levels,this.startFragRequested=!1;var a=this.config;(a.autoStartLoad||this.forceStartLoad)&&this.hls.startLoad(a.startPosition)},d.onLevelLoaded=function(e){var t=e.details,r=e.level,n=this.levels[this.levelLastLoaded],a=this.levels[r],i=t.totalduration,o=0;if(l.b.log("level "+r+" loaded ["+t.startSN+","+t.endSN+"],duration:"+i),t.live||a.details&&a.details.live){var s=a.details;s&&t.fragments.length>0?(re(s,t),o=t.fragments[0].start,this.liveSyncPosition=this.computeLivePosition(o,s),t.PTSKnown&&Object(u.a)(o)?l.b.log("live playlist sliding:"+o.toFixed(3)):(l.b.log("live playlist - outdated PTS, unknown sliding"),se(this.fragPrevious,n,t))):(l.b.log("live playlist - first load, unknown sliding"),t.PTSKnown=!1,se(this.fragPrevious,n,t))}else t.PTSKnown=!1;if(a.details=t,this.levelLastLoaded=r,this.hls.trigger(c.a.LEVEL_UPDATED,{details:t,level:r}),!1===this.startFragRequested){if(-1===this.startPosition||-1===this.lastCurrentTime){var d=t.startTimeOffset;Object(u.a)(d)?(d<0&&(l.b.log("negative start time offset "+d+", count from end of last fragment"),d=o+i+d),l.b.log("start time offset found in playlist, adjust startPosition to "+d),this.startPosition=d):t.live?(this.startPosition=this.computeLivePosition(o,t),l.b.log("configure startPosition to "+this.startPosition)):this.startPosition=0,this.lastCurrentTime=this.startPosition}this.nextLoadPosition=this.startPosition}this.state===Pe&&(this.state=me),this.tick()},d.onKeyLoaded=function(){this.state===be&&(this.state=me,this.tick())},d.onFragLoaded=function(e){var t=this.fragCurrent,r=this.hls,n=this.levels,a=this.media,i=e.frag;if(this.state===Se&&t&&"main"===i.type&&i.level===t.level&&i.sn===t.sn){var o=e.stats,s=n[t.level],u=s.details;if(this.bitrateTest=!1,this.stats=o,l.b.log("Loaded "+t.sn+" of ["+u.startSN+" ,"+u.endSN+"],level "+t.level),i.bitrateTest&&r.nextLoadLevel)this.state=me,this.startFragRequested=!1,o.tparsed=o.tbuffered=window.performance.now(),r.trigger(c.a.FRAG_BUFFERED,{stats:o,frag:t,id:"main"}),this.tick();else if("initSegment"===i.sn)this.state=me,o.tparsed=o.tbuffered=window.performance.now(),u.initSegment.data=e.payload,r.trigger(c.a.FRAG_BUFFERED,{stats:o,frag:t,id:"main"}),this.tick();else{l.b.log("Parsing "+t.sn+" of ["+u.startSN+" ,"+u.endSN+"],level "+t.level+", cc "+t.cc),this.state=we,this.pendingBuffering=!0,this.appended=!1,i.bitrateTest&&(i.bitrateTest=!1,this.fragmentTracker.onFragLoaded({frag:i}));var d=!(a&&a.seeking)&&(u.PTSKnown||!u.live),f=u.initSegment?u.initSegment.data:[],h=this._getAudioCodec(s);(this.demuxer=this.demuxer||new $(this.hls,"main")).push(e.payload,f,h,s.videoCodec,t,u.totalduration,d)}}this.fragLoadError=0},d.onFragParsingInitSegment=function(e){var t=this.fragCurrent,r=e.frag;if(t&&"main"===e.id&&r.sn===t.sn&&r.level===t.level&&this.state===we){var n,a,i=e.tracks;if(this.audioOnly=i.audio&&!i.video,this.altAudio&&!this.audioOnly&&delete i.audio,a=i.audio){var o=this.levels[this.level].audioCodec,s=navigator.userAgent.toLowerCase();o&&this.audioCodecSwap&&(l.b.log("swapping playlist audio codec"),o=-1!==o.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),this.audioCodecSwitch&&1!==a.metadata.channelCount&&-1===s.indexOf("firefox")&&(o="mp4a.40.5"),-1!==s.indexOf("android")&&"audio/mpeg"!==a.container&&(o="mp4a.40.2",l.b.log("Android: force audio codec to "+o)),a.levelCodec=o,a.id=e.id}for(n in(a=i.video)&&(a.levelCodec=this.levels[this.level].videoCodec,a.id=e.id),this.hls.trigger(c.a.BUFFER_CODECS,i),i){a=i[n],l.b.log("main track:"+n+",container:"+a.container+",codecs[level/parsed]=["+a.levelCodec+"/"+a.codec+"]");var u=a.initSegment;u&&(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(c.a.BUFFER_APPENDING,{type:n,data:u,parent:"main",content:"initSegment"}))}this.tick()}},d.onFragParsingData=function(e){var t=this,r=this.fragCurrent,n=e.frag;if(r&&"main"===e.id&&n.sn===r.sn&&n.level===r.level&&("audio"!==e.type||!this.altAudio)&&this.state===we){var a=this.levels[this.level],i=r;if(Object(u.a)(e.endPTS)||(e.endPTS=e.startPTS+r.duration,e.endDTS=e.startDTS+r.duration),!0===e.hasAudio&&i.addElementaryStream(g.AUDIO),!0===e.hasVideo&&i.addElementaryStream(g.VIDEO),l.b.log("Parsed "+e.type+",PTS:["+e.startPTS.toFixed(3)+","+e.endPTS.toFixed(3)+"],DTS:["+e.startDTS.toFixed(3)+"/"+e.endDTS.toFixed(3)+"],nb:"+e.nb+",dropped:"+(e.dropped||0)),"video"===e.type)if(i.dropped=e.dropped,i.dropped)if(i.backtracked)l.b.warn("Already backtracked on this fragment, appending with the gap",i.sn);else{var o=a.details;if(!o||i.sn!==o.startSN)return l.b.warn("missing video frame(s), backtracking fragment",i.sn),this.fragmentTracker.removeFragment(i),i.backtracked=!0,this.nextLoadPosition=e.startPTS,this.state=me,this.fragPrevious=i,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),void this.tick();l.b.warn("missing video frame(s) on first frag, appending with gap",i.sn)}else i.backtracked=!1;var s=te(a.details,i,e.startPTS,e.endPTS,e.startDTS,e.endDTS),d=this.hls;d.trigger(c.a.LEVEL_PTS_UPDATED,{details:a.details,level:this.level,drift:s,type:e.type,start:e.startPTS,end:e.endPTS}),[e.data1,e.data2].forEach((function(r){r&&r.length&&t.state===we&&(t.appended=!0,t.pendingBuffering=!0,d.trigger(c.a.BUFFER_APPENDING,{type:e.type,data:r,parent:"main",content:"data"}))})),this.tick()}},d.onFragParsed=function(e){var t=this.fragCurrent,r=e.frag;t&&"main"===e.id&&r.sn===t.sn&&r.level===t.level&&this.state===we&&(this.stats.tparsed=window.performance.now(),this.state=Oe,this._checkAppendedParsed())},d.onAudioTrackSwitching=function(e){var t=this.altAudio,r=!!e.url,n=e.id;if(!r){if(this.mediaBuffer!==this.media){l.b.log("switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var a=this.fragCurrent;a.loader&&(l.b.log("switching to main audio track, cancel main fragment load"),a.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=me}var i=this.hls;t&&i.trigger(c.a.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),i.trigger(c.a.AUDIO_TRACK_SWITCHED,{id:n})}},d.onAudioTrackSwitched=function(e){var t=e.id,r=!!this.hls.audioTracks[t].url;if(r){var n=this.videoBuffer;n&&this.mediaBuffer!==n&&(l.b.log("switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=n)}this.altAudio=r,this.tick()},d.onBufferCreated=function(e){var t,r,n=e.tracks,a=!1;for(var i in n){var o=n[i];"main"===o.id?(r=i,t=o,"video"===i&&(this.videoBuffer=n[i].buffer)):a=!0}a&&t?(l.b.log("alternate track found, use "+r+".buffered to schedule main fragment loading"),this.mediaBuffer=t.buffer):this.mediaBuffer=this.media},d.onBufferAppended=function(e){if("main"===e.parent){var t=this.state;t!==we&&t!==Oe||(this.pendingBuffering=e.pending>0,this._checkAppendedParsed())}},d._checkAppendedParsed=function(){if(!(this.state!==Oe||this.appended&&this.pendingBuffering)){var e=this.fragCurrent;if(e){var t=this.mediaBuffer?this.mediaBuffer:this.media;l.b.log("main buffered : "+ie(t.buffered)),this.fragPrevious=e;var r=this.stats;r.tbuffered=window.performance.now(),this.fragLastKbps=Math.round(8*r.total/(r.tbuffered-r.tfirst)),this.hls.trigger(c.a.FRAG_BUFFERED,{stats:r,frag:e,id:"main"}),this.state=me}(this.loadedmetadata||this.startPosition<=0)&&this.tick()}},d.onError=function(e){var t=e.frag||this.fragCurrent;if(!t||"main"===t.type){var r=!!this.media&&K.isBuffered(this.media,this.media.currentTime)&&K.isBuffered(this.media,this.media.currentTime+.5);switch(e.details){case s.a.FRAG_LOAD_ERROR:case s.a.FRAG_LOAD_TIMEOUT:case s.a.KEY_LOAD_ERROR:case s.a.KEY_LOAD_TIMEOUT:if(!e.fatal)if(this.fragLoadError+1<=this.config.fragLoadingMaxRetry){var n=Math.min(Math.pow(2,this.fragLoadError)*this.config.fragLoadingRetryDelay,this.config.fragLoadingMaxRetryTimeout);l.b.warn("mediaController: frag loading failed, retry in "+n+" ms"),this.retryDate=window.performance.now()+n,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.fragLoadError++,this.state=Ee}else l.b.error("mediaController: "+e.details+" reaches max retry, redispatch as fatal ..."),e.fatal=!0,this.state=Re;break;case s.a.LEVEL_LOAD_ERROR:case s.a.LEVEL_LOAD_TIMEOUT:this.state!==Re&&(e.fatal?(this.state=Re,l.b.warn("streamController: "+e.details+",switch to "+this.state+" state ...")):e.levelRetry||this.state!==Pe||(this.state=me));break;case s.a.BUFFER_FULL_ERROR:"main"!==e.parent||this.state!==we&&this.state!==Oe||(r?(this._reduceMaxBufferLength(this.config.maxBufferLength),this.state=me):(l.b.warn("buffer full error also media.currentTime is not buffered, flush everything"),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)))}}},d._reduceMaxBufferLength=function(e){var t=this.config;return t.maxMaxBufferLength>=e&&(t.maxMaxBufferLength/=2,l.b.warn("main:reduce max buffer length to "+t.maxMaxBufferLength+"s"),!0)},d._checkBuffer=function(){var e=this.media;if(e&&0!==e.readyState){var t=(this.mediaBuffer?this.mediaBuffer:e).buffered;!this.loadedmetadata&&t.length?(this.loadedmetadata=!0,this._seekToStartPos()):this.immediateSwitch?this.immediateLevelSwitchEnd():this.gapController.poll(this.lastCurrentTime,t)}},d.onFragLoadEmergencyAborted=function(){this.state=me,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tick()},d.onBufferFlushed=function(){var e=this.mediaBuffer?this.mediaBuffer:this.media;if(e){var t=this.audioOnly?g.AUDIO:g.VIDEO;this.fragmentTracker.detectEvictedFragments(t,e.buffered)}this.state=me,this.fragPrevious=null},d.onLevelsUpdated=function(e){this.levels=e.levels},d.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},d._seekToStartPos=function(){var e=this.media,t=e.currentTime,r=this.startPosition;if(t!==r&&r>=0){if(e.seeking)return void l.b.log("could not seek to "+r+", already seeking at "+t);var n=(e.buffered.length?e.buffered.start(0):0)-r;n>0&&n<this.config.maxBufferHole&&(l.b.log("adjusting start position by "+n+" to match buffer start"),r+=n,this.startPosition=r),l.b.log("seek to target start position "+r+" from current time "+t+". ready state "+e.readyState),e.currentTime=r}},d._getAudioCodec=function(e){var t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&(l.b.log("swapping playlist audio codec"),t&&(t=-1!==t.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5")),t},a=n,(o=[{key:"state",set:function(e){if(this.state!==e){var t=this.state;this._state=e,l.b.log("main stream-controller: "+t+"->"+e),this.hls.trigger(c.a.STREAM_STATE_TRANSITION,{previousState:t,nextState:e})}},get:function(){return this._state}},{key:"currentLevel",get:function(){var e=this.media;if(e){var t=this.getBufferedFrag(e.currentTime);if(t)return t.level}return-1}},{key:"nextBufferedFrag",get:function(){var e=this.media;return e?this.followingBufferedFrag(this.getBufferedFrag(e.currentTime)):null}},{key:"nextLevel",get:function(){var e=this.nextBufferedFrag;return e?e.level:-1}},{key:"liveSyncPosition",get:function(){return this._liveSyncPosition},set:function(e){this._liveSyncPosition=e}}])&&Le(a.prototype,o),n}(Ce);function xe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Me=function(e){var t,r;function n(t){var r;return(r=e.call(this,t,c.a.MANIFEST_LOADED,c.a.LEVEL_LOADED,c.a.AUDIO_TRACK_SWITCHED,c.a.FRAG_LOADED,c.a.ERROR)||this).canload=!1,r.currentLevelIndex=null,r.manualLevelIndex=-1,r.timer=null,De=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),r}r=e,(t=n).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var a,i,o=n.prototype;return o.onHandlerDestroying=function(){this.clearTimer(),this.manualLevelIndex=-1},o.clearTimer=function(){null!==this.timer&&(clearTimeout(this.timer),this.timer=null)},o.startLoad=function(){var e=this._levels;this.canload=!0,this.levelRetryCount=0,e&&e.forEach((function(e){e.loadError=0;var t=e.details;t&&t.live&&(e.details=void 0)})),null!==this.timer&&this.loadLevel()},o.stopLoad=function(){this.canload=!1},o.onManifestLoaded=function(e){var t,r=[],n=[],a={},i=null,o=!1,u=!1;if(e.levels.forEach((function(e){var t=e.attrs;e.loadError=0,e.fragmentError=!1,o=o||!!e.videoCodec,u=u||!!e.audioCodec,De&&e.audioCodec&&-1!==e.audioCodec.indexOf("mp4a.40.34")&&(e.audioCodec=void 0),(i=a[e.bitrate])?i.url.push(e.url):(e.url=[e.url],e.urlId=0,a[e.bitrate]=e,r.push(e)),t&&(t.AUDIO&&J(i||e,"audio",t.AUDIO),t.SUBTITLES&&J(i||e,"text",t.SUBTITLES))})),o&&u&&(r=r.filter((function(e){return!!e.videoCodec}))),r=r.filter((function(e){var t=e.audioCodec,r=e.videoCodec;return(!t||A(t,"audio"))&&(!r||A(r,"video"))})),e.audioTracks&&(n=e.audioTracks.filter((function(e){return!e.audioCodec||A(e.audioCodec,"audio")}))).forEach((function(e,t){e.id=t})),r.length>0){t=r[0].bitrate,r.sort((function(e,t){return e.bitrate-t.bitrate})),this._levels=r;for(var d=0;d<r.length;d++)if(r[d].bitrate===t){this._firstLevel=d,l.b.log("manifest loaded,"+r.length+" level(s) found, first bitrate:"+t);break}var f=u&&!o;this.hls.trigger(c.a.MANIFEST_PARSED,{levels:r,audioTracks:n,firstLevel:this._firstLevel,stats:e.stats,audio:u,video:o,altAudio:!f&&n.some((function(e){return!!e.url}))})}else this.hls.trigger(c.a.ERROR,{type:s.b.MEDIA_ERROR,details:s.a.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:this.hls.url,reason:"no level with compatible codecs found in manifest"})},o.setLevelInternal=function(e){var t=this._levels,r=this.hls;if(e>=0&&e<t.length){if(this.clearTimer(),this.currentLevelIndex!==e){l.b.log("switching to level "+e),this.currentLevelIndex=e;var n=t[e];n.level=e,r.trigger(c.a.LEVEL_SWITCHING,n)}var a=t[e],i=a.details;if(!i||i.live){var o=a.urlId;r.trigger(c.a.LEVEL_LOADING,{url:a.url[o],level:e,id:o})}}else r.trigger(c.a.ERROR,{type:s.b.OTHER_ERROR,details:s.a.LEVEL_SWITCH_ERROR,level:e,fatal:!1,reason:"invalid level idx"})},o.onError=function(e){if(e.fatal)e.type===s.b.NETWORK_ERROR&&this.clearTimer();else{var t,r=!1,n=!1;switch(e.details){case s.a.FRAG_LOAD_ERROR:case s.a.FRAG_LOAD_TIMEOUT:case s.a.KEY_LOAD_ERROR:case s.a.KEY_LOAD_TIMEOUT:t=e.frag.level,n=!0;break;case s.a.LEVEL_LOAD_ERROR:case s.a.LEVEL_LOAD_TIMEOUT:t=e.context.level,r=!0;break;case s.a.REMUX_ALLOC_ERROR:t=e.level,r=!0}void 0!==t&&this.recoverLevel(e,t,r,n)}},o.recoverLevel=function(e,t,r,n){var a,i,o,s=this,u=this.hls.config,c=e.details,d=this._levels[t];if(d.loadError++,d.fragmentError=n,r){if(!(this.levelRetryCount+1<=u.levelLoadingMaxRetry))return l.b.error("level controller, cannot recover from "+c+" error"),this.currentLevelIndex=null,this.clearTimer(),void(e.fatal=!0);i=Math.min(Math.pow(2,this.levelRetryCount)*u.levelLoadingRetryDelay,u.levelLoadingMaxRetryTimeout),this.timer=setTimeout((function(){return s.loadLevel()}),i),e.levelRetry=!0,this.levelRetryCount++,l.b.warn("level controller, "+c+", retry in "+i+" ms, current retry count is "+this.levelRetryCount)}(r||n)&&((a=d.url.length)>1&&d.loadError<a?(d.urlId=(d.urlId+1)%a,d.details=void 0,l.b.warn("level controller, "+c+" for level "+t+": switching to redundant URL-id "+d.urlId)):-1===this.manualLevelIndex?(o=0===t?this._levels.length-1:t-1,l.b.warn("level controller, "+c+": switch to "+o),this.hls.nextAutoLevel=this.currentLevelIndex=o):n&&(l.b.warn("level controller, "+c+": reload a fragment"),this.currentLevelIndex=null))},o.onFragLoaded=function(e){var t=e.frag;if(void 0!==t&&"main"===t.type){var r=this._levels[t.level];void 0!==r&&(r.fragmentError=!1,r.loadError=0,this.levelRetryCount=0)}},o.onLevelLoaded=function(e){var t=this,r=e.level,n=e.details;if(r===this.currentLevelIndex){var a=this._levels[r];if(a.fragmentError||(a.loadError=0,this.levelRetryCount=0),n.live){var i=ae(a.details,n,e.stats.trequest);l.b.log("live playlist, reload in "+Math.round(i)+" ms"),this.timer=setTimeout((function(){return t.loadLevel()}),i)}else this.clearTimer()}},o.onAudioTrackSwitched=function(e){var t=this.hls.audioTracks[e.id].groupId,r=this.hls.levels[this.currentLevelIndex];if(r&&r.audioGroupIds){for(var n=-1,a=0;a<r.audioGroupIds.length;a++)if(r.audioGroupIds[a]===t){n=a;break}n!==r.urlId&&(r.urlId=n,this.startLoad())}},o.loadLevel=function(){if(l.b.debug("call to loadLevel"),null!==this.currentLevelIndex&&this.canload){var e=this._levels[this.currentLevelIndex];if("object"==typeof e&&e.url.length>0){var t=this.currentLevelIndex,r=e.urlId,n=e.url[r];l.b.log("Attempt loading level index "+t+" with URL-id "+r),this.hls.trigger(c.a.LEVEL_LOADING,{url:n,level:t,id:r})}}},o.removeLevel=function(e,t){var r=this.levels.filter((function(r,n){return n!==e||r.url.length>1&&void 0!==t&&(r.url=r.url.filter((function(e,r){return r!==t})),r.urlId=0,!0)})).map((function(e,t){var r=e.details;return r&&r.fragments&&r.fragments.forEach((function(e){e.level=t})),e}));this._levels=r,this.hls.trigger(c.a.LEVELS_UPDATED,{levels:r})},a=n,(i=[{key:"levels",get:function(){return this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(e){var t=this._levels;t&&(e=Math.min(e,t.length-1),this.currentLevelIndex===e&&t[e].details||this.setLevelInternal(e))}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(e){this.manualLevelIndex=e,void 0===this._startLevel&&(this._startLevel=e),-1!==e&&(this.level=e)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(e){this._firstLevel=e}},{key:"startLevel",get:function(){if(void 0===this._startLevel){var e=this.hls.config.startLevel;return void 0!==e?e:this._firstLevel}return this._startLevel},set:function(e){this._startLevel=e}},{key:"nextLoadLevel",get:function(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(e){this.level=e,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=e)}}])&&xe(a.prototype,i),n}(f),Ue=r(4);function je(e,t){var r;try{r=new Event("addtrack")}catch(e){(r=document.createEvent("Event")).initEvent("addtrack",!1,!1)}r.track=e,t.dispatchEvent(r)}function Fe(e){if(null==e?void 0:e.cues)for(;e.cues.length>0;)e.removeCue(e.cues[0])}var Ne=function(e){var t,r;function n(t){var r;return(r=e.call(this,t,c.a.MEDIA_ATTACHED,c.a.MEDIA_DETACHING,c.a.FRAG_PARSING_METADATA,c.a.LIVE_BACK_BUFFER_REACHED)||this).id3Track=void 0,r.media=void 0,r}r=e,(t=n).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var a=n.prototype;return a.destroy=function(){f.prototype.destroy.call(this)},a.onMediaAttached=function(e){this.media=e.media,this.media},a.onMediaDetaching=function(){Fe(this.id3Track),this.id3Track=void 0,this.media=void 0},a.getID3Track=function(e){for(var t=0;t<e.length;t++){var r=e[t];if("metadata"===r.kind&&"id3"===r.label)return je(r,this.media),r}return this.media.addTextTrack("metadata","id3")},a.onFragParsingMetadata=function(e){var t=e.frag,r=e.samples;this.id3Track||(this.id3Track=this.getID3Track(this.media.textTracks),this.id3Track.mode="hidden");for(var n=window.WebKitDataCue||window.VTTCue||window.TextTrackCue,a=0;a<r.length;a++){var i=Ue.a.getID3Frames(r[a].data);if(i){var o=Math.max(r[a].pts,0),s=a<r.length-1?r[a+1].pts:t.endPTS;s||(s=t.start+t.duration),s-o<=0&&(s=o+.25);for(var u=0;u<i.length;u++){var c=i[u];if(!Ue.a.isTimeStampFrame(c)){var l=new n(o,s,"");l.value=c,this.id3Track.addCue(l)}}}}},a.onLiveBackBufferReached=function(e){var t=e.bufferEnd,r=this.id3Track;if(r&&r.cues&&r.cues.length){var n=function(e,t){if(t<e[0].endTime)return e[0];if(t>e[e.length-1].endTime)return e[e.length-1];for(var r=0,n=e.length-1;r<=n;){var a=Math.floor((n+r)/2);if(t<e[a].endTime)n=a-1;else{if(!(t>e[a].endTime))return e[a];r=a+1}}return e[r].endTime-t<t-e[n].endTime?e[r]:e[n]}(r.cues,t);if(n)for(;r.cues[0]!==n;)r.removeCue(r.cues[0])}},n}(f),Be=function(){function e(e){this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=0,this.totalWeight_=0}var t=e.prototype;return t.sample=function(e,t){var r=Math.pow(this.alpha_,e);this.estimate_=t*(1-r)+r*this.estimate_,this.totalWeight_+=e},t.getTotalWeight=function(){return this.totalWeight_},t.getEstimate=function(){if(this.alpha_){var e=1-Math.pow(this.alpha_,this.totalWeight_);return this.estimate_/e}return this.estimate_},e}(),Ge=function(){function e(e,t,r,n){this.hls=void 0,this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.hls=e,this.defaultEstimate_=n,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new Be(t),this.fast_=new Be(r)}var t=e.prototype;return t.sample=function(e,t){var r=(e=Math.max(e,this.minDelayMs_))/1e3,n=8*t/r;this.fast_.sample(r,n),this.slow_.sample(r,n)},t.canEstimate=function(){var e=this.fast_;return e&&e.getTotalWeight()>=this.minWeight_},t.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},t.destroy=function(){},e}();function Ve(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Ke=window.performance,He=function(e){var t,r;function n(t){var r;return(r=e.call(this,t,c.a.FRAG_LOADING,c.a.FRAG_LOADED,c.a.FRAG_BUFFERED,c.a.ERROR)||this).lastLoadedFragLevel=0,r._nextAutoLevel=-1,r.hls=t,r.timer=null,r._bwEstimator=null,r.onCheck=r._abandonRulesCheck.bind(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(r)),r}r=e,(t=n).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var a,i,o=n.prototype;return o.destroy=function(){this.clearTimer(),f.prototype.destroy.call(this)},o.onFragLoading=function(e){var t=e.frag;if("main"===t.type&&(this.timer||(this.fragCurrent=t,this.timer=setInterval(this.onCheck,100)),!this._bwEstimator)){var r,n,a=this.hls,i=a.config,o=t.level;a.levels[o].details.live?(r=i.abrEwmaFastLive,n=i.abrEwmaSlowLive):(r=i.abrEwmaFastVoD,n=i.abrEwmaSlowVoD),this._bwEstimator=new Ge(a,n,r,i.abrEwmaDefaultEstimate)}},o._abandonRulesCheck=function(){var e=this.hls,t=e.media,r=this.fragCurrent;if(r){var n=r.loader;if(!n||n.stats&&n.stats.aborted)return l.b.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),void(this._nextAutoLevel=-1);var a=n.stats;if(t&&a&&(!t.paused&&0!==t.playbackRate||!t.readyState)&&r.autoLevel&&r.level){var i=Ke.now()-a.trequest,o=Math.abs(t.playbackRate);if(i>500*r.duration/o){var s=e.levels,u=Math.max(1,a.bw?a.bw/8:1e3*a.loaded/i),d=s[r.level];if(!d)return;var f=d.realBitrate?Math.max(d.realBitrate,d.bitrate):d.bitrate,h=a.total?a.total:Math.max(a.loaded,Math.round(r.duration*f/8)),p=t.currentTime,g=(h-a.loaded)/u,v=(K.bufferInfo(t,p,e.config.maxBufferHole).end-p)/o;if(v<2*r.duration/o&&g>v){var m,y=e.minAutoLevel;for(m=r.level-1;m>y;m--){var b=s[m].realBitrate?Math.max(s[m].realBitrate,s[m].bitrate):s[m].bitrate;if(r.duration*b/(6.4*u)<v)break}void 0<g&&(l.b.warn("loading too slow, abort fragment loading and switch to level "+m+":fragLoadedDelay["+m+"]<fragLoadedDelay["+(r.level-1)+"];bufferStarvationDelay:"+(void 0).toFixed(1)+"<"+g.toFixed(1)+":"+v.toFixed(1)),e.nextLoadLevel=m,this._bwEstimator.sample(i,a.loaded),n.abort(),this.clearTimer(),e.trigger(c.a.FRAG_LOAD_EMERGENCY_ABORTED,{frag:r,stats:a}))}}}}},o.onFragLoaded=function(e){var t=e.frag;if("main"===t.type&&Object(u.a)(t.sn)){if(this.clearTimer(),this.lastLoadedFragLevel=t.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var r=this.hls.levels[t.level],n=(r.loaded?r.loaded.bytes:0)+e.stats.loaded,a=(r.loaded?r.loaded.duration:0)+e.frag.duration;r.loaded={bytes:n,duration:a},r.realBitrate=Math.round(8*n/a)}if(e.frag.bitrateTest){var i=e.stats;i.tparsed=i.tbuffered=i.tload,this.onFragBuffered(e)}}},o.onFragBuffered=function(e){var t=e.stats,r=e.frag;if(!0!==t.aborted&&"main"===r.type&&Object(u.a)(r.sn)&&(!r.bitrateTest||t.tload===t.tbuffered)){var n=t.tparsed-t.trequest;l.b.log("latency/loading/parsing/append/kbps:"+Math.round(t.tfirst-t.trequest)+"/"+Math.round(t.tload-t.tfirst)+"/"+Math.round(t.tparsed-t.tload)+"/"+Math.round(t.tbuffered-t.tparsed)+"/"+Math.round(8*t.loaded/(t.tbuffered-t.trequest))),this._bwEstimator.sample(n,t.loaded),t.bwEstimate=this._bwEstimator.getEstimate(),r.bitrateTest?this.bitrateTestDelay=n/1e3:this.bitrateTestDelay=0}},o.onError=function(e){switch(e.details){case s.a.FRAG_LOAD_ERROR:case s.a.FRAG_LOAD_TIMEOUT:this.clearTimer()}},o.clearTimer=function(){clearInterval(this.timer),this.timer=null},o._findBestLevel=function(e,t,r,n,a,i,o,s,u){for(var c=a;c>=n;c--){var d=u[c];if(d){var f,h=d.details,p=h?h.totalduration/h.fragments.length:t,g=!!h&&h.live;f=c<=e?o*r:s*r;var v=u[c].realBitrate?Math.max(u[c].realBitrate,u[c].bitrate):u[c].bitrate,m=v*p/f;if(l.b.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+c+"/"+Math.round(f)+"/"+v+"/"+p+"/"+i+"/"+m),f>v&&(!m||g&&!this.bitrateTestDelay||m<i))return c}}return-1},a=n,(i=[{key:"nextAutoLevel",get:function(){var e=this._nextAutoLevel,t=this._bwEstimator;if(!(-1===e||t&&t.canEstimate()))return e;var r=this._nextABRAutoLevel;return-1!==e&&(r=Math.min(e,r)),r},set:function(e){this._nextAutoLevel=e}},{key:"_nextABRAutoLevel",get:function(){var e=this.hls,t=e.maxAutoLevel,r=e.levels,n=e.config,a=e.minAutoLevel,i=e.media,o=this.lastLoadedFragLevel,s=this.fragCurrent?this.fragCurrent.duration:0,u=i?i.currentTime:0,c=i&&0!==i.playbackRate?Math.abs(i.playbackRate):1,d=this._bwEstimator?this._bwEstimator.getEstimate():n.abrEwmaDefaultEstimate,f=(K.bufferInfo(i,u,n.maxBufferHole).end-u)/c,h=this._findBestLevel(o,s,d,a,t,f,n.abrBandWidthFactor,n.abrBandWidthUpFactor,r);if(h>=0)return h;l.b.trace("rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering");var p=s?Math.min(s,n.maxStarvationDelay):n.maxStarvationDelay,g=n.abrBandWidthFactor,v=n.abrBandWidthUpFactor;if(0===f){var m=this.bitrateTestDelay;m&&(p=(s?Math.min(s,n.maxLoadingDelay):n.maxLoadingDelay)-m,l.b.trace("bitrate test took "+Math.round(1e3*m)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*p)+" ms"),g=v=1)}return h=this._findBestLevel(o,s,d,a,t,f+p,g,v,r),Math.max(h,0)}}])&&Ve(a.prototype,i),n}(f),Ze=q(),Ye=function(e){var t,r;function n(t){var r;return(r=e.call(this,t,c.a.MEDIA_ATTACHING,c.a.MEDIA_DETACHING,c.a.MANIFEST_PARSED,c.a.BUFFER_RESET,c.a.BUFFER_APPENDING,c.a.BUFFER_CODECS,c.a.BUFFER_EOS,c.a.BUFFER_FLUSHING,c.a.LEVEL_PTS_UPDATED,c.a.LEVEL_UPDATED)||this)._msDuration=null,r._levelDuration=null,r._levelTargetDuration=10,r._live=null,r._objectUrl=null,r._needsFlush=!1,r._needsEos=!1,r.config=void 0,r.audioTimestampOffset=void 0,r.bufferCodecEventsExpected=0,r._bufferCodecEventsTotal=0,r.media=null,r.mediaSource=null,r.segments=[],r.parent=void 0,r.appending=!1,r.appended=0,r.appendError=0,r.flushBufferCounter=0,r.tracks={},r.pendingTracks={},r.sourceBuffer={},r.flushRange=[],r._onMediaSourceOpen=function(){l.b.log("media source opened"),r.hls.trigger(c.a.MEDIA_ATTACHED,{media:r.media});var e=r.mediaSource;e&&e.removeEventListener("sourceopen",r._onMediaSourceOpen),r.checkPendingTracks()},r._onMediaSourceClose=function(){l.b.log("media source closed")},r._onMediaSourceEnded=function(){l.b.log("media source ended")},r._onSBUpdateEnd=function(){if(r.audioTimestampOffset&&r.sourceBuffer.audio){var e=r.sourceBuffer.audio;l.b.warn("change mpeg audio timestamp offset from "+e.timestampOffset+" to "+r.audioTimestampOffset),e.timestampOffset=r.audioTimestampOffset,delete r.audioTimestampOffset}r._needsFlush&&r.doFlush(),r._needsEos&&r.checkEos(),r.appending=!1;var t=r.parent,n=r.segments.reduce((function(e,r){return r.parent===t?e+1:e}),0),a={},i=r.sourceBuffer;for(var o in i){var s=i[o];if(!s)throw Error("handling source buffer update end error: source buffer for "+o+" uninitilized and unable to update buffered TimeRanges.");a[o]=s.buffered}r.hls.trigger(c.a.BUFFER_APPENDED,{parent:t,pending:n,timeRanges:a}),r._needsFlush||r.doAppending(),r.updateMediaElementDuration(),0===n&&r.flushLiveBackBuffer()},r._onSBUpdateError=function(e){l.b.error("sourceBuffer error:",e),r.hls.trigger(c.a.ERROR,{type:s.b.MEDIA_ERROR,details:s.a.BUFFER_APPENDING_ERROR,fatal:!1})},r.config=t.config,r}r=e,(t=n).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var a=n.prototype;return a.destroy=function(){f.prototype.destroy.call(this)},a.onLevelPtsUpdated=function(e){var t=e.type,r=this.tracks.audio;if("audio"===t&&r&&"audio/mpeg"===r.container){var n=this.sourceBuffer.audio;if(!n)throw Error("Level PTS Updated and source buffer for audio uninitalized");if(Math.abs(n.timestampOffset-e.start)>.1){var a=n.updating;try{n.abort()}catch(e){l.b.warn("can not abort audio buffer: "+e)}a?this.audioTimestampOffset=e.start:(l.b.warn("change mpeg audio timestamp offset from "+n.timestampOffset+" to "+e.start),n.timestampOffset=e.start)}}},a.onManifestParsed=function(e){var t=2;(e.audio&&!e.video||!e.altAudio)&&(t=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=t,l.b.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},a.onMediaAttaching=function(e){var t=this.media=e.media;if(t&&Ze){var r=this.mediaSource=new Ze;r.addEventListener("sourceopen",this._onMediaSourceOpen),r.addEventListener("sourceended",this._onMediaSourceEnded),r.addEventListener("sourceclose",this._onMediaSourceClose),t.src=window.URL.createObjectURL(r),this._objectUrl=t.src}},a.onMediaDetaching=function(){l.b.log("media source detaching");var e=this.mediaSource;if(e){if("open"===e.readyState)try{e.endOfStream()}catch(e){l.b.warn("onMediaDetaching:"+e.message+" while calling endOfStream")}e.removeEventListener("sourceopen",this._onMediaSourceOpen),e.removeEventListener("sourceended",this._onMediaSourceEnded),e.removeEventListener("sourceclose",this._onMediaSourceClose),this.media&&(this._objectUrl&&window.URL.revokeObjectURL(this._objectUrl),this.media.src===this._objectUrl?(this.media.removeAttribute("src"),this.media.load()):l.b.warn("media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={},this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}this.hls.trigger(c.a.MEDIA_DETACHED)},a.checkPendingTracks=function(){var e=this.bufferCodecEventsExpected,t=this.pendingTracks,r=Object.keys(t).length;(r&&!e||2===r)&&(this.createSourceBuffers(t),this.pendingTracks={},this.doAppending())},a.onBufferReset=function(){var e=this.sourceBuffer;for(var t in e){var r=e[t];try{r&&(this.mediaSource&&this.mediaSource.removeSourceBuffer(r),r.removeEventListener("updateend",this._onSBUpdateEnd),r.removeEventListener("error",this._onSBUpdateError))}catch(e){}}this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0},a.onBufferCodecs=function(e){var t=this;Object.keys(this.sourceBuffer).length||(Object.keys(e).forEach((function(r){t.pendingTracks[r]=e[r]})),this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&"open"===this.mediaSource.readyState&&this.checkPendingTracks())},a.createSourceBuffers=function(e){var t=this.sourceBuffer,r=this.mediaSource;if(!r)throw Error("createSourceBuffers called when mediaSource was null");for(var n in e)if(!t[n]){var a=e[n];if(!a)throw Error("source buffer exists for track "+n+", however track does not");var i=a.levelCodec||a.codec,o=a.container+";codecs="+i;l.b.log("creating sourceBuffer("+o+")");try{var u=t[n]=r.addSourceBuffer(o);u.addEventListener("updateend",this._onSBUpdateEnd),u.addEventListener("error",this._onSBUpdateError),this.tracks[n]={buffer:u,codec:i,id:a.id,container:a.container,levelCodec:a.levelCodec}}catch(e){l.b.error("error while trying to add sourceBuffer:"+e.message),this.hls.trigger(c.a.ERROR,{type:s.b.MEDIA_ERROR,details:s.a.BUFFER_ADD_CODEC_ERROR,fatal:!1,err:e,mimeType:o})}}this.hls.trigger(c.a.BUFFER_CREATED,{tracks:this.tracks})},a.onBufferAppending=function(e){this._needsFlush||(this.segments?this.segments.push(e):this.segments=[e],this.doAppending())},a.onBufferEos=function(e){for(var t in this.sourceBuffer)if(!e.type||e.type===t){var r=this.sourceBuffer[t];r&&!r.ended&&(r.ended=!0,l.b.log(t+" sourceBuffer now EOS"))}this.checkEos()},a.checkEos=function(){var e=this.sourceBuffer,t=this.mediaSource;if(t&&"open"===t.readyState){for(var r in e){var n=e[r];if(n){if(!n.ended)return;if(n.updating)return void(this._needsEos=!0)}}l.b.log("all media data are available, signal endOfStream() to MediaSource and stop loading fragment");try{t.endOfStream()}catch(e){l.b.warn("exception while calling mediaSource.endOfStream()")}this._needsEos=!1}else this._needsEos=!1},a.onBufferFlushing=function(e){e.type?this.flushRange.push({start:e.startOffset,end:e.endOffset,type:e.type}):(this.flushRange.push({start:e.startOffset,end:e.endOffset,type:"video"}),this.flushRange.push({start:e.startOffset,end:e.endOffset,type:"audio"})),this.flushBufferCounter=0,this.doFlush()},a.flushLiveBackBuffer=function(){if(this._live){var e=this.config.liveBackBufferLength;if(isFinite(e)&&!(e<0))if(this.media)for(var t=this.media.currentTime,r=this.sourceBuffer,n=Object.keys(r),a=t-Math.max(e,this._levelTargetDuration),i=n.length-1;i>=0;i--){var o=n[i],s=r[o];if(s){var u=s.buffered;u.length>0&&a>u.start(0)&&this.removeBufferRange(o,s,0,a)&&this.hls.trigger(c.a.LIVE_BACK_BUFFER_REACHED,{bufferEnd:a})}}else l.b.error("flushLiveBackBuffer called without attaching media")}},a.onLevelUpdated=function(e){var t=e.details;t.fragments.length>0&&(this._levelDuration=t.totalduration+t.fragments[0].start,this._levelTargetDuration=t.averagetargetduration||t.targetduration||10,this._live=t.live,this.updateMediaElementDuration())},a.updateMediaElementDuration=function(){var e,t=this.config;if(null!==this._levelDuration&&this.media&&this.mediaSource&&this.sourceBuffer&&0!==this.media.readyState&&"open"===this.mediaSource.readyState){for(var r in this.sourceBuffer){var n=this.sourceBuffer[r];if(n&&!0===n.updating)return}e=this.media.duration,null===this._msDuration&&(this._msDuration=this.mediaSource.duration),!0===this._live&&!0===t.liveDurationInfinity?(l.b.log("Media Source duration is set to Infinity"),this._msDuration=this.mediaSource.duration=1/0):(this._levelDuration>this._msDuration&&this._levelDuration>e||!Object(u.a)(e))&&(l.b.log("Updating Media Source duration to "+this._levelDuration.toFixed(3)),this._msDuration=this.mediaSource.duration=this._levelDuration)}},a.doFlush=function(){for(;this.flushRange.length;){var e=this.flushRange[0];if(!this.flushBuffer(e.start,e.end,e.type))return void(this._needsFlush=!0);this.flushRange.shift(),this.flushBufferCounter=0}if(0===this.flushRange.length){this._needsFlush=!1;var t=0,r=this.sourceBuffer;try{for(var n in r){var a=r[n];a&&(t+=a.buffered.length)}}catch(e){l.b.error("error while accessing sourceBuffer.buffered")}this.appended=t,this.hls.trigger(c.a.BUFFER_FLUSHED)}},a.doAppending=function(){var e=this.config,t=this.hls,r=this.segments,n=this.sourceBuffer;if(Object.keys(n).length){if(!this.media||this.media.error)return this.segments=[],void l.b.error("trying to append although a media error occured, flush segment and abort");if(!this.appending){var a=r.shift();if(a)try{var i=n[a.type];if(!i)return void this._onSBUpdateEnd();if(i.updating)return void r.unshift(a);i.ended=!1,this.parent=a.parent,i.appendBuffer(a.data),this.appendError=0,this.appended++,this.appending=!0}catch(n){l.b.error("error while trying to append buffer:"+n.message),r.unshift(a);var o={type:s.b.MEDIA_ERROR,parent:a.parent,details:"",fatal:!1};22===n.code?(this.segments=[],o.details=s.a.BUFFER_FULL_ERROR):(this.appendError++,o.details=s.a.BUFFER_APPEND_ERROR,this.appendError>e.appendErrorMaxRetry&&(l.b.log("fail "+e.appendErrorMaxRetry+" times to append segment in sourceBuffer"),this.segments=[],o.fatal=!0)),t.trigger(c.a.ERROR,o)}}}},a.flushBuffer=function(e,t,r){var n=this.sourceBuffer;if(!Object.keys(n).length)return!0;var a="null";if(this.media&&(a=this.media.currentTime.toFixed(3)),l.b.log("flushBuffer,pos/start/end: "+a+"/"+e+"/"+t),this.flushBufferCounter>=this.appended)return l.b.warn("abort flushing too many retries"),!0;var i=n[r];if(i){if(i.ended=!1,i.updating)return l.b.warn("cannot flush, sb updating in progress"),!1;if(this.removeBufferRange(r,i,e,t))return this.flushBufferCounter++,!1}return l.b.log("buffer flushed"),!0},a.removeBufferRange=function(e,t,r,n){try{for(var a=0;a<t.buffered.length;a++){var i=t.buffered.start(a),o=t.buffered.end(a),s=Math.max(i,r),u=Math.min(o,n);if(Math.min(u,o)-s>.5){var c="null";return this.media&&(c=this.media.currentTime.toString()),l.b.log("sb remove "+e+" ["+s+","+u+"], of ["+i+","+o+"], pos:"+c),t.remove(s,u),!0}}}catch(e){l.b.warn("removeBufferRange failed",e)}return!1},n}(f);function qe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var We=function(e){var t,r;function n(t){var r;return(r=e.call(this,t,c.a.FPS_DROP_LEVEL_CAPPING,c.a.MEDIA_ATTACHING,c.a.MANIFEST_PARSED,c.a.LEVELS_UPDATED,c.a.BUFFER_CODECS,c.a.MEDIA_DETACHING)||this).autoLevelCapping=Number.POSITIVE_INFINITY,r.firstLevel=null,r.levels=[],r.media=null,r.restrictedLevels=[],r.timer=null,r.clientRect=null,r}r=e,(t=n).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var a,i,o,s=n.prototype;return s.destroy=function(){this.hls.config.capLevelToPlayerSize&&(this.media=null,this.clientRect=null,this.stopCapping())},s.onFpsDropLevelCapping=function(e){n.isLevelAllowed(e.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(e.droppedLevel)},s.onMediaAttaching=function(e){this.media=e.media instanceof window.HTMLVideoElement?e.media:null},s.onManifestParsed=function(e){var t=this.hls;this.restrictedLevels=[],this.levels=e.levels,this.firstLevel=e.firstLevel,t.config.capLevelToPlayerSize&&e.video&&this.startCapping()},s.onBufferCodecs=function(e){this.hls.config.capLevelToPlayerSize&&e.video&&this.startCapping()},s.onLevelsUpdated=function(e){this.levels=e.levels},s.onMediaDetaching=function(){this.stopCapping()},s.detectPlayerSize=function(){if(this.media){var e=this.levels?this.levels.length:0;if(e){var t=this.hls;t.autoLevelCapping=this.getMaxLevel(e-1),t.autoLevelCapping>this.autoLevelCapping&&t.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}},s.getMaxLevel=function(e){var t=this;if(!this.levels)return-1;var r=this.levels.filter((function(r,a){return n.isLevelAllowed(a,t.restrictedLevels)&&a<=e}));return this.clientRect=null,n.getMaxLevelByMediaSize(r,this.mediaWidth,this.mediaHeight)},s.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),clearInterval(this.timer),this.timer=setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},s.stopCapping=function(){this.restrictedLevels=[],this.firstLevel=null,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(this.timer=clearInterval(this.timer),this.timer=null)},s.getDimensions=function(){if(this.clientRect)return this.clientRect;var e=this.media,t={width:0,height:0};if(e){var r=e.getBoundingClientRect();t.width=r.width,t.height=r.height,t.width||t.height||(t.width=r.right-r.left||e.width||0,t.height=r.bottom-r.top||e.height||0)}return this.clientRect=t,t},n.isLevelAllowed=function(e,t){return void 0===t&&(t=[]),-1===t.indexOf(e)},n.getMaxLevelByMediaSize=function(e,t,r){if(!e||e&&!e.length)return-1;for(var n,a,i=e.length-1,o=0;o<e.length;o+=1){var s=e[o];if((s.width>=t||s.height>=r)&&(n=s,!(a=e[o+1])||n.width!==a.width||n.height!==a.height)){i=o;break}}return i},a=n,o=[{key:"contentScaleFactor",get:function(){var e=1;try{e=window.devicePixelRatio}catch(e){}return e}}],(i=[{key:"mediaWidth",get:function(){return this.getDimensions().width*n.contentScaleFactor}},{key:"mediaHeight",get:function(){return this.getDimensions().height*n.contentScaleFactor}}])&&qe(a.prototype,i),o&&qe(a,o),n}(f),ze=window.performance,Xe=function(e){var t,r;function n(t){return e.call(this,t,c.a.MEDIA_ATTACHING)||this}r=e,(t=n).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var a=n.prototype;return a.destroy=function(){this.timer&&clearInterval(this.timer),this.isVideoPlaybackQualityAvailable=!1},a.onMediaAttaching=function(e){var t=this.hls.config;t.capLevelOnFPSDrop&&("function"==typeof(this.video=e.media instanceof window.HTMLVideoElement?e.media:null).getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),clearInterval(this.timer),this.timer=setInterval(this.checkFPSInterval.bind(this),t.fpsDroppedMonitoringPeriod))},a.checkFPS=function(e,t,r){var n=ze.now();if(t){if(this.lastTime){var a=n-this.lastTime,i=r-this.lastDroppedFrames,o=t-this.lastDecodedFrames,s=1e3*i/a,u=this.hls;if(u.trigger(c.a.FPS_DROP,{currentDropped:i,currentDecoded:o,totalDroppedFrames:r}),s>0&&i>u.config.fpsDroppedMonitoringThreshold*o){var d=u.currentLevel;l.b.warn("drop FPS ratio greater than max allowed value for currentLevel: "+d),d>0&&(-1===u.autoLevelCapping||u.autoLevelCapping>=d)&&(d-=1,u.trigger(c.a.FPS_DROP_LEVEL_CAPPING,{level:d,droppedLevel:u.currentLevel}),u.autoLevelCapping=d,u.streamController.nextLevelSwitch())}}this.lastTime=n,this.lastDroppedFrames=r,this.lastDecodedFrames=t}},a.checkFPSInterval=function(){var e=this.video;if(e)if(this.isVideoPlaybackQualityAvailable){var t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)},n}(f),Qe=function(){function e(e){e&&e.xhrSetup&&(this.xhrSetup=e.xhrSetup)}var t=e.prototype;return t.destroy=function(){this.abort(),this.loader=null},t.abort=function(){var e=this.loader;e&&4!==e.readyState&&(this.stats.aborted=!0,e.abort()),window.clearTimeout(this.requestTimeout),this.requestTimeout=null,window.clearTimeout(this.retryTimeout),this.retryTimeout=null},t.load=function(e,t,r){this.context=e,this.config=t,this.callbacks=r,this.stats={trequest:window.performance.now(),retry:0},this.retryDelay=t.retryDelay,this.loadInternal()},t.loadInternal=function(){var e,t=this.context;e=this.loader=new window.XMLHttpRequest;var r=this.stats;r.tfirst=0,r.loaded=0;var n=this.xhrSetup;try{if(n)try{n(e,t.url)}catch(r){e.open("GET",t.url,!0),n(e,t.url)}e.readyState||e.open("GET",t.url,!0)}catch(r){return void this.callbacks.onError({code:e.status,text:r.message},t,e)}t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout),e.send()},t.readystatechange=function(e){var t=e.currentTarget,r=t.readyState,n=this.stats,a=this.context,i=this.config;if(!n.aborted&&r>=2)if(window.clearTimeout(this.requestTimeout),0===n.tfirst&&(n.tfirst=Math.max(window.performance.now(),n.trequest)),4===r){var o=t.status;if(o>=200&&o<300){var s,u;n.tload=Math.max(n.tfirst,window.performance.now()),u="arraybuffer"===a.responseType?(s=t.response).byteLength:(s=t.responseText).length,n.loaded=n.total=u;var c={url:t.responseURL,data:s};this.callbacks.onSuccess(c,n,a,t)}else n.retry>=i.maxRetry||o>=400&&o<499?(l.b.error(o+" while loading "+a.url),this.callbacks.onError({code:o,text:t.statusText},a,t)):(l.b.warn(o+" while loading "+a.url+", retrying in "+this.retryDelay+"..."),this.destroy(),this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,i.maxRetryDelay),n.retry++)}else this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),i.timeout)},t.loadtimeout=function(){l.b.warn("timeout while loading "+this.context.url),this.callbacks.onTimeout(this.stats,this.context,null)},t.loadprogress=function(e){var t=e.currentTarget,r=this.stats;r.loaded=e.loaded,e.lengthComputable&&(r.total=e.total);var n=this.callbacks.onProgress;n&&n(r,this.context,null,t)},e}();function $e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Je=function(e){var t,r;function n(t){var r;return(r=e.call(this,t,c.a.MANIFEST_LOADING,c.a.MANIFEST_PARSED,c.a.AUDIO_TRACK_LOADED,c.a.AUDIO_TRACK_SWITCHED,c.a.LEVEL_LOADED,c.a.ERROR)||this)._trackId=-1,r._selectDefaultTrack=!0,r.tracks=[],r.trackIdBlacklist=Object.create(null),r.audioGroupId=null,r}r=e,(t=n).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var a,i,o=n.prototype;return o.onManifestLoading=function(){this.tracks=[],this._trackId=-1,this._selectDefaultTrack=!0},o.onManifestParsed=function(e){var t=this.tracks=e.audioTracks||[];this.hls.trigger(c.a.AUDIO_TRACKS_UPDATED,{audioTracks:t}),this._selectAudioGroup(this.hls.nextLoadLevel)},o.onAudioTrackLoaded=function(e){if(e.id>=this.tracks.length)l.b.warn("Invalid audio track id:",e.id);else{if(l.b.log("audioTrack "+e.id+" loaded"),this.tracks[e.id].details=e.details,e.details.live&&!this.hasInterval()){var t=1e3*e.details.targetduration;this.setInterval(t)}!e.details.live&&this.hasInterval()&&this.clearInterval()}},o.onAudioTrackSwitched=function(e){var t=this.tracks[e.id].groupId;t&&this.audioGroupId!==t&&(this.audioGroupId=t)},o.onLevelLoaded=function(e){this._selectAudioGroup(e.level)},o.onError=function(e){e.type===s.b.NETWORK_ERROR&&(e.fatal&&this.clearInterval(),e.details===s.a.AUDIO_TRACK_LOAD_ERROR&&(l.b.warn("Network failure on audio-track id:",e.context.id),this._handleLoadError()))},o._setAudioTrack=function(e){if(this._trackId===e&&this.tracks[this._trackId].details)l.b.debug("Same id as current audio-track passed, and track details available -> no-op");else if(e<0||e>=this.tracks.length)l.b.warn("Invalid id passed to audio-track controller");else{var t=this.tracks[e];l.b.log("Now switching to audio-track index "+e),this.clearInterval(),this._trackId=e;var r=t.url,n=t.type,a=t.id;this.hls.trigger(c.a.AUDIO_TRACK_SWITCHING,{id:a,type:n,url:r}),this._loadTrackDetailsIfNeeded(t)}},o.doTick=function(){this._updateTrack(this._trackId)},o._selectAudioGroup=function(e){var t=this.hls.levels[e];if(t&&t.audioGroupIds){var r=t.audioGroupIds[t.urlId];this.audioGroupId!==r&&(this.audioGroupId=r,this._selectInitialAudioTrack())}},o._selectInitialAudioTrack=function(){var e=this,t=this.tracks;if(t.length){var r=this.tracks[this._trackId],n=null;if(r&&(n=r.name),this._selectDefaultTrack){var a=t.filter((function(e){return e.default}));a.length?t=a:l.b.warn("No default audio tracks defined")}var i=!1,o=function(){t.forEach((function(t){i||e.audioGroupId&&t.groupId!==e.audioGroupId||n&&n!==t.name||(e._setAudioTrack(t.id),i=!0)}))};o(),i||(n=null,o()),i||(l.b.error("No track found for running audio group-ID: "+this.audioGroupId),this.hls.trigger(c.a.ERROR,{type:s.b.MEDIA_ERROR,details:s.a.AUDIO_TRACK_LOAD_ERROR,fatal:!0}))}},o._needsTrackLoading=function(e){var t=e.details,r=e.url;return!(t&&!t.live||!r)},o._loadTrackDetailsIfNeeded=function(e){if(this._needsTrackLoading(e)){var t=e.url,r=e.id;l.b.log("loading audio-track playlist for id: "+r),this.hls.trigger(c.a.AUDIO_TRACK_LOADING,{url:t,id:r})}},o._updateTrack=function(e){if(!(e<0||e>=this.tracks.length)){this.clearInterval(),this._trackId=e,l.b.log("trying to update audio-track "+e);var t=this.tracks[e];this._loadTrackDetailsIfNeeded(t)}},o._handleLoadError=function(){this.trackIdBlacklist[this._trackId]=!0;var e=this._trackId,t=this.tracks[e],r=t.name,n=t.language,a=t.groupId;l.b.warn("Loading failed on audio track id: "+e+", group-id: "+a+', name/language: "'+r+'" / "'+n+'"');for(var i=e,o=0;o<this.tracks.length;o++)if(!this.trackIdBlacklist[o]&&this.tracks[o].name===r){i=o;break}i!==e?(l.b.log("Attempting audio-track fallback id:",i,"group-id:",this.tracks[i].groupId),this._setAudioTrack(i)):l.b.warn('No fallback audio-track found for name/language: "'+r+'" / "'+n+'"')},a=n,(i=[{key:"audioTracks",get:function(){return this.tracks}},{key:"audioTrack",get:function(){return this._trackId},set:function(e){this._setAudioTrack(e),this._selectDefaultTrack=!1}}])&&$e(a.prototype,i),n}(pe);function et(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var tt=window.performance,rt=function(e){var t,r;function n(t,r){var n;return(n=e.call(this,t,c.a.MEDIA_ATTACHED,c.a.MEDIA_DETACHING,c.a.AUDIO_TRACKS_UPDATED,c.a.AUDIO_TRACK_SWITCHING,c.a.AUDIO_TRACK_LOADED,c.a.KEY_LOADED,c.a.FRAG_LOADED,c.a.FRAG_PARSING_INIT_SEGMENT,c.a.FRAG_PARSING_DATA,c.a.FRAG_PARSED,c.a.ERROR,c.a.BUFFER_RESET,c.a.BUFFER_CREATED,c.a.BUFFER_APPENDED,c.a.BUFFER_FLUSHED,c.a.INIT_PTS_FOUND)||this).fragmentTracker=r,n.config=t.config,n.audioCodecSwap=!1,n._state=ge,n.initPTS=[],n.waitingFragment=null,n.videoTrackCC=null,n.waitingVideoCC=null,n}r=e,(t=n).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var a,i,o=n.prototype;return o.onInitPtsFound=function(e){var t=e.id,r=e.frag.cc,n=e.initPTS;"main"===t&&(this.initPTS[r]=n,this.videoTrackCC=r,l.b.log("InitPTS for cc: "+r+" found from main: "+n),this.state===ke&&this.tick())},o.startLoad=function(e){if(this.tracks){var t=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),this.fragLoadError=0,t>0&&-1===e?(l.b.log("audio:override startPosition with lastCurrentTime @"+t.toFixed(3)),this.state=me):(this.lastCurrentTime=this.startPosition?this.startPosition:e,this.state=ve),this.nextLoadPosition=this.startPosition=this.lastCurrentTime,this.tick()}else this.startPosition=e,this.state=ge},o.doTick=function(){var e,t,r,n=this.hls,a=n.config;switch(this.state){case Re:case ye:case Ae:break;case ve:this.state=Te,this.loadedmetadata=!1;break;case me:var i=this.tracks;if(!i)break;if(!this.media&&(this.startFragRequested||!a.startFragPrefetch))break;if(this.loadedmetadata)e=this.media.currentTime;else if(void 0===(e=this.nextLoadPosition))break;var o=this.mediaBuffer?this.mediaBuffer:this.media,s=this.videoBuffer?this.videoBuffer:this.media,d=e<a.maxBufferHole?Math.max(2,a.maxBufferHole):a.maxBufferHole,f=K.bufferInfo(o,e,d),h=K.bufferInfo(s,e,d),p=f.len,g=f.end,v=this.fragPrevious,m=Math.min(a.maxBufferLength,a.maxMaxBufferLength),y=Math.max(m,h.len),b=this.audioSwitch,S=this.trackId;if((p<y||b)&&S<i.length){if(void 0===(r=i[S].details)){this.state=Te;break}if(!b&&this._streamEnded(f,r))return this.hls.trigger(c.a.BUFFER_EOS,{type:"audio"}),void(this.state=_e);var E,T=r.fragments,w=T.length,O=T[0].start,A=T[w-1].start+T[w-1].duration;if(b)if(r.live&&!r.PTSKnown)l.b.log("switching audiotrack, live stream, unknown PTS,load first fragment"),g=0;else if(g=e,r.PTSKnown&&e<O){if(!(f.end>O||f.nextStart))return;l.b.log("alt audio track ahead of main track, seek to start of alt audio track"),this.media.currentTime=O+.05}if(r.initSegment&&!r.initSegment.data)E=r.initSegment;else if(g<=O){if(E=T[0],null!==this.videoTrackCC&&E.cc!==this.videoTrackCC&&(E=function(e,t){return V(e,(function(e){return e.cc<t?1:e.cc>t?-1:0}))}(T,this.videoTrackCC)),r.live&&E.loadIdx&&E.loadIdx===this.fragLoadIdx){var _=f.nextStart?f.nextStart:O;return l.b.log("no alt audio available @currentTime:"+this.media.currentTime+", seeking @"+(_+.05)),void(this.media.currentTime=_+.05)}}else{var R,k=a.maxFragLookUpTolerance,P=v?T[v.sn-T[0].sn+1]:void 0;g<A?(g>A-k&&(k=0),R=P&&!le(g,k,P)?P:V(T,(function(e){return le(g,k,e)}))):R=T[w-1],R&&(E=R,O=R.start,v&&E.level===v.level&&E.sn===v.sn&&(E.sn<r.endSN?(E=T[E.sn+1-r.startSN],this.fragmentTracker.getState(E)!==B&&l.b.log("SN just loaded, load next one: "+E.sn)):E=null))}E&&(E.encrypted?(l.b.log("Loading key for "+E.sn+" of ["+r.startSN+" ,"+r.endSN+"],track "+S),this.state=be,n.trigger(c.a.KEY_LOADING,{frag:E})):(this.fragCurrent=E,(b||this.fragmentTracker.getState(E)===j)&&(l.b.log("Loading "+E.sn+", cc: "+E.cc+" of ["+r.startSN+" ,"+r.endSN+"],track "+S+", "+(this.loadedmetadata?"currentTime":"nextLoadPosition")+": "+e+", bufferEnd: "+g.toFixed(3)),"initSegment"!==E.sn&&(this.startFragRequested=!0),Object(u.a)(E.sn)&&(this.nextLoadPosition=E.start+E.duration),n.trigger(c.a.FRAG_LOADING,{frag:E}),this.state=Se)))}break;case Te:(t=this.tracks[this.trackId])&&t.details&&(this.state=me);break;case Ee:var C=tt.now(),L=this.retryDate,D=(o=this.media)&&o.seeking;(!L||C>=L||D)&&(l.b.log("audioStreamController: retryDate reached, switch back to IDLE state"),this.state=me);break;case ke:var I=this.waitingFragment;if(I){var x=I.frag.cc;if(void 0!==this.initPTS[x])this.waitingFragment=null,this.state=Se,this.onFragLoaded(I);else if(this.videoTrackCC!==this.waitingVideoCC)l.b.log("Waiting fragment cc ("+x+") cancelled because video is at cc "+this.videoTrackCC),this.clearWaitingFragment();else{var M=K.bufferInfo(this.mediaBuffer,this.media.currentTime,a.maxBufferHole);le(M.end,a.maxFragLookUpTolerance,I.frag)<0&&(l.b.log("Waiting fragment cc ("+x+") @ "+I.frag.start+" cancelled because another fragment at "+M.end+" is needed"),this.clearWaitingFragment())}}else this.state=me}},o.clearWaitingFragment=function(){var e=this.waitingFragment;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingFragment=null,this.waitingVideoCC=null,this.state=me)},o.onMediaAttached=function(e){var t=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener("seeking",this.onvseeking),t.addEventListener("ended",this.onvended);var r=this.config;this.tracks&&r.autoStartLoad&&this.startLoad(r.startPosition)},o.onMediaDetaching=function(){var e=this.media;e&&e.ended&&(l.b.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()},o.onAudioTracksUpdated=function(e){l.b.log("audio tracks updated"),this.tracks=e.audioTracks},o.onAudioTrackSwitching=function(e){var t=!!e.url;this.trackId=e.id,this.fragCurrent=null,this.clearWaitingFragment(),this.state=ye,t?this.setInterval(100):this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),t&&(this.audioSwitch=!0,this.state=me),this.tick()},o.onAudioTrackLoaded=function(e){var t=e.details,r=e.id,n=this.tracks[r],a=n.details,i=t.totalduration,o=0;if(l.b.log("track "+r+" loaded ["+t.startSN+","+t.endSN+"],duration:"+i),t.live||a&&a.live?a&&t.fragments.length>0?(re(a,t),o=t.fragments[0].start,t.PTSKnown?l.b.log("live audio playlist sliding:"+o.toFixed(3)):l.b.log("live audio playlist - outdated PTS, unknown sliding")):(t.PTSKnown=!1,l.b.log("live audio playlist - first load, unknown sliding")):t.PTSKnown=!1,n.details=t,!this.startFragRequested){if(-1===this.startPosition){var s=t.startTimeOffset;Object(u.a)(s)?(l.b.log("start time offset found in playlist, adjust startPosition to "+s),this.startPosition=s):t.live?(this.startPosition=this.computeLivePosition(o,t),l.b.log("compute startPosition for audio-track to "+this.startPosition)):this.startPosition=0}this.nextLoadPosition=this.startPosition}this.state===Te&&(this.state=me),this.tick()},o.onKeyLoaded=function(){this.state===be&&(this.state=me,this.tick())},o.onFragLoaded=function(e){var t=this.fragCurrent,r=e.frag;if(this.state===Se&&t&&"audio"===r.type&&r.level===t.level&&r.sn===t.sn){var n=this.tracks[this.trackId],a=n.details,i=a.totalduration,o=t.level,s=t.sn,u=t.cc,d=this.config.defaultAudioCodec||n.audioCodec||"mp4a.40.2",f=this.stats=e.stats;if("initSegment"===s)this.state=me,f.tparsed=f.tbuffered=tt.now(),a.initSegment.data=e.payload,this.hls.trigger(c.a.FRAG_BUFFERED,{stats:f,frag:t,id:"audio"}),this.tick();else{this.state=we,this.appended=!1,this.demuxer||(this.demuxer=new $(this.hls,"audio"));var h=this.initPTS[u],p=a.initSegment?a.initSegment.data:[];void 0!==h?(this.pendingBuffering=!0,l.b.log("Demuxing "+s+" of ["+a.startSN+" ,"+a.endSN+"],track "+o),this.demuxer.push(e.payload,p,d,null,t,i,!1,h)):(l.b.log("Unknown video PTS for cc "+u+", waiting for video PTS before demuxing audio frag "+s+" of ["+a.startSN+" ,"+a.endSN+"],track "+o),this.waitingFragment=e,this.waitingVideoCC=this.videoTrackCC,this.state=ke)}}this.fragLoadError=0},o.onFragParsingInitSegment=function(e){var t=this.fragCurrent,r=e.frag;if(t&&"audio"===e.id&&r.sn===t.sn&&r.level===t.level&&this.state===we){var n,a=e.tracks;if(a.video&&delete a.video,n=a.audio){n.levelCodec=n.codec,n.id=e.id,this.hls.trigger(c.a.BUFFER_CODECS,a),l.b.log("audio track:audio,container:"+n.container+",codecs[level/parsed]=["+n.levelCodec+"/"+n.codec+"]");var i=n.initSegment;if(i){var o={type:"audio",data:i,parent:"audio",content:"initSegment"};this.audioSwitch?this.pendingData=[o]:(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(c.a.BUFFER_APPENDING,o))}this.tick()}}},o.onFragParsingData=function(e){var t=this,r=this.fragCurrent,n=e.frag;if(r&&"audio"===e.id&&"audio"===e.type&&n.sn===r.sn&&n.level===r.level&&this.state===we){var a=this.trackId,i=this.tracks[a],o=this.hls;Object(u.a)(e.endPTS)||(e.endPTS=e.startPTS+r.duration,e.endDTS=e.startDTS+r.duration),r.addElementaryStream(g.AUDIO),l.b.log("parsed "+e.type+",PTS:["+e.startPTS.toFixed(3)+","+e.endPTS.toFixed(3)+"],DTS:["+e.startDTS.toFixed(3)+"/"+e.endDTS.toFixed(3)+"],nb:"+e.nb),te(i.details,r,e.startPTS,e.endPTS);var d=this.media,f=!1;if(this.audioSwitch)if(d&&d.readyState){var h=d.currentTime;l.b.log("switching audio track : currentTime:"+h),h>=e.startPTS&&(l.b.log("switching audio track : flushing all audio"),this.state=Ae,o.trigger(c.a.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),f=!0,this.audioSwitch=!1,o.trigger(c.a.AUDIO_TRACK_SWITCHED,{id:a}))}else this.audioSwitch=!1,o.trigger(c.a.AUDIO_TRACK_SWITCHED,{id:a});var p=this.pendingData;if(!p)return l.b.warn("Apparently attempt to enqueue media payload without codec initialization data upfront"),void o.trigger(c.a.ERROR,{type:s.b.MEDIA_ERROR,details:null,fatal:!0});this.audioSwitch||([e.data1,e.data2].forEach((function(t){t&&t.length&&p.push({type:e.type,data:t,parent:"audio",content:"data"})})),!f&&p.length&&(p.forEach((function(e){t.state===we&&(t.pendingBuffering=!0,t.hls.trigger(c.a.BUFFER_APPENDING,e))})),this.pendingData=[],this.appended=!0)),this.tick()}},o.onFragParsed=function(e){var t=this.fragCurrent,r=e.frag;t&&"audio"===e.id&&r.sn===t.sn&&r.level===t.level&&this.state===we&&(this.stats.tparsed=tt.now(),this.state=Oe,this._checkAppendedParsed())},o.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},o.onBufferCreated=function(e){var t=e.tracks.audio;t&&(this.mediaBuffer=t.buffer,this.loadedmetadata=!0),e.tracks.video&&(this.videoBuffer=e.tracks.video.buffer)},o.onBufferAppended=function(e){if("audio"===e.parent){var t=this.state;t!==we&&t!==Oe||(this.pendingBuffering=e.pending>0,this._checkAppendedParsed())}},o._checkAppendedParsed=function(){if(!(this.state!==Oe||this.appended&&this.pendingBuffering)){var e=this.fragCurrent,t=this.stats,r=this.hls;if(e){this.fragPrevious=e,t.tbuffered=tt.now(),r.trigger(c.a.FRAG_BUFFERED,{stats:t,frag:e,id:"audio"});var n=this.mediaBuffer?this.mediaBuffer:this.media;n&&l.b.log("audio buffered : "+ie(n.buffered)),this.audioSwitch&&this.appended&&(this.audioSwitch=!1,r.trigger(c.a.AUDIO_TRACK_SWITCHED,{id:this.trackId})),this.state=me}this.tick()}},o.onError=function(e){var t=e.frag;if(!t||"audio"===t.type)switch(e.details){case s.a.FRAG_LOAD_ERROR:case s.a.FRAG_LOAD_TIMEOUT:var r=e.frag;if(r&&"audio"!==r.type)break;if(!e.fatal){var n=this.fragLoadError;n?n++:n=1;var a=this.config;if(n<=a.fragLoadingMaxRetry){this.fragLoadError=n;var i=Math.min(Math.pow(2,n-1)*a.fragLoadingRetryDelay,a.fragLoadingMaxRetryTimeout);l.b.warn("AudioStreamController: frag loading failed, retry in "+i+" ms"),this.retryDate=tt.now()+i,this.state=Ee}else l.b.error("AudioStreamController: "+e.details+" reaches max retry, redispatch as fatal ..."),e.fatal=!0,this.state=Re}break;case s.a.AUDIO_TRACK_LOAD_ERROR:case s.a.AUDIO_TRACK_LOAD_TIMEOUT:case s.a.KEY_LOAD_ERROR:case s.a.KEY_LOAD_TIMEOUT:this.state!==Re&&(this.state=e.fatal?Re:me,l.b.warn("AudioStreamController: "+e.details+" while loading frag, now switching to "+this.state+" state ..."));break;case s.a.BUFFER_FULL_ERROR:if("audio"===e.parent&&(this.state===we||this.state===Oe)){var o=this.mediaBuffer,u=this.media.currentTime;if(o&&K.isBuffered(o,u)&&K.isBuffered(o,u+.5)){var d=this.config;d.maxMaxBufferLength>=d.maxBufferLength&&(d.maxMaxBufferLength/=2,l.b.warn("AudioStreamController: reduce max buffer length to "+d.maxMaxBufferLength+"s")),this.state=me}else l.b.warn("AudioStreamController: buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,this.state=Ae,this.hls.trigger(c.a.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"})}}},o.onBufferFlushed=function(){var e=this,t=this.pendingData;t&&t.length?(l.b.log("AudioStreamController: appending pending audio data after buffer flushed"),t.forEach((function(t){e.hls.trigger(c.a.BUFFER_APPENDING,t)})),this.appended=!0,this.pendingData=[],this.state=Oe):(this.state=me,this.fragPrevious=null,this.tick())},a=n,(i=[{key:"state",set:function(e){if(this.state!==e){var t=this.state;this._state=e,l.b.log("audio stream:"+t+"->"+e)}},get:function(){return this._state}}])&&et(a.prototype,i),n}(Ce),nt=function(){if("undefined"!=typeof window&&window.VTTCue)return window.VTTCue;var e={"":!0,lr:!0,rl:!0},t={start:!0,middle:!0,end:!0,left:!0,right:!0};function r(e){return"string"==typeof e&&!!t[e.toLowerCase()]&&e.toLowerCase()}function n(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)e[n]=r[n]}return e}function a(t,a,i){var o=this,s={enumerable:!0};o.hasBeenReset=!1;var u="",c=!1,l=t,d=a,f=i,h=null,p="",g=!0,v="auto",m="start",y=50,b="middle",S=50,E="middle";Object.defineProperty(o,"id",n({},s,{get:function(){return u},set:function(e){u=""+e}})),Object.defineProperty(o,"pauseOnExit",n({},s,{get:function(){return c},set:function(e){c=!!e}})),Object.defineProperty(o,"startTime",n({},s,{get:function(){return l},set:function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");l=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"endTime",n({},s,{get:function(){return d},set:function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");d=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"text",n({},s,{get:function(){return f},set:function(e){f=""+e,this.hasBeenReset=!0}})),Object.defineProperty(o,"region",n({},s,{get:function(){return h},set:function(e){h=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"vertical",n({},s,{get:function(){return p},set:function(t){var r=function(t){return"string"==typeof t&&!!e[t.toLowerCase()]&&t.toLowerCase()}(t);if(!1===r)throw new SyntaxError("An invalid or illegal string was specified.");p=r,this.hasBeenReset=!0}})),Object.defineProperty(o,"snapToLines",n({},s,{get:function(){return g},set:function(e){g=!!e,this.hasBeenReset=!0}})),Object.defineProperty(o,"line",n({},s,{get:function(){return v},set:function(e){if("number"!=typeof e&&"auto"!==e)throw new SyntaxError("An invalid number or illegal string was specified.");v=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"lineAlign",n({},s,{get:function(){return m},set:function(e){var t=r(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");m=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"position",n({},s,{get:function(){return y},set:function(e){if(e<0||e>100)throw new Error("Position must be between 0 and 100.");y=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"positionAlign",n({},s,{get:function(){return b},set:function(e){var t=r(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");b=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"size",n({},s,{get:function(){return S},set:function(e){if(e<0||e>100)throw new Error("Size must be between 0 and 100.");S=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"align",n({},s,{get:function(){return E},set:function(e){var t=r(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");E=t,this.hasBeenReset=!0}})),o.displayState=void 0}return a.prototype.getCueAsHTML=function(){return window.WebVTT.convertCueToDOMTree(window,this.text)},a}(),at=function(){return{decode:function(e){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}};function it(){this.window=window,this.state="INITIAL",this.buffer="",this.decoder=new at,this.regionList=[]}function ot(){this.values=Object.create(null)}function st(e,t,r,n){var a=n?e.split(n):[e];for(var i in a)if("string"==typeof a[i]){var o=a[i].split(r);2===o.length&&t(o[0],o[1])}}ot.prototype={set:function(e,t){this.get(e)||""===t||(this.values[e]=t)},get:function(e,t,r){return r?this.has(e)?this.values[e]:t[r]:this.has(e)?this.values[e]:t},has:function(e){return e in this.values},alt:function(e,t,r){for(var n=0;n<r.length;++n)if(t===r[n]){this.set(e,t);break}},integer:function(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))},percent:function(e,t){return!!(t.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(t=parseFloat(t))>=0&&t<=100)&&(this.set(e,t),!0)}};var ut=new nt(0,0,0),ct="middle"===ut.align?"middle":"center";function lt(e,t,r){var n=e;function a(){var t=function(e){function t(e,t,r,n){return 3600*(0|e)+60*(0|t)+(0|r)+(0|n)/1e3}var r=e.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return r?r[3]?t(r[1],r[2],r[3].replace(":",""),r[4]):r[1]>59?t(r[1],r[2],0,r[4]):t(0,r[1],r[2],r[4]):null}(e);if(null===t)throw new Error("Malformed timestamp: "+n);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function i(){e=e.replace(/^\s+/,"")}if(i(),t.startTime=a(),i(),"--\x3e"!==e.substr(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+n);e=e.substr(3),i(),t.endTime=a(),i(),function(e,t){var n=new ot;st(e,(function(e,t){switch(e){case"region":for(var a=r.length-1;a>=0;a--)if(r[a].id===t){n.set(e,r[a].region);break}break;case"vertical":n.alt(e,t,["rl","lr"]);break;case"line":var i=t.split(","),o=i[0];n.integer(e,o),n.percent(e,o)&&n.set("snapToLines",!1),n.alt(e,o,["auto"]),2===i.length&&n.alt("lineAlign",i[1],["start",ct,"end"]);break;case"position":i=t.split(","),n.percent(e,i[0]),2===i.length&&n.alt("positionAlign",i[1],["start",ct,"end","line-left","line-right","auto"]);break;case"size":n.percent(e,t);break;case"align":n.alt(e,t,["start",ct,"end","left","right"])}}),/:/,/\s/),t.region=n.get("region",null),t.vertical=n.get("vertical","");var a=n.get("line","auto");"auto"===a&&-1===ut.line&&(a=-1),t.line=a,t.lineAlign=n.get("lineAlign","start"),t.snapToLines=n.get("snapToLines",!0),t.size=n.get("size",100),t.align=n.get("align",ct);var i=n.get("position","auto");"auto"===i&&50===ut.position&&(i="start"===t.align||"left"===t.align?0:"end"===t.align||"right"===t.align?100:50),t.position=i}(e,t)}function dt(e){return e.replace(/<br(?: \/)?>/gi,"\n")}it.prototype={parse:function(e){var t=this;function r(){var e=t.buffer,r=0;for(e=dt(e);r<e.length&&"\r"!==e[r]&&"\n"!==e[r];)++r;var n=e.substr(0,r);return"\r"===e[r]&&++r,"\n"===e[r]&&++r,t.buffer=e.substr(r),n}e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));try{var n;if("INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;var a=(n=r()).match(/^()?WEBVTT([ \t].*)?$/);if(!a||!a[0])throw new Error("Malformed WebVTT signature.");t.state="HEADER"}for(var i=!1;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(i?i=!1:n=r(),t.state){case"HEADER":/:/.test(n)?st(n,(function(e,t){}),/:/):n||(t.state="ID");continue;case"NOTE":n||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(n)){t.state="NOTE";break}if(!n)continue;if(t.cue=new nt(0,0,""),t.state="CUE",-1===n.indexOf("--\x3e")){t.cue.id=n;continue}case"CUE":try{lt(n,t.cue,t.regionList)}catch(e){t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":var o=-1!==n.indexOf("--\x3e");if(!n||o&&(i=!0)){t.oncue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}t.cue.text&&(t.cue.text+="\n"),t.cue.text+=n;continue;case"BADCUE":n||(t.state="ID");continue}}}catch(e){"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){try{if(this.buffer+=this.decoder.decode(),(this.cue||"HEADER"===this.state)&&(this.buffer+="\n\n",this.parse()),"INITIAL"===this.state)throw new Error("Malformed WebVTT signature.")}catch(e){throw e}return this.onflush&&this.onflush(),this}};var ft=it;function ht(e,t,r,n){for(var a,i,o,s,u,c=[],l=window.VTTCue||TextTrackCue,d=0;d<n.rows.length;d++)if(o=!0,s=0,u="",!(a=n.rows[d]).isEmpty()){for(var f=0;f<a.chars.length;f++)a.chars[f].uchar.match(/\s/)&&o?s++:(u+=a.chars[f].uchar,o=!1);a.cueStartTime=t,t===r&&(r+=1e-4),i=new l(t,r,dt(u.trim())),s>=16?s--:s++,navigator.userAgent.match(/Firefox\//)?i.line=d+1:i.line=d>7?d-2:d+1,i.align="left",i.position=Math.max(0,Math.min(100,s/32*100)),c.push(i),e&&e.addCue(i)}return c}var pt,gt={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},vt=function(e){var t=e;return gt.hasOwnProperty(e)&&(t=gt[e]),String.fromCharCode(t)},mt={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},yt={17:2,18:4,21:6,22:8,23:10,19:13,20:15},bt={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},St={25:2,26:4,29:6,30:8,31:10,27:13,28:15},Et=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];!function(e){e[e.ERROR=0]="ERROR",e[e.TEXT=1]="TEXT",e[e.WARNING=2]="WARNING",e[e.INFO=2]="INFO",e[e.DEBUG=3]="DEBUG",e[e.DATA=3]="DATA"}(pt||(pt={}));var Tt=function(){function e(){this.time=null,this.verboseLevel=pt.ERROR}return e.prototype.log=function(e,t){this.verboseLevel>=e&&l.b.log(this.time+" ["+e+"] "+t)},e}(),wt=function(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r].toString(16));return t},Ot=function(){function e(e,t,r,n,a){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=e||"white",this.underline=t||!1,this.italics=r||!1,this.background=n||"black",this.flash=a||!1}var t=e.prototype;return t.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},t.setStyles=function(e){for(var t=["foreground","underline","italics","background","flash"],r=0;r<t.length;r++){var n=t[r];e.hasOwnProperty(n)&&(this[n]=e[n])}},t.isDefault=function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},t.equals=function(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash},t.copy=function(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash},t.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},e}(),At=function(){function e(e,t,r,n,a,i){this.uchar=void 0,this.penState=void 0,this.uchar=e||" ",this.penState=new Ot(t,r,n,a,i)}var t=e.prototype;return t.reset=function(){this.uchar=" ",this.penState.reset()},t.setChar=function(e,t){this.uchar=e,this.penState.copy(t)},t.setPenState=function(e){this.penState.copy(e)},t.equals=function(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)},t.copy=function(e){this.uchar=e.uchar,this.penState.copy(e.penState)},t.isEmpty=function(){return" "===this.uchar&&this.penState.isDefault()},e}(),_t=function(){function e(e){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(var t=0;t<100;t++)this.chars.push(new At);this.logger=e,this.pos=0,this.currPenState=new Ot}var t=e.prototype;return t.equals=function(e){for(var t=!0,r=0;r<100;r++)if(!this.chars[r].equals(e.chars[r])){t=!1;break}return t},t.copy=function(e){for(var t=0;t<100;t++)this.chars[t].copy(e.chars[t])},t.isEmpty=function(){for(var e=!0,t=0;t<100;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e},t.setCursor=function(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(pt.DEBUG,"Negative cursor position "+this.pos),this.pos=0):this.pos>100&&(this.logger.log(pt.DEBUG,"Too large cursor position "+this.pos),this.pos=100)},t.moveCursor=function(e){var t=this.pos+e;if(e>1)for(var r=this.pos+1;r<t+1;r++)this.chars[r].setPenState(this.currPenState);this.setCursor(t)},t.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},t.insertChar=function(e){e>=144&&this.backSpace();var t=vt(e);this.pos>=100?this.logger.log(pt.ERROR,"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1))},t.clearFromPos=function(e){var t;for(t=e;t<100;t++)this.chars[t].reset()},t.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},t.clearToEndOfRow=function(){this.clearFromPos(this.pos)},t.getTextString=function(){for(var e=[],t=!0,r=0;r<100;r++){var n=this.chars[r].uchar;" "!==n&&(t=!1),e.push(n)}return t?"":e.join("")},t.setPenStyles=function(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)},e}(),Rt=function(){function e(e){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(var t=0;t<15;t++)this.rows.push(new _t(e));this.logger=e,this.currRow=14,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}var t=e.prototype;return t.reset=function(){for(var e=0;e<15;e++)this.rows[e].clear();this.currRow=14},t.equals=function(e){for(var t=!0,r=0;r<15;r++)if(!this.rows[r].equals(e.rows[r])){t=!1;break}return t},t.copy=function(e){for(var t=0;t<15;t++)this.rows[t].copy(e.rows[t])},t.isEmpty=function(){for(var e=!0,t=0;t<15;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e},t.backSpace=function(){this.rows[this.currRow].backSpace()},t.clearToEndOfRow=function(){this.rows[this.currRow].clearToEndOfRow()},t.insertChar=function(e){this.rows[this.currRow].insertChar(e)},t.setPen=function(e){this.rows[this.currRow].setPenStyles(e)},t.moveCursor=function(e){this.rows[this.currRow].moveCursor(e)},t.setCursor=function(e){this.logger.log(pt.INFO,"setCursor: "+e),this.rows[this.currRow].setCursor(e)},t.setPAC=function(e){this.logger.log(pt.INFO,"pacData = "+JSON.stringify(e));var t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(var r=0;r<15;r++)this.rows[r].clear();var n=this.currRow+1-this.nrRollUpRows,a=this.lastOutputScreen;if(a){var i=a.rows[n].cueStartTime,o=this.logger.time;if(i&&null!==o&&i<o)for(var s=0;s<this.nrRollUpRows;s++)this.rows[t-this.nrRollUpRows+s+1].copy(a.rows[n+s])}}this.currRow=t;var u=this.rows[this.currRow];if(null!==e.indent){var c=e.indent,l=Math.max(c-1,0);u.setCursor(e.indent),e.color=u.chars[l].penState.foreground}var d={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(d)},t.setBkgData=function(e){this.logger.log(pt.INFO,"bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)},t.setRollUpRows=function(e){this.nrRollUpRows=e},t.rollUp=function(){if(null!==this.nrRollUpRows){this.logger.log(pt.TEXT,this.getDisplayText());var e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(pt.INFO,"Rolling up")}else this.logger.log(pt.DEBUG,"roll_up but nrRollUpRows not set yet")},t.getDisplayText=function(e){e=e||!1;for(var t=[],r="",n=-1,a=0;a<15;a++){var i=this.rows[a].getTextString();i&&(n=a+1,e?t.push("Row "+n+": '"+i+"'"):t.push(i.trim()))}return t.length>0&&(r=e?"["+t.join(" | ")+"]":t.join("\n")),r},t.getTextAndFormat=function(){return this.rows},e}(),kt=function(){function e(e,t,r){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new Rt(r),this.nonDisplayedMemory=new Rt(r),this.lastOutputScreen=new Rt(r),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=r}var t=e.prototype;return t.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null},t.getHandler=function(){return this.outputFilter},t.setHandler=function(e){this.outputFilter=e},t.setPAC=function(e){this.writeScreen.setPAC(e)},t.setBkgData=function(e){this.writeScreen.setBkgData(e)},t.setMode=function(e){e!==this.mode&&(this.mode=e,this.logger.log(pt.INFO,"MODE="+e),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)},t.insertChars=function(e){for(var t=0;t<e.length;t++)this.writeScreen.insertChar(e[t]);var r=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(pt.INFO,r+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(this.logger.log(pt.TEXT,"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},t.ccRCL=function(){this.logger.log(pt.INFO,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},t.ccBS=function(){this.logger.log(pt.INFO,"BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},t.ccAOF=function(){},t.ccAON=function(){},t.ccDER=function(){this.logger.log(pt.INFO,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},t.ccRU=function(e){this.logger.log(pt.INFO,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)},t.ccFON=function(){this.logger.log(pt.INFO,"FON - Flash On"),this.writeScreen.setPen({flash:!0})},t.ccRDC=function(){this.logger.log(pt.INFO,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},t.ccTR=function(){this.logger.log(pt.INFO,"TR"),this.setMode("MODE_TEXT")},t.ccRTD=function(){this.logger.log(pt.INFO,"RTD"),this.setMode("MODE_TEXT")},t.ccEDM=function(){this.logger.log(pt.INFO,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},t.ccCR=function(){this.logger.log(pt.INFO,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},t.ccENM=function(){this.logger.log(pt.INFO,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},t.ccEOC=function(){if(this.logger.log(pt.INFO,"EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(pt.TEXT,"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)},t.ccTO=function(e){this.logger.log(pt.INFO,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)},t.ccMIDROW=function(e){var t={flash:!1};if(t.underline=e%2==1,t.italics=e>=46,t.italics)t.foreground="white";else{var r=Math.floor(e/2)-16;t.foreground=["white","green","blue","cyan","red","yellow","magenta"][r]}this.logger.log(pt.INFO,"MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)},t.outputDataUpdate=function(e){void 0===e&&(e=!1);var t=this.logger.time;null!==t&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t):this.cueStartTime=t,this.lastOutputScreen.copy(this.displayedMemory))},t.cueSplitAtTime=function(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))},e}();function Pt(e,t,r){r.a=e,r.b=t}function Ct(e,t,r){return r.a===e&&r.b===t}var Lt=function(){function e(e,t,r){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;var n=new Tt;this.channels=[null,new kt(e,t,n),new kt(e+1,r,n)],this.cmdHistory={a:null,b:null},this.logger=n}var t=e.prototype;return t.getHandler=function(e){return this.channels[e].getHandler()},t.setHandler=function(e,t){this.channels[e].setHandler(t)},t.addData=function(e,t){var r,n,a,i=!1;this.logger.time=e;for(var o=0;o<t.length;o+=2)if(n=127&t[o],a=127&t[o+1],0!==n||0!==a){if(this.logger.log(pt.DATA,"["+wt([t[o],t[o+1]])+"] -> ("+wt([n,a])+")"),(r=this.parseCmd(n,a))||(r=this.parseMidrow(n,a)),r||(r=this.parsePAC(n,a)),r||(r=this.parseBackgroundAttributes(n,a)),!r&&(i=this.parseChars(n,a))){var s=this.currentChannel;s&&s>0?this.channels[s].insertChars(i):this.logger.log(pt.WARNING,"No channel found yet. TEXT-MODE?")}r||i||this.logger.log(pt.WARNING,"Couldn't parse cleaned data "+wt([n,a])+" orig: "+wt([t[o],t[o+1]]))}},t.parseCmd=function(e,t){var r=this.cmdHistory;if(!((20===e||28===e||21===e||29===e)&&t>=32&&t<=47||(23===e||31===e)&&t>=33&&t<=35))return!1;if(Ct(e,t,r))return Pt(null,null,r),this.logger.log(pt.DEBUG,"Repeated command ("+wt([e,t])+") is dropped"),!0;var n=20===e||21===e||23===e?1:2,a=this.channels[n];return 20===e||21===e||28===e||29===e?32===t?a.ccRCL():33===t?a.ccBS():34===t?a.ccAOF():35===t?a.ccAON():36===t?a.ccDER():37===t?a.ccRU(2):38===t?a.ccRU(3):39===t?a.ccRU(4):40===t?a.ccFON():41===t?a.ccRDC():42===t?a.ccTR():43===t?a.ccRTD():44===t?a.ccEDM():45===t?a.ccCR():46===t?a.ccENM():47===t&&a.ccEOC():a.ccTO(t-32),Pt(e,t,r),this.currentChannel=n,!0},t.parseMidrow=function(e,t){var r=0;if((17===e||25===e)&&t>=32&&t<=47){if((r=17===e?1:2)!==this.currentChannel)return this.logger.log(pt.ERROR,"Mismatch channel in midrow parsing"),!1;var n=this.channels[r];return!!n&&(n.ccMIDROW(t),this.logger.log(pt.DEBUG,"MIDROW ("+wt([e,t])+")"),!0)}return!1},t.parsePAC=function(e,t){var r,n=this.cmdHistory;if(!((e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127||(16===e||24===e)&&t>=64&&t<=95))return!1;if(Ct(e,t,n))return Pt(null,null,n),!0;var a=e<=23?1:2;r=t>=64&&t<=95?1===a?mt[e]:bt[e]:1===a?yt[e]:St[e];var i=this.channels[a];return!!i&&(i.setPAC(this.interpretPAC(r,t)),Pt(e,t,n),this.currentChannel=a,!0)},t.interpretPAC=function(e,t){var r,n={color:null,italics:!1,indent:null,underline:!1,row:e};return r=t>95?t-96:t-64,n.underline=1==(1&r),r<=13?n.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(r/2)]:r<=15?(n.italics=!0,n.color="white"):n.indent=4*Math.floor((r-16)/2),n},t.parseChars=function(e,t){var r,n=null,a=null;if(e>=25?(r=2,a=e-8):(r=1,a=e),a>=17&&a<=19){var i;i=17===a?t+80:18===a?t+112:t+144,this.logger.log(pt.INFO,"Special char '"+vt(i)+"' in channel "+r),n=[i]}else e>=32&&e<=127&&(n=0===t?[e]:[e,t]);if(n){var o=wt(n);this.logger.log(pt.DEBUG,"Char codes =  "+o.join(",")),Pt(e,t,this.cmdHistory)}return n},t.parseBackgroundAttributes=function(e,t){var r;if(!((16===e||24===e)&&t>=32&&t<=47||(23===e||31===e)&&t>=45&&t<=47))return!1;var n={};16===e||24===e?(r=Math.floor((t-32)/2),n.background=Et[r],t%2==1&&(n.background=n.background+"_semi")):45===t?n.background="transparent":(n.foreground="black",47===t&&(n.underline=!0));var a=e<=23?1:2;return this.channels[a].setBkgData(n),Pt(e,t,this.cmdHistory),!0},t.reset=function(){for(var e=0;e<Object.keys(this.channels).length;e++){var t=this.channels[e];t&&t.reset()}this.cmdHistory={a:null,b:null}},t.cueSplitAtTime=function(e){for(var t=0;t<this.channels.length;t++){var r=this.channels[t];r&&r.cueSplitAtTime(e)}},e}(),Dt=function(){function e(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}var t=e.prototype;return t.dispatchCue=function(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)},t.newCue=function(e,t,r){(null===this.startTime||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=r,this.timelineController.createCaptionsTrack(this.trackName)},t.reset=function(){this.cueRanges=[]},e}(),It=function(e,t,r){return e.substr(r||0,t.length)===t},xt=function(e){for(var t=5381,r=e.length;r;)t=33*t^e.charCodeAt(--r);return(t>>>0).toString()},Mt=function(e,t,r,n,a,i){var o,s=Object(Ue.b)(new Uint8Array(e)).trim().replace(/\r\n|\n\r|\n|\r/g,"\n").split("\n"),c="00:00.000",l=0,d=0,f=0,h=[],p=!0,g=!1,v=new ft;v.oncue=function(e){var t=r[n],a=r.ccOffset;t&&t.new&&(void 0!==d?a=r.ccOffset=t.start:function(e,t,r){var n=e[t],a=e[n.prevCC];if(!a||!a.new&&n.new)return e.ccOffset=e.presentationOffset=n.start,void(n.new=!1);for(;a&&a.new;)e.ccOffset+=n.start-a.start,n.new=!1,a=e[(n=a).prevCC];e.presentationOffset=r}(r,n,f)),f&&(a=f-r.presentationOffset),g&&(e.startTime+=a-d,e.endTime+=a-d),e.id=xt(e.startTime.toString())+xt(e.endTime.toString())+xt(e.text),e.text=decodeURIComponent(encodeURIComponent(e.text)),e.endTime>0&&h.push(e)},v.onparsingerror=function(e){o=e},v.onflush=function(){o&&i?i(o):a(h)},s.forEach((function(e){if(p){if(It(e,"X-TIMESTAMP-MAP=")){p=!1,g=!0,e.substr(16).split(",").forEach((function(e){It(e,"LOCAL:")?c=e.substr(6):It(e,"MPEGTS:")&&(l=parseInt(e.substr(7)))}));try{t+(9e4*r[n].start||0)<0&&(t+=8589934592),l-=t,d=function(e){var t=parseInt(e.substr(-3)),r=parseInt(e.substr(-6,2)),n=parseInt(e.substr(-9,2)),a=e.length>9?parseInt(e.substr(0,e.indexOf(":"))):0;if(!(Object(u.a)(t)&&Object(u.a)(r)&&Object(u.a)(n)&&Object(u.a)(a)))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+e);return t+=1e3*r,(t+=6e4*n)+36e5*a}(c)/1e3,f=l/9e4}catch(e){g=!1,o=e}return}""===e&&(p=!1)}v.parse(e+"\n")})),v.flush()};function Ut(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jt(e,t){return e&&e.label===t.name&&!(e.textTrack1||e.textTrack2)}var Ft=function(e){var t,r;function n(t){var r;if((r=e.call(this,t,c.a.MEDIA_ATTACHING,c.a.MEDIA_DETACHING,c.a.FRAG_PARSING_USERDATA,c.a.FRAG_DECRYPTED,c.a.MANIFEST_LOADING,c.a.MANIFEST_LOADED,c.a.FRAG_LOADED,c.a.INIT_PTS_FOUND)||this).media=null,r.config=void 0,r.enabled=!0,r.Cues=void 0,r.textTracks=[],r.tracks=[],r.initPTS=[],r.unparsedVttFrags=[],r.captionsTracks={},r.nonNativeCaptionsTracks={},r.captionsProperties=void 0,r.cea608Parser1=void 0,r.cea608Parser2=void 0,r.lastSn=-1,r.prevCC=-1,r.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!1}},r.hls=t,r.config=t.config,r.Cues=t.config.cueHandler,r.captionsProperties={textTrack1:{label:r.config.captionsTextTrack1Label,languageCode:r.config.captionsTextTrack1LanguageCode},textTrack2:{label:r.config.captionsTextTrack2Label,languageCode:r.config.captionsTextTrack2LanguageCode},textTrack3:{label:r.config.captionsTextTrack3Label,languageCode:r.config.captionsTextTrack3LanguageCode},textTrack4:{label:r.config.captionsTextTrack4Label,languageCode:r.config.captionsTextTrack4LanguageCode}},r.config.enableCEA708Captions){var n=new Dt(Ut(r),"textTrack1"),a=new Dt(Ut(r),"textTrack2"),i=new Dt(Ut(r),"textTrack3"),o=new Dt(Ut(r),"textTrack4");r.cea608Parser1=new Lt(1,n,a),r.cea608Parser2=new Lt(3,i,o)}return r}r=e,(t=n).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var a=n.prototype;return a.addCues=function(e,t,r,n,a){for(var i,o,s,u,l=!1,d=a.length;d--;){var f=a[d],h=(i=f[0],o=f[1],s=t,u=r,Math.min(o,u)-Math.max(i,s));if(h>=0&&(f[0]=Math.min(f[0],t),f[1]=Math.max(f[1],r),l=!0,h/(r-t)>.5))return}if(l||a.push([t,r]),this.config.renderTextTracksNatively)this.Cues.newCue(this.captionsTracks[e],t,r,n);else{var p=this.Cues.newCue(null,t,r,n);this.hls.trigger(c.a.CUES_PARSED,{type:"captions",cues:p,track:e})}},a.onInitPtsFound=function(e){var t=this,r=e.frag,n=e.id,a=e.initPTS,i=this.unparsedVttFrags;"main"===n&&(this.initPTS[r.cc]=a),i.length&&(this.unparsedVttFrags=[],i.forEach((function(e){t.onFragLoaded(e)})))},a.getExistingTrack=function(e){var t=this.media;if(t)for(var r=0;r<t.textTracks.length;r++){var n=t.textTracks[r];if(n[e])return n}return null},a.createCaptionsTrack=function(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)},a.createNativeTrack=function(e){if(!this.captionsTracks[e]){var t=this.captionsProperties,r=this.captionsTracks,n=this.media,a=t[e],i=a.label,o=a.languageCode,s=this.getExistingTrack(e);if(s)r[e]=s,Fe(r[e]),je(r[e],n);else{var u=this.createTextTrack("captions",i,o);u&&(u[e]=!0,r[e]=u)}}},a.createNonNativeTrack=function(e){if(!this.nonNativeCaptionsTracks[e]){var t=this.captionsProperties[e];if(t){var r={_id:e,label:t.label,kind:"captions",default:!!t.media&&!!t.media.default,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=r,this.hls.trigger(c.a.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[r]})}}},a.createTextTrack=function(e,t,r){var n=this.media;if(n)return n.addTextTrack(e,t,r)},a.destroy=function(){e.prototype.destroy.call(this)},a.onMediaAttaching=function(e){this.media=e.media,this._cleanTracks()},a.onMediaDetaching=function(){var e=this.captionsTracks;Object.keys(e).forEach((function(t){Fe(e[t]),delete e[t]})),this.nonNativeCaptionsTracks={}},a.onManifestLoading=function(){this.lastSn=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!1}},this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={}},a._cleanTracks=function(){var e=this.media;if(e){var t=e.textTracks;if(t)for(var r=0;r<t.length;r++)Fe(t[r])}},a.onManifestLoaded=function(e){var t=this;if(this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset()),this.config.enableWebVTT){var r=e.subtitles||[],n=this.tracks&&r&&this.tracks.length===r.length;if(this.tracks=e.subtitles||[],this.config.renderTextTracksNatively){var a=this.media?this.media.textTracks:[];this.tracks.forEach((function(e,r){var n;if(r<a.length){for(var i=null,o=0;o<a.length;o++)if(jt(a[o],e)){i=a[o];break}i&&(n=i)}n||(n=t.createTextTrack("subtitles",e.name,e.lang)),e.default?n.mode=t.hls.subtitleDisplay?"showing":"hidden":n.mode="disabled",t.textTracks.push(n)}))}else if(!n&&this.tracks&&this.tracks.length){var i=this.tracks.map((function(e){return{label:e.name,kind:e.type.toLowerCase(),default:e.default,subtitleTrack:e}}));this.hls.trigger(c.a.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:i})}}this.config.enableCEA708Captions&&e.captions&&e.captions.forEach((function(e){var r=/(?:CC|SERVICE)([1-4])/.exec(e.instreamId);if(r){var n="textTrack"+r[1],a=t.captionsProperties[n];a&&(a.label=e.name,e.lang&&(a.languageCode=e.lang),a.media=e)}}))},a.onFragLoaded=function(e){var t=e.frag,r=e.payload,n=this.cea608Parser1,a=this.cea608Parser2,i=this.initPTS,o=this.lastSn,s=this.unparsedVttFrags;if("main"===t.type){var l=t.sn;t.sn!==o+1&&n&&a&&(n.reset(),a.reset()),this.lastSn=l}else if("subtitle"===t.type)if(r.byteLength){if(!Object(u.a)(i[t.cc]))return s.push(e),void(i.length&&this.hls.trigger(c.a.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t}));var d=t.decryptdata;null!=d&&null!=d.key&&"AES-128"===d.method||this._parseVTTs(t,r)}else this.hls.trigger(c.a.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t})},a._parseVTTs=function(e,t){var r=this,n=this.hls,a=this.prevCC,i=this.textTracks,o=this.vttCCs;o[e.cc]||(o[e.cc]={start:e.start,prevCC:a,new:!0},this.prevCC=e.cc),Mt(t,this.initPTS[e.cc],o,e.cc,(function(t){if(r.config.renderTextTracksNatively){var a=i[e.level];if("disabled"===a.mode)return void n.trigger(c.a.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e});t.forEach((function(e){if(!a.cues.getCueById(e.id))try{if(a.addCue(e),!a.cues.getCueById(e.id))throw new Error("addCue is failed for: "+e)}catch(r){l.b.debug("Failed occurred on adding cues: "+r);var t=new window.TextTrackCue(e.startTime,e.endTime,e.text);t.id=e.id,a.addCue(t)}}))}else{var o=r.tracks[e.level].default?"default":"subtitles"+e.level;n.trigger(c.a.CUES_PARSED,{type:"subtitles",cues:t,track:o})}n.trigger(c.a.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})}),(function(t){l.b.log("Failed to parse VTT cue: "+t),n.trigger(c.a.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e})}))},a.onFragDecrypted=function(e){var t=e.frag,r=e.payload;if("subtitle"===t.type){if(!Object(u.a)(this.initPTS[t.cc]))return void this.unparsedVttFrags.push(e);this._parseVTTs(t,r)}},a.onFragParsingUserdata=function(e){var t=this.cea608Parser1,r=this.cea608Parser2;if(this.enabled&&t&&r)for(var n=0;n<e.samples.length;n++){var a=e.samples[n].bytes;if(a){var i=this.extractCea608Data(a);t.addData(e.samples[n].pts,i[0]),r.addData(e.samples[n].pts,i[1])}}},a.extractCea608Data=function(e){for(var t=31&e[0],r=2,n=[[],[]],a=0;a<t;a++){var i=e[r++],o=127&e[r++],s=127&e[r++],u=3&i;0===o&&0===s||0!=(4&i)&&(0!==u&&1!==u||(n[u].push(o),n[u].push(s)))}return n},n}(f);function Nt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Bt(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];"subtitles"===n.kind&&n.label&&t.push(e[r])}return t}var Gt,Vt=function(e){var t,r;function n(t){var r;return(r=e.call(this,t,c.a.MEDIA_ATTACHED,c.a.MEDIA_DETACHING,c.a.MANIFEST_LOADED,c.a.SUBTITLE_TRACK_LOADED)||this).tracks=[],r.trackId=-1,r.media=null,r.stopped=!0,r.subtitleDisplay=!0,r.queuedDefaultTrack=null,r}r=e,(t=n).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var a,i,o=n.prototype;return o.destroy=function(){f.prototype.destroy.call(this)},o.onMediaAttached=function(e){var t=this;this.media=e.media,this.media&&(Object(u.a)(this.queuedDefaultTrack)&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=null),this.trackChangeListener=this._onTextTracksChanged.bind(this),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.subtitlePollingInterval=setInterval((function(){t.trackChangeListener()}),500):this.media.textTracks.addEventListener("change",this.trackChangeListener))},o.onMediaDetaching=function(){this.media&&(this.useTextTrackPolling?clearInterval(this.subtitlePollingInterval):this.media.textTracks.removeEventListener("change",this.trackChangeListener),Object(u.a)(this.subtitleTrack)&&(this.queuedDefaultTrack=this.subtitleTrack),Bt(this.media.textTracks).forEach((function(e){Fe(e)})),this.subtitleTrack=-1,this.media=null)},o.onManifestLoaded=function(e){var t=this,r=e.subtitles||[];this.tracks=r,this.hls.trigger(c.a.SUBTITLE_TRACKS_UPDATED,{subtitleTracks:r}),r.forEach((function(e){e.default&&(t.media?t.subtitleTrack=e.id:t.queuedDefaultTrack=e.id)}))},o.onSubtitleTrackLoaded=function(e){var t=this,r=e.id,n=e.details,a=this.trackId,i=this.tracks,o=i[a];if(r>=i.length||r!==a||!o||this.stopped)this._clearReloadTimer();else if(l.b.log("subtitle track "+r+" loaded"),n.live){var s=ae(o.details,n,e.stats.trequest);l.b.log("Reloading live subtitle playlist in "+s+"ms"),this.timer=setTimeout((function(){t._loadCurrentTrack()}),s)}else this._clearReloadTimer()},o.startLoad=function(){this.stopped=!1,this._loadCurrentTrack()},o.stopLoad=function(){this.stopped=!0,this._clearReloadTimer()},o._clearReloadTimer=function(){this.timer&&(clearTimeout(this.timer),this.timer=null)},o._loadCurrentTrack=function(){var e=this.trackId,t=this.tracks,r=this.hls,n=t[e];e<0||!n||n.details&&!n.details.live||(l.b.log("Loading subtitle track "+e),r.trigger(c.a.SUBTITLE_TRACK_LOADING,{url:n.url,id:e}))},o._toggleTrackModes=function(e){var t=this.media,r=this.subtitleDisplay,n=this.trackId;if(t){var a=Bt(t.textTracks);if(-1===e)[].slice.call(a).forEach((function(e){e.mode="disabled"}));else{var i=a[n];i&&(i.mode="disabled")}var o=a[e];o&&(o.mode=r?"showing":"hidden")}},o._setSubtitleTrackInternal=function(e){var t=this.hls,r=this.tracks;!Object(u.a)(e)||e<-1||e>=r.length||(this.trackId=e,l.b.log("Switching to subtitle track "+e),t.trigger(c.a.SUBTITLE_TRACK_SWITCH,{id:e}),this._loadCurrentTrack())},o._onTextTracksChanged=function(){if(this.media&&this.hls.config.renderTextTracksNatively){for(var e=-1,t=Bt(this.media.textTracks),r=0;r<t.length;r++)if("hidden"===t[r].mode)e=r;else if("showing"===t[r].mode){e=r;break}this.subtitleTrack=e}},a=n,(i=[{key:"subtitleTracks",get:function(){return this.tracks}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(e){this.trackId!==e&&(this._toggleTrackModes(e),this._setSubtitleTrackInternal(e))}}])&&Nt(a.prototype,i),n}(f),Kt=r(7),Ht=window.performance,Zt=function(e){var t,r;function n(t,r){var n;return(n=e.call(this,t,c.a.MEDIA_ATTACHED,c.a.MEDIA_DETACHING,c.a.ERROR,c.a.KEY_LOADED,c.a.FRAG_LOADED,c.a.SUBTITLE_TRACKS_UPDATED,c.a.SUBTITLE_TRACK_SWITCH,c.a.SUBTITLE_TRACK_LOADED,c.a.SUBTITLE_FRAG_PROCESSED,c.a.LEVEL_UPDATED)||this).fragmentTracker=r,n.config=t.config,n.state=ge,n.tracks=[],n.tracksBuffered=[],n.currentTrackId=-1,n.decrypter=new Kt.a(t,t.config),n.lastAVStart=0,n._onMediaSeeking=n.onMediaSeeking.bind(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(n)),n}r=e,(t=n).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var a=n.prototype;return a.startLoad=function(){this.stopLoad(),this.state=me;var e=this.tracks[this.currentTrackId];e&&e.details&&(this.setInterval(500),this.tick())},a.onSubtitleFragProcessed=function(e){var t=e.frag,r=e.success;if(this.fragPrevious=t,this.state=me,r){var n=this.tracksBuffered[this.currentTrackId];if(n){for(var a,i=t.start,o=0;o<n.length;o++)if(i>=n[o].start&&i<=n[o].end){a=n[o];break}var s=t.start+t.duration;a?a.end=s:(a={start:i,end:s},n.push(a))}}},a.onMediaAttached=function(e){var t=e.media;this.media=t,t.addEventListener("seeking",this._onMediaSeeking),this.state=me},a.onMediaDetaching=function(){var e=this;this.media&&(this.media.removeEventListener("seeking",this._onMediaSeeking),this.fragmentTracker.removeAllFragments(),this.currentTrackId=-1,this.tracks.forEach((function(t){e.tracksBuffered[t.id]=[]})),this.media=null,this.state=ge)},a.onError=function(e){var t=e.frag;t&&"subtitle"===t.type&&(this.fragCurrent&&this.fragCurrent.loader&&this.fragCurrent.loader.abort(),this.state=me)},a.onSubtitleTracksUpdated=function(e){var t=this;l.b.log("subtitle tracks updated"),this.tracksBuffered=[],this.tracks=e.subtitleTracks,this.tracks.forEach((function(e){t.tracksBuffered[e.id]=[]}))},a.onSubtitleTrackSwitch=function(e){if(this.currentTrackId=e.id,this.tracks&&this.tracks.length&&-1!==this.currentTrackId){var t=this.tracks[this.currentTrackId];t&&t.details&&this.setInterval(500)}else this.clearInterval()},a.onSubtitleTrackLoaded=function(e){var t=e.id,r=e.details,n=this.currentTrackId,a=this.tracks,i=a[n];t>=a.length||t!==n||!i||(r.live&&function(e,t,r){void 0===r&&(r=0);var n=-1;ne(e,t,(function(e,t,r){t.start=e.start,n=r}));var a=t.fragments;if(n<0)a.forEach((function(e){e.start+=r}));else for(var i=n+1;i<a.length;i++)a[i].start=a[i-1].start+a[i-1].duration}(i.details,r,this.lastAVStart),i.details=r,this.setInterval(500))},a.onKeyLoaded=function(){this.state===be&&(this.state=me)},a.onFragLoaded=function(e){var t=this.fragCurrent,r=e.frag.decryptdata,n=e.frag,a=this.hls;if(this.state===Se&&t&&"subtitle"===e.frag.type&&t.sn===e.frag.sn&&e.payload.byteLength>0&&r&&r.key&&"AES-128"===r.method){var i=Ht.now();this.decrypter.decrypt(e.payload,r.key.buffer,r.iv.buffer,(function(e){var t=Ht.now();a.trigger(c.a.FRAG_DECRYPTED,{frag:n,payload:e,stats:{tstart:i,tdecrypt:t}})}))}},a.onLevelUpdated=function(e){var t=e.details.fragments;this.lastAVStart=t.length?t[0].start:0},a.doTick=function(){if(this.media)switch(this.state){case me:var e=this.config,t=this.currentTrackId,r=this.fragmentTracker,n=this.media,a=this.tracks;if(!a||!a[t]||!a[t].details)break;var i,o=e.maxBufferHole,s=e.maxFragLookUpTolerance,u=Math.min(e.maxBufferLength,e.maxMaxBufferLength),d=K.bufferedInfo(this._getBuffered(),n.currentTime,o),f=d.end,h=d.len,p=a[t].details,g=p.fragments,v=g.length,m=g[v-1].start+g[v-1].duration;if(h>u)return;var y=this.fragPrevious;f<m?(y&&p.hasProgramDateTime&&(i=ue(g,y.endProgramDateTime,s)),i||(i=ce(y,g,f,s))):i=g[v-1],i&&i.encrypted?(l.b.log("Loading key for "+i.sn),this.state=be,this.hls.trigger(c.a.KEY_LOADING,{frag:i})):i&&r.getState(i)===j&&(this.fragCurrent=i,this.state=Se,this.hls.trigger(c.a.FRAG_LOADING,{frag:i}))}else this.state=me},a.stopLoad=function(){this.lastAVStart=0,this.fragPrevious=null,e.prototype.stopLoad.call(this)},a._getBuffered=function(){return this.tracksBuffered[this.currentTrackId]||[]},a.onMediaSeeking=function(){if(this.fragCurrent){var e=this.media?this.media.currentTime:0,t=this.config.maxFragLookUpTolerance,r=this.fragCurrent.start-t,n=this.fragCurrent.start+this.fragCurrent.duration+t;(e<r||e>n)&&(this.fragCurrent.loader&&this.fragCurrent.loader.abort(),this.fragmentTracker.removeFragment(this.fragCurrent),this.fragCurrent=null,this.fragPrevious=null,this.state=me,this.tick())}},n}(Ce);!function(e){e.WIDEVINE="com.widevine.alpha",e.PLAYREADY="com.microsoft.playready"}(Gt||(Gt={}));var Yt="undefined"!=typeof window&&window.navigator&&window.navigator.requestMediaKeySystemAccess?window.navigator.requestMediaKeySystemAccess.bind(window.navigator):null;function qt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Wt=function(e){var t,r;function n(t){var r;return(r=e.call(this,t,c.a.MEDIA_ATTACHED,c.a.MEDIA_DETACHED,c.a.MANIFEST_PARSED)||this)._widevineLicenseUrl=void 0,r._licenseXhrSetup=void 0,r._emeEnabled=void 0,r._requestMediaKeySystemAccess=void 0,r._drmSystemOptions=void 0,r._config=void 0,r._mediaKeysList=[],r._media=null,r._hasSetMediaKeys=!1,r._requestLicenseFailureCount=0,r.mediaKeysPromise=null,r._onMediaEncrypted=function(e){if(l.b.log('Media is encrypted using "'+e.initDataType+'" init data type'),!r.mediaKeysPromise)return l.b.error("Fatal: Media is encrypted but no CDM access or no keys have been requested"),void r.hls.trigger(c.a.ERROR,{type:s.b.KEY_SYSTEM_ERROR,details:s.a.KEY_SYSTEM_NO_KEYS,fatal:!0});var t=function(t){r._media&&(r._attemptSetMediaKeys(t),r._generateRequestWithPreferredKeySession(e.initDataType,e.initData))};r.mediaKeysPromise.then(t).catch(t)},r._config=t.config,r._widevineLicenseUrl=r._config.widevineLicenseUrl,r._licenseXhrSetup=r._config.licenseXhrSetup,r._emeEnabled=r._config.emeEnabled,r._requestMediaKeySystemAccess=r._config.requestMediaKeySystemAccessFunc,r._drmSystemOptions=t.config.drmSystemOptions,r}r=e,(t=n).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var a,i,o=n.prototype;return o.getLicenseServerUrl=function(e){switch(e){case Gt.WIDEVINE:if(!this._widevineLicenseUrl)break;return this._widevineLicenseUrl}throw new Error('no license server URL configured for key-system "'+e+'"')},o._attemptKeySystemAccess=function(e,t,r){var n=this,a=function(e,t,r,n){if(e===Gt.WIDEVINE)return function(e,t,r){var n={audioCapabilities:[],videoCapabilities:[]};return e.forEach((function(e){n.audioCapabilities.push({contentType:'audio/mp4; codecs="'+e+'"',robustness:r.audioRobustness||""})})),t.forEach((function(e){n.videoCapabilities.push({contentType:'video/mp4; codecs="'+e+'"',robustness:r.videoRobustness||""})})),[n]}(t,r,n);throw new Error("Unknown key-system: "+e)}(e,t,r,this._drmSystemOptions);l.b.log("Requesting encrypted media key-system access");var i=this.requestMediaKeySystemAccess(e,a);this.mediaKeysPromise=i.then((function(t){return n._onMediaKeySystemAccessObtained(e,t)})),i.catch((function(t){l.b.error('Failed to obtain key-system "'+e+'" access:',t)}))},o._onMediaKeySystemAccessObtained=function(e,t){var r=this;l.b.log('Access for key-system "'+e+'" obtained');var n={mediaKeysSessionInitialized:!1,mediaKeySystemAccess:t,mediaKeySystemDomain:e};this._mediaKeysList.push(n);var a=Promise.resolve().then((function(){return t.createMediaKeys()})).then((function(t){return n.mediaKeys=t,l.b.log('Media-keys created for key-system "'+e+'"'),r._onMediaKeysCreated(),t}));return a.catch((function(e){l.b.error("Failed to create media-keys:",e)})),a},o._onMediaKeysCreated=function(){var e=this;this._mediaKeysList.forEach((function(t){t.mediaKeysSession||(t.mediaKeysSession=t.mediaKeys.createSession(),e._onNewMediaKeySession(t.mediaKeysSession))}))},o._onNewMediaKeySession=function(e){var t=this;l.b.log("New key-system session "+e.sessionId),e.addEventListener("message",(function(r){t._onKeySessionMessage(e,r.message)}),!1)},o._onKeySessionMessage=function(e,t){l.b.log("Got EME message event, creating license request"),this._requestLicense(t,(function(t){l.b.log("Received license data (length: "+(t?t.byteLength:t)+"), updating key-session"),e.update(t)}))},o._attemptSetMediaKeys=function(e){if(!this._media)throw new Error("Attempted to set mediaKeys without first attaching a media element");if(!this._hasSetMediaKeys){var t=this._mediaKeysList[0];if(!t||!t.mediaKeys)return l.b.error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet"),void this.hls.trigger(c.a.ERROR,{type:s.b.KEY_SYSTEM_ERROR,details:s.a.KEY_SYSTEM_NO_KEYS,fatal:!0});l.b.log("Setting keys for encrypted media"),this._media.setMediaKeys(t.mediaKeys),this._hasSetMediaKeys=!0}},o._generateRequestWithPreferredKeySession=function(e,t){var r=this,n=this._mediaKeysList[0];if(!n)return l.b.error("Fatal: Media is encrypted but not any key-system access has been obtained yet"),void this.hls.trigger(c.a.ERROR,{type:s.b.KEY_SYSTEM_ERROR,details:s.a.KEY_SYSTEM_NO_ACCESS,fatal:!0});if(n.mediaKeysSessionInitialized)l.b.warn("Key-Session already initialized but requested again");else{var a=n.mediaKeysSession;if(!a)return l.b.error("Fatal: Media is encrypted but no key-session existing"),void this.hls.trigger(c.a.ERROR,{type:s.b.KEY_SYSTEM_ERROR,details:s.a.KEY_SYSTEM_NO_SESSION,fatal:!0});if(!t)return l.b.warn("Fatal: initData required for generating a key session is null"),void this.hls.trigger(c.a.ERROR,{type:s.b.KEY_SYSTEM_ERROR,details:s.a.KEY_SYSTEM_NO_INIT_DATA,fatal:!0});l.b.log('Generating key-session request for "'+e+'" init data type'),n.mediaKeysSessionInitialized=!0,a.generateRequest(e,t).then((function(){l.b.debug("Key-session generation succeeded")})).catch((function(e){l.b.error("Error generating key-session request:",e),r.hls.trigger(c.a.ERROR,{type:s.b.KEY_SYSTEM_ERROR,details:s.a.KEY_SYSTEM_NO_SESSION,fatal:!1})}))}},o._createLicenseXhr=function(e,t,r){var n=new XMLHttpRequest,a=this._licenseXhrSetup;try{if(a)try{a(n,e)}catch(t){n.open("POST",e,!0),a(n,e)}n.readyState||n.open("POST",e,!0)}catch(e){throw new Error("issue setting up KeySystem license XHR "+e)}return n.responseType="arraybuffer",n.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,n,e,t,r),n},o._onLicenseRequestReadyStageChange=function(e,t,r,n){if(4===e.readyState)if(200===e.status)this._requestLicenseFailureCount=0,l.b.log("License request succeeded"),"arraybuffer"!==e.responseType&&l.b.warn("xhr response type was not set to the expected arraybuffer for license request"),n(e.response);else{if(l.b.error("License Request XHR failed ("+t+"). Status: "+e.status+" ("+e.statusText+")"),this._requestLicenseFailureCount++,this._requestLicenseFailureCount>3)return void this.hls.trigger(c.a.ERROR,{type:s.b.KEY_SYSTEM_ERROR,details:s.a.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0});var a=3-this._requestLicenseFailureCount+1;l.b.warn("Retrying license request, "+a+" attempts left"),this._requestLicense(r,n)}},o._generateLicenseRequestChallenge=function(e,t){if(e.mediaKeySystemDomain===Gt.WIDEVINE)return t;throw new Error("unsupported key-system: "+e.mediaKeySystemDomain)},o._requestLicense=function(e,t){l.b.log("Requesting content license for key-system");var r=this._mediaKeysList[0];if(!r)return l.b.error("Fatal error: Media is encrypted but no key-system access has been obtained yet"),void this.hls.trigger(c.a.ERROR,{type:s.b.KEY_SYSTEM_ERROR,details:s.a.KEY_SYSTEM_NO_ACCESS,fatal:!0});try{var n=this.getLicenseServerUrl(r.mediaKeySystemDomain),a=this._createLicenseXhr(n,e,t);l.b.log("Sending license request to URL: "+n);var i=this._generateLicenseRequestChallenge(r,e);a.send(i)}catch(e){l.b.error("Failure requesting DRM license: "+e),this.hls.trigger(c.a.ERROR,{type:s.b.KEY_SYSTEM_ERROR,details:s.a.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}},o.onMediaAttached=function(e){if(this._emeEnabled){var t=e.media;this._media=t,t.addEventListener("encrypted",this._onMediaEncrypted)}},o.onMediaDetached=function(){var e=this._media,t=this._mediaKeysList;e&&(e.removeEventListener("encrypted",this._onMediaEncrypted),this._media=null,this._mediaKeysList=[],Promise.all(t.map((function(e){if(e.mediaKeysSession)return e.mediaKeysSession.close().catch((function(){}))}))).then((function(){return e.setMediaKeys(null)})).catch((function(){})))},o.onManifestParsed=function(e){if(this._emeEnabled){var t=e.levels.map((function(e){return e.audioCodec})),r=e.levels.map((function(e){return e.videoCodec}));this._attemptKeySystemAccess(Gt.WIDEVINE,t,r)}},a=n,(i=[{key:"requestMediaKeySystemAccess",get:function(){if(!this._requestMediaKeySystemAccess)throw new Error("No requestMediaKeySystemAccess function configured");return this._requestMediaKeySystemAccess}}])&&qt(a.prototype,i),n}(f);function zt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Xt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?zt(Object(r),!0).forEach((function(t){Qt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Qt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var $t=Xt(Xt({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,maxBufferSize:6e7,maxBufferHole:.5,lowBufferWatchdogPeriod:.5,highBufferWatchdogPeriod:3,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,liveDurationInfinity:!1,liveBackBufferLength:1/0,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:Qe,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,abrController:He,bufferController:Ye,capLevelController:We,fpsController:Xe,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystemOptions:{},requestMediaKeySystemAccessFunc:Yt,testBandwidth:!0},{cueHandler:n,enableCEA708Captions:!0,enableWebVTT:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}),{},{subtitleStreamController:Zt,subtitleTrackController:Vt,timelineController:Ft,audioStreamController:rt,audioTrackController:Je,emeController:Wt});function Jt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function er(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Jt(Object(r),!0).forEach((function(t){tr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Jt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function tr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ar(e,t,r){return t&&nr(e.prototype,t),r&&nr(e,r),e}var ir=function(e){var t,r;function n(t){var r;void 0===t&&(t={}),(r=e.call(this)||this).config=void 0,r._autoLevelCapping=void 0,r.abrController=void 0,r.capLevelController=void 0,r.levelController=void 0,r.streamController=void 0,r.networkControllers=void 0,r.audioTrackController=void 0,r.subtitleTrackController=void 0,r.emeController=void 0,r.coreComponents=void 0,r.media=null,r.url=null;var a=n.DefaultConfig;if((t.liveSyncDurationCount||t.liveMaxLatencyDurationCount)&&(t.liveSyncDuration||t.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");r.config=er(er({},a),t);var i=rr(r).config;if(void 0!==i.liveMaxLatencyDurationCount&&i.liveMaxLatencyDurationCount<=i.liveSyncDurationCount)throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"');if(void 0!==i.liveMaxLatencyDuration&&(void 0===i.liveSyncDuration||i.liveMaxLatencyDuration<=i.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"');Object(l.a)(i.debug),r._autoLevelCapping=-1;var o=r.abrController=new i.abrController(rr(r)),s=new i.bufferController(rr(r)),u=r.capLevelController=new i.capLevelController(rr(r)),c=new i.fpsController(rr(r)),d=new x(rr(r)),f=new M(rr(r)),h=new U(rr(r)),p=new Ne(rr(r)),g=r.levelController=new Me(rr(r)),v=new G(rr(r)),m=[g,r.streamController=new Ie(rr(r),v)],y=i.audioStreamController;y&&m.push(new y(rr(r),v)),r.networkControllers=m;var b=[d,f,h,o,s,u,c,p,v];if(y=i.audioTrackController){var S=new y(rr(r));r.audioTrackController=S,b.push(S)}if(y=i.subtitleTrackController){var E=new y(rr(r));r.subtitleTrackController=E,m.push(E)}if(y=i.emeController){var T=new y(rr(r));r.emeController=T,b.push(T)}return(y=i.subtitleStreamController)&&m.push(new y(rr(r),v)),(y=i.timelineController)&&b.push(new y(rr(r))),r.coreComponents=b,r}r=e,(t=n).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,n.isSupported=function(){return function(){var e=q();if(!e)return!1;var t=self.SourceBuffer||self.WebKitSourceBuffer,r=e&&"function"==typeof e.isTypeSupported&&e.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),n=!t||t.prototype&&"function"==typeof t.prototype.appendBuffer&&"function"==typeof t.prototype.remove;return!!r&&!!n}()},ar(n,null,[{key:"version",get:function(){return"0.14.17"}},{key:"Events",get:function(){return c.a}},{key:"ErrorTypes",get:function(){return s.b}},{key:"ErrorDetails",get:function(){return s.a}},{key:"DefaultConfig",get:function(){return n.defaultConfig?n.defaultConfig:$t},set:function(e){n.defaultConfig=e}}]);var a=n.prototype;return a.destroy=function(){l.b.log("destroy"),this.trigger(c.a.DESTROYING),this.detachMedia(),this.coreComponents.concat(this.networkControllers).forEach((function(e){e.destroy()})),this.url=null,this.removeAllListeners(),this._autoLevelCapping=-1},a.attachMedia=function(e){l.b.log("attachMedia"),this.media=e,this.trigger(c.a.MEDIA_ATTACHING,{media:e})},a.detachMedia=function(){l.b.log("detachMedia"),this.trigger(c.a.MEDIA_DETACHING),this.media=null},a.loadSource=function(e){e=o.buildAbsoluteURL(window.location.href,e,{alwaysNormalize:!0}),l.b.log("loadSource:"+e),this.url=e,this.trigger(c.a.MANIFEST_LOADING,{url:e})},a.startLoad=function(e){void 0===e&&(e=-1),l.b.log("startLoad("+e+")"),this.networkControllers.forEach((function(t){t.startLoad(e)}))},a.stopLoad=function(){l.b.log("stopLoad"),this.networkControllers.forEach((function(e){e.stopLoad()}))},a.swapAudioCodec=function(){l.b.log("swapAudioCodec"),this.streamController.swapAudioCodec()},a.recoverMediaError=function(){l.b.log("recoverMediaError");var e=this.media;this.detachMedia(),e&&this.attachMedia(e)},a.removeLevel=function(e,t){void 0===t&&(t=0),this.levelController.removeLevel(e,t)},ar(n,[{key:"levels",get:function(){return this.levelController.levels}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(e){l.b.log("set currentLevel:"+e),this.loadLevel=e,this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(e){l.b.log("set nextLevel:"+e),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(e){l.b.log("set loadLevel:"+e),this.levelController.manualLevel=e}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(e){this.levelController.nextLoadLevel=e}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(e){l.b.log("set firstLevel:"+e),this.levelController.firstLevel=e}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(e){l.b.log("set startLevel:"+e),-1!==e&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}},{key:"capLevelToPlayerSize",set:function(e){var t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(e){l.b.log("set autoLevelCapping:"+e),this._autoLevelCapping=e}},{key:"bandwidthEstimate",get:function(){var e=this.abrController._bwEstimator;return e?e.getEstimate():NaN}},{key:"autoLevelEnabled",get:function(){return-1===this.levelController.manualLevel}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){for(var e=this.levels,t=this.config.minAutoBitrate,r=e?e.length:0,n=0;n<r;n++)if((e[n].realBitrate?Math.max(e[n].realBitrate,e[n].bitrate):e[n].bitrate)>t)return n;return 0}},{key:"maxAutoLevel",get:function(){var e=this.levels,t=this.autoLevelCapping;return-1===t&&e&&e.length?e.length-1:t}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(e){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,e)}},{key:"audioTracks",get:function(){var e=this.audioTrackController;return e?e.audioTracks:[]}},{key:"audioTrack",get:function(){var e=this.audioTrackController;return e?e.audioTrack:-1},set:function(e){var t=this.audioTrackController;t&&(t.audioTrack=e)}},{key:"liveSyncPosition",get:function(){return this.streamController.liveSyncPosition}},{key:"subtitleTracks",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTrack:-1},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}},{key:"subtitleDisplay",get:function(){var e=this.subtitleTrackController;return!!e&&e.subtitleDisplay},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}}]),n}(z);ir.defaultConfig=void 0}]).default)},76931:function(e){self,e.exports=function(){"use strict";var e={d:function(t,r){for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r:function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};function r(e,t,r){if("function"==typeof e.slice)return e.slice(t,t+r);for(var n=new Uint8Array(r),a=0;a<r;a+=1)n[a]=e[t+a];return n}function n(e){var t;function n(){return t.bytes[t.position++]}function a(e){e=e||0,t.bytes[t.position++]=255&e}function i(e){a((e=e||0)>>>24&255),a(e>>>16&255),a(e>>>8&255),a(255&e)}return e instanceof Uint8Array||(e=new Uint8Array(e)),t={bytes:e,position:0,readUnsignedByte:n,readUnsignedInt16:function(){for(var e=0,t=0;t<2;t+=1)e=e<<8|n();return e},readUnsignedInt24:function(){for(var e=0,t=0;t<3;t+=1)e=e<<8|n();return e},readUnsignedInt32:function(){for(var e=0,t=0;t<4;t+=1)e=256*e+n();return e},readUnsignedInt64:function(){for(var e=0,t=0;t<8;t+=1)e=256*e+n();return e},readString:function(e){for(var r="",n=0;n<e;n+=1)r+=String.fromCharCode(t.bytes[t.position++]);return r},readBytes:function(e){var n=r(t.bytes,t.position,e);return t.position+=e,n},writeUnsignedByte:a,writeUnsignedInt16:function(e){a((e=e||0)>>>8&255),a(255&e)},writeUnsignedInt24:function(e){a((e=e||0)>>>16&255),a(e>>>8&255),a(255&e)},writeUnsignedInt32:i,writeUnsignedInt64:function(e){i(Math.floor(e/Math.pow(2,32))),i(Math.floor(e%Math.pow(2,32)))},writeString:function(e){for(var r=0;r<e.length;r+=1)t.bytes[t.position++]=e.charCodeAt(r)},writeBytes:function(e){t.bytes.set(e,t.position),t.position+=e.length}}}e.r(t),e.d(t,{getFragments:function(){return y},parse:function(){return u},version:function(){return m}});var a={decorate:function(e){var t=n(e.bytes);for(t.position=e.fourCC?e.start+8:e.start,e.boxes=[];t.position<e.start+e.length;){var r={};r.start=t.position,r.length=t.readUnsignedInt32(),r.fourCC=t.readString(4),r.bytes=e.bytes,e.boxes.push(r),t.position+=r.length-8}}};function i(e,t){for(var r="0";r.length<t;)r+=r;return(r+e).substr(-t,t)}var o={fmov:a,free:a,mdia:a,minf:a,moof:a,moov:a,mvex:a,stbl:a,traf:a,trak:a,ustm:a,fhst:{decorate:function(e){function t(){var t,r=n(e.bytes);r.position=e.start+8,e.hashes=[];for(var a=0;a<Math.floor((e.length-8)/4);a+=1)t=r.readUnsignedInt32(),e.hashes.push(i(t.toString(16),8))}e.parseBytes=t,t()}},hash:{decorate:function(e){function t(){var t=n(e.bytes);t.position=e.start+8;var r=t.readUnsignedInt32();e.hash=i(r.toString(16),8)}e.parseBytes=t,t()}},idta:{decorate:function(e){function t(){var t=n(e.bytes);t.position=e.start+8,e.rawInit=t.readBytes(e.length-8)}e.parseBytes=t,t()}},sidx:{decorate:function(e){var t,r,a=n(e.bytes);a.position=e.start+8,e.version=a.readUnsignedByte(),e.rawFlags=a.readUnsignedInt24(),e.referenceId=a.readUnsignedInt32(),e.timeScale=a.readUnsignedInt32(),e.version?(e.earliestPresentationTime=a.readUnsignedInt64(),e.firstOffset=a.readUnsignedInt64()):(e.earliestPresentationTime=a.readUnsignedInt32(),e.firstOffset=a.readUnsignedInt32()),a.readUnsignedInt16(),e.referenceCount=a.readUnsignedInt16(),e.references=[];for(var i=0;i<e.referenceCount;i+=1)t={},r=a.readUnsignedInt32(),t.referenceType=!!(2147483648&r),t.subsegmentSize=2147483647&r,t.subsegmentDuration=a.readUnsignedInt32(),r=a.readUnsignedInt32(),t.containsRAP=!!(2147483648&r),t.rapType=(1879048192&r)>>>28,t.rapDeltaTime=268435455&r,e.references.push(t)}},styp:{decorate:function(e){var t=n(e.bytes);for(t.position=e.start+8,e.majorBrand=t.readString(4),e.minorVersion=t.readUnsignedInt32(),e.compatibleBrands=[];t.position<e.start+e.length;)e.compatibleBrands.push(t.readString(4))}},trun:{decorate:function(e){function t(){var t,r=n(e.bytes);r.position=e.start+8,e.version=r.readUnsignedByte(),e.flags={dataOffsetPresent:!!(1&(t=r.readUnsignedInt24())),firstSampleFlagsPresent:!!(4&t),sampleDurationsPresent:!!(256&t),sampleSizesPresent:!!(512&t),sampleFlagsPresent:!!(1024&t),sampleCompositionTimeOffsetsPresent:!!(2048&t)},e.sampleCount=r.readUnsignedInt32(),e.flags.dataOffsetPresent&&(e.dataOffset=r.readUnsignedInt32()),e.flags.firstSampleFlagsPresent&&(e.firstSampleFlags=r.readUnsignedInt32()),e.samples=[];for(var a=0;a<e.sampleCount;a+=1){var i={};e.flags.sampleDurationsPresent&&(i.duration=r.readUnsignedInt32()),e.flags.sampleSizesPresent&&(i.size=r.readUnsignedInt32()),e.flags.sampleFlagsPresent&&(i.flags=r.readUnsignedInt32()),e.flags.sampleCompositionTimeOffsetsPresent&&(i.compositionTimeOffset=r.readUnsignedInt32()),e.samples.push(i)}}e.parseBytes=t,e.writeBytes=function(){e.flags=e.flags||{};var t=4*e.flags.dataOffsetPresent,r=4*e.flags.firstSampleFlagsPresent,a=4*(e.flags&&e.flags.sampleDurationsPresent)+4*(e.flags&&e.flags.sampleSizesPresent)+4*(e.flags&&e.flags.sampleFlagsPresent)+4*(e.flags&&e.flags.sampleCompositionTimeOffsetsPresent);e.length=16+t+r+e.sampleCount*a;var i,o,s=n(new Uint8Array(e.length));s.writeUnsignedInt32(e.length),s.writeString(e.fourCC),s.writeUnsignedByte(e.version),s.writeUnsignedInt24((o=0,o|=1*(i=e.flags).dataOffsetPresent,o|=4*i.firstSampleFlagsPresent,o|=256*i.sampleDurationsPresent,o|=512*i.sampleSizesPresent,(o|=1024*i.sampleFlagsPresent)|2048*i.sampleCompositionTimeOffsetsPresent)),s.writeUnsignedInt32(e.sampleCount),e.flags.dataOffsetPresent&&s.writeUnsignedInt32(e.dataOffset),e.flags.firstSampleFlagsPresent&&s.writeUnsignedInt32(e.firstSampleFlags);for(var u=0;u<e.sampleCount;u+=1)e.flags.sampleDurationsPresent&&s.writeUnsignedInt32(e.samples[u].duration),e.flags.sampleSizesPresent&&s.writeUnsignedInt32(e.samples[u].size),e.flags.sampleFlagsPresent&&s.writeUnsignedInt32(e.samples[u].flags),e.flags.sampleCompositionTimeOffsetsPresent&&s.writeUnsignedInt32(e.samples[u].compositionTimeOffset);e.bytes=s.bytes,e.start=0},t()}},tfdt:{decorate:function(e){function t(){var t=n(e.bytes);t.position=e.start+8,e.version=t.readUnsignedByte(),e.rawFlags=t.readUnsignedInt24(),e.version?e.baseMediaDecodeTime=t.readUnsignedInt64():e.baseMediaDecodeTime=t.readUnsignedInt32()}e.parseBytes=t,e.writeBytes=function(){e.length=12+(e.version?8:4);var t=n(new Uint8Array(e.length));t.writeUnsignedInt32(e.length),t.writeString(e.fourCC),t.writeUnsignedByte(e.version),t.writeUnsignedInt24(e.rawFlags),e.version?t.writeUnsignedInt64(e.baseMediaDecodeTime):t.writeUnsignedInt32(e.baseMediaDecodeTime),e.bytes=t.bytes,e.start=0},t()}},tfhd:{decorate:function(e){function t(){var t,r=n(e.bytes);r.position=e.start+8,e.version=r.readUnsignedByte(),e.flags={baseDataOffsetPresent:!!(1&(t=r.readUnsignedInt24())),sampleDescriptionIndexPresent:!!(2&t),defaultSampleDurationPresent:!!(8&t),defaultSampleSizePresent:!!(16&t),defaultSampleFlagsPresent:!!(32&t)},e.trackId=r.readUnsignedInt32(),e.flags.baseDataOffsetPresent&&(e.baseDataOffset=r.readUnsignedInt64()),e.flags.sampleDescriptionIndexPresent&&(e.sampleDescriptionIndex=r.readUnsignedInt32()),e.flags.defaultSampleDurationPresent&&(e.defaultSampleDuration=r.readUnsignedInt32()),e.flags.defaultSampleSizePresent&&(e.defaultSampleSize=r.readUnsignedInt32()),e.flags.defaultSampleFlagsPresent&&(e.defaultSampleFlags=r.readUnsignedInt32())}e.parseBytes=t,e.writeBytes=function(){e.flags=e.flags||{},e.length=16,e.length+=8*e.flags.baseDataOffsetPresent,e.length+=4*e.flags.sampleDescriptionIndexPresent,e.length+=4*e.flags.defaultSampleDurationPresent,e.length+=4*e.flags.defaultSampleSizePresent,e.length+=4*e.flags.defaultSampleFlagsPresent;var t,r,a=n(new Uint8Array(e.length));a.writeUnsignedInt32(e.length),a.writeString(e.fourCC),a.writeUnsignedByte(e.version),a.writeUnsignedInt24((r=0,r|=1*(t=e.flags).baseDataOffsetPresent,r|=2*t.sampleDescriptionIndexPresent,r|=8*t.defaultSampleDurationPresent,(r|=16*t.defaultSampleSizePresent)|32*t.defaultSampleFlagsPresent)),a.writeUnsignedInt32(e.trackId),e.flags.baseDataOffsetPresent&&a.writeUnsignedInt64(e.baseDataOffset),e.flags.sampleDescriptionIndexPresent&&a.writeUnsignedInt32(e.sampleDescriptionIndex),e.flags.defaultSampleDurationPresent&&a.writeUnsignedInt32(e.defaultSampleDuration),e.flags.defaultSampleSizePresent&&a.writeUnsignedInt32(e.defaultSampleSize),e.flags.defaultSampleFlagsPresent&&a.writeUnsignedInt32(e.defaultSampleFlags),e.bytes=a.bytes,e.start=0},t()}},mfhd:{decorate:function(e){function t(){var t=n(e.bytes);t.position=e.start+8,e.version=t.readUnsignedByte(),e.rawFlags=t.readUnsignedInt24(),e.sequenceNumber=t.readUnsignedInt32()}e.parseBytes=t,e.writeBytes=function(){e.length=16;var t=n(new Uint8Array(e.length));t.writeUnsignedInt32(e.length),t.writeString(e.fourCC),t.writeUnsignedByte(e.version),t.writeUnsignedInt24(e.rawFlags),t.writeUnsignedInt32(e.sequenceNumber),e.bytes=t.bytes,e.start=0},t()}}};function s(e){var t=e.fourCC?o[e.fourCC]:a;if(t&&(t.decorate(e),e.boxes)){for(var r=0;r<e.boxes.length;r+=1)s(e.boxes[r]);e.boxes.length&&(delete e.bytes,delete e.start,delete e.length)}}function u(e){var t={bytes:e,start:0,length:e.length};return s(t),t}function c(e){if(e.bytes)return e.length;if(e.boxes){for(var t=e.fourCC?8:0,r=0;r<e.boxes.length;r+=1)t+=c(e.boxes[r]);return t}return 0}function l(e,t){if(t.bytes)e.writeBytes(r(t.bytes,t.start,t.length));else if(t.boxes){t.fourCC&&(e.writeUnsignedInt32(c(t)),e.writeString(t.fourCC));for(var n=0;n<t.boxes.length;n+=1)l(e,t.boxes[n])}}function d(e){var t=n(new Uint8Array(c(e)));return l(t,e),t.bytes}function f(e,t){return Math.floor(1e3*function(e,t){return e/t}(e,t))}function h(e,t){for(var r=0;r<e.boxes.length;r+=1)if(e.boxes[r].fourCC===t)return e.boxes[r];return null}function p(e,t){for(var r=t.split(".");e&&r.length;)e=h(e,r.shift());return e}var g=["moof","mdat"];function v(e,t,r,n){var a=p({boxes:e},"moof.traf.tfdt"),i=p({boxes:e},"moof.traf.trun");if(a&&i){var o=f(a.baseMediaDecodeTime,r),s=f(t.subsegmentDuration,r);return{start:o,duration:s,end:o+s,bytes:d({boxes:e}),containsRAP:!!t.containsRAP,rapType:t.rapType,rapDeltaTime:t.rapDeltaTime,sampleCount:i.samples.length,hash:n}}}var m="1.0.9";function y(e){return h(e,"styp")?function(e){for(var t,r,n,a=h(e,"sidx"),i=function(e){var t=[],r=p(e,"free.ustm.fhst");return r&&(t=r.hashes),t}(e),o=[],s=[],u=0;u<e.boxes.length;u+=1)r=e.boxes[u],-1!==g.indexOf(r.fourCC)&&(s.push(r),g.indexOf(r.fourCC)===g.length-1&&(n=i[Math.min(o.length,i.length-1)],(t=v(s,a.references[o.length],a.timeScale,n))&&o.push(t),s=[]));return o}(e):[]}return t}()},74112:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return Array.from(new Set(e))}},21807:function(e,t,r){"use strict";t.jV=function(e,t){return(0,a.default)([].concat(i(e),i(t)).map((function(e){return e.start}))).reduce((function(r,n){var a=s(n,e),i=s(n,t);if(!a||!i)return r;var o={start:Math.max(a.start,i.start),end:Math.min(a.end,i.end)};return r.push(o),r}),[]).sort((function(e,t){return e.start-t.start}))},t._Q=function(e){return Array.from({length:e.length}).map((function(t,r){return{start:e.start(r),end:e.end(r)}}))};var n,a=(n=r(74112))&&n.__esModule?n:{default:n};function i(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function s(e,t){return t.find((function(t){var r=t.start,n=t.end;return r<=e&&e<=n}))}}}]);