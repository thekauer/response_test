(self.webpackChunkustreamPlayer=self.webpackChunkustreamPlayer||[]).push([[430],{37594:function(e,t,n){"use strict";n.r(t),n.d(t,{initialize:function(){return py}});var r=n(26448),a=n.n(r),i=n(40202),o=n.n(i),s=n(75069),c=n(31065),u=n(81984),d=n(52097);function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}var f=function e(){for(var t={},n=0;n<arguments.length;n++)for(var r in arguments[n]){var a=arguments[n][r],i=t[r];i&&"object"===l(a)&&"object"===l(i)?t[r]=e(i,a):t[r]=a}return t},p={STREAM_UPDATE:"streamUpdate",THUMBNAIL_UPDATE:"thumbnailUpdate",BROADCASTER_UPDATE:"broadcasterUpdate",META_UPDATE:"metaUpdate",CONTENT_CUT_UPDATE:"contentCutUpdate",VIEWERS_UPDATE:"viewersUpdate",ALLVIEWERS_UPDATE:"allViewersUpdate",ALLTIMETOTAL_UPDATE:"allTimeTotalUpdate",SHARE_UPDATE:"shareUpdate",LOGO_UPDATE:"logoUpdate",CLIENT_RATE_LIMIT_UPDATE:"clientRateLimitUpdate",CHAT_UPDATE:"chatUpdate",ADVERT_UPDATE:"advertUpdate",STREAM_VERSION_UPDATE:"streamVersionUpdate",LIVE_CTA_UPDATE:"livectaUpdate",CAPTION_UPDATE:"captionUpdate",SLIDES_UPDATE:"slidesUpdate",POLL_UPDATE:"pollUpdate",CAPTION_SEARCH_UPDATE:"captionSearchUpdate",WENT_ONLINE_IN_UNIX_TS_UPDATE:"wentOnlineInUnixTsUpdate",ID_UPDATE:"idUpdate",UNSUPPORTED:"unsupported",LIVE:"live",OFFLINE_MODULE_RECEIVED:"offlineModuleReceived",PLAY:"play",PAUSE:"pause",LOAD:"load",VOLUME:"volume",PLAYING:"playing",SEEK:"seek",PROGRESS:"progress",DURATION:"duration",CREATE_SLIDESHOW:"createSlideShow",DESTROY_SLIDESHOW:"destroySlideShow",CREATE_OFFAIR_VIDEO:"createOffairVideo",DESTROY_OFFAIR_VIDEO:"destroyOffairVideo",NEXT_OFFAIR_VIDEO:"nextOffairVideo",VIDEO_FINISHED:"videoFinished",AUDIO_TRACKS:"audioTracks",URL_RESOLVE_COMPLETE:"urlResolveComplete",URL_RESOLVE_FAILURE:"urlResolveFailure",PLAY_OPTIONS:"playOptions",CHUNK_LENGTH:"chunkLength",ATLAS_METADATA:"atlasMetadata",ATLAS_STORED_UPDATE:"atlasStoredUpdate",ATLAS_BUFFERED_UPDATE:"atlasBufferedUpdate",ATLAS_POSITION_UPDATE:"atlasPositionUpdate",ATLAS_PROGRESS:"atlasProgress",ATLAS_ERROR:"atlasError",ATLAS_LOG:"atlasLog",ATLAS_CLEANUP:"atlasCleanup",ATLAS_THROTTLE:"atlasThrottle",ATLAS_DOWNLOAD_ERROR:"atlasDownloadError",ATLAS_QUALITY_CHANGE_STARTED:"atlasQualityChangeStarted",ATLAS_QUALITY_CHANGE_COMPLETED:"atlasQualityChangeCompleted",ATLAS_QUALITY_CHANGE_CANCELLED:"atlasQualityChangeCancelled",RECORDED_READY:"recordedReady",BANDWIDTH_UPDATED:"bandwidthUpdated",QUALITY_CHANGE:"qualityChange",CHANGE_PROVIDER:"changeProvider",PROVIDER_CHANGE:"providerChange",FLASH_CALL_ERROR:"flashCallError",SEND_REPORT:"sendReport",UMS_CONNECT_START:"umsConnectStart",UMS_CONNECTED:"umsConnected",UMS_REJECT:"umsReject",MODULE_INFO:"moduleInfo",REPORT_BANDWIDTH:"reportBandwidth",REPORT_BUFFER_EMPTY:"reportBufferEmpty",REPORT_BUFFER_FULL:"reportBufferFull",REPORT_DROPPED_FRAMES:"reportDroppedFrames",REPORT_ERROR:"reportError",REPORT_AD_RESPONDED:"reportAdResponded",REPORT_ECDN_TESTS:"reportEcdnTests",REPORT_AUDIO_CHANGED:"reportAudioChanged",CONTENT_AVAILABLE:"contentAvailable",AD_AVAILABLE:"adAvailable",SET_CAPTION_POSITION:"setCaptionPosition",DEBUG_FLOT_LOG:"flotLog"},m=[p.PROGRESS,p.VIEWERS_UPDATE,p.ALLVIEWERS_UPDATE,p.ALLTIMETOTAL_UPDATE,p.MODULE_INFO,p.DEBUG_FLOT_LOG,p.ATLAS_PROGRESS,p.ATLAS_POSITION_UPDATE,p.ATLAS_STORED_UPDATE,p.ATLAS_BUFFERED_UPDATE,p.ATLAS_LOG,p.SEND_REPORT,p.STREAM_UPDATE,p.THUMBNAIL_UPDATE,p.BROADCASTER_UPDATE,p.META_UPDATE,p.VIEWERS_UPDATE,p.ALLVIEWERS_UPDATE,p.ALLTIMETOTAL_UPDATE,p.SHARE_UPDATE,p.LOGO_UPDATE,p.CLIENT_RATE_LIMIT_UPDATE,p.CHAT_UPDATE,p.ADVERT_UPDATE,p.LIVE_CTA_UPDATE,p.CAPTION_UPDATE,p.SLIDES_UPDATE,p.POLL_UPDATE,p.CAPTION_SEARCH_UPDATE,p.WENT_ONLINE_IN_UNIX_TS_UPDATE,p.ID_UPDATE],g=n(96534),E=(0,c.w)("facade"),v={};function y(e,t){return"".concat(e,".").concat(t)}var T,h="command",b="event",S="data",O="report",A=p,I=function(e,t,n){var r=y(e,t);-1===m.indexOf(t)&&E.debug("".concat(e," ").concat(t),n),(0,g.Z)(v,r,n),(0,g.Z)(v,"".concat(e,".*"),t,n)},L=function(e,t,n){var r=y(e,t);v[r]||(v[r]=[]),v[r].push(n)},_="flv",D="flv/segmented",P="mp4",R="mp4/segmented",N="hls",C=n(79884),w=n(60461);function U(){if(!T)throw new Error("uiInstance not inited");return T}var M,F,j,k,G,B,V=n(49612),H="channel",x="recorded",Y="video",Z="image",K="highlight",W=(0,c.w)("atlas/data/content"),Q=location.pathname,z=C.Z.player?C.Z.player.contentType:C.Z.contentType,X=z===Y||z===K,q=z===H,$=z===K,J=0,ee=1,te=0,ne=!1,re="",ae=null,ie=0;function oe(){return k===N}function se(){return(ee-J)*te}function ce(e){if(oe())return e;var t=te*J;return Math.max(e-t,0)}!Q.includes("/embed/")&&C.Z.player?(F=[C.Z.player.contentId],C.Z.player.contentType===K&&F.unshift(C.Z.player.videoId)):F=Q.match(/(\d+)/g),j=+F[0],M=q?H:x,L(b,A.LIVE,(function(e){e&&(re="",G=void 0),ne=e})),L(S,A.META_UPDATE,(function(e){B=f(B,e)})),L(b,A.CREATE_SLIDESHOW,(function(e){re=e.itemType===Z?Z:"slide",re=Z,G=void 0})),L(b,A.CREATE_OFFAIR_VIDEO,(function(e){re=Y,G=e})),L(b,A.DESTROY_OFFAIR_VIDEO,(function(){re="",G=void 0})),L(b,A.DESTROY_SLIDESHOW,(function(){re=""})),L(b,A.ATLAS_PROGRESS,(function(e){var t=e.position;ie=t}));var ue={TYPE_CHANNEL:H,TYPE_RECORDE:x,TYPE_HIGHLIGHT:K,setStreamType:function(e){k=e},getStreamType:function(){return k},isHLS:oe,isFLV:function(){return k===D||k===_},isMP4:function(){return k===R||k===P},isSegmentedMP4:function(){return k===R},isContentPlayable:function(){return""===re||re===Y},live:function(){return ne},meta:function(){return B},cluster:function(){return B&&B.cluster?B.cluster:void 0},offairType:function(){return re},offairVid:function(){return G},getMediaType:function(){return X?Y:re?"offair"+re:ne?"live":"unknown"},id:function(){return j},app:function(){return M},ids:function(){return F},isCid:function(){return q},getType:function(){return q?H:$?K:x},setHighlight:function(e){J=e[0],ee=e[1],I(b,A.CONTENT_CUT_UPDATE)},getHighlight:function(){return Ie.get("ignoretrim")?null:void 0!==J||void 0!==ee?{cutStart:J,cutEnd:ee}:null},getCutStart:function(){return J},getCutEnd:function(){return ee},setDurationInMillisec:function(e){te=e,I(b,A.DURATION)},getDurationInMillisec:function(){return te},getTrimmedDurationInMillisec:se,getRelativeSeekPositionInMs:ce,getAbsoluteSeekPositionInMs:function(e){var t,n;oe()?(t=0,n=se()):(t=te*J,n=te*ee);var r=t+e;return Math.min(Math.max(t,r),n)},getSavedSeek:function(){return ae},hasSavedSeek:function(){return!!ae},saveSeek:function(e){var t,n=e.positionInMs,r=e.initiator,a=(null===(t=ae)||void 0===t?void 0:t.initiator)===w._.USER,i=r===w._.SYSTEM;a&&i||(ae={positionInMs:n,initiator:r})},resetSavedSeek:function(){ae=null},getOwnerChannelId:function(){return C.Z.cId},isVid:function(){return X},isHid:function(){return $},isOffairVid:function(){return re===Y},isOffairImg:function(){return re===Z},getMid:function(){return[this.app()].concat(F).join(".")},isLiveContent:function(){return!this.isVid()&&""===re},getUrl:function(e,t){var n=(0,s.default)(window,"location.protocol","https:"),r=(0,s.default)(V.Z,"config.contentUrl","video.ibm.com"),a=new URL("".concat(n,"//").concat(r));if(t?a.pathname+="".concat("embed","/"):q&&(a.pathname+="".concat(H,"/")),X&&(a.pathname+="".concat(x,"/")),a.pathname+="".concat(F[0]),$&&(a.pathname+="/".concat(K,"/").concat(F[1])),e&&(a.pathname+="/pop-out",!this.isLiveContent())){var i=ce(ie),o=Math.ceil(i/1e3);o>0&&(a.hash="to".concat(o))}return a.toString()},update:function(e,t){W.debug("update ",{type:e,ids:t}),Array.isArray(t)||(t=[t]),F=t,re="",J=0,ee=1,te=0,e===H?(q=!0,j=t[0],M=H,X=!1,$=!1):e===Y||e===x?(X=!0,j=t[0],M=x,q=!1,$=!1):e===K&&(X=!0,$=!0,j=t[0],M=x,q=!1),U().setContentUpdate()}},de=n(20917),le=n(81),fe=n(304);function pe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function me(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ge(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?me(Object(n),!0).forEach((function(t){Ee(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):me(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ee(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ve=(0,c.w)("atlas/data/params"),ye={ads:!1,autoplay:!1,bdtools:!1,chunkReporting:!1,controls:!0,cmenu:!0,combinedstreammodule:!1,debug:!1,disableEosSeek:!1,experiment:!1,externalvtt:!1,flot:!1,hideaudioswitch:!1,hidecaptionsearch:!1,hidecc:!1,hidechapters:!1,hidecopylink:!1,hidecta:!1,hidecustomlogo:!1,hideembedcode:!1,hidefacebook:!1,hidefullscreen:!1,hidelivebadge:!1,hidelogo:!1,hideplaybackspeed:!1,hideplayscreen:!1,hidereplaybadge:!1,hideseekbar:!1,hideshare:!1,hidetitle:!1,hidetwitter:!1,hideviewernumbers:!1,html5:!1,ios:!1,lite:!1,longpoll:!1,ignoretrim:!1,playsinline:!0,qosplayer:!1,reftest:!1,showhiddencontextmenuitems:Boolean(le.ZP.get("showHiddenContextMenuItems")),showpopout:!1,showtheatre:!1,sitemode:!1,uselongpoll:!1,allowfullscreen:!0,disablecaptionsearch:!1,popoutvisible:!1,showtitle:!0,theatervisible:!1,viewingexperience:!1,disablejump:!1},Te=ge({defaultlang:void 0,findtext:void 0,v:3,volume:100,slideshowspeed:fe.Z.DEFAULT_SLIDE_DELAY_IN_SEC,oneclickdelay:fe.Z.DEFAULT_ONE_CLICK_DELAY_IN_MS,multiclickdelay:fe.Z.DEFAULT_MULTI_CLICK_DELAY_IN_MS},ye),he={};function be(e){return e.replace(/-/g,"").toLowerCase()}function Se(e){try{var t=new URL(de.Z);return e.test(t.hostname)}catch(e){return!1}}function Oe(e,t){var n=ue.id().toString();he[n]||(he[n]={}),he[n][be(e)]=t}var Ae=function(){var e=function(e){var t=window.location.hash.match(/to(\d+(?::\d+){0,2})/);if(t){var n=t[1].split(":").map((function(e){return parseInt(e,10)})),r=n.pop(),a=n.pop()||0;return 60*(n.pop()||0)*60+60*a+r}}();e&&Oe("startAt",e);var t,n,r,a,i=window===window.parent&&C.Z.player&&0!==window.location.pathname.indexOf("/embed")?(ve.debug("params from exposedVars.player expose",C.Z.player),Object.entries(C.Z.player).reduce((function(e,t){var n,r,a=(r=2,function(e){if(Array.isArray(e))return e}(n=t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){s=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(s)throw a}}return i}}(n,r)||function(e,t){if(e){if("string"==typeof e)return pe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?pe(e,t):void 0}}(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=a[0],o=a[1],s=ge(ge({},e),{},Ee({},be(i),o));return"false"===s.autoplay&&(s.autoplay=!1),s.hidetitle&&(s.hidetitle=!1),s}),{})):{},o=(r={branchname:C.Z.branchName,subscription:C.Z.hasSubscription,betachannel:C.Z.isBetaChannel,islive:C.Z.isLive,initialquality:C.Z.initialQuality,forcedquality:C.Z.forcedQuality,locale:C.Z.locale,loggedin:C.Z.loggedIn,isibmbranded:C.Z.ibmBranding,uumfoffairvods:C.Z.uumfOffAirContentVideoIds,uumf:C.Z.isUUMF,align:"true"===C.Z.align||!0===C.Z.align,adfree:Boolean(C.Z.sessionId&&C.Z.adFree)},"channel"===(null!==(t=C.Z.contentType)&&void 0!==t?t:null===(n=C.Z.player)||void 0===n?void 0:n.contentType)&&(r.uumf=!0),r),s=(a=(window.location.search.match(/([a-z0-9\-_]+)(?:=([a-z0-9\-_.:%]*))?/gi)||[]).filter((function(e){return!/^hash=.+/.test(e)})),ve.debug("params from url",a),a.reduce((function(e,t){var n,r=t.split("="),a=be(r[0]),i=r[1];switch(!0){case Object.keys(ye).some((function(e){return e===a})):var o="bdtools"===a?{bdtools:!0,autoplay:!0,adfree:!0}:{};return ge(ge({},e),{},Ee({},a,"true"===(n=i)||"1"===n||""===n||void 0===n),o);case"volume"===a:var s=parseInt(i,10),c=i&&s>=0&&s<=100;return ge(ge({},e),{},Ee({},a,c?s:100));case"slideshowspeed"===a:var l=(0,d.Z)(parseInt(i,10),{lower:1});return ge(ge({},e),{},Ee({},a,(0,u.Z)(l)?fe.Z.DEFAULT_SLIDE_DELAY_IN_SEC:l));case"defaultlang"===a:case"findtext"===a:return ge(ge({},e),{},Ee({},a,i));case"oneClickDelay"===a:var f=parseInt(i,10)||fe.Z.DEFAULT_ONE_CLICK_DELAY_IN_MS;return ge(ge({},e),{},Ee({},be(a),f));case"multiClickDelay"===a:var p=parseInt(i,10)||fe.Z.DEFAULT_MULTI_CLICK_DELAY_IN_MS;return ge(ge({},e),{},Ee({},be(a),p))}return e}),{})),c=function(){var e={};return["isonibm","isonustream","popout"].forEach((function(t){switch(t){case"isonibm":e[t]=Se(/ibm\.com$/);break;case"isonustream":e[t]=Se(/ustream\.tv(?:\.lh)?$/);break;case"popout":e[t]=(n="/pop-out",window.location.pathname.slice(-1*n.length)===n)}var n})),e}();return ge(ge(ge(ge(ge({},Te),i),o),s),c)}();ve.debug("params object initiated",Ae,!0);var Ie={get:function(e){return Ae[be(e)]},set:function(e,t){Ae[be(e)]=t},getByContent:function(e){var t=ue.id().toString(),n=be(e);return he[t]&&he[t][n]||Oe(n,!1),he[t][n]},setByContent:Oe};function Le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _e(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function De(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Pe=(0,c.w)("atlas/lib/centralLogger"),Re=function(){var e,t,n,r,i={subdomain:"eventtracking-log",protocol:"localhost"===(null===(e=window)||void 0===e||null===(t=e.location)||void 0===t?void 0:t.hostname)?"https:":"",tag:"eventtracking.web.player",type:"web",callback:function(e,t){e?Pe.debug("error:",e):t.forEach((function(e){Pe.debug("sent:",e)}))}},o=(0,s.default)(V.Z.config,"eventtrackingUrl","").match(/^([^.]+)\.(.+)$/);if(o){var c=(r=3,function(e){if(Array.isArray(e))return e}(n=o)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){s=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(s)throw a}}return i}}(n,r)||function(e,t){if(e){if("string"==typeof e)return De(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?De(e,t):void 0}}(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),u=c[1],d=c[2];i.subdomain=u,i.domain=d}return a().create(i)}();function Ne(){return o().storage}var Ce={isLoggingEnabled:Ne,send:function(e){var t;if(Ne()){"string"==typeof e&&(e={message:e}),e.message=e.message||"";var n=o().swf?o().swf.join("."):"none",r=ue.getMediaType(),a=ue.app()===ue.TYPE_CHANNEL?"channel_id":"recorded_id";e.data=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Le(Object(n),!0).forEach((function(t){_e(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Le(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}((_e(t={cluster:ue.cluster()},a,ue.id()),_e(t,"branch_name",Ie.get("branchName")),_e(t,"player_version","v5"),_e(t,"flash_version",n),_e(t,"buildNumber",fe.Z.BUILD_NUMBER),_e(t,"broadcaster_user_id",C.Z.ownerId),_e(t,"contentType",r),t),e.data||{}),Re.send(e)}}},we=n(62074),Ue=n(36891),Me=n(45878),Fe=n(3494),je="ADD_VIDEO_TAG",ke="REMOVE_VIDEO_TAG",Ge=n(97399);function Be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ve(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Be(Object(n),!0).forEach((function(t){He(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Be(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function He(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var xe={},Ye="TOGGLE_CAPTION_SEARCH_COMPONENT",Ze="SET_CAPTION_MODULE",Ke="SET_SEARCH_RESULT",We=n(36811);function Qe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ze(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qe(Object(n),!0).forEach((function(t){Xe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Xe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var qe={panelVisibility:!1,visibility:!1,searchResult:null},$e=n(42640);function Je(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function et(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Je(Object(n),!0).forEach((function(t){tt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Je(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function tt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var nt={activeCues:[],options:{}},rt="DISABLE",at="SET_SLIDES",it="SET_CURRENT_SLIDE",ot=n(45663);function st(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ct(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?st(Object(n),!0).forEach((function(t){ut(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):st(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ut(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var dt={isEnabled:!1,slides:[],currentSlide:null,slideIndexPanelVisible:!1,onboarding:!1},lt=n(3515);function ft(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ft(Object(n),!0).forEach((function(t){mt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ft(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function mt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var gt={activeMarker:void 0},Et="REMOVE_HASH",vt="SET_LOCK_INFO",yt=n(8834),Tt="SET_STREAM_MODULE",ht="SET_META_MODULE",bt="SET_ALL_TIME_TOTAL_MODULE",St="SET_ALL_VIEWERS_MODULE",Ot="SET_VIEWERS_MODULE",At="SET_LOGO_MODULE",It="SET_SHARE_MODULE",Lt="SET_BROADCASTER_MODULE",_t="SET_LIVE_CTA_MODULE",Dt="SET_THUMBNAIL_MODULE",Pt="SET_POLL_MODULE",Rt=(0,c.w)("shared/ui/screen/hashlockadvanced");function Nt(){var e=ue.isVid()?C.Z.cId:ue.id();return"c:token-".concat(e)}function Ct(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ue.id();return"v:token-".concat(e)}function wt(e){var t=e.hash,n="video"===e.mediaType?Ct():Nt();le.ZP.set(n,t,{expires:Ft(t)})}function Ut(){if(ue.isVid()||ue.isOffairVid())return le.ZP.get(Nt())||le.ZP.get(Ct(ue.offairVid()))}function Mt(){return"ustreamEmbedHash-".concat(ue.isVid()?C.Z.cId:ue.id())}function Ft(e){var t=function(e){var t;try{t=JSON.parse(e)}catch(t){return void Rt.error("Failed to parse hash",e)}return t}(e);if(!t)return 14;var n=function(e){var t=function(e){var t=e.find((function(e){return Object.keys(e).includes("hashExpire")}));if(t)return Object.values(t).pop()}(e);return new Date(1e3*t)}(t);return isNaN(n.getTime())?14:n}var jt={saveHashToLocalStorage:wt,getHashFromLocalStorage:function(){var e=(0,s.default)(C.Z,"hash");if(e)return e;var t=ue.isVid()?Ct():Nt(),n=le.ZP.get(t);if(n)return n;var r=Ut();if(r)return r;var a=le.ZP.get(Mt());return a&&wt({hash:a}),a},getFallbackHash:Ut,removeCurrentHashFromLocalStorage:function(){if(le.ZP.set(Mt(),null),ue.isVid()){var e=Ct();if(le.ZP.get(e))return void le.ZP.set(e,null)}le.ZP.set(Nt(),null)},getPasswordFromSessionStorage:function(){var e=(ue.isVid()?"v:":"c:")+ue.id(),t="c:".concat(C.Z.cId),n="ustreamContentPw-".concat(e),r="ustreamContentPw-".concat(t);try{var a=window.sessionStorage.getItem(n);if(a)return JSON.parse(a).value;var i=window.sessionStorage.getItem(r);return JSON.parse(i).value}catch(e){return}}};function kt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Gt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?kt(Object(n),!0).forEach((function(t){Bt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Bt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Vt,Ht={hash:(Vt=jt.getHashFromLocalStorage(),xt(Vt)?Vt:void 0),password:jt.getPasswordFromSessionStorage(),info:{},id:null,lock:{type:"",data:{}},hashInvalid:!1,viewerAuthToken:C.Z.viewerToken};function xt(e){return"false"!==e}var Yt={setWebkitSupportsFullscreen:"SET_WEBKIT_SUPPORTS_FULLSCREEN",setStreamModuleReceivedDate:"SET_STREAM_MODULE_RECEIVED_DATE",setHash:"SET_HASH",setPosition:"SET_POSITION"},Zt=n(76741);function Kt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Wt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Kt(Object(n),!0).forEach((function(t){Qt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Kt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Qt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var zt={isBufferEmpty:!0,webkitSupportsFullscreen:!1,audioTracks:[],closedCaptionTracks:[],selectedAudio:-1,selectedClosedCaption:-2,closedCaptionSelection:null,closedCaptionVisible:!0,stats:{storages:{},buffers:{}},videoResolution:"",playing:!1,progress:0,position:0,ready:!1,videoTrackDisabled:!1};function Xt(e,t){var n=e.event,r=e.ranges,a=e.streamId;return"Atlas.stored"!==n?t:Wt(Wt({},t),{},Qt({},a,r))}function qt(e,t){var n=e.event,r=e.ranges,a=e.bufferId;return"Atlas.buffered"!==n?t:Wt(Wt({},t),{},Qt({},a,r))}function $t(e){var t=e.prevTracks,n=e.nextTracks,r=e.selectedTrack,a=t.find((function(e){return e.id===r}));if(!a)return-1;var i=n.filter((function(e){var t=e.language,n=e.country;return t===a.language&&n===a.country})),o=i.find((function(e){return e.id===a.id}));return o?o.id:(0,s.default)(i,"0.id",-1)}var Jt=n(26879);function en(e){for(var t=document.cookie.split(";"),n=0;n<t.length;n+=1){var r=t[n].split("=");if(r[0].trim()===e)return decodeURIComponent(r[1])}}function tn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function nn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tn(Object(n),!0).forEach((function(t){rn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function rn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var an="notice_preferences",on={ibmCookie:le.ZP.get(an)},sn=n(81635),cn=n.n(sn),un="SET_TITLE",dn="SET_TRIM_INFO",ln=n(74504),fn=n(72177);function pn(){return!(!ue.isVid()&&!ue.isOffairVid()||C.Z.isDashboard)}function mn(e,t){var n=e.initialSeekTimeInMs;if(pn()&&void 0!==t){if(n)return n;var r=ue.isOffairVid()?ue.offairVid():ue.id(),a=fn.Z.getSavedProgressToVideoId(r);if(a)return a.progress-fe.Z.CONTINUE_WATCHING_OFFSET_IN_MS}}var gn=n(29020);function En(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function vn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?En(Object(n),!0).forEach((function(t){yn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):En(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function yn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Tn={title:void 0,duration:void 0,trimmedDuration:void 0,audioOnly:!1,videoOnly:!1,mediaId:"",streamInfo:{},mediaType:void 0,isReplay:!1,thumbnails:{},trimInfo:void 0,defaultLang:void 0,is360Video:void 0,fov360Video:void 0,countryCode:void 0,regionCode:void 0,liveStatus:void 0,initialSeekTimeInMs:void 0,isAudioOnlyPlaybackAvailable:!1,sourceMedia:void 0};function hn(e){var t=e.streamFormats;return Object.prototype.hasOwnProperty.call(t,"hls/improved")?(0,s.default)(t,"hls/improved.contentAccess.accessList.0.data.hasAudioOnlyPlaylist",!1):!(Object.prototype.hasOwnProperty.call(t,"flv/segmented")&&!cn().capabilities.includes(cn().formats.MP4_SEGMENTED))}function bn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Sn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bn(Object(n),!0).forEach((function(t){On(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function On(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var An={allTimeTotal:null,allViewers:null,viewers:null};function In(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ln(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?In(Object(n),!0).forEach((function(t){_n(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):In(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Dn(e){return"secureUrl"in e}function Pn(e){var t=e.find(Dn);if(!t)return null;var n=t.secureUrl,r=t.clickUrl;return r?{url:n,clickUrl:r}:{url:n}}var Rn={showDefaultLogo:!1,customLogo:null},Nn=n(38727);function Cn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function wn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Cn(Object(n),!0).forEach((function(t){Un(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Cn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Un(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Mn={facebook:void 0,twitter:void 0,mail:void 0,embed:void 0,copyLink:void 0,enabled:!1},Fn=n(25790);function jn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function kn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?jn(Object(n),!0).forEach((function(t){Gn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Gn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Bn={showHiddenContextMenuItems:!1};function Vn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Hn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Vn(Object(n),!0).forEach((function(t){xn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function xn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Yn={userName:null,benefits:[]},Zn=n(47157);function Kn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Wn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Kn(Object(n),!0).forEach((function(t){Qn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Kn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Qn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var zn=n(40576);function Xn(e){var t=(0,s.default)(e,"location","");return/multicast\//.test(t)}function qn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $n(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qn(Object(n),!0).forEach((function(t){Jn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Jn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function er(e){return er="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},er(e)}var tr={finalResult:[],forcedUrl:"",fallback:"",location:"",preferredLocation:[],cdnConfig:{}};function nr(e){return"object"!==er(e)||null===e?e:Object.assign(e,{isMulticastProvider:Xn(e)})}var rr=n(70875);function ar(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ir(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ar(Object(n),!0).forEach((function(t){or(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ar(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function or(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var sr={stats:{}};function cr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ur(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?cr(Object(n),!0).forEach((function(t){dr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function dr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var lr={},fr="SET_ADS_PLAYING";function pr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function mr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pr(Object(n),!0).forEach((function(t){gr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function gr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Er={adsPlaying:!1},vr=n(23353),yr=n(65529);function Tr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function hr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Tr(Object(n),!0).forEach((function(t){br(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Tr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function br(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Sr={visible:!1,message:"",icon:"",isPermanent:!1,timeoutInMs:null},Or={fullScreen:!1,volume:100,speed:1,theaterMode:{visible:function(){if(Ie.get("theaterVisible"))return!0;var e=document.querySelector(".ve-container"),t=e&&!e.classList.contains("no-rightbar")&&!e.classList.contains("no-socialstream");return!(!Ie.get("sitemode")||!t)}(),enabled:!1},statsOverlayVisible:!1,debugOverlayVisible:!1,assistedReportingOverlayVisible:!1,playerSize:{width:0,height:0},isBrowserOldNotificationVisible:!1,isAssistedReportingNotificationVisible:!1,loading:!1,messageScreens:Object.values(yr.Oh).reduce((function(e,t){return hr(hr({},e),{},br({},t,Sr))}),{})};function Ar(e){var t=e;return e>100?t=100:e<0&&(t=0),t}function Ir(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Lr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ir(Object(n),!0).forEach((function(t){_r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ir(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Dr={},Pr=n(38891),Rr=n(50812);function Nr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Cr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Nr(Object(n),!0).forEach((function(t){wr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function wr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ur(e){return function(e){if(Array.isArray(e))return Mr(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Mr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Mr(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Mr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Fr=function(e,t){var n=Ur(e),r=n.length,a=n[r-1],i=a&&a[a.length-1],o=function(e){return e.msg===t.msg&&t.timeStamp-e.timeStamp<3e3};return Array.isArray(a)&&o(i)?n[r-1]=[].concat(Ur(a),[t]):a&&o(a)?n[r-1]=[a,t]:n=[].concat(Ur(e),[t]),n},jr={keyFrameInterval:"N/A",frameRate:"N/A",dropRate:"N/A",INIT:{groupId:"FLOT",status:Rr.Q.LOADING,data:[]},TIMING:{groupId:"FLOT",status:Rr.Q.LOADING,data:[],timeToStartInMs:null},DISCONNECTS:{groupId:"FLOT",status:Rr.Q.SUCCESS,data:[]},REJECTS:{groupId:"FLOT",status:Rr.Q.SUCCESS,data:[]},EMPTY_MODULE:{groupId:"FLOT",status:Rr.Q.SUCCESS,data:[]},DOWNLOAD:{groupId:"QOS",isEcdn:!1,status:Rr.Q.SUCCESS,data:[],highestTotal:0},PLAYBACK_RECOVERABLE:{groupId:"PLAYBACK",status:Rr.Q.SUCCESS,data:[]},PLAYBACK_NON_RECOVERABLE:{groupId:"PLAYBACK",status:Rr.Q.SUCCESS,data:[]},EMPTY_CHUNK:{groupId:"PLAYBACK",status:Rr.Q.SUCCESS,data:[]}},kr="SET_INITIAL_LOADING_TIME",Gr="SET_UMS_CONNECTION_START_TIME",Br="SET_UMS_CONNECTION_CONNECTED_TIME",Vr="SET_STREAM_MODULE_RECEIVED_TIME",Hr="SET_FIRST_FRAME_TIME";function xr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Yr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xr(Object(n),!0).forEach((function(t){Zr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Zr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Kr={initialLoadingTime:void 0,umsConnectionStartTime:void 0,umsConnectionConnectedTime:void 0,streamModuleReceivedTime:void 0,firstFrameTime:void 0},Wr="RESET_CHAPTERS",Qr=n(90271);function zr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Xr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zr(Object(n),!0).forEach((function(t){qr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function qr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var $r={panelVisible:!1,markersVisible:!0,chapters:[]};function Jr(e){return e.startsWith("channel")}var ea,ta,na={key:"root",storage:Fe.Z,whitelist:[]},ra={key:"provider",storage:Fe.Z,whitelist:["forcedUrl"]},aa={key:"mte_viewer_volume",storage:Fe.Z,whitelist:["volume"]},ia={key:"captionSettings",storage:Fe.Z,whitelist:["options"]},oa={key:"hidden_context_menu_items",storage:Fe.Z,whitelist:["showHiddenContextMenuItems"]},sa=(0,Ue.UY)({ads:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Er,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;return n===fr?mr(mr({},e),{},{adsPlaying:r.adsPlaying}):e},broadcaster:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Yn,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case ht:var a=Hn({},e),i=(0,s.default)(r,"userName",null);a.userName=i;var o=(0,s.default)(r,"broadcaster.benefits");return Array.isArray(o)&&(a.benefits=o),a;case Lt:var c=(0,s.default)(r,"benefits",[]);return Hn(Hn({},e),{},{benefits:c});default:return e}},captionSearch:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:qe,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case We.Z.toggleCaptionSearchPanel:return ze(ze({},e),{},{panelVisibility:r.panelVisibility});case We.Z.setSearchText:return ze(ze({},e),{},{searchText:r.searchText});case Ze:return ze(ze({},e),{},{module:r.module,visibility:r.visibility});case Ke:var a=r.searchResult;return Array.isArray(a)?ze(ze({},e),{},{searchResult:a.slice().sort((function(e,t){return e.start_sec-t.start_sec}))}):ze(ze({},e),{},{searchResult:a});case Ye:return ze(ze({},e),{},{visibility:r.visibility});default:return e}},captionSettings:(0,Me.OJ)(ia,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:nt,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case $e.Z.setActiveCues:return et(et({},e),{},{activeCues:r});case $e.Z.setOptions:var a=Ie.get("externalvtt")?e.options:et(et({},e.options),r);return a.live?(a.textAlignLive=a.textAlign,delete a.textAlign):(a.textAlignVod=a.textAlign,delete a.textAlign),et(et({},e),{},{options:a});case $e.Z.resetOptions:return et(et({},e),{},{options:{}});default:return e}})),chapters:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$r,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case Qr.Z.setChapterMarkersVisibility:return Xr(Xr({},e),{},{markersVisible:r});case Qr.Z.setChaptersPanelVisibility:return Xr(Xr({},e),{},{panelVisible:r});case ht:var a=r.chapters,i=r.mid;if("string"==typeof i&&Jr(i))return e;if(!a||0===a.length)return Xr(Xr({},e),{},{chapters:[]});var o=a.map((function(e){return{position:e.position,title:e.title}})).sort((function(e,t){return e.position-t.position}));return Xr(Xr({},e),{},{chapters:o});case Wr:return $r;default:return e}},content:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Tn,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case un:return vn(vn({},e),{},{title:r});case ln.Z.setDuration:return vn(vn({},e),{},{duration:r});case ln.Z.setTrimmedDuration:return vn(vn({},e),{},{trimmedDuration:r,initialSeekTimeInMs:mn(e,r)});case ln.Z.toggleAudioOnly:return vn(vn({},e),{},{audioOnly:r});case ln.Z.toggleVideoOnly:return vn(vn({},e),{},{videoOnly:r});case ln.Z.setStreamInfo:return vn(vn({},e),{},{streamInfo:r.streamInfo});case ln.Z.setMediaId:return vn(vn({},e),{},{mediaId:r.id});case ln.Z.setMediaType:return vn(vn({},e),{},{mediaType:r});case ht:var a=r.isReplay,i=r.cut,o=r.highlight,s=r.defaultLang,c=r.video360,u=r.video360Fov,l=r.live360,f=r.live360Fov,p=r.countryCode,m=void 0===p?e.countryCode:p,g=r.regionCode,E=void 0===g?e.regionCode:g,v=u||f;return v=v?(0,d.Z)(parseInt(v,10),{lower:0,upper:360}):void 0,vn(vn({},e),{},{isReplay:a,trimInfo:i||o,defaultLang:s?s.replace("-00",""):void 0,is360Video:c||l,fov360Video:v,countryCode:m,regionCode:E});case Tt:var y=e.isAudioOnlyPlaybackAvailable,T=e.sourceMedia;return(0,gn.M)(r)||(y=hn(r),r.contentAvailable&&(T=r.sourceMedia)),vn(vn({},e),{},{sourceMedia:T,isAudioOnlyPlaybackAvailable:y});case Dt:return vn(vn({},e),{},{thumbnails:r});case dn:return vn(vn({},e),{},{trimInfo:r});case ln.Z.setLiveStatus:return vn(vn({},e),{},{liveStatus:r});default:return e}},contextMenu:(0,Me.OJ)(oa,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Bn,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;if(n===Fn.Z.toggleHiddenContextMenuItems){var a=r.isVisible;return kn(kn({},e),{},{showHiddenContextMenuItems:a})}return e})),debug:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:jr,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case Pr.Z.addFlotInitDiagnostics:return Cr(Cr({},e),{},{INIT:Cr(Cr({},e.INIT),{},{status:r.inited?Rr.Q.SUCCESS:Rr.Q.ERROR})});case Pr.Z.addFlotDisconnectError:return Cr(Cr({},e),{},{DISCONNECTS:Cr(Cr({},e.DISCONNECTS),{},{status:Rr.Q.WARNING,data:[].concat(Ur(e.DISCONNECTS.data),[r])})});case Pr.Z.addFlotRejectError:return Cr(Cr({},e),{},{REJECTS:Cr(Cr({},e.REJECTS),{},{status:Rr.Q.ERROR,data:[].concat(Ur(e.REJECTS.data),[r])})});case Pr.Z.addFlotTimingDiagnostics:return Cr(Cr({},e),{},{TIMING:Cr(Cr({},e.TIMING),{},{status:r.timeToStartInMs<=5e3?Rr.Q.SUCCESS:Rr.Q.WARNING,timeToStartInMs:r.timeToStartInMs})});case Pr.Z.addFlotEmptyStreamModuleError:var a=r.isEmpty,i=!!e.EMPTY_MODULE.data.length;return i||a?Cr(Cr({},e),{},{EMPTY_MODULE:Cr(Cr({},e.EMPTY_MODULE),{},{status:Rr.Q.WARNING,data:[].concat(Ur(e.EMPTY_MODULE.data),[r])})}):e;case Pr.Z.addSlowChunkWarning:return Cr(Cr({},e),{},{DOWNLOAD:Cr(Cr({},e.DOWNLOAD),{},{status:Rr.Q.WARNING,data:[].concat(Ur(e.DOWNLOAD.data),[r]),isEcdn:!!r.isEcdn,highestTotal:e.DOWNLOAD.highestTotal<r.total?r.total:e.DOWNLOAD.highestTotal})});case Pr.Z.addPlaybackWarning:case Pr.Z.addPlaybackError:var o=n===Pr.Z.addPlaybackError,s=o?Rr.Q.ERROR:Rr.Q.WARNING,c=o?"PLAYBACK_NON_RECOVERABLE":"PLAYBACK_RECOVERABLE";return Cr(Cr({},e),{},wr({},c,Cr(Cr({},e[c]),{},{status:s,data:Fr(e[c].data,r)})));case Pr.Z.addChunkEmptyWarning:return Cr(Cr({},e),{},{EMPTY_CHUNK:Cr(Cr({},e.EMPTY_CHUNK),{},{status:Rr.Q.WARNING,data:[].concat(Ur(e.EMPTY_CHUNK.data),[r])})});case Pr.Z.addKeyFrameDiagnostics:return Cr(Cr({},e),{},{keyFrameInterval:"number"==typeof r.keyFrameInterval?r.keyFrameInterval:"N/A"});case Pr.Z.addFrameAndDropRate:var u=r.frameRate,d=void 0===u?"N/A":u,l=r.dropRate,f=void 0===l?"N/A":l;return Cr(Cr({},e),{},{frameRate:d,dropRate:f});case Pr.Z.resetDebugOverlay:return jr;default:return e}},externalVtt:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xe,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;if(n===Ge.Z.addExternalVtt){var a=r.vtt;return Ve(Ve({},e),{},{hasExternalVtt:!!a.length,vtt:a})}return e},liveCTA:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:lr,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;if(n===_t){var a=r.remove;if(a)return{};var i=r.activate;return i?ur({},i):e}return e},logo:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Rn,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;if(n===At){var a=r&&r.some((function(e){return!Dn(e)})),i=r?Pn(r):null;return Ln(Ln({},e),{},{showDefaultLogo:a,customLogo:i})}return e},playback:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:zt,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case Zt.Z.setBufferEmpty:return Wt(Wt({},e),{},{isBufferEmpty:r.isBufferEmpty});case Yt.setWebkitSupportsFullscreen:return Wt(Wt({},e),{},{webkitSupportsFullscreen:r.supports});case Zt.Z.setAudioTracks:var a=r.tracks,i=$t({prevTracks:e.audioTracks,nextTracks:a,selectedTrack:e.selectedAudio});return Wt(Wt({},e),{},{selectedAudio:i,audioTracks:a});case Zt.Z.selectAudio:var o=r.index,c=e.audioTracks.some((function(e){return e.id===o}));return c?Wt(Wt({},e),{},{selectedAudio:o}):e;case Yt.setStreamModuleReceivedDate:var u=r.ts;return Wt(Wt({},e),{},{lastStreamModuleReceived:u});case Zt.Z.selectClosedCaption:var l=r.index;return Wt(Wt({},e),{},{selectedClosedCaption:l,closedCaptionVisible:-1!==l});case Zt.Z.setClosedCaptionTracks:var f=r.tracks,p=r.closedCaptionActiveFromLocalStorage,m=e.selectedClosedCaption,g=e.closedCaptionSelection;if(f.length>0&&-2===m){var E=(0,s.default)(f.find((function(e){return e.default})),"id",null);E||0===E?(m=E,g="broadcaster"):p?(m=0,g="history"):(m=-1,g="manual")}return Wt(Wt({},e),{},{closedCaptionTracks:f,selectedClosedCaption:m,closedCaptionSelection:g});case Zt.Z.setCodecInfo:var v=r.codec,y=v.width,T=v.height,h=v.audioCodec,b=v.videoCodec;return Wt(Wt({},e),{},{audio:{codec:h},video:{width:y,height:T,codec:b},videoResolution:y&&T?"".concat(y,"x").concat(T):null});case Zt.Z.setPlaybackStats:var S=Xt(r.stats,e.stats.storages),O=qt(r.stats,e.stats.buffers);return Wt(Wt({},e),{},{stats:{storages:S,buffers:O}});case Zt.Z.togglePlaying:return Wt(Wt({},e),{},{playing:r});case Yt.setHash:return Wt(Wt({},e),{},{hashes:Wt(Wt({},e.hashes),r)});case Zt.Z.setProgress:return Wt(Wt({},e),{},{progress:(0,d.Z)(r,{lower:0,upper:1})});case Yt.setPosition:var A=r.position;return Wt(Wt({},e),{},{position:A});case Zt.Z.setReady:return Wt(Wt({},e),{},{ready:r});case Zt.Z.toggleVideoTrack:return Wt(Wt({},e),{},{videoTrackDisabled:r});default:return e}},player:(0,Me.OJ)(aa,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Or,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case vr.Z.toggleFullScreen:return hr(hr({},e),{},{fullScreen:r});case vr.Z.setVolume:return hr(hr({},e),{},{volume:Ar(r)});case vr.Z.setPlaybackSpeed:return hr(hr({},e),{},{speed:r});case vr.Z.toggleTheaterMode:var a=hr(hr({},e.theaterMode),r);return hr(hr({},e),{},{theaterMode:a});case vr.Z.toggleStatsOverlay:return hr(hr({},e),{},{statsOverlayVisible:r,debugOverlayVisible:!1,assistedReportingOverlayVisible:!1});case vr.Z.toggleDebugOverlay:return hr(hr({},e),{},{debugOverlayVisible:r,statsOverlayVisible:!1,assistedReportingOverlayVisible:!1});case vr.Z.toggleAssistedReportingOverlay:return hr(hr({},e),{},{debugOverlayVisible:!1,statsOverlayVisible:!1,assistedReportingOverlayVisible:r});case vr.Z.resize:return hr(hr({},e),{},{playerSize:r});case vr.Z.showNotification:var i=r===yr.GT.oldBrowser||e.isBrowserOldNotificationVisible,o=r===yr.GT.assistedReporting||e.isAssistedReportingNotificationVisible,s=hr(hr({},e),{},{isBrowserOldNotificationVisible:i,isAssistedReportingNotificationVisible:o});return hr(hr({},e),s);case vr.Z.hideNotification:var c=r!==yr.GT.oldBrowser&&e.isBrowserOldNotificationVisible,u=r!==yr.GT.assistedReporting&&e.isAssistedReportingNotificationVisible,d=hr(hr({},e),{},{isBrowserOldNotificationVisible:c,isAssistedReportingNotificationVisible:u});return hr(hr({},e),d);case vr.Z.closeAssistedReportingNotificationByUser:var l=hr(hr({},e),{},{isAssistedReportingNotificationVisible:!1,isAssistedReportingNotificationClosedByUser:!0});return hr(hr({},e),l);case vr.Z.toggleLoading:return hr(hr({},e),{},{loading:r});case vr.Z.showMessageScreen:var f=r.type,p=e.messageScreens,m=Object.keys(p).reduce((function(e,t){var n=t===f?hr(hr({},p[f]),{},{visible:!0},r):Sr;return hr(hr({},e),{},br({},t,n))}),{});return hr(hr({},e),{},{messageScreens:hr({},m)});case vr.Z.hideMessageScreen:var g=r.type,E=e.messageScreens,v=hr(hr({},Sr),{},{visible:!1});return hr(hr({},e),{},{messageScreens:hr(hr({},E),{},br({},g,v))});default:return e}})),poll:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Dr,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;if(n===Pt){var a=r.remove;if(a)return{};var i=Lr({},e),o=(0,s.default)(r,"pollStart");o&&(i=Lr({},o));var c=(0,s.default)(r,"pollStop.stoppedAt");return c&&Object.assign(i,{stoppedAt:c}),i}return e},privacy:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:on,t=arguments.length>1?arguments[1]:void 0,n=t.type;return n===Jt.Z.updatePrivacyCookie?nn(nn({},e),{},{ibmCookie:en(an)}):e},provider:(0,Me.OJ)(ra,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:tr,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case zn.Z.setProvidersStats:var a=(0,s.default)(r.stats,"finalResult",e.finalResult),i=(0,s.default)(r.stats,"fallback",e.fallback),o=(0,s.default)(r.stats,"location",e.location),c=(0,s.default)(r.stats,"preferredLocation",e.preferredLocation),u=(0,s.default)(r.stats,"cdnConfig",e.cdnConfig);return $n($n({},e),{},{finalResult:a,fallback:i,location:o,preferredLocation:c,cdnConfig:u});case zn.Z.setCurrentProvider:var d=r.provider,l=nr(d);return $n($n({},e),{},{currentProvider:l});case zn.Z.setForcedProviderUrl:return $n($n({},e),{},{forcedUrl:r.url});default:return e}})),qos:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:sr,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;return n===rr.Z.setStatsData?ir(ir({},e),{},{stats:ir(ir({},e.stats),r.stats)}):e},seekbar:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:gt,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case lt.Z.setActiveMarker:return pt(pt({},e),{},{activeMarker:r.activeMarker});case lt.Z.clearActiveMarker:return gt;default:return e}},settings:function(e,t){var n=t.type,r=t.payload,a={debug:le.ZP.get(le.Bx)||!!Ie.get("debug"),isTitleVisible:!0},i=void 0===e?a:e;switch(n){case Zn.Z.toggleDebug:return Wn(Wn({},i),{},{debug:r});case Zn.Z.toggleTitleVisibility:return Wn(Wn({},i),{},{isTitleVisible:r});default:return i}},share:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Mn,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;if(n===It){var a=(0,Nn.Z)(r,["facebook","twitter","mail","embed","copy-link"]),i=a.facebook,o=a.twitter,s=a.mail,c=a.embed,u=a["copy-link"];return wn(wn({},e),{},{facebook:i,twitter:o,mail:s,embed:c,copyLink:u,enabled:!!r})}return e},slideDeck:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:dt,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case rt:return ct({},dt);case at:var a=r.slides.slice().sort((function(e,t){return(0,s.default)(e,"start",-1)-(0,s.default)(t,"start",-1)}));return ct(ct({},e),{},{slides:a,isEnabled:!0});case it:var i=(0,s.default)(r,"slide.url",""),o=i.length?r.slide:null;return ct(ct({},e),{},{currentSlide:o,isEnabled:!0});case ot.Z.setOnboarding:return ct(ct({},e),{},{onboarding:r.onboarding});case ot.Z.toggleSlideIndexPanel:return ct(ct({},e),{},{slideIndexPanelVisible:r});default:return e}},tracking:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Kr,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case kr:return Yr(Yr({},e),{},{initialLoadingTime:r,umsConnectionStartTime:void 0,umsConnectionConnectedTime:void 0,streamModuleReceivedTime:void 0,firstFrameTime:void 0});case Gr:return Yr(Yr({},e),{},{umsConnectionStartTime:r,umsConnectionConnectedTime:void 0,streamModuleReceivedTime:void 0,firstFrameTime:void 0});case Br:return Yr(Yr({},e),{},{umsConnectionConnectedTime:r,streamModuleReceivedTime:void 0,firstFrameTime:void 0});case Vr:return Yr(Yr({},e),{},{streamModuleReceivedTime:r,firstFrameTime:void 0});case Hr:return Yr(Yr({},e),{},{firstFrameTime:r});default:return e}},ums:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ht,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case yt.Z.addPassword:return Gt(Gt({},e),{},{password:r.password,lock:{type:"",data:{}}});case yt.Z.addHash:var a=!xt(r.hash);return Gt(Gt({},e),{},{hashInvalid:a,hash:r.hash,lock:{type:"",data:{}}});case Et:return Gt(Gt({},e),{},{hash:null});case yt.Z.setUmsInfo:return Gt(Gt({},e),{},{info:r.info});case ht:return Gt(Gt({},e),{},{id:r.umsId});case vt:return Gt(Gt({},e),{},{lock:{type:r.type,data:r.data}});default:return e}},videoTag:function(e,t){var n=e||null,r=t.type,a=t.payload;switch(r){case je:return a.videoTag;case ke:return null;default:return n}},viewers:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:An,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case bt:return Sn(Sn({},e),{},{allTimeTotal:r});case St:return Sn(Sn({},e),{},{allViewers:r});case Ot:return Sn(Sn({},e),{},{viewers:r});default:return e}}}),ca=(0,Me.OJ)(na,sa),ua=n(38209),da=(0,c.w)("atlas/logic/api"),la={COMMAND:"api_command"},fa={},pa="api-target-origin";function ma(e){return ea||function(e){try{return new URL(e).origin}catch(e){return""}}(e)}function ga(e,t){var n=document.referrer||window.location.href,r=window.parent,a=/^(\/internal)?\/combined-embed\//.test(window.location.pathname);if((window===window.parent||a)&&(n=window.location.href,r=window),"progress"!==e&&da.debug("send ",[e,t]),n){var i=ma(n);if(i){var o={event:{}};e.property?o=e:o.event[e]=t,r.postMessage(JSON.stringify(o),i)}}}window.addEventListener("message",(function(e){var t,n,r=e.origin,a=window.location,i=document.referrer||a.href;if(i){if(r===ma(i)||(n=[r,a.href].map((function(e){try{return new URL(e).host}catch(e){return""}})))[0]===n[1]){try{t=JSON.parse(e.data)}catch(e){t={}}if("CorsFrame"===t.id&&t.sessionId&&(0,g.Z)(fa,la.COMMAND,{cmd:"setSession",args:[t.sessionId,!1]}),"setSession"===t.cmd&&!function(e){return/(m|www)\.?(dev)?\.ustream\.tv/gi.test(e)}(r))return;t.cmd&&(0,g.Z)(fa,la.COMMAND,t)}}else da.debug("message event handler error: no referrer ")})),(ta=document.getElementById("CorsFrame"))&&(o().ssl||Ie.get("sitemode")||ta.setAttribute("src",ta.getAttribute("data-src")));var Ea=function(){if(void 0===window.postMessage)return{event:la,send:function(){},on:function(){}};if(Ie[pa]){var e=decodeURIComponent(Ie[pa]);try{var t=new URL(e);ea=t.origin}catch(e){da.error("api-target-origin is not a valid URL")}}return{event:la,send:ga,on:function(e,t){fa[e]||(fa[e]=[]),fa[e].push(t)}}}(),va=[Zt.Z.selectAudio,Zt.Z.setAudioTracks],ya=[Zt.Z.selectClosedCaption,Zt.Z.setClosedCaptionTracks];function Ta(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ha(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ta(Object(n),!0).forEach((function(t){ba(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ta(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ba(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Sa="is_cc_active",Oa=n(83935);function Aa(e,t){var n=e.find((function(e){return e.id===t}));if(!n)return null;var r=n.country,a=void 0===r?"00":r,i=n.language,o=n.isGenerated;return{language:"".concat(i,"-").concat(a),generated:o}}function Ia(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function La(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ia(Object(n),!0).forEach((function(t){_a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ia(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Da(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){s=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(s)throw a}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Pa(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Pa(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pa(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ra=n(38557),Na=(0,Ue.MT)(ca,{},(0,ua.U)((0,Ue.md)((function(){return function(e){return function(t){return t.type===yt.Z.addHash&&("false"!==t.payload.hash?jt.saveHashToLocalStorage(t.payload):jt.removeCurrentHashFromLocalStorage()),t.type===yt.Z.removeHash&&jt.removeCurrentHashFromLocalStorage(),e(t)}}}),(function(e){return function(t){return function(n){var r=t(n);if(va.includes(n.type)){var a=e.getState().playback,i=a.selectedAudio,o=a.audioTracks;if(o.length>0){var s=o.map((function(e){var t=e.id;return{index:t,label:e.label,language:e.language,country:e.country,active:i===t}}));Ea.send("audio",s)}}return r}}}),(function(e){return function(t){return function(n){var r=t(n);if(ya.includes(n.type)){var a=(0,we.I6)(e.getState()),i=e.getState().playback.selectedClosedCaption;if(a.length>0){var o=a.map((function(e){var t=e.id;return{index:t,label:e.label,language:e.language,country:e.country,active:i===t}}));Ea.send("cc",o)}}return r}}}),(function(e){return function(t){return function(n){if(n.type===Zt.Z.selectClosedCaption){var r=n.payload.index>=0;le.ZP.set(Sa,r,{expires:3650})}if(n.type===Zt.Z.setClosedCaptionTracks&&-2===e.getState().playback.selectedClosedCaption){var a=le.ZP.get(Sa),i=ha(ha({},n.payload),{},{closedCaptionActiveFromLocalStorage:a});return t(ha(ha({},n),{},{payload:i}))}return t(n)}}}),(function(e){return function(t){return function(n){if(n.type===Yt.selectClosedCaption){var r=(0,s.default)(e.getState(),"playback.selectedClosedCaption"),a=(0,s.default)(n,"payload.index");if(r!==a){var i=(0,s.default)(e.getState(),"playback.closedCaptionTracks",[]),o=(0,s.default)(e.getState(),"content.mediaType")===Oa.w_.live?"live":"vod";if(a>-1){var c=Aa(i,a);c&&Ce.send({message:"Turn on CC",data:{category:"Interaction",item:"CC",action:"turn_on",type:o,language:c.language,generated:c.generated}})}else{var u=Aa(i,r);u&&Ce.send({message:"Turn off CC",data:{category:"Interaction",item:"CC",action:"turn_off",type:o,language:u.language,generated:u.generated}})}}}return t(n)}}}),(function(e){return function(t){return function(n){var r=t(n);if(n.type===Zn.Z.toggleDebug){var a=e.getState().settings.debug;le.ZP.set(le.Bx,a)}return r}}}),(function(){return function(e){return function(t){var n=t.type,r=t.payload;if(n===Dt){var a=function(e){return/SecureUrl$/.test(e)},i=Object.fromEntries(Object.entries(r).filter((function(e){var t=Da(e,1)[0];return o().ssl&&a(t)||!o().ssl&&!a(t)})).map((function(e){var t=Da(e,2),n=t[0],r=t[1];return[n.replace(/(?:Secure)?Url$/,""),r]})));return e(La(La({},t),{},{payload:i}))}return e(t)}}}),Ra.Z,(function(){return function(e){return function(t){if(t.type===ln.Z.setTrimmedDuration){if(!pn())return e(t);var n=t.payload,r=ue.isOffairVid()?ue.offairVid():ue.id(),a=fn.Z.getSavedProgressToVideoId(r);if(void 0===n||!a)return e(t);var i=a.progress,o=a.cut,s=o?ue.getRelativeSeekPositionInMs(i):i,c=o&&(o.cutStart!==ue.getCutStart()||o.cutEnd!==ue.getCutEnd()),u=1e3*t.payload,d=s-fe.Z.CONTINUE_WATCHING_OFFSET_IN_MS,l=d<0||d>=u-fe.Z.CONTINUE_WATCHING_OFFSET_IN_MS-500;(c||l)&&fn.Z.removeProgressForVideoId(r)}if(t.type===Yt.setPosition){if(!pn())return e(t);var f=t.payload,p=f.position,m=f.sourceMedia,g=ue.getHighlight(),E=!g||0===g.cutStart&&1===g.cutEnd?void 0:g;fn.Z.saveProgressToCurrentVideoId(p,"".concat(m),E)}return e(t)}}}))));(0,Me.p5)(Na);var Ca=Na,wa=(0,n(17719).Z)(Ca),Ua={};function Ma(){Ua={}}var Fa={cleanup:Ma,setInitStart:function(){Ua.initStart=Date.now();var e=(0,we.hz)(wa.getState()),t=e.width,n=e.height;Ce.send({message:"Initial loading started",data:{category:"Loading",item:"initial loading",action:"started",width:t,height:n}})},reportUmsConnectionStart:function(e){Ua.ums=Ua.ums||{},Ua.ums[e]={startTime:Date.now()},Ce.send({message:"UMS connection started",data:{category:"Loading",item:"UMS connection",action:"connected",autoplay:Ie.get("autoplay"),time_spent_from_init:Ua.ums[e].startTime-Ua.initStart}})},reportUmsConnectionFinished:function(e){Ua.ums&&Ua.ums[e]&&(Ua.ums[e].endTime=Date.now(),Ce.send({message:"UMS connection completed",data:{category:"Loading",item:"UMS connection",action:"connected",autoplay:Ie.get("autoplay"),time_spent:Ua.ums[e].endTime-Ua.ums[e].startTime,time_spent_from_init:Ua.ums[e].endTime-Ua.initStart}}))},reportStreamModuleReceived:function(){Ua.ums&&(Ua.streamModule=Date.now(),Ce.send({message:"Stream module received",data:{category:"Loading",item:"stream module",action:"received",time_spent_from_init:Ua.streamModule-Ua.initStart,time_spent:Ua.streamModule-Object.keys(Ua.ums).reduce((function(e,t){var n=Ua.ums[t].endTime;return n>e?n:e}),0),autoplay:Ie.get("autoplay")}}))},reportFirstTimeUpdate:function(){var e=Date.now();Ce.send({message:"First time update",data:{category:"Playback",item:"playback",action:"started",time_spent:e-Ua.streamModule,time_spent_from_init:e-Ua.initStart,autoplay:Ie.get("autoplay")}}),Ma()},reportFirstPlayCall:function(){Ua.firstPlayCall=Date.now(),Ce.send({message:"First Play call",data:{category:"Interaction",item:"playback",action:"requested",time_spent:Ua.firstPlayCall-Ua.streamModule,time_spent_from_init:Ua.firstPlayCall-Ua.initStart,autoplay:Ie.get("autoplay")}})}},ja=n(43308),ka=n(71489),Ga=n.n(ka);function Ba(e){return{type:ht,payload:e}}function Va(e){return{type:_t,payload:e}}function Ha(e){return{type:Pt,payload:e}}var xa=(0,c.w)("atlas/data/datamanager"),Ya={};var Za=function(e){xa.debug("createMedia: ".concat(e),void 0,!0),Ya[e]={}},Ka=function(e){xa.debug("destroyMedia:",e),delete Ya[e]},Wa=!(ue.isCid()&&o().android&&2===o().android[0])&&!o().swf&&!o().ie&&!!document.createElement("video").canPlayType&&o().android||o().blackberry||o().ios||o().playstation||!!Ie.get("ios")||!!Ie.get("refTest")||!!Ie.get("html5"),Qa={AD_EVENT:"ustreamAdEvent",AD_ERROR:"ustreamProviderError",AD_STARTED:"ustreamAdStarted",AD_FINISHED:"ustreamAdFinished",AD_CHANGED:"ustreamAdChanged",DELAY_STARTED:"ustreamDelayStarted",DELAY_FINISHED:"ustreamDelayFinished",DELAY_ERROR:"ustreamDelayError",types:{PLAY_POSTROLL:"adEvent.type.playPostroll",VIDEO_FINISHED:"adEvent.type.videoFinished",POSTROLL_FINISHED:"adEvent.type.postrollFinished",VIDEO_STARTED:"adEvent.type.videoStarted",PREROLL_DONE:"adEvent.type.prerollDone",COMPANION:"adEvent.type.companion",AD_RESIZE:"adEvent.type.adResize",RULESET_HAS_ADS:"adEvent.type.rulesetHasAds"}},za=n(26451),Xa=n(87757),qa=n(4469),$a=n(25657),Ja=n(63647),ei=(0,c.w)("htmlApiProxy"),ti=Math.pow(10,3),ni=!1,ri=0,ai=0,ii=0,oi=0;function si(e){ni=e}function ci(e){ri=e}function ui(e){ai=e}function di(e){var t=function(e){var t=ue.getDurationInMillisec()/1e3;return 0===e||0===t?0:ue.isHLS()?ue.getTrimmedDurationInMillisec()/1e3*e:e*t-t*ue.getCutStart()}(e);ii=Math.round(t*ti)/ti}function li(e){oi=e}function fi(e,t){var n={property:{}};n.property[e]=t,Ea.send(n)}function pi(e){switch(ei.debug("api command received",e),e.cmd){case"probe":(0,we.DK)(wa.getState())&&Ea.send("ready",!0);break;case"play":Ie.set("autoplay",!0),U().setPlay();break;case"pause":U().setPause();break;case"stop":U().setPause(),U().setSeek(0);break;case"load":I(h,A.LOAD,e.args),ni&&I(h,A.PLAY);break;case"seek":var t=1e3*e.args[0],n=ue.getTrimmedDurationInMillisec();if(!cn().initialized||!n)return void ue.saveSeek({positionInMs:t,initiator:w._.USER});if(t<0||t>n)return;ue.resetSavedSeek();var r=t/n;U().setSeek(r);break;case"volume":if(null!==e.args[0])return void wa.dispatch((0,yr.jA)(e.args[0]));var a=cn().initialized?100*cn().getVolume():null;fi(e.cmd,a);break;case"content":fi(e.cmd,[ue.app()].concat(ue.ids()));break;case"playingContent":!function(e){ue.isCid()&&!ue.live()?fi(e.cmd,oi?["recorded",oi]:[]):fi(e.cmd,[ue.app()].concat(ue.ids()))}(e);break;case"duration":fi(e.cmd,ue.getDurationInMillisec()/1e3);break;case"progress":fi(e.cmd,ii);break;case"viewers":fi(e.cmd,ai);break;case"allTimeTotalViewers":fi(e.cmd,ri);break;case"quality":var i=e.args[0];I(h,A.QUALITY_CHANGE,i);break;case"setSession":U().setSession(e.args);break;case"setTitleVisibility":var o=!!e.args[0];wa.dispatch((0,qa.w)(o));break;case"pollAnswer":U().setPollAnswer(e.args[0]);break;case"pollTracking":U().setPollTracking(e.args[0]);break;case"cc":wa.dispatch((0,Xa.JM)(parseInt(e.args[0],10)));break;case"setExternalVtt":wa.dispatch((0,za.R)(e.args[0][0].forVTTCue));break;case"audio":wa.dispatch((0,Xa.Ft)(parseInt(e.args[0],10)));break;case"theater":wa.dispatch((0,yr.Eu)({visible:e.args[0]}));break;case"webkitEnterFullscreen":try{var s=cn().getVideoTag();(0,$a.g)(s)}catch(e){Ea.send("error",{name:"webkitEnterFullscreenRejected",message:e.message})}break;case"stats":var c=(0,we.af)(wa.getState());fi(e.cmd,c);break;case"sendLog":var u=U();u.setLogSendingStarted(),(0,Ja.Z)({onProgress:u.setLogSendingProgress}).then((function(e){u.setLogSendingCompleted(e)})).catch((function(e){ei.error(e.message),u.setLogSendingCompleted()}))}}var mi=function(){L(S,A.ALLTIMETOTAL_UPDATE,ci),L(S,A.VIEWERS_UPDATE,ui),L(b,A.PLAYING,si),L(b,A.PROGRESS,di),L(b,A.CREATE_OFFAIR_VIDEO,li),Ea.on(Ea.event.COMMAND,pi),Ie.get("viewingexperience")&&window.$&&(window.$.capture("HIDETHEATERBUTTON",(function(){return wa.dispatch((0,yr.Eu)({visible:!1}))})),window.$.capture("SHOWTHEATERBUTTON",(function(){return wa.dispatch((0,yr.Eu)({visible:!0}))})))},gi=(0,c.w)("atlas/lib/cdngw"),Ei=0,vi=0,yi=!1;function Ti(e,t,n,r,a){var i;yi=!1,Ei>6?r.call(null):(a?i=a:(i=Math.pow(2,Ei),i*=1e3),vi=setTimeout((function(){!function(e,t,n,r,a){a?(gi.debug("gateway timeout."),r.call(null)):(Ei+=1,gi.debug("gateway timeout. Trying again ..."),Ti(e,t,n,r))}(e,t,n,r,a)}),i),e(t,n,r,a))}function hi(e,t){clearTimeout(vi),Ei=1,yi||e.call(null,t)}var bi,Si=(0,c.w)("atlas/logic/ads/provider/delay");function Oi(){bi&&I(b,Qa.DELAY_FINISHED)}function Ai(){Si.debug("reset timer"),bi&&clearTimeout(bi),bi=void 0}var Ii,Li,_i,Di,Pi,Ri,Ni,Ci,wi,Ui,Mi,Fi,ji,ki={type:"delay",start:function(e){if(Si.debug("start delay"),Ai(),e&&e.duration){var t=1e3*parseInt(e.duration,10);t>0?(Si.debug("start ".concat(t,"ms timeout")),bi=setTimeout(Oi,t),I(b,Qa.DELAY_STARTED)):I(b,Qa.DELAY_ERROR)}else I(b,Qa.DELAY_ERROR)},reset:Ai},Gi=n(88820),Bi={DEFAULT:"default",INITIALIZED:"initialized",STARTED:"started",STOPPED:"stopped",PAUSED:"paused",FAILED:"failed",IN_PROGRESS:"adInProgress"},Vi={PRE:"pre",MID:"mid",POST:"post",PARTNER:"partner",LINEAR:"lfeed"},Hi=3e4,xi=3e4,Yi=9e5,Zi={},Ki=(0,c.w)("atlas/logic/ads/providers/googleIMA"),Wi=o().ssl?"https://imasdk.googleapis.com/js/sdkloader/ima3.js":"http://imasdk.googleapis.com/js/sdkloader/ima3.js",Qi=!1,zi=!1,Xi=!1,qi=!1,$i=0,Ji=o().ios;function eo(e){void 0!==e&&clearTimeout(e)}function to(e){Qi&&I(b,Qa.AD_ERROR,{code:e})}function no(){eo(Pi),Qi&&to("400")}function ro(){eo(Ni),Qi&&to("400")}function ao(){Ki.debug("googleIMA.onAllAdsCompleted"),Qi&&I(b,Qa.AD_FINISHED)}function io(){Ki.debug("googleIMA.onTimeout"),Qi&&(eo(Di),ao())}function oo(e){var t=e.getInnerError(),n={errorCode:e.getErrorCode(),message:e.getMessage()};t&&(n.innerErrorMessage=t.message),Ki.debug("googleIMA.onAdError",n)}function so(e){e.getError()&&oo(e.getError()),eo(Pi),eo(Ri),Qi&&to("200")}function co(){Ki.debug("googleIMA.onAdLoaded"),eo(Ri),Qi&&(Ni=setTimeout(ro,xi))}function uo(){Ki.debug("googleIMA.adBreakReadyHandler"),Qi&&(Ni=setTimeout(ro,xi))}function lo(){Ki.debug("googleIMA.onContentPauseRequested"),Li.removeEventListener("ended",Ao),Ji&&(ji=Li.src,$i=Li.currentTime),I(h,A.PAUSE)}function fo(){Li.seekable.length?Li.seekable.end(0)>$i&&(Li.currentTime=$i,Li.removeEventListener("loadedmetadata",fo),I(h,A.PLAY)):setTimeout(fo,100)}function po(){Ki.debug("googleIMA.onContentResumeRequested"),Zi.isAdBlockPlaying||(Li.addEventListener("ended",Ao),Ji?(Li.src=ji,Li.addEventListener("loadedmetadata",fo),Li.load()):I(h,A.PLAY))}function mo(){Ki.debug("googleIMA.onAdStarted"),eo(Ni),Qi&&(I(b,Qa.AD_STARTED),(_i.forceTimer||"video"!==_i.type)&&_i.duration&&1e3*parseInt(_i.duration,10)>0&&(Ki.debug("set forceTimer: ".concat(_i.duration,"s")),Di=setTimeout(io,1e3*parseInt(_i.duration,10))))}function go(){Ki.debug("googleIMA.onAdClicked"),Ui&&(Fi?Ui.resume():Ui.pause())}function Eo(){Ki.debug("googleIMA.onAdPaused"),Fi=!0}function vo(){Ki.debug("googleIMA.onAdResumed"),Fi=!1}function yo(){Ki.debug("googleIMA.onAdComplete")}function To(){eo(Ri),Qi&&to("400")}function ho(e){Ki.debug("googleIMA.onAdsManagerLoaded"),eo(Pi);var t=new google.ima.AdsRenderingSettings;t.restoreCustomPlaybackStateOnAdBreakComplete=!Ji,(Ui=e.getAdsManager(Li,t)).addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,so),Ui.addEventListener(google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,lo),Ui.addEventListener(google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,po),Ui.addEventListener(google.ima.AdEvent.Type.LOADED,co),Ui.addEventListener(google.ima.AdEvent.Type.STARTED,mo),Ui.addEventListener(google.ima.AdEvent.Type.COMPLETE,yo),Ui.addEventListener(google.ima.AdEvent.Type.ALL_ADS_COMPLETED,ao),Ui.addEventListener(google.ima.AdEvent.Type.AD_BREAK_READY,uo),Ui.addEventListener(google.ima.AdEvent.Type.CLICK,go),Ui.addEventListener(google.ima.AdEvent.Type.PAUSED,Eo),Ui.addEventListener(google.ima.AdEvent.Type.RESUMED,vo);try{Ri=setTimeout(To,Hi),Ui.init(So().width,So().height,google.ima.ViewMode.NORMAL),Ui.start()}catch(e){Ki.error("error during googleIMA ad init and start process"),oo(e),to("300")}}function bo(){eo(Di),eo(Pi),eo(Ri),eo(Ni)}function So(){return{width:Ii.clientWidth,height:Ii.clientHeight}}function Oo(){Ki.debug("setupIMA"),google.ima.settings.setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.ENABLED),(Ci=new google.ima.AdDisplayContainer(Ii,Li)).initialize(),(Mi=new google.ima.AdsLoader(Ci)).getSettings().setDisableCustomPlaybackForIOS10Plus(!0),Mi.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,ho,!1),Mi.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,so,!1),Li.onended=Ao}function Ao(){Ki.debug("content ended detected"),qi||(Mi.contentComplete(),I(b,Qa.PLAY_POSTROLL),qi=!0)}function Io(e,t,n){return n?e.replace(new RegExp("__".concat(t,"__"),"g"),n):e}function Lo(){throw Ki.debug("googleIMA.onSdkLoadError"),Xi=!0,new Error("SDK load failed")}function _o(){Ki.debug("googleIMA.onVpaidSdkLoadSuccess"),Xi=!0,void 0!==google.ima&&(zi=!0)}var Do,Po,Ro,No,Co=function(e,t){return e?t?(Ii=e,Li=t,(Ki.debug("googleIMA.loadSdks"),zi?Promise.resolve():Xi?(to(100),Promise.reject(new Error("SDK load failed"))):Gi.Z.js(Wi).then(_o,Lo)).then(Oo)):Promise.reject(new Error("Empty content element")):Promise.reject(new Error("Empty Ad slot element"))},wo=function(e){var t,n;Ki.debug("request ad",e),e&&(_i=e),Ki.debug("googleIMA.request. hasSdk: ".concat(zi," isSdkTriedToLoad: ").concat(Xi)),zi?(Qi=!0,Ci?Mi&&Mi.contentComplete():(Ki.debug("AdDisplayContainer not initialized yet"),Oo()),(wi=new google.ima.AdsRequest).adTagUrl=(t=function(e){var t=e.adTag;if(t=Io(t,"REFERRER",de.Z),t=Io(t,"CHANNEL_PAGE_URL",de.Z),t=Io(t,"CHANNEL",Zi.channelId),t=Io(t,"CACHE_BREAKER",Math.round(1e7*Math.random())),Zi.title){var n=encodeURI(Zi.title.substr(0,100));t=Io(t,"TITLE",n)}return Zi.videoId&&(t=Io(t,"VIDEOID",Zi.videoId)),e.metaData&&Object.keys(e.metaData).forEach((function(n){var r="CUSTOM_META-ID".concat(n),a=e.metaData[n],i="".concat(a.displayName,"=").concat(a.value);t=Io(t,r,i)})),t}(_i),n=new URL(t),!0===Zi.npa&&n.searchParams.set("npa","1"),n.href),wi.linearAdSlotWidth=So().width,wi.linearAdSlotHeight=So().height,Mi.requestAds(wi),Pi=setTimeout(no,Hi)):to(100)},Uo=function(){Ui&&Ui.resize(So().width,So().height,"normal")},Mo=function(){Ki.debug("googleIMA.destroy"),bo(),Ui&&(Ui.removeEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,so),Ui.removeEventListener(google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,lo),Ui.removeEventListener(google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,po),Ui.removeEventListener(google.ima.AdEvent.Type.LOADED,co),Ui.removeEventListener(google.ima.AdEvent.Type.STARTED,mo),Ui.removeEventListener(google.ima.AdEvent.Type.COMPLETE,yo),Ui.removeEventListener(google.ima.AdEvent.Type.ALL_ADS_COMPLETED,ao),Ui.removeEventListener(google.ima.AdEvent.Type.AD_BREAK_READY,uo),Ui.removeEventListener(google.ima.AdEvent.Type.CLICK,go),Ui.removeEventListener(google.ima.AdEvent.Type.PAUSED,Eo),Ui.removeEventListener(google.ima.AdEvent.Type.RESUMED,vo),Ui.destroy(),Ui=null),Mi&&(Mi.removeEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,ho),Mi.removeEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,so),Mi.destroy(),Mi=null),Ci&&(Ci.destroy(),Ci=null),Qi=!1,qi=!1},Fo=function(){Ki.debug("googleIMA.reset"),Qi=!1,qi=!1,bo()},jo=(0,c.w)("atlas/logic/ads/ruleset/handler"),ko=[Vi.PRE,Vi.MID,Vi.POST,Vi.PARTNER,Vi.LINEAR],Go=-1;function Bo(){return Ro}function Vo(){return!!Ro&&ko.reduce((function(e,t){var n=Ro[t]||[];return e.concat(n)}),[]).length>0}function Ho(e){void 0!==e.block?e.block!==Go&&(-1!==Go&&(e.blockEnd=!0),Go=e.block,e.blockStart=!0):-1!==Go&&(e.blockEnd=!0,Go=-1)}function xo(e){var t=-1!=="delay,googleads".indexOf(e.provider);return t||jo.error("rule provider is not supported"),t}function Yo(e){jo.debug("createPartnerDelayForVOD");var t={duration:Yi,provider:"delay",rule:1};Ro[e].push(t)}function Zo(e,t){for(var n,r=[],a=0;a<e.length;a+=1){var i=e[a];i&&xo(i)&&(t===Vi.MID&&(Ho(i),a===e.length-1&&(i.blockEnd=!0,Go=-1)),ue.isVid()&&t===Vi.PARTNER&&Yo(t),Po&&(i.metaData=Po),r.push(i))}return t!==Vi.PRE&&t!==Vi.POST&&t!==Vi.PARTNER||(n=r).length>1&&(n[0].blockStart=!0,n[n.length-1].blockEnd=!0),r}var Ko,Wo={setData:function(e,t){jo.debug("setData: ",e),e&&t?(No=t,function(e){Object.prototype.hasOwnProperty.call(e,"info")&&!Do&&(Do=e.info,jo.debug("parseData >> data.info exists",Do)),Object.prototype.hasOwnProperty.call(e,"metadata")&&Object.keys(e.metadata).length>0&&(Po=e.metadata,jo.debug("parseData >> data.metadata exists",Po)),Ro={};for(var t=0;t<ko.length;t+=1){var n=ko[t];jo.debug("current position: ",n),Object.prototype.hasOwnProperty.call(e,n)&&e[n].length&&(Ro[n]=Zo(e[n],n))}jo.debug("parse has ended with ruleSet",Ro)}(e),Vo()&&I(b,Qa.AD_EVENT,{type:Qa.types.RULESET_HAS_ADS})):jo.error("there is no data")},destroy:function(){jo.debug("destroy"),Do=void 0,Po=void 0,Ro=void 0},removeRule:function(e,t){jo.debug("removeRule - pos: ".concat(e," - index: ").concat(t)),e&&void 0!==t&&Ro[e][t]&&Ro[e].splice(t,1)},getData:Bo,getInfo:function(){return Do},hasAds:Vo,id:function(){return No},addRevShareRules:function(e){var t=e.map((function(e){return e.block=2375423,e}));!function(e,t){jo.debug("updateRulesInPosition",{rules:e,pos:t}),e&&0!==e.length?Ro[t]=Zo(e,t):jo.error("updateRulesInPosition called without rules")}(t,Vi.MID)},isRuleSetReadyForMedia:function(e){return Vo()&&Bo()&&e===No},clearPosition:function(e){Ro[e]&&(Ro[e]=[])},hasPostroll:function(){var e=Ro[Vi.POST];return e&&e.length>0}},Qo=n(89645),zo=["AT","BE","BG","CH","HR","CY","CZ","DE","DK","EE","ES","FI","FR","GB","GR","HU","IE","IS","IT","LT","LU","LV","MT","NO","NL","PO","PT","RO","SE","SI","SK"],Xo=function(e){return-1!==zo.indexOf(e)};function qo(){wa.dispatch((0,Qo.X)())}function $o(){Ko&&clearInterval(Ko),Ko=null}function Jo(e){return!e||Xo(e)}var es={startCheck:function(){$o(),qo(),Ko=setInterval(qo,5e3)},stopCheck:$o,isGDPRUser:Jo,canStartAutoplay:function(){var e=Ie.get("isOnIbm")||Ie.get("isOnUstream")||"unknown"===de.Z,t=wa.getState().content,n=t.countryCode,r=t.regionCode;return!(e&&(Jo(n)||function(e){return!e||"CA"===e}(r))&&!wa.getState().privacy.ibmCookie)},areAdsEnabled:function(e){var t=wa.getState().privacy.ibmCookie;return t&&-1===t.indexOf("0:")&&-1===t.indexOf("1:")||!t&&e&&!Xo(e)}};function ts(e){return{type:fr,payload:{adsPlaying:e}}}var ns,rs,as,is=(0,c.w)("atlas/logic/ads/ads"),os=!1,ss=Bi.DEFAULT,cs=!1,us=!1,ds=!1,ls=!1,fs=!1,ps=!1,ms=0,gs=0,Es=Vi.PRE,vs=-1,ys=!1;function Ts(){ls||(ls=!0,is.debug("dispatchPrerollDone - isPrerollDone: ",ls),I(b,Qa.AD_EVENT,{type:Qa.types.PREROLL_DONE}))}function hs(){is.debug("dispatchCompanion - isCompanionDone: ".concat(fs," - started: ").concat(us)),!fs&&us&&(fs=!0,I(b,Qa.types.COMPANION))}function bs(){is.debug("getNextRule - status: ",ss);var e=Wo.getData();if(as=void 0,Fo(),ki.reset(),!cs&&us&&ss!==Bi.PAUSED){if(ss=Bi.STARTED,vs+=1,is.debug("getNextRule - pos: ".concat(Es," - index: ").concat(vs)),!Object.prototype.hasOwnProperty.call(e,Es)||vs===e[Es].length){if(is.debug("there is no rules in current pos: ",!Object.prototype.hasOwnProperty.call(e,Es)),vs>0&&Object.prototype.hasOwnProperty.call(e,Es)&&is.debug("end of loop: ",vs===e[Es].length),vs=0,Es===Vi.POST)return void Wo.clearPosition(Vi.POST);if(Es===Vi.PRE)Es=Vi.MID,Zi.currentPos=Es,Ts();else if(Es===Vi.MID&&ps)return is.debug("revshare block has finished"),ps=!1,void Wo.clearPosition(Vi.MID);is.debug("current pos: ".concat(Es," currentIndex:").concat(vs))}Object.prototype.hasOwnProperty.call(e,Es)&&e[Es].length>0?(as=e[Es][vs],is.debug("processCurrentRule"),"googleads"===as.provider?(is.debug("renderCurrentAd",{currentRule:as,currentPos:Es,currentIndex:vs}),wa.dispatch(ts(!0)),Zi.width=ms,Zi.height=gs,wo(as)):"delay"===as.provider?ki.start(as):(is.error("No provider defined to current rule."),Ds()),as&&as.remove&&(Wo.removeRule(Es,vs),vs-=1)):is.debug("there are no more ads")}}function Ss(){is.debug("sendPostrollFinishedEvent"),I(b,Qa.AD_EVENT,{type:Qa.types.POSTROLL_FINISHED})}function Os(e){is.debug("sendVideoFinishedEvent"),I(b,Qa.AD_EVENT,{type:Qa.types.VIDEO_FINISHED,contentPlaying:e.contentPlaying,controls:e.controls})}function As(){(!Zi.isAdBlockPlaying||Zi.isAdBlockPlaying&&as.blockEnd)&&(wa.dispatch(ts(!1)),Zi.isAdBlockPlaying=!1)}function Is(){is.debug("onDelayStarted"),ss!==Bi.PAUSED&&(ss=Bi.IN_PROGRESS)}function Ls(){is.debug("onDelayFinished"),bs()}function _s(){is.debug("onDelayFinished"),bs()}function Ds(){is.debug("onAdFinished - isAdBlockPlaying: ".concat(Zi.isAdBlockPlaying," - blockEnd: ").concat(as.blockEnd)),Fo(),As(),"video"!==as.type||Zi.isAdBlockPlaying||(cs||Ce.send({message:"".concat(Es,"roll finished"),data:{category:"Ad",item:"".concat(Es,"roll"),action:"finished"}}),is.debug("onAdFinished - currentRule.type: ".concat(as.type," - isAdBlockPlaying: ").concat(Zi.isAdBlockPlaying)),Es===Vi.POST?Ss():Os({contentPlaying:!0,controls:!0})),bs()}function Ps(){is.debug("disposeLogics"),hs(),Zi.isAdBlockPlaying=!1,Es=Vi.PRE,vs=-1,Mo(),as&&(As(),Os({contentPlaying:void 0,controls:void 0}),as=void 0),ki.reset(),Wo.destroy(),is.debug("dispose done")}function Rs(e){var t=e!==cs;if(is.debug("setAdFree",{currentAdFreeStatus:cs,newAdFreeStatus:e}),t){if(cs=e)return Ts(),void Ps();us?(vs=0,Es=Vi.MID,bs()):Fs()}}function Ns(){is.debug("onAdStarted - isAdBlockPlaying: ".concat(Zi.isAdBlockPlaying," - blockStart: ").concat(as.blockStart)),wa.dispatch(ts(!0)),ss!==Bi.PAUSED&&(ss=Bi.IN_PROGRESS),"video"===as.type?(Zi.isAdBlockPlaying||(cs||Ce.send({message:"".concat(Es,"roll started"),data:{category:"Ad",item:"".concat(Es,"roll"),action:"started"}}),I(b,Qa.AD_EVENT,{type:Qa.types.VIDEO_STARTED,contentPlaying:!1,controls:!1})),(as.blockStart||void 0===as.blockStart&&!Zi.isAdBlockPlaying)&&as.blockStart&&(is.debug("set isAdBlockPlaying"),Zi.isAdBlockPlaying=!0)):"overlay"===as.type&&Ce.send({message:"Overlay ad displayed",data:{category:"Ad",item:"overlay ad",action:"displayed"}})}function Cs(){is.debug("handleAdError"),Fo(),As(),Os({contentPlaying:!0,controls:!0}),bs()}function ws(e){is.debug("onAdvertUpdate",e),e.revShare&&function(e){is.debug("revShare modul received");var t=e.ads&&e.ads.mid?e.ads.mid:void 0,n=ps&&(ss===Bi.IN_PROGRESS||ss===Bi.PAUSED),r=us&&!cs&&t;n?is.error("revShare ad is still running"):r&&(ps=!0,vs=-1,Wo.addRevShareRules(t),bs())}(e.revShare),e.disableAds&&Rs(!0),e.init&&Rs(!1)}function Us(e){Object.keys(e).forEach((function(t){Object.prototype.hasOwnProperty.call(Zi,t)&&Zi[t]===e[t]||(Zi[t]=e[t],is.debug("update - key: ".concat(t," - value: ").concat(Zi[t])))}))}function Ms(){if(rs)return rs.hasBenefit&&rs.hasSettings}function Fs(){var e=os||Ie.get("adFree"),t=document.referrer.indexOf("/dashboard")>-1&&Ie.get("loggedIn")&&(Ie.get("isOnUstream")||Ie.get("isIbmBranded")),n=es.areAdsEnabled(ns);if(is.debug("startPlayingAds",{integrationSettings:rs,isCurrentPageDashboard:t,isPremiumMemberFromSession:os,isAdFreeFromParams:e,paramsAdFree:Ie.get("adFree"),enabledFromCookie:n,adfree:cs}),!us)if(e||cs||!Ms()||!n||t)cs?(Ts(),Ps()):Rs(!0);else if(Wo.hasAds()&&Wo.getData())ks().then(bs);else{var r=new Promise((function(e,t){var n=[ue.id(),ue.app(),ns,ue.isHid()?ue.ids()[1]:null,C.Z.locale,de.Z,"web"];is.debug("getRuleset - getAdverts called with params: ",Ie),function(e,t,n,r){var a;Ti((function(e,t,n,r){var a="http://".concat(V.Z.config.cdngwPlain),i="https://".concat(V.Z.config.cdngwSecure),s=e[0],c=e[1],u=e[2],d=e[3],l=e[4],f=e[5],p=e[6],m=o().ssl?i:a,g={brandId:1,mediaId:s,mediaType:c,countryCode:u,locale:l,pageUrl:encodeURIComponent(f)};d&&(g.highlightId=d,g.mediaType="recorded"),p&&(g.device=p);var E=[m,"/rgwjson/Viewer.getAdverts/",encodeURIComponent(JSON.stringify(g))].join(""),v=document.createElement("script");window.jsonpCallback=function(e){t(e),document.body.removeChild(v),delete window.jsonpCallback},v.setAttribute("src","".concat(E,"?jsoncallback=jsonpCallback")),document.body.appendChild(v)}),e,(a=t,function(e){hi(a,e)}),n,r)}(n,e,t,5e3)})).then(js);Promise.all([r,ks()]).then(bs).catch((function(e){is.error("ruleset loading failed",e),is.debug("handleFailedRulesetLoad"),Rs(!0)}))}}function js(e){is.debug("handleSuccessfulRulesetLoad",e);var t="".concat(ue.app(),"_").concat(ue.id());return e&&e.success?e.ads?(is.debug("ruleset for media loaded successfully"),Wo.setData(e.ads,t),Promise.resolve()):Promise.reject(new Error("no ads found in ruleset")):(is.debug("ruleset response was not valid",e),Promise.reject(new Error("ruleset response not valid")))}function ks(){var e=document.querySelector("#ViewerContainer video"),t=document.getElementById("AdHolder");return Co(t,e).then((function(){us=!0})).catch((function(e){"SDK load failed"===e.message?Rs(!0):(is.error("Following error happened while initializing google IMA provider",e),Cs())}))}function Gs(e){is.debug("privacy cookie changed to",e),Rs(!es.areAdsEnabled(ns))}function Bs(e){Us({contentVolume:e})}function Vs(){ys||(ys=!0,Fs())}function Hs(){!cs&&us&&Wo.hasPostroll()?(is.debug("playPostroll",{adfree:cs,started:us,hasPostRoll:Wo.hasPostroll()}),Es=Vi.POST,vs=-1,bs()):Ss()}var xs,Ys,Zs={initialize:function(e){is.debug("initialize"),ds||(L(S,A.ADVERT_UPDATE,ws),L(b,Qa.AD_ERROR,Cs),L(b,Qa.AD_FINISHED,Ds),L(b,Qa.AD_STARTED,Ns),L(b,Qa.DELAY_STARTED,Is),L(b,Qa.DELAY_FINISHED,Ls),L(b,Qa.DELAY_ERROR,_s),L(b,Qa.PLAY_POSTROLL,Hs),ms=e.width,gs=e.height,Zi.currentPos=Vi.PRE,Zi.channelId=ue.getOwnerChannelId(),Zi.npa=Ie.get("isOnIbm")||Ie.get("isOnUstream")||"unknown"===de.Z,ue.isVid()&&(Zi.videoId=ue.id()),wa.subscribe("privacy.ibmCookie",Gs),wa.subscribe("player.volume",Bs),wa.subscribe("playback.position",Vs),ds=!0),e.countryCode&&(ns=e.countryCode,is.debug("countryCode updated",ns)),e.adIntegration&&(rs=e.adIntegration,is.debug("adIntegration updated",rs))},startPlayingAds:Fs,destroy:function(){is.debug("destroy"),ys=!1,ls=!1,fs=!1,us=!1,ss=Bi.DEFAULT,Ps()},update:Us,resize:function(e,t){cs||ms===e&&gs===t||(ms=e,gs=t,ss===Bi.IN_PROGRESS?ms<300||gs<180?(ss=Bi.PAUSED,Ds(),Ts(),hs()):Uo():ss===Bi.PAUSED&&bs())},isPrerollDone:function(){return ls},isAdfree:function(){return cs},isStarted:function(){return us},isAdInProgress:function(){return ss===Bi.IN_PROGRESS},isInitialized:function(){return ds},getType:function(){return as?as.type:void 0},setPremiumMember:function(){is.debug("setPremiumMember",{settings:Ms()});var e=Ms();os=!0,e||void 0===e||Rs(!0)},playPostroll:Hs},Ks=n(40282),Ws=n.n(Ks),Qs=n(37255),zs=n(38172),Xs={},qs={},$s=(0,c.w)("atlas/logic/stats/aggregator");function Js(){var e;if((0,Qs.Z)(Xs)){for(e in Xs)Xs[e].common&&Xs[e].common.bufempty.length&&(Xs[e].common.bufempty=Xs[e].common.bufempty.pop().value),I(O,A.SEND_REPORT,{mid:e,send:{cmd:"stats",data:[Xs[e]]}});Xs={}}}function ec(){var e,t,n;if((0,Qs.Z)(qs)){for(e in qs){if(qs[e].benchmark&&qs[e].benchmark.bwrpt&&qs[e].benchmark.bwrpt.length)for(t=qs[e].benchmark.bwrpt,n=0;n<t.length-1;++n)t[n].url===t[n+1].url&&(t[n].size+=t[n+1].size,t[n].time+=t[n+1].time,t.splice(n+1,1),n--);I(O,A.SEND_REPORT,{mid:e.split("_").join("."),send:{cmd:"stats",data:[qs[e]]}})}qs={}}}function tc(){Xs={},qs={},clearInterval(xs),clearInterval(Ys),xs=window.setInterval(Js,1e3),Ys=window.setInterval(ec,5e3)}var nc={init:function(){tc()},feed:function(e,t){$s.debug("aggregator feed",{mid:e,data:t}),t.common&&void 0!==t.common.bufempty&&(Xs[e]=Xs[e]?Xs[e]:{common:{bufempty:[]}},t.common.strurl&&(Xs[e].common.strurl=t.common.strurl,delete t.common.strurl),Xs[e].common.bufempty.push({value:t.common.bufempty,time:(new Date).getTime()}),delete t.common.bufempty,(0,Qs.Z)(t.common)||delete t.common),(0,Qs.Z)(t)&&(qs[e]?(0,zs.Z)(t,qs[e]):qs[e]=t)},feedImmediate:function(e,t){I(O,A.SEND_REPORT,{mid:e,send:{cmd:"stats",data:[t]}})},reset:tc},rc=n(40126),ac=n(50420),ic=n(51361),oc=n(37722),sc=n(62549);function cc(e){return function(e){if(Array.isArray(e))return dc(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||uc(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function uc(e,t){if(e){if("string"==typeof e)return dc(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?dc(e,t):void 0}}function dc(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var lc,fc,pc,mc,gc,Ec,vc,yc,Tc,hc,bc=3e5,Sc="ecdnPreferredLocation",Oc=0,Ac={pingPath:"/ping",pingThreads:6,pingRounds:1,pingTimeout:400,addRndParam:!0,locationPriority:[]},Ic={},Lc={},_c={},Dc=0,Pc=le.ZP.get(Sc)||[],Rc=!0,Nc=(0,c.w)("atlas/logic/sdcdnHandler"),Cc=(0,c.w)("atlas/logic/sdcdnHandler"),wc=wa.getState().provider.forcedUrl,Uc=(0,ic.default)(wc)?wc:null;function Mc(e){var t=e&&e.result&&e.result.time>-1;Nc.debug("Ping result",e),t&&((!Tc||Tc.time>e.result.time)&&(Tc=e.result),!fc&&Ic[vc]&&(fc=!0,Nc.debug("Send first result"),Gc([e.result],vc))),hc.onStat({type:"overlay",data:{pingResult:e}})}function Fc(e){var t;Dc=(new Date).getTime(),_c[vc]=e,Nc.debug("Pings finished",{duration:Dc-gc,data:_c[vc]}),Gc(_c[vc],vc),mc=vc,vc=!1,Lc[t=mc]&&(!_c[t]&&Lc[t]||!_c[t].some((function(e){return Bc(e.url)}))&&Lc[t].data.some((function(e){return e.useBestSite})))?function(){var e=Oc?1e3:0;e=Math.min(bc,e*Math.pow(2,Oc-1))+Math.floor(5e3*Math.random()),Nc.debug("Retry ecdn pings in ".concat(Math.round(e/1e3),"sec")),clearTimeout(lc),lc=setTimeout((function(){Oc+=1,xc()}),e)}():Oc=0,hc.onStat({type:"report",data:Dc-gc})}function jc(e){Cc.debug(e.line,e.data)}function kc(e){Cc.error("SDCDN lib error:",e)}function Gc(e,t){if(Ic[t]&&e)if(Uc)!function(e,t){Nc.debug("Send forced providers",{mid:t,results:Uc});var n=e.find((function(e){return e.url===Uc}));if(n){var r=[{url:n.url,location:n.location}];Ic[t].providers=r,hc.onComplete(t,{stream:Ic[t]}),hc.onStat({type:"overlay",data:{finalResult:_c[t],fallback:"not available",location:"not available",preferredLocation:Pc,forcedProvider:Uc,cdnConfig:Lc[mc]}})}}(e,t);else{var n=e,r=function(e){var t=Vc(e);if(!t)return!0;var n=function(e){var t=[];return e.forEach((function(e){e.data.forEach((function(n){Object.prototype.hasOwnProperty.call(n,"cdnFallbackEnabled")&&t.push({location:n.location,cdnFallbackEnabled:n.cdnFallbackEnabled,group:e.name})}))})),t}(t);if(!n.length)return!0;if((0,ac.Z)(Pc)&&Pc.length){var r=n.filter((function(e){return Pc.indexOf("".concat(e.group,"/").concat(e.location))>-1}));if(r.length)return r[0].cdnFallbackEnabled}return n.some((function(e){return e.cdnFallbackEnabled}))}(t),a=Tc&&Tc.location;Nc.debug("use cdn fallback: ".concat(r)),a&&function(e){if(Pc&&(0,ac.Z)(Pc)){var t=Pc.indexOf(e);t>-1&&Pc.splice(t,1),Pc.unshift(e),Pc=Pc.slice(0,5)}else Pc=[e];le.ZP.set(Sc,Pc)}(a),r||(n=e.filter((function(e){return e.location===a}))),n=function(e){var t,n,r=e.reduce((function(e,t){return function(e){var t=e.location||"";return/^fallback\//i.test(t)}(t)?e[1].push(t):e[0].push(t),e}),[[],[]]),a=(n=2,function(e){if(Array.isArray(e))return e}(t=r)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){s=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(s)throw a}}return i}}(t,n)||uc(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=a[0],o=a[1];return[].concat(cc(i),cc(o))}(n),Ic[t].providers=(0,rc.Z)(n),Nc.debug("Send results",{mid:t,results:Ic[t].providers}),hc.onComplete(t,{stream:Ic[t]}),hc.onStat({type:"overlay",data:{finalResult:n,fallback:r,location:a,preferredLocation:Pc,forcedProvider:Uc,cdnConfig:Lc[mc]}}),clearTimeout(Ec),Ec=setTimeout(Hc,bc)}}function Bc(e){var t,n,r=decodeURIComponent(e).toLowerCase();for(t in Lc)if(Object.prototype.hasOwnProperty.call(Lc,t))return(n=Lc[t].data,n.filter((function(e){return e.useBestSite})).reduce((function(e,t){var n=t.data.reduce((function(e,t){return e.concat(t.sites)}),[]);return e.concat(n)}),[])).some((function(e){var t=e.host.toLowerCase();return r.indexOf(t)>-1||t.indexOf(r)>-1}));return!1}function Vc(e){var t;return Lc[e]&&(t=Lc[e].data.filter((function(e){return e.useBestSite})).map((function(e){return(0,rc.Z)(e)}))),t&&t.length?t:null}function Hc(e){var t=e||mc;(new Date).getTime()-Dc>=bc&&Ic[t]&&Lc[t]&&!vc&&(Ec=clearTimeout(Ec),Pc&&(Ac.locationPriority=Pc),(-1===t.indexOf("recorded")||t.indexOf("recorded")>-1&&!_c[t])&&(gc=(new Date).getTime(),vc=t,oc.Z.test(Lc[t],Ac)))}function xc(){vc||(Dc=0,Nc.debug("Force tests"),Hc())}function Yc(e){Nc.debug("force provider ",e||"off"),Uc=Uc===e?null:e,Gc(_c[mc],mc)}hc={update:function(e,t){e!==mc&&(Dc=0);var n,r=(0,rc.Z)(t);r.stream&&r.stream.version&&(Nc.debug("Stream module received"),wa.dispatch({type:Yt.setStreamModuleReceivedDate,payload:{ts:Date.now()}}),Rc&&(Fa.reportStreamModuleReceived(),wa.dispatch((n=performance.now(),{type:Vr,payload:n})),Rc=!1),r.stream.contentAvailable?(Ic[e]=(0,rc.Z)(r.stream),Ic[e].mid=e,delete r.stream):(Ec=clearTimeout(Ec),vc&&oc.Z.test(),yc=null,vc=!1,Dc=0,_c={},Ic={},fc=!1,Uc=null,Rc=!0),Gc(_c[e],e)),r.cdnConfig&&(pc||(oc.Z.on(oc.Z.events.PING_RESULT,Mc),oc.Z.on(oc.Z.events.FINISHED,Fc),oc.Z.on(oc.Z.events.ERROR,kc),oc.Z.on(oc.Z.events.LOG,jc),pc=!0),mc=mc||e,Dc=0,Lc[e]=(0,rc.Z)(r.cdnConfig),Lc[e].mid=e,Nc.debug("CDN config received"),delete r.cdnConfig),(0,sc.Z)(r)||hc.onComplete(e,r),function(e){return e&&e.streamFormats&&(e.streamFormats.mp4||e.streamFormats.flv)&&!(e.streamFormats.hasOwnProperty("flv/segmented")||e.streamFormats.hasOwnProperty("mp4/segmented")||e.streamFormats.hasOwnProperty("hls/improved"))}(Ic[e])?(Nc.debug("Mp4 or Flv movie, cdn tests skipped!"),hc.onComplete(e,{stream:Ic[e]})):Hc(e)},onStat:function(){},onComplete:function(){},onProviderChange:function(e){Nc.debug("Provider changed");var t=e&&Object.prototype.hasOwnProperty.call(e,"to")&&!Bc(e.to),n=yc&&Bc(yc)||!yc&&Vc(mc);t&&n&&xc(),yc=e.to},onProviderFailure:function(e){Nc.debug("Provider failure",e),(e&&Object.prototype.hasOwnProperty.call(e,"url")&&Bc(e.url)||Vc(mc))&&xc()},isEcdnProvider:Bc,getEcdnConfig:Vc,forceProvider:Yc},wa.subscribe("provider.forcedUrl",Yc);var Zc,Kc,Wc=hc,Qc=n(27685),zc=(0,c.w)("providers"),Xc=-1,qc=[];function $c(e){var t=Zc.length;if(Zc&&t&&e>=0&&e<t?Kc=Zc[Xc=e]:(Xc=-1,Kc=null),Kc){var n=Kc.name;qc.includes(n)||qc.push(n)}}function Jc(e){var t=function(e){for(var t=Zc.length,n=-1,r=0;r<t;r+=1)if(e===Zc[r].name){n=r;break}return n}(e);$c(t=Math.max(0,t))}var eu,tu,nu,ru=function(e){e.name||(e.name=e.url),Zc.push(e)},au=function(){var e=Zc.findIndex((function(e,t){return t!==Xc&&!qc.includes(e.name)}));return $c(-1!==e?e:(Xc+1)%Zc.length),Kc},iu=function(e){return e?Jc(e):-1===Xc?$c(0):Jc(Kc.name),wa.dispatch((0,Qc.DJ)(Kc)),zc.info("selected provider: ",Kc),Kc},ou=function(){Zc=[]},su=function(){return Kc},cu=(0,c.w)("atlas/logic/stats/collector"),uu={LOGIC_INITIATED:"lid",UMS_CONNECTED:"ucd",FIRST_MODULE_INFO:"fmi",KEYFRAME_AFTER_PLAY:"kfap",SEEK_COMPLETE:"kfas",JUMP_COMPLETE:"kfaj",BANDWIDTH_REPORT:"bwrpt",DROPPED_FRAMES:"dpfs",UMS_COMMAND_PLAYING:"playing",UMS_COMMAND_SEEK:"seek"},du={},lu=-1,fu=!1,pu=!1;function mu(e){var t=e.send.duration,n=[Math.round(e.send.from*t),Math.round(e.send.to*t)];-1!==lu&&clearTimeout(lu),lu=setTimeout((function(){!function(e,t){lu=-1,I(O,A.SEND_REPORT,{mid:e,send:{cmd:uu.UMS_COMMAND_SEEK,data:t}})}(e.mid,n)}),1e3)}function gu(){void 0!==tu&&(nu=tu,tu=void 0,Eu({playing:!0}))}function Eu(e){var t,n,r=e.playing,a=e.reason,i=void 0===a?"":a,o=(n=nu,wa.getState().playback.audioTracks.find((function(e){return e.id===n}))),c=(0,s.default)(o,"language");c&&(t={language:c,country:(0,s.default)(o,"country","00")}),I(O,A.SEND_REPORT,{mid:eu,send:{cmd:uu.UMS_COMMAND_PLAYING,data:[eu.split(".")[1],r,{reason:i,multiaudio:t}]}})}function vu(e){eu=e.mid,fu?Eu({mid:e.mid,reason:e.reason,playing:e.playing}):pu=!0}function yu(e){du[e]={},du[e].start=Date.now(),du[e].success=-1,du[e].firstModule=-1}function Tu(e){eu=e,-1===du[e].success&&(du[e].success=Date.now(),nc.feed(e,{benchmark:{ucd:du[e].success-du[e].start}})),function(e){nc.feed(e,{branchName:Ie.get("branchName")})}(e)}function hu(e){-1===du[e.mid].success&&(du[e.mid].start=-1,du[e.mid].firstModule=-1)}function bu(e){-1!==du[e.mid].success&&-1===du[e.mid].firstModule&&(du[e.mid].firstModule=Date.now(),nc.feed(e.mid,{benchmark:{fmi:du[e.mid].firstModule-du[e.mid].success}}))}function Su(e){var t=Wc.isEcdnProvider(e.url);nc.feed(eu,{benchmark:{bwrpt:[{time:e.time,size:e.size,url:e.url,ecdn:t}]}})}function Ou(e){nc.feed(eu,{common:{bufempty:e}})}function Au(){Ou(!0)}function Iu(){Ou(!1)}function Lu(e){var t={type:e.error,details:e.details?e.details:{}},n=eu.split(".");"channel"===n[0]?t.details.cid=n[1]:t.details.vid=n[1],nc.feed(eu,{error:[t]})}function _u(e){cu.debug("adResponse",e),nc.feed(eu,{benchmark:{adr:e}})}function Du(e){nc.feed(eu,{benchmark:{ecdnt:e}})}function Pu(){var e=iu();if(e&&e.location&&e.url){var t,n=function(e){var t=e.match(/(.+?)\/.+/);if(t)return t[1]}(e.location),r=e.providerHost||(t=e.url,new URL(t).host);nc.feed(eu,{common:{cdnProviderType:n,cdnProviderHostname:r}})}}function Ru(){du={},eu=null,nc.reset(),tu=void 0,nu=void 0,fu=!1,pu=!1}function Nu(){ue.isHLS()&&(fu=!0,pu&&(pu=!1,Eu({playing:!0})))}function Cu(){ue.isHLS()||(fu=!0,pu&&(pu=!1,Eu({playing:!0})))}wa.subscribe("playback.selectedAudio",(function(e){void 0===nu?nu=e:tu=e}));var wu=function(){nc.init(),Ru(),L(O,A.PLAYING,vu),L(O,A.SEEK,mu),L(O,A.UMS_CONNECT_START,yu),L(O,A.UMS_CONNECTED,Tu),L(O,A.UMS_REJECT,hu),L(O,A.MODULE_INFO,bu),L(O,A.REPORT_BANDWIDTH,Su),L(O,A.REPORT_BUFFER_EMPTY,Au),L(O,A.REPORT_BUFFER_FULL,Iu),L(O,A.REPORT_ERROR,Lu),L(O,A.REPORT_AD_RESPONDED,_u),L(b,A.PROVIDER_CHANGE,Pu),L(b,A.AUDIO_TRACKS,Nu),L(b,A.PLAY_OPTIONS,Cu),L(O,A.REPORT_AUDIO_CHANGED,gu),L(O,A.REPORT_ECDN_TESTS,Du)},Uu={},Mu={},Fu=(0,c.w)("atlas/logic/stats/reporter");function ju(e){var t;Mu[e.mid]?(t=Ws()(e.mid))?(Fu.debug("report to ums",{cmd:e.send.cmd,data:e.send.data}),t.send(e.send.cmd,e.send.data)):Fu.warn("umsInstance not available!",{report:e}):(Fu.debug("cache data",{mid:e.mid,data:e.send}),Uu[e.mid]=Uu[e.mid]?Uu[e.mid]:[],Uu[e.mid].push(e))}function ku(e){if(Mu[e]=!0,Uu[e]){for(;Uu[e].length;)ju(Uu[e].shift());delete Uu[e]}}var Gu,Bu=function(){wu(),L(O,A.SEND_REPORT,ju),L(O,A.UMS_CONNECTED,ku)},Vu=function(e){var t=e.type,n=e.data;return{type:vt,payload:{type:t,data:n}}},Hu=!1,xu=!1,Yu=-1,Zu=(0,c.w)("atlas/logic/offiarContentHandler"),Ku={},Wu=!0,Qu=!1,zu=!1;function Xu(){return Ku&&Ku.videos&&Ku.videos.length}function qu(){return Ku&&Ku.pictures&&Ku.pictures.length}function $u(){Zu.debug("Stop offair content"),xu&&(xu=!1,I(b,A.DESTROY_SLIDESHOW),Yu>-1&&Xu()&&I(b,A.DESTROY_OFFAIR_VIDEO,Ku.videos[Yu])),Yu=-1}function Ju(){Xu()&&xu&&(0!==(Yu+=1)&&I(b,A.DESTROY_OFFAIR_VIDEO,Ku.videos[Yu-1]),Zu.debug("Next offair video",{next:Ku.videos[Yu]}),I(b,A.CREATE_OFFAIR_VIDEO,Ku.videos[Yu]))}function ed(){Zu.debug("Start offair content"),xu||(Wu=!1),xu=!0,qu()?I(b,A.CREATE_SLIDESHOW,Ku.pictures):Xu()?-1===Yu&&(Zu.debug("Init offair vids",{videos:Ku.videos}),Ju()):($u(),ad())}function td(){xu&&$u(),ed()}function nd(){return Ku&&(qu()||Xu())}function rd(){U().setContentAvailable(!0),wa.dispatch(Vu({type:""}))}function ad(){U().setContentAvailable(!1),wa.dispatch((0,Oa.y5)(Oa.w_.offairScreen)),wa.dispatch(Vu({type:"offair"}))}function id(){if(Qu&&zu){var e=Xu()&&!Wu;if(!Gu&&(!nd()||e))return $u(),void ad();Gu?(xu&&$u(),rd()):nd()&&(rd(),td())}}function od(e){e!==Gu&&(Qu=!0,(Gu=e)&&(Wu=!1),id())}function sd(e){zu=!0;var t=e.offairContent;void 0!==t&&(function(e,t){return JSON.stringify(e)===JSON.stringify(t)}(t,Ku)||(Ku=t,id()))}var cd,ud=function(){Hu||(Hu=!0,L(b,A.LIVE,od),L(b,A.NEXT_OFFAIR_VIDEO,Ju),L(S,A.META_UPDATE,sd))},dd=function(){$u(),Gu=void 0,Qu=!1,zu=!1,Wu=!0,Ku={},rd()},ld=function(){return!xu||xu&&Xu()&&Yu===Ku.videos.length-1},fd=function(){var e=Yu+1;return e>-1&&Ku.videos&&e<Ku.videos.length},pd=n(97894);function md(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function gd(e){var t=e.hasExternalVtt,n=e.vtt;if(t){var r=n.map((function(e){var t,n,r=(n=3,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){s=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(s)throw a}}return i}}(t,n)||function(e,t){if(e){if("string"==typeof e)return md(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?md(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a=r[0],i=r[1],o=r[2];return new VTTCue(a,i,o)}));wa.dispatch((0,pd._r)(r))}else wa.dispatch((0,pd._r)([]))}var Ed=function(){cd||(cd=!0,wa.subscribe("externalVtt",gd))},vd=(0,c.w)("contentAvailabilityChecker"),yd=!1,Td=!1,hd=!1,bd=!1,Sd=!1;function Od(){return Td&&hd&&bd}function Ad(){vd.debug("runCheck",{isPrerollDone:yd,isAllInformationAvailableForContent:Od(),contentAvailableEventSent:Sd}),Sd||Od()&&(Ea.send("contentAvailable",!0),I(b,A.CONTENT_AVAILABLE),Sd=!0)}function Id(){yd=!1,Td=!1,hd=!1,bd=!1,Sd=!1}var Ld=function(){Id()},_d=function(){vd.debug("reset"),Id()},Dd=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];vd.debug("setHasLiveStatus",e);var t=hd;hd=e,!t&&hd&&Ad()},Pd=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];vd.debug("setHasMeta",e);var t=bd;bd=e,!t&&bd&&Ad()},Rd=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];vd.debug("setHasPlayBackData",e);var t=Td;Td=e,!t&&Td&&Ad()},Nd=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];vd.debug("setPreRollDone",e);var t=yd;yd=e,!t&&yd&&Ad()},Cd=function(e){return wa.dispatch({type:je,payload:{videoTag:e}})},wd=n(26193),Ud=(0,c.w)("lockManager");var Md=n(46060),Fd=n(21957),jd=n(42610),kd=function(e){return[function(e){return(0,jd.Z)(e)},function(e){var t=e.size;return(0,Fd.default)(t)&&t>0},function(e){var t=e.time;return(0,Fd.default)(t)&&t>25},function(e){var t=e.url;return(0,ic.default)(t)},function(e){var t=e.url;return!/\.m4[va]h$/.test(t)},function(e){var t=e.url;return!/\.vtt$/.test(t)}].every((function(t){return t(e)}))},Gd=function(e){return(0,s.default)(e,"performance.responseStart")&&(0,s.default)(e,"performance.responseEnd")&&(0,s.default)(e,"performance.startTime")};function Bd(e){if(Gd(e)){var t=e.performance;return{waitingTime:t.responseStart-t.startTime,loadingTime:t.responseEnd-t.responseStart}}return{waitingTime:0,loadingTime:e.time}}function Vd(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Hd(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function xd(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Hd(Object(n),!0).forEach((function(t){Yd(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Hd(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Yd(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Zd(e){return function(e){return e.map((function(e){var t=e.language;if("string"!=typeof t)return e;var n=t.match(/(\w+)(?:-(\w+))?/);if(!n)return e;var r,a,i=(a=3,function(e){if(Array.isArray(e))return e}(r=n)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){s=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(s)throw a}}return i}}(r,a)||function(e,t){if(e){if("string"==typeof e)return Vd(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Vd(e,t):void 0}}(r,a)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=i[1],s=i[2],c=void 0===s?"00":s;return xd(xd({},e),{},{language:o,country:c})}))}(function(e){return e.map((function(e,t){var n=parseInt(e.id,10);return xd(xd({},e),{},{id:n||0===n?n:t})}))}(e))}var Kd=n(1692);function Wd(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Qd(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Wd(Object(n),!0).forEach((function(t){zd(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Wd(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function zd(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Xd,qd,$d,Jd,el,tl,nl,rl,al=o().ios&&"10"===o().ios[0],il=(0,c.w)("playbackhandler"),ol=Math.random()<=.05,sl=["m4vh","m4ah","flv"],cl=!1,ul=!1,dl={},ll=0,fl=[],pl={playing:!1,pauseTime:0,data:null},ml="",gl=!1,El=!1,vl=!0,yl=!0,Tl="default",hl=!0,bl=-2;function Sl(){lf("".concat(3," segment not found error")),I(O,A.PLAYING,{mid:ue.getMid(),playing:!1}),ff()}function Ol(){qd=clearTimeout(qd)}function Al(e){il.info("handleMultipleAtlasDownloadError"),Xd?(function(){il.debug("handle multiple atlas download error by getting updated stream module");var e,t=ll?1e3:0;e=t=Math.min(16e3,t*Math.pow(2,ll-1)),Ol(),qd=setTimeout(Sl,e),ll+=1}(),Xd=!1):(il.debug("handle multiple atlas download error by changing provider"),I(h,A.CHANGE_PROVIDER,{reason:"multiple segment not found error"}),Xd=!0),I(b,A.ATLAS_DOWNLOAD_ERROR,e)}function Il(){pf(),U().showPlayScreen(),cn().removeListener(cn().events.ATLAS_FULLY_INITIALIZED,Il)}function Ll(){var e;il.debug("initializeAtlas"),cn().initialized||(cn().initialize("ViewerContainer"),cn().addListener(cn().events.BANDWIDTH,Jl),cn().addListener(cn().events.BUFFER_EMPTY,ef),cn().addListener(cn().events.BUFFER_FULL,tf),cn().addListener(cn().events.ERROR,nf),cn().addListener(cn().events.POSITION,af),cn().addListener(cn().events.LOG,rf),cn().addListener(cn().events.FINISHED,Yl),cn().addListener(cn().events.METADATA,xl),cn().addListener(cn().events.THROTTLE,wl),cn().addListener(cn().events.AUDIO_TRACKS,Ul),cn().addListener(cn().events.TEXT_TRACKS,Ml),cn().addListener(cn().events.TEXT_TRACK_CUE_CHANGE,Fl),cn().addListener(cn().events.X08_DETECTED,jl),cn().addListener(cn().events.WEBKIT_SUPPORTS_FULLSCREEN,kl),cn().addListener(cn().events.WEBKIT_ENTER_FULLSCREEN,Vl),cn().addListener(cn().events.WEBKIT_END_FULLSCREEN,Hl),cn().addListener(cn().events.STORED,sf),cn().addListener(cn().events.BUFFERED,cf),cn().addListener(cn().events.ATLAS_FULLY_INITIALIZED,Pl),cn().addListener(cn().events.QUALITY_CHANGE_STARTED,Zl),cn().addListener(cn().events.QUALITY_CHANGE_COMPLETED,Kl),cn().addListener(cn().events.QUALITY_CHANGE_CANCELLED,Wl),cn().addListener(cn().events.LANGUAGE_CHANGE_STARTED,Ql),cn().addListener(cn().events.LANGUAGE_CHANGE_COMPLETED,zl),cn().addListener(cn().events.LANGUAGE_CHANGE_CANCELLED,Xl),cn().addListener(cn().events.SEEK_STARTED,_l),cn().addListener(cn().events.SEEK_COMPLETED,Dl),e={},Wa&&!1!==Ie.get("playsinline")&&!al&&(e["webkit-playsinline"]=!0,e.playsinline=!0),"native"===Ie.get("controls")&&(e.controls="true"),0===Ie.get("volume")&&(e.defaultMuted=!0),wa.getState().content.is360Video&&o().ios&&(e.crossOrigin="anonymous"),cn().setOption(cn().optionNames.VIDEO_TAG_ATTRIBUTES,e),cn().setOption(cn().optionNames.RENDER_TEXT_TRACKS_NATIVELY,ue.isHLS()),cn().setOption(cn().optionNames.HIDE_NATIVE_TRACKS,ue.isHLS()),cn().setOption(cn().optionNames.FLASH_PROXY_URL_PLAIN,"http://".concat(V.Z.config.cdn1)),cn().setOption(cn().optionNames.FLASH_PROXY_URL_SECURE,"https://".concat(V.Z.config.staticSecure)),il.debug("Atlas is initialized"))}function _l(e){var t=e.from,n=e.to,r=e.initiator;Ea.send("seekStarted",{from:ue.getRelativeSeekPositionInMs(1e3*t)/1e3,to:ue.getRelativeSeekPositionInMs(1e3*n)/1e3,initiator:r}),Ce.send({message:"Seek started",data:{category:"Playback",item:"playback",action:"started"}})}function Dl(){Ea.send("seekCompleted",!0),Ce.send({message:"Seek completed",data:{category:"Playback",item:"playback",action:"completed"}})}function Pl(){ul=!0,I(b,"onAtlasSeekable")}function Rl(){df("nextoffair")}function Nl(e){return e.split(".").pop()}function Cl(e){pl.data=Qd(Qd({},e),{},{isLive:!ue.isVid()&&!ue.isOffairVid(),lastStreamModuleReceived:wa.getState().playback.lastStreamModuleReceived}),pl.data.debug=Ie.get("showHiddenContextMenuItems"),($d&&Object.prototype.hasOwnProperty.call(pl.data,"format")&&$d!==pl.data.format||e.format===N&&ml&&function(e){if(e===ml)return!1;if(!e)return!0;var t=new URL(ml),n=new URL(e);return t.searchParams.get("sourceChannel")!==n.searchParams.get("sourceChannel")}(e.url)||rl&&pl.data.sourceMedia!==rl)&&df("Format changed");var t=(0,s.default)(pl,"data.representations",[]).map((function(e){return e.contentType})),n=function(e){return e.includes("video/mp4")},r=n(fl)&&!n(t),a=!n(fl)&&n(t);if(r||a){if(!pl.data.isLive&&pl.position>=0){var i=ue.getRelativeSeekPositionInMs(pl.position);ue.saveSeek({positionInMs:i,initiator:w._.SYSTEM})}df("Toggle video track")}fl=t,$d=pl.data.format,rl=pl.data.sourceMedia,ml=e.url,cn().initialized||Ll();var o=wa.getState().player.volume;cn().setVolume(o/100),pl.playing&&uf(pl.data),Rd()}function wl(e){var t="throttle"===e.state;I(b,A.ATLAS_THROTTLE,t)}function Ul(e){if(ue.isHLS()){var t=Zd(e.data);if(wa.dispatch((0,Xa.KS)(t)),hl){var n=wa.getState().playback.selectedAudio,r=Ie.get("defaultLang"),a=(0,Md.Z)(t,r);if(-1!==n)cn().selectAudio(n);else if(a)wa.dispatch((0,Xa.Ft)(a.id));else{var i=t.find((function(e){return e.enabled}));i&&wa.dispatch((0,Xa.Ft)(i.id))}hl=!1}else{var o=t.find((function(e){return e.enabled}));o&&wa.dispatch((0,Xa.Ft)(o.id))}I(b,A.AUDIO_TRACKS,t)}}function Ml(e){if(ue.isHLS()&&!Ie.get("externalvtt")){var t=Zd(e.data);wa.dispatch((0,Xa.kY)(t))}}function Fl(e){var t=e.data.activeCues;wa.dispatch((0,pd._r)(t))}function jl(){Ie.get("externalvtt")||wa.dispatch((0,Xa.kY)([{id:1,label:"ui.closedCaption",shouldTranslate:!0}]))}function kl(e){var t;wa.dispatch((t=e.data,{type:Yt.setWebkitSupportsFullscreen,payload:{supports:t}}))}function Gl(){pl.playing&&(pl.playing=!1,I(b,A.PLAYING,!1));var e=cn().getVideoTag();e&&e.removeEventListener("pause",Gl),el=clearTimeout(el)}function Bl(){var e=cn().getVideoTag();if(e){var t=!e.paused;pl.playing!==t&&(pl.playing=t,I(b,A.PLAYING,t)),t&&(e.addEventListener("pause",Gl),el=setTimeout((function(){e.removeEventListener("pause",Gl)}),1e3))}}function Vl(){Bl()}function Hl(){Bl()}function xl(e){I(b,A.ATLAS_METADATA,e)}function Yl(){gl&&ue.isCid()&&!1===ue.isOffairVid()?$l():(I(b,A.VIDEO_FINISHED),Ea.send("finished",!0))}function Zl(){El||(El=!0,I(b,A.ATLAS_QUALITY_CHANGE_STARTED))}function Kl(){El&&(El=!1,I(b,A.ATLAS_QUALITY_CHANGE_COMPLETED))}function Wl(){El&&(El=!1,I(b,A.ATLAS_QUALITY_CHANGE_CANCELLED))}function Ql(e){e.activeStreamId.includes("text")||U().setAudioLoading(!0)}function zl(e){e.activeStreamId.includes("text")||(I(O,A.REPORT_AUDIO_CHANGED),U().setAudioLoading(!1))}function Xl(e){e.activeStreamId.includes("text")||U().setAudioLoading(!1)}function ql(){gl&&nl===pl.position&&(il.debug("check end of stream"),$l()),nl=pl.position}function $l(){il.debug("end of stream"),tl=clearInterval(tl),df("End of stream"),dl={},I(b,A.LIVE,!1)}function Jl(e){var t=Nl(e.url);Object.prototype.hasOwnProperty.call(dl,t)&&(dl[t]=0),ll=0,Ol(),function(e){if(ol||Ie.get("chunkReporting")){var t=Nl(e.url);if(!sl.includes(t)){var n=Bd(e),r=n.waitingTime,a=n.loadingTime;Ce.send({message:"Chunk download",data:{category:"Chunk",item:"download",action:"success",start_loading:Date.now()-e.time,chunk_size:e.size,chunk_type:t,waiting_time:r,loading_time:a}})}}}(e),I(O,A.REPORT_BANDWIDTH,e)}function ef(){wa.dispatch((0,Xa.Bt)(!0)),!0!==gl&&!1===(ue.isVid()&&pl.position>pl.data.contentLength-200)&&I(O,A.REPORT_BUFFER_EMPTY)}function tf(){wa.dispatch((0,Xa.Bt)(!1)),I(O,A.REPORT_BUFFER_FULL)}function nf(e){if(I(b,A.ATLAS_ERROR,e),!e.recoverable)return il.debug("handleAtlasUnrecoverableError"),I(b,A.ATLAS_CLEANUP,"Unrecoverable atlas error"),ul=!1,dl={},Ol(),hl=!0,void(Jd=setTimeout(vf,750));switch(e.error){case cn().errors.SEGMENT_NOT_FOUND:case cn().errors.SEGMENT_LOAD_FAILED:I(O,A.REPORT_ERROR,e),function(e){if(il.debug("handleAtlasDownloadError"),e.status>=500||0===e.status)!function(e){var t=e.url,n=su(),r=(0,s.default)(n,"url");il.info("serverError",{currentProvider:r,url:t}),r&&!t.includes(r)||I(h,A.CHANGE_PROVIDER,{reason:"server error"})}(e);else if(gl&&!1===ue.isOffairVid())tl||(il.debug("start end of stream interval"),tl=setInterval(ql,1e3));else if(!qd){var t=Nl(e.url);Object.prototype.hasOwnProperty.call(dl,t)||(dl[t]=0),dl[t]+=1,dl[t]>=3&&Al(e)}}(e.details);break;case cn().errors.PLAY_ERROR:"NotAllowedError"===(t=e.details).error.name&&(ul?Il():cn().addListener(cn().events.ATLAS_FULLY_INITIALIZED,Il),Ea.send("error",{name:"autoplayRejected",message:t.error.message}),of());break;default:I(O,A.REPORT_ERROR,e)}var t}function rf(e){c.Z.log(Qd(Qd({},e),{},{source:"atlas/".concat(e.source)})),I(b,A.ATLAS_LOG,e)}function af(e){var t=ue.isHLS()?ue.getTrimmedDurationInMillisec():ue.getDurationInMillisec();if(t=t||0,e.position>0){var n=function(){if(!ue.hasSavedSeek())return null;var e=ue.getSavedSeek(),t=e.positionInMs,n=e.initiator;return{positionInMs:ue.getAbsoluteSeekPositionInMs(t),initiator:n}}();cn().initialized&&ul&&n?(cn().seek(n.positionInMs,n.initiator),ue.resetSavedSeek()):U().showViewerContainer()}if(e.position>=0){var r=t?e.position/t:0;pl.position=e.position,I(b,A.PROGRESS,r)}yl&&of(),I(b,A.ATLAS_PROGRESS,{position:e.position,sourceMedia:(0,s.default)(pl,"data.sourceMedia")})}function of(){var e;Fa.reportFirstTimeUpdate(),wa.dispatch((e=performance.now(),{type:Hr,payload:e})),C.Z.isDashboard||C.Z.align||function(e){var t,n=wa.getState().ums.hash;if(!e||!n||!e.watchedUrl)return null;try{t=JSON.parse(n)}catch(e){return Ud.error("Parsing hash data failed",n),null}var r=(0,s.default)(t.find((function(e){return e.hash})),"hash",null),a=function(e,t){return decodeURIComponent(e).replace("@@channelId@@",ue.id()).replace("@@contentType@@",ue.isCid()?"channel":"recorded").replace("@@contentId@@",ue.id()).replace("@@hash@@",t)}(e.watchedUrl,r);fetch(a).then((function(e){return e.json()})).then((function(e){return Ud.info("WatchedUrl successfully called",e)})).catch((function(e){return Ud.warn(e.message)}))}(C.Z.hashLockData),yl=!1}function sf(e){I(b,A.ATLAS_STORED_UPDATE,e)}function cf(e){I(b,A.ATLAS_BUFFERED_UPDATE,e)}function uf(e){vl&&(Fa.reportFirstPlayCall(),vl=!1),pl.data&&Object.prototype.hasOwnProperty.call(pl.data,"format")&&pl.data.format===D&&U().showViewerContainer(),cn().play(e),cn().getVideoTag()&&Cd(cn().getVideoTag())}function df(e){il.debug("atlasReset"),cn().initialized&&(cn().removeListener(cn().events.BANDWIDTH,Jl),cn().removeListener(cn().events.BUFFER_EMPTY,ef),cn().removeListener(cn().events.BUFFER_FULL,tf),cn().removeListener(cn().events.ERROR,nf),cn().removeListener(cn().events.POSITION,af),cn().removeListener(cn().events.FINISHED,Yl),cn().removeListener(cn().events.METADATA,xl),cn().removeListener(cn().events.STORED,sf),cn().removeListener(cn().events.BUFFERED,cf),cn().removeListener(cn().events.THROTTLE,wl),cn().removeListener(cn().events.AUDIO_TRACKS,Ul),cn().removeListener(cn().events.TEXT_TRACKS,Ml),cn().removeListener(cn().events.TEXT_TRACK_CUE_CHANGE,Fl),cn().removeListener(cn().events.X08_DETECTED,jl),cn().removeListener(cn().events.WEBKIT_SUPPORTS_FULLSCREEN,kl),cn().removeListener(cn().events.WEBKIT_ENTER_FULLSCREEN,Vl),cn().removeListener(cn().events.WEBKIT_END_FULLSCREEN,Hl),cn().removeListener(cn().events.QUALITY_CHANGE_STARTED,Zl),cn().removeListener(cn().events.QUALITY_CHANGE_COMPLETED,Kl),cn().removeListener(cn().events.QUALITY_CHANGE_CANCELLED,Wl),cn().removeListener(cn().events.ATLAS_FULLY_INITIALIZED,Pl),cn().removeListener(cn().events.LANGUAGE_CHANGE_STARTED,Ql),cn().removeListener(cn().events.LANGUAGE_CHANGE_COMPLETED,zl),cn().removeListener(cn().events.LANGUAGE_CHANGE_CANCELLED,Xl),cn().removeListener(cn().events.SEEK_STARTED,_l),cn().removeListener(cn().events.SEEK_COMPLETED,Dl),cn().removeListener(cn().events.ATLAS_FULLY_INITIALIZED,Il),cn().cleanup(),ul=!1,I(b,A.ATLAS_CLEANUP,e||"unknown reason"),Fa.cleanup(),Fa.setInitStart()),dl={},ll=0,bl=-2,hl=!0,Ol()}function lf(e){il.debug("reset"),df(e),pl={playing:!1,pauseTime:0,position:0},ue.resetSavedSeek(),ll=0,yl=!0,vl=!0,Fa.setInitStart(),Jd=clearTimeout(Jd),rl=void 0,fl=[]}function ff(){il.debug("playbackhandler.onPlay()",{playback:pl});var e=!1;if(cn().initialized||Ll(),pl.playing){var t=Date.now();cn().resume(),il.debug("resume"),pl.pauseTime>0&&t-pl.pauseTime>100&&!ue.isVid()&&!ue.isOffairVid()?(il.debug("resume.time: ".concat(t," - diff: ").concat(t-pl.pauseTime)),cn().seek(pl.position+(t-pl.pauseTime)),pl.pauseTime=0):e=!0}pl.playing&&!e||!pl.data||(pl.playing=!0,uf(pl.data),yl||cn().resume()),pl.playing||(pl.playing=!0),I(b,A.PLAYING,!0)}function pf(){il.debug("playbackhandler.onPause()"),cn().initialized&&(pl.pauseTime=Date.now(),il.debug("pause.time",pl.pauseTime),qd&&(dl={},ll=0,Ol()),cn().pause(),pl.playing=!1,I(b,A.PLAYING,!1))}function mf(e){var t=e.position,n=e.initiator,r=cn().getVideoTag(),a=1e3*t;cn().initialized&&ul&&(!ue.isHLS()||null!=r&&r.seekable.length)?cn().seek(a,n):ue.saveSeek({positionInMs:ue.getRelativeSeekPositionInMs(a),initiator:n})}function gf(){if(cn().initialized){var e=wa.getState().playback,t=e.selectedClosedCaption,n=e.closedCaptionVisible;if(cn().toggleCaptions({trackId:t>-1?t:bl,isVisible:n}),cn().setCaptionPosition(Tl),bl=t,document.pictureInPictureElement){var r=n?{fromMode:"hidden",toMode:"showing"}:{fromMode:"showing",toMode:"hidden"};(0,Kd.T)(r,cn().getVideoTag())}}}function Ef(e){Tl=e,cn().initialized&&cn().setCaptionPosition(e)}function vf(){pl.playing&&pl.data&&Cl(pl.data)}il.debug("atlas",{capabilities:cn().capabilities}),wa.subscribe("playback.selectedAudio",(function(e){cn().initialized&&cn().selectAudio(e)})),wa.subscribe("playback.selectedClosedCaption",gf),wa.subscribe("playback.closedCaptionVisible",gf),wa.subscribe("playback.hashes",(function(e){cn().initialized&&cn().setHash(e)})),wa.subscribe("player.volume",(function(e){var t=e/100;cn().initialized&&cn().setVolume(t)})),wa.subscribe("player.speed",(function(e){cn().initialized&&cn().setPlaybackSpeed(e)}));var yf={init:function(){Xd=!0,cl?(il.debug("reinit"),lf("Atlas init")):(il.debug("init"),cl=!0,L(b,A.PLAY_OPTIONS,Cl),L(b,A.CONTENT_CUT_UPDATE,(function(){ue.getCutStart()&&!Wa&&U().hideViewerContainer()})),L(b,A.NEXT_OFFAIR_VIDEO,Rl),L(b,A.LIVE,(function(e){pl.pauseTime=0,pl.data=null,gl=!e,!0===e&&(tl=clearInterval(tl),df("Status changed"))})),L(b,A.OFFLINE_MODULE_RECEIVED,(function(){il.debug("offline module received",{playing:pl.playing}),gl=!0,pl.playing||$l()})),L(h,A.PLAY,ff),L(h,A.PAUSE,pf),L(h,A.SEEK,mf),L(h,A.SET_CAPTION_POSITION,Ef))},reset:lf},Tf=(0,c.w)("atlas/logic/getstream"),hf={},bf={SUCCESS:"mte_getstream_success",ERROR:"mte_getstream_error"},Sf=1e3,Of=1e4,Af=2e3,If=null,Lf=0,_f=0,Df=0,Pf=0,Rf=!1;function Nf(e){var t=e.target;switch(t.readyState){case XMLHttpRequest.HEADERS_RECEIVED:!function(e){switch(Tf.debug("UHLS polling - status ",e.status),e.status){case 202:Tf.debug("UHLS polling - retry in 2 seconds"),e.abort(),Uf(),Df=setTimeout((function(){return wf(e.streamUrl)}),Af),Rf=!1;break;case 204:Rf?(Tf.debug("UHLS polling - going offline"),(0,g.Z)(hf,bf.ERROR,204),Rf=!1):(Tf.debug("UHLS polling - retry in 10 seconds"),e.abort(),Uf(),Pf=setTimeout((function(){return wf(e.streamUrl)}),Of),Rf=!0);break;case 404:(0,g.Z)(hf,bf.ERROR,404),Uf(),Lf=0,clearTimeout(_f),clearTimeout(Df),clearTimeout(Pf),_f=0,Df=0,Pf=0,Rf=!1}}(t);break;case XMLHttpRequest.DONE:!function(e){200===e.status&&(Tf.info("Master playlist downloaded",{url:e.responseURL,content:e.responseText}),Lf=1,(0,g.Z)(hf,bf.SUCCESS,e.streamUrl),Uf(),Rf=!1)}(t)}}function Cf(e){var t=e.target;if(Lf>6)(0,g.Z)(hf,bf.ERROR,408);else{Lf+=1;var n=Math.pow(2,Lf);Tf.debug("UHLS timeout. Retrying in ".concat(n," secs")),Uf(),_f=setTimeout((function(){return wf(t.streamUrl)}),n*Sf)}}function wf(e){Tf.debug("load",e),e?If&&void 0!==If.readyState?Tf.debug("current request already sent, abort first"):((If=new XMLHttpRequest).streamUrl=e,If.timeout=5e3,If.onreadystatechange=Nf,If.ontimeout=Cf,If.onerror=Cf,e&&o().playstation&&(e=e.replace("/iphone/","/sony/")),If.open("GET",e,!0),If.setRequestHeader("Content-type","application/x-www-form-urlencoded"),If.send()):Tf.debug("no url")}function Uf(){If=null}var Mf,Ff,jf={event:bf,load:wf,abort:function(){Tf.debug("abort"),clearTimeout(_f),clearTimeout(Df),clearTimeout(Pf),If&&If.abort&&If.abort(),Uf()},on:function(e,t){hf[e]||(hf[e]=[]),hf[e].push(t)},setPollingInterval:function(e){Af=e},setRetryTimeout:function(e){Sf=e},setOfflineTimeout:function(e){Of=e},setRetryCount:function(e){Lf=e}},kf=[],Gf=(0,c.w)("lib/hlsChecker");function Bf(e){jf.load(e)}jf.on(jf.event.SUCCESS,(function(){Mf(Ff)})),jf.on(jf.event.ERROR,(function(e){Gf.debug("hls check error:",e),Ff.streams.length>0&&(kf.push(Ff.streams.shift()),Bf(Ff.streams[0].initUrl))}));var Vf=function(e,t,n){var r,a;t=t||{},n.forEach((function(n){n.hasOwnProperty("name")&&(r=n.name,a=n.hasOwnProperty("updatedName")?n.updatedName:n.name,t[a]=e.hasOwnProperty(a)?e[a]:e[r])}))},Hf=[{name:"name"},{name:"url"},{name:"varnishUrl"},{name:"seek"}],xf=[{name:"width"},{name:"height"},{name:"videoCodec",updatedName:"codec"},{name:"bitrate"},{name:"description"},{name:"contentType"},{name:"initUrl"},{name:"chunkId"},{name:"streamNameService"},{name:"url",updatedName:"initUrl"},{name:"streamName",updatedName:"segmentUrl"},{name:"chunkTime",updatedName:"segmentLength"}],Yf=(0,c.w)("shim/legacy"),Zf=function(e){return function(e){return!!(e&&(0,ac.Z)(e)&&e[0]&&e[0].streams&&(0,ac.Z)(e[0].streams)&&e[0].streams[0])}(e)?(e.providers=function(e){return e.map((function(e){var t={};return Vf(e,t,Hf),t}))}(e),e.hashes=function(e){var t,n=e[0].streams[0];return n.hasOwnProperty("chunkRange")&&(t=n.chunkRange),t}(e),e.streams=function(e){return e[0].streams.map((function(e){var t={};return Vf(e,t,xf),(0,ac.Z)(t.segmentUrl)&&(t.segmentUrl=t.segmentUrl[0]),t}))}(e),e.chunkTime=function(e){var t,n;for(n=0;n<e[0].streams.length;n++)if(e[0].streams[n].hasOwnProperty("chunkTime")){t=e[0].streams[n].chunkTime;break}return t}(e),e.streamType=e.hashes?D:_,e):(Yf.warn("cannot validate module structure"),null)},Kf=function(e){return function(e){return!!(e.hasOwnProperty("providers")&&e.hasOwnProperty("streams")&&e.hasOwnProperty("hashes")&&e.hashes)}(e)?(e.streams=function(e){return e.streams.map((function(t){var n={};return Vf(t,n,xf),e.hasOwnProperty("chunkTime")&&(n.segmentLength=e.chunkTime),e.hasOwnProperty("chunkId")&&(n.chunkId=e.chunkId),n}))}(e),e):(debugLogger.warn("cannot validate module structure"),null)},Wf=(0,c.w)("shim/flvsegmented"),Qf=function(e){return function(e){return!!(e.hasOwnProperty("providers")&&e.hasOwnProperty("streams")&&e.hasOwnProperty("hashes")&&e.hashes)}(e)?(e.hashes=function(e){var t={};return e&&e.hashes&&((0,ac.Z)(e.hashes)?t=e.hashes[0]:(0,jd.Z)(e.hashes)&&(t=e.hashes)),t}(e),e.streams=function(e){var t;return t=e.streams.map((function(e){var t={};return Vf(e,t,xf),(0,ac.Z)(t.segmentUrl)&&(t.segmentUrl=t.segmentUrl[0]),t})),e.hasOwnProperty("keyframe")&&(0,ac.Z)(e.keyframe)?e.keyframe.forEach((function(e,n){t[n]&&(t[n].chunkId=+e.chunkId||0)})):t.forEach((function(e){e.chunkId=e.chunkId||0})),t}(e),e.hasOwnProperty("keyframe")&&delete e.keyframe,e):(Wf.warn("cannot validate module structure"),null)},zf=(0,c.w)("shim/hls"),Xf=function(e){return function(e){return!!(e&&(0,ac.Z)(e)&&e[0]&&e[0].name&&e[0].url)}(e)?(e.streamType=N,e.streams=function(e){return e.map((function(e){var t={};return Vf(e,t,xf),t}))}(e),e):(zf.warn("cannot validate module structure"),null)},qf=(0,c.w)("shim/mp4movie"),$f=function(e){return function(e){return!!(e&&(0,ac.Z)(e)&&e[0]&&e[0].streams&&e[0].streams[0].mimetype)}(e)?(e.streamType=P,e.streams=function(e){return e[0].streams.map((function(e){var t={};return Vf(e,t,xf),t}))}(e),e):(qf.warn("cannot validate module structure"),null)},Jf=(0,c.w)("shim/simple"),ep=function(e){return function(e){return!(!e.hasOwnProperty("providers")||!e.hasOwnProperty("streams"))}(e)?(e.streamType=_,e.streams=function(e){return e.streams.map((function(e){var t={};return Vf(e,t,xf),t}))}(e),e):(Jf.warn("cannot validate module structure"),null)};function tp(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function np(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tp(Object(n),!0).forEach((function(t){rp(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tp(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function rp(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ap=function(e){return function(e){var t=(0,s.default)(e,"streamFormats.mp4/segmented"),n=(0,s.default)(t,"contentAccess.accessList"),r=e.providers.map((function(e){var t=new URL(e.url),r=(0,s.default)(n,"0.data.protocol");t.protocol=r;var a=(0,s.default)(n,"0.data.path"),i="".concat(t.pathname,"/").concat(a,"/").replace(/\/{2,}/g,"/");return t.pathname=i,Object.assign(e,{url:t.toString()})})),a=t.streams.map((function(e){return np(np({},e),{},{segmentLength:t.chunkTime,chunkId:t.chunkId})}));return np(np({},t),{},{streams:a,providers:r,streamType:R,sourceMedia:e.sourceMedia})}(e)},ip=function(e){var t=(0,s.default)(e,"streamFormats.mp4/segmented.contentAccess.accessList");return cn().capabilities.includes(cn().formats.MP4_SEGMENTED)&&e&&1===e.version&&t&&t.length};function op(e){return function(e){if(Array.isArray(e))return fp(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||lp(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function sp(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function cp(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?sp(Object(n),!0).forEach((function(t){up(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sp(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function up(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function dp(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){s=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(s)throw a}}return i}}(e,t)||lp(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function lp(e,t){if(e){if("string"==typeof e)return fp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?fp(e,t):void 0}}function fp(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function pp(e){var t=(0,Nn.Z)(e,["language","country","label","default","audioCodec","segmentUrl","segmentLength","chunkId"]);return Object.assign(t,{contentType:"audio",bitrate:(0,s.default)(t,"audioCodec.audioBitrate")})}function mp(e){var t=(0,Nn.Z)(e,["offsetInMs","offset","preset","transcoded","videoCodec","segmentUrl","segmentLength","chunkId"]);return Object.assign(t,{contentType:"video",bitrate:(0,s.default)(t,"videoCodec.videoBitrate"),width:(0,s.default)(t,"videoCodec.width"),height:(0,s.default)(t,"videoCodec.height")})}function gp(e){return{audio:pp(e),video:mp(e)}}function Ep(e){var t=(0,s.default)(e,"streamFormats.flv/segmented"),n=t.streams,r=t.chunkTime,a=t.chunkId;if(0===n.length)return[];var i=n.map((function(e){return Object.assign(e,{segmentLength:r,chunkId:a})}));if(function(e){var t=dp(e,1)[0];return-1===(0,s.default)(t,"videoCodec.videoBitrate",-1)&&-1===(0,s.default)(t,"videoCodec.height",-1)}(n))return i.map(pp);if(function(e){var t=dp(e,1)[0];return-1===(0,s.default)(t,"audioCodec.audioBitrate",-1)}(n))return i.map(mp);var o=function(e){var t=e.map(gp).reduce((function(e,t){var n,r,a,i=t.audio,o=t.video,c=(n=o,r=(0,s.default)(n,"videoCodec.height",0),a=(0,s.default)(n,"videoCodec.videoBitrate",0),"".concat(r,":").concat(a));return e.hasOwnProperty(c)||(e[c]=Object.assign(o,{audioVersions:[],segmentUrl:void 0})),e[c].audioVersions.push(i),e}),{});return Object.values(t)}(i),c=o[0].audioVersions.map((function(e){return cp(cp({},e),{},{segmentUrl:void 0})}));return[].concat(op(o),op(c))}var vp=function(e){return function(e){var t=function(e){var t=(0,s.default)(e,"providers",[]),n=(0,s.default)(e,"streamFormats.flv/segmented.contentAccess"),r=(0,s.default)(n,"accessList.0.data");return r&&"INSERT"===n.accessMode?t.map((function(e){var t=new URL(e.url);return r.protocol&&(t.protocol=r.protocol),r.path&&(t.pathname=r.path),cp(cp({},e),{},{url:t.toString()})})):t}(e),n=Ep(e);return cp(cp({},(0,s.default)(e,"streamFormats.flv/segmented")),{},{streams:n,providers:t,streamType:D,sourceMedia:e.sourceMedia})}(e)},yp=function(e){var t=(0,s.default)(e,"streamFormats.flv/segmented.contentAccess.accessList");return-1!==cn().capabilities.indexOf(cn().formats.FLV_SEGMENTED)&&e&&1===e.version&&t&&t.length};function Tp(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function hp(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Tp(Object(n),!0).forEach((function(t){bp(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Tp(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function bp(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Sp=function(e){return function(e){var t=function(e){var t=(0,s.default)(e,"providers",[]),n=(0,s.default)(e,"streamFormats.hls/improved.contentAccess"),r=(0,s.default)(n,"accessList.0.data");return r&&"APPEND"===n.accessMode?t.map((function(e){var t=new URL(e.url).host,n=new URL(r.url);return n.searchParams.set(r.parameter,encodeURIComponent(t)),hp(hp({},e),{},{url:n.toString(),providerHost:t})})):t}(e),n=function(e,t){var n=(0,s.default)(e,"streamFormats.hls/improved.contentAccess.accessList.0.data.parameter");return t.map((function(e){return{parameter:n,initUrl:e.url}}))}(e,t);return{providers:t,streams:n,streamType:N}}(e)},Op=function(e){var t=(0,s.default)(e,"streamFormats.hls/improved.contentAccess.accessList");return t&&t.length&&e&&1===e.version},Ap=function(e){return e.streamType=P,e.streams=[],function(e){var t=(0,s.default)(e,"streamFormats.mp4.contentAccess.accessList");return e.streams=t.map((function(e){return{mimetype:"video/mp4",segmentUrl:e.data.url}})),e}(e)},Ip=function(e){var t=(0,s.default)(e,"streamFormats.mp4.contentAccess.accessList");return e&&1===e.version&&t&&t.length},Lp=function(e){return e.streamType=_,e.streams=[],function(e){var t,n=(0,s.default)(e,"streamFormats.flv.contentAccess.accessList");return e.providers=[],t=n.map((function(t){return e.providers.push({name:t.data.provider,seek:{mode:"byte",param:"fs"}}),t.data.url})),e.streams=[{segmentUrl:t}],e}(e)},_p=function(e){var t=(0,s.default)(e,"streamFormats.flv.contentAccess.accessList");return e&&1===e.version&&t&&t.length},Dp=(0,c.w)("streamshim"),Pp=function(e){if(!e)return null;if(e.hasOwnProperty("version")&&1===e.version)ip(e)?e=ap(e):yp(e)?e=vp(e):Op(e)?e=Sp(e):Ip(e)?e=Ap(e):_p(e)&&(e=Lp(e));else if(e.hasOwnProperty("streamType"))switch(Dp.debug("shim ".concat(e.streamType," type")),e.streamType){case R:e=Kf(e);break;case D:e=Qf(e)}else e=(0,ac.Z)(e)?function(e){return!(!(e&&(0,ac.Z)(e)&&e[0]&&e[0].name&&e[0].url)||e[0].providers)}(e)?Xf(e):function(e){return!!(e&&(0,ac.Z)(e)&&e[0]&&e[0].streams&&e[0].streams[0].mimetype&&"video/mp4"===e[0].streams[0].mimetype)}(e)?$f(e):Zf(e):ep(e);return e};function Rp(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Np(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Cp(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var wp=(0,c.w)("streams"),Up={text:[],audio:[],video:[]};function Mp(){var e=Up.audio.reduce((function(e,t){var n,r=t.label||"Default",a=e[r]||[];return e[r]=[].concat(function(e){if(Array.isArray(e))return Rp(e)}(n=a)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(n)||function(e,t){if(e){if("string"==typeof e)return Rp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Rp(e,t):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[t]),e}),{});return Object.keys(e).map((function(t){return e[t]})).map((function(e){return e.reduce((function(e,t){return e.transcoded?e:t}))}))}var Fp,jp,kp,Gp,Bp,Vp={store:function(e){var t,n=(t=e.contentType)?t.split("/")[0]:"video";if(Up.hasOwnProperty(n)){var r=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Np(Object(n),!0).forEach((function(t){Cp(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Np(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({id:Up[n].length},e);Up[n].push(r)}else wp.warn("Unknown stream type: ".concat(n))},clear:function(){Object.assign(Up,{text:[],audio:[],video:[]})},getAvailableQualities:function(){return Up.video.filter((function(e){return e.height||e.bitrate}))},getVideoVersions:function(){return Up.video},getAudioVersions:Mp,getDefaultAudioVersion:function(){var e=Mp(),t=Ie.get("defaultLang");return(0,Md.Z)(e,t)||e.find((function(e){return!!e.default}))||e[0]},getTextVersions:function(){return Up.text},findOneVideoVersionById:function(e){return Up.video.find((function(t){return t.id===e}))},findOneTextVersionBySourceStream:function(e){return Up.text.find((function(t){return t.sourceStreamVersion===e}))},findOneAudioVersionById:function(e){return Mp().find((function(t){return t.id===e}))}},Hp=null,xp=null,Yp=!1,Zp=(0,c.w)("streamparser");function Kp(){I(b,A.STREAM_VERSION_UPDATE)}function Wp(e){return Object.prototype.hasOwnProperty.call(e,"videoLength")?e.videoLength:ue.getDurationInMillisec()}function Qp(e){(function(e){kp=e.streamType,Fp=e.hashes;var t=Wp(e);t&&t!==ue.getDurationInMillisec()&&ue.setDurationInMillisec(t),e.streams=e.streams||[],Vp.clear(),e.streams.forEach((function(e){!function(e){Object.prototype.hasOwnProperty.call(e,"chunkId")&&(jp=e.chunkId)}(e),Vp.store(e)})),ou(),e.providers&&e.providers.forEach((function(e){ru(e)}))})(e),Kp()}function zp(e){if(!ue.isSegmentedMP4()&&!ue.isFLV()){var t=Wp(e),n=e.cut&&Yp;xp=e,t&&t!==ue.getDurationInMillisec()&&(ue.setDurationInMillisec(1e3*t),n=!0),n&&Kp()}}function Xp(){xp&&xp.cut&&Kp(),Yp=!0}function qp(e){var t,n;(function(e){return Zp.debug("handleLiveStatus",{previousLiveStatus:Bp,liveStatus:Gp}),($p(e)||"offline"===e||$p(e)&&e.hasOwnProperty("version"))&&((Gp=!("offline"===e||$p(e)&&!1===e.contentAvailable))!==Bp&&(!Bp||Gp||ue.isHLS()?I(b,A.LIVE,Gp):I(b,A.OFFLINE_MODULE_RECEIVED,Gp),Gp&&ue.setDurationInMillisec(0),Bp=Gp),"offline"===e||!1===e.contentAvailable)?(ue.setStreamType(void 0),!1):(function(e){var t=e.mid;return t&&t.indexOf("recorded")>-1}(e)&&(Bp=!1,Gp=!1,I(b,A.RECORDED_READY)),!0)})(e)&&function(e){return e&&e.streamFormats&&Object.keys(e.streamFormats).length}(e)&&(e=Pp(e))&&(e.streamType?(ue.setStreamType(e.streamType),Hp||Ce.send({message:"Streamtype selected",data:{category:"Playback",item:"initial loading",action:"selected"}}),t=e,n=Hp,JSON.stringify(t)!==JSON.stringify(n)&&(Hp=(0,rc.Z)(e),function(e,t){var n;Mf=t,Ff=e,ue.isCid()&&(n=Ff)&&"hls"===n.streamType&&n.streams&&n.streams.length?(Gf.debug("check hls",Ff),kf=[],jf.abort(),Bf(Ff.streams[0].initUrl)):Mf(Ff)}(e,Qp))):I(b,A.UNSUPPORTED))}function $p(e){var t=e.mid;return t&&t.indexOf("channel")>-1}var Jp=function(){L(b,A.CONTENT_CUT_UPDATE,Xp),L(S,A.STREAM_UPDATE,qp),L(S,A.META_UPDATE,zp)},em=function(){return Fp},tm=function(){return kp},nm=function(){return Hp&&Hp.sourceMedia},rm=function(){return jp},am=function(){Zp.debug("reset"),jp=void 0,Fp=null,kp=void 0,Gp=void 0,Bp=void 0,Yp=!1,xp=null,Hp=null,Vp.clear(),ou()};function im(e){return im="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},im(e)}function om(e,t){var n,r=e.length;for(n=0;n<r&&e[n]!=t;n++);return e.splice(n,1),e}var sm={emit:function(e,t,n,r){if(r=r||"def",e&&e[t]){var a=[];if("def"===r)for(var i in e[t])a=a.concat(e[t][i]);else a=e[t][r];var o,s=a.length;for(i=0;i<s;i++)o=a[i],"undefined"!==im(n)?o.call(null,n):o.call(null)}},on:function(e,t,n,r){r=r||"def",e[t]||(e[t]={},e[t].def=[]),e[t][r]||(e[t][r]=[]),e[t][r].push(n)},off:function(e,t,n,r){if(t&&n&&r)e[t][r]=om(e[t][r],n);else if(t&&n&&!r)for(var a in e[t])e[t][a]=om(e[t][a],n);else if(!t||n||r){if(t&&!n&&r)e[t][r]=[];else if(!t&&!n&&r)for(var i in e)e[i][r]=[]}else e[t]={def:[]}}};function cm(e){if(!e.length)return 0;var t=e.reduce((function(e,t){return 0!==t?e+1/t:e}),0);return 0===t?0:e.length/t}function um(e){return e.length?e.reduce((function(e,t){return e+t}),0)/e.length:0}var dm,lm,fm,pm,mm,gm,Em,vm,ym={harmonicFromList:cm,harmonicFromKey:function(e,t){return e.length?cm(e.map((function(e){return e[t]}))):0},fromList:um,fromKey:function(e,t){return e.length?um(e.map((function(e){return e[t]}))):0}},Tm=function(e){function t(e){var t=lm.slice(lm.length-e);return t.map((function(e){return e.sizeInKiloBit/e.loadingTimeInSec}))}function n(e){return e<=lm.length}return lm=[],{getName:function(){return e},addThroughputSample:function(e){if(kd(e)){var t=Bd(e),n=t.waitingTime,r=t.loadingTime;lm.push({sizeInKiloBit:.008*e.size,waitingTimeInSec:n/1e3,loadingTimeInSec:r/1e3}),lm=lm.slice(-50),pm=null,fm=null,mm=null,dm=Date.now()}},getHarmonicMeanWaitingTime:function(e){if(n(e)){if(null===pm||e!==pm.calcLength){var t=lm.slice(lm.length-e);pm={calcLength:e,value:ym.harmonicFromKey(t,"waitingTimeInSec")}}return pm.value}},getHarmonicMeanThroughput:function(e){if(n(e)){if(null===fm||e!==fm.calcLength){var r=t(e);fm={calcLength:e,value:ym.harmonicFromList(r)}}return fm.value}},getMeanThroughput:function(e){if(n(e)){if(null===mm||e!==mm.calcLength){var r=t(e);mm={calcLength:e,value:ym.fromList(r)}}return mm.value}},getLastUpdatedTimeStamp:function(){return dm}}},hm=[],bm={UPDATE:"update",PROVIDER:"stats"},Sm={},Om=(0,c.w)("atlas/playback/qos/network"),Am={getCurrentProviderName:function(){return gm?gm.getName():void 0},setCurrentProviderName:function(e){gm=function(e){return hm.find((function(t){return t.name===e}))}(e),void 0===gm&&(gm=Tm(e),hm.push(gm)),sm.emit(Sm,bm.PROVIDER,e)},getHarmonicMeanWaitingTime:function(e){return gm?gm.getHarmonicMeanWaitingTime(e):void 0},getHarmonicMeanThroughput:function(e){return gm?gm.getHarmonicMeanThroughput(e):void 0},getMeanThroughput:function(e){return gm?gm.getMeanThroughput(e):void 0},addThroughputSample:function(e){gm?(gm.addThroughputSample(e),sm.emit(Sm,bm.UPDATE)):Om.warn("sample data without provider set")},event:bm,on:sm.on.bind(null,Sm)},Im={},Lm={BANDWIDTH_UPDATE:"bandwidthUpdate",QUALITY_SELECTED:"qualitySelected",EMPTY_SELECTION:"emptySelection",STATS:"stats"},_m=(0,c.w)("qos"),Dm=[],Pm=[],Rm={waitingTimeInSec:0,playerWidth:0,playerHeight:0,shortMean:void 0,longMean:void 0,chunkLengthInSec:0,forcedId:void 0,currentVersion:null};function Nm(e){var t={};return e.forEach((function(e){Object.prototype.hasOwnProperty.call(Rm,e)?t[e]=Rm[e]:_m.debug("Warning: dependency does not exist")})),t}function Cm(e,t){var n=[];return t.forEach((function(t){Object.prototype.hasOwnProperty.call(e,t)&&void 0!==e[t]||n.push(t)})),n}function wm(e,t){var n=(0,rc.Z)(e),r=Nm(t.getDependencies()),a=t.getLeastWorstFilter();return sm.emit(Im,Lm.EMPTY_SELECTION,t.NAME),a.call(null,n,r)}function Um(e,t){var n=(0,rc.Z)(e),r=t.getDependencies(),a=Nm(r),i=t.getFilter(),o=Cm(a,r);return 0===o.length?n=i.call(null,n,a):_m.debug("Filter ".concat(t.NAME,"function has the following missing dependencies: "),o),n}function Mm(){var e;0!==Dm.length&&(e=function(e){var t,n,r=(0,rc.Z)(e);for(n=0;n<Pm.length;n+=1)if(0===(r=Um(r,t=Pm[n])).length){r=wm(e,t);break}return r}(Dm),Em=vm?function(e){var t=e[0],n=vm.getDependencies(),r=Nm(n),a=vm.getRunner(),i=Cm(r,n);return 0===i.length?t=a.call(null,e,r):_m.warn("Select module has the following missing dependencies: ",i),t}(e):e[0],sm.emit(Im,Lm.QUALITY_SELECTED,Em))}function Fm(){Rm.shortMean=Am.getHarmonicMeanThroughput(3),Rm.longMean=Am.getHarmonicMeanThroughput(5),Rm.waitingTimeInSec=Am.getHarmonicMeanWaitingTime(5),sm.emit(Im,Lm.STATS,{throughput:{shortMean:Rm.shortMean,longMean:Rm.longMean,waitingTimeInSec:Rm.waitingTimeInSec}}),sm.emit(Im,Lm.BANDWIDTH_UPDATE)}function jm(e){sm.emit(Im,Lm.STATS,{provider:{name:e}})}var km={init:function(){Am.on(Am.event.UPDATE,Fm),Am.on(Am.event.PROVIDER,jm)},reset:function(){},setStreams:function(e){Dm=(0,rc.Z)(e),Mm()},setFilters:function(e){var t=(Pm=e).map((function(e){return e.NAME}));sm.emit(Im,Lm.STATS,{filters:{names:t}})},setSelectModule:function(e){vm=e},setParameters:function(e){Rm=Object.assign(Rm,e),Mm()},setForcedId:function(e){Rm.forcedId=e>=0?e:void 0},setQualityPlaying:function(e){Rm.currentVersion=e},setCurrentProviderName:function(e){Am.setCurrentProviderName(e)},getAverageBandwidth:function(e){return Am.getMeanThroughput(e)},addThroughputSample:function(e){Am.addThroughputSample(e),Mm()},getSelectedQuality:function(){return Em?Em.id:void 0},getSelectedStreamVerison:function(){return Em},event:Lm,on:sm.on.bind(null,Im),off:sm.off.bind(null,Im)},Gm=function(){return{NAME:"network",getDependencies:function(){return["longMean","shortMean","waitingTimeInSec","chunkLengthInSec"]},getFilter:function(){return function(e,t){var n=function(e){var t=e.shortMean,n=e.longMean;if(t&&n)return Math.min(n,t)}(t);if(!n||void 0===t.chunkLengthInSec)return e;var r=t.chunkLengthInSec;return e.filter((function(e){return e.bitrate*r/n+t.waitingTimeInSec<.8*r}))}},getLeastWorstFilter:function(){return function(e,t){return 0===e.length?[]:[e.reduce((function(e,t){return t.bitrate<e.bitrate?t:e}))]}}}},Bm=function(){function e(e){return e.video.width*e.video.height}return{NAME:"initialScreen",getDependencies:function(){return["playerWidth","playerHeight"]},getFilter:function(){return function(t,n){var r=n.playerWidth,a=n.playerHeight;return t.filter((function(t){return!Object.hasOwnProperty.call(t,"video")||e(t)/(r*a)<.6}))}},getLeastWorstFilter:function(){return function(t){return t.length&&Object.hasOwnProperty.call(t[0],"video")?[t.reduce((function(t,n){return e(n)<e(t)?n:t}))]:t}}}},Vm=function(){return{NAME:"screen",getDependencies:function(){return["playerWidth","playerHeight"]},getFilter:function(){return function(e,t){var n=t.playerWidth,r=t.playerHeight;return e.filter((function(e){return!Object.hasOwnProperty.call(e,"video")||n>=e.video.width||r>=e.video.height}))}},getLeastWorstFilter:function(){return function(e){return e}}}},Hm=function(){return{NAME:"streamVersionId",getDependencies:function(){return["forcedId"]},getFilter:function(){return function(e,t){var n=t.forcedId;return e.filter((function(e){return n===e.id}))}},getLeastWorstFilter:function(){return function(e){return e}}}};function xm(e,t){return t.bitrate-e.bitrate}var Ym=function(){return{NAME:"select",getDependencies:function(){return[]},getRunner:function(){return function(e){return e.slice().sort(xm)[0]}}}};function Zm(e){if(e){var t=["segmentId","hashId"];return e.replace(/%/g,(function(){return"#".concat(t.shift(),"#")}))}}var Km=function(e,t){switch(t){case"mp4/segmented":return function(e){return{contentType:e.contentType,codecs:e.codec,initUrl:Zm(e.initUrl),segmentUrl:Zm(e.segmentUrl),segmentLength:e.segmentLength,label:e.label,language:e.language,country:e.country}}(e);case"flv/segmented":return function(e){return{contentType:"video/flv",codecs:"",segmentUrl:Zm(e.segmentUrl),segmentLength:e.segmentLength,label:e.label,language:e.language,country:e.country}}(e);case"hls":case"mp4":case"flv/movie":return function(e){var t={segmentUrl:e.segmentUrl};return e.streamNameService&&(t.streamNameService=e.streamNameService),t}(e);default:return null}},Wm=function(e){return{contentType:e.contentType,segmentUrl:Zm(e.segmentUrl),country:e.country,default:e.default,language:e.language,label:e.label,sourceStreamVersion:e.sourceStreamVersion,segmentLength:e.segmentLength}};function Qm(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function zm(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qm(Object(n),!0).forEach((function(t){Xm(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qm(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Xm(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qm(e,t){return"".concat(e,"://").concat(V.Z.config.tcdn,"/").concat(t,"/?protocol=http&version=1")}var $m,Jm=function(e){var t=function(e){switch(e.format){case"hls":return function(e){return{url:e.provider.url||e.videoVersion.initUrl,hlsSdcdnHostParameterName:e.hlsSdcdnHostParameterName}}(e);case"mp4":return function(e){return{url:e.videoVersion.segmentUrl}}(e);case"flv":return function(e){return{url:e.videoVersion.segmentUrl[0],seekParameter:"fs"}}(e);case"flv/segmented":return function(e){var t={contentStart:0,segmentId:e.chunkId,hashes:e.hashes,baseUrl:e.provider.url};if("uhs_tcdn"===e.provider.name){var n=e.ssl?"https":"http";t.streamNameService=qm(n,e.mediaId)}var r,a=e.videoVersion,i=e.audioVersion;if(a)if(i){var o=a.audioVersions.find((function(e){return e.label===i.label})).segmentUrl,s=(0,Nn.Z)(a,["segmentLength"]),c=(0,Nn.Z)(i,["label","language","country"]),u=zm(zm({segmentUrl:o},s),c);r=Km(u,e.format)}else r=Km(a,e.format);else r=Km(i,e.format);return t.representations=[r],t}(e);default:return function(e){var t={contentStart:0,segmentId:e.chunkId,hashes:e.hashes,baseUrl:e.provider.url,sourceMedia:e.sourceMedia};if("uhs_tcdn"===e.provider.name){var n=e.ssl?"https":"http";t.streamNameService=qm(n,e.mediaId)}t.representations=[];var r=e.videoVersion;if(r){var a=Km(r,e.format);t.representations.push(a)}var i=e.audioVersion;if(i){var o=Km(i,e.format);t.representations.push(o)}var s=e.textVersion;if(s){var c=Wm(s);t.representations.push(c)}return t}(e)}}(e),n=function(e){var t={format:e.format};return e.contentLength&&(t.contentLength=e.isHLS?e.trimmedLength:e.contentLength),t}(e);return Object.assign(t,n)},eg=!1,tg=(0,c.w)("atlas/playback/tcdnurlresolver");$m={isInProgress:function(){return eg},resolve:function(e,t,n){tg.debug("resolving: ".concat(e," - ").concat(n));var r=new XMLHttpRequest,a=window.setTimeout(r.ontimeout,5e3);function i(n,r){eg=!1,t&&t({status:n,url:e,resolved:r})}r.ontimeout=function(){window.clearTimeout(a),tg.error("timeout: ".concat(e," - "),n),i($m.status.TIMEOUT,this.responseText)},r.onreadystatechange=function(){4===this.readyState&&(window.clearTimeout(a),200===this.status?this.responseText&&this.responseText.length?(tg.info("resolved: ".concat(e," - "),this.responseText),i($m.status.SUCCESS,this.responseText)):(tg.warn("resolve failed (empty response): ".concat(e," - "),this.responseText),i($m.status.ERROR,this.responseText)):(tg.error("resolve failed (status error): ".concat(e," - "),this.responseText),i($m.status.ERROR,this.responseText)))},eg=!0,r.open("GET",n,!0),r.send(null)},status:{SUCCESS:"success",ERROR:"error",TIMEOUT:"timeout"}};var ng=$m;function rg(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ag,ig,og,sg=null,cg=null;function ug(){var e=sg.url||sg.baseUrl;if(function(e){var t,n,r=e.url||e.baseUrl,a=e.format===N,i=cg.format===N;if(a&&i&&ig){var o=(t=[cg.url,e.url].map((function(e){try{return new URL(e).searchParams}catch(e){return new URLSearchParams}})).map((function(e){return e.get(ig)})),n=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){s=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(s)throw a}}return i}}(t,n)||function(e,t){if(e){if("string"==typeof e)return rg(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?rg(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),s=o[0],c=o[1];return s&&c&&s!==c}return r!==og}(sg)){var t={from:og,to:e};Wc.onProviderChange(t),I(b,A.PROVIDER_CHANGE,t)}og=e}function dg(){var e,t;ug(),e=(0,s.default)(sg,"representations.0.segmentLength"),I(b,A.CHUNK_LENGTH,e),t={format:sg.format,url:sg.baseUrl||sg.url},wa.dispatch((0,Oa.Ab)(t)),I(b,A.PLAY_OPTIONS,sg)}function lg(e){sg.hasOwnProperty("representation")?sg.baseUrl=e:sg.url=e}function fg(e){e.status===ng.status.SUCCESS&&e.resolved?(ag[e.url]=e.resolved,lg(e.resolved),delete sg.streamNameService,dg()):I(h,A.CHANGE_PROVIDER,{reason:"tcdn resolve error"})}var pg,mg,gg,Eg,vg,yg,Tg,hg=function(e){var t,n,r;ig=e.hlsSdcdnHostParameterName,t=sg=(0,rc.Z)(e),n=cg,JSON.stringify(t)!==JSON.stringify(n)&&(cg=(0,rc.Z)(sg),Object.prototype.hasOwnProperty.call(sg,"streamNameService")?ag[sg.streamNameService]?(lg(sg,ag[sg.streamNameService]),delete sg.streamNameService,dg()):(r=sg.url||sg.baseUrl,ng.isInProgress()||ng.resolve(r,fg,sg.streamNameService)):dg())},bg=function(){sg=null,cg=null};function Sg(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Og(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Sg(Object(n),!0).forEach((function(t){Ag(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Sg(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ag(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ig(){mg=(new Date).getTime()}function Lg(){if(void 0===vg)return mg=void 0,void(gg=0);if(void 0!==mg){var e=(new Date).getTime();gg+=e-mg}mg=void 0}function _g(){Eg=pg?"bandwidth update":"quality change",vg=(new Date).getTime(),mg=mg?(new Date).getTime():void 0,Ng("started",void 0,{from_kbps:Tg.bitrate,from_height:Tg.height})}function Dg(){var e=(new Date).getTime()-vg;if(void 0!==mg){var t=(new Date).getTime();gg+=t-mg,mg=t}vg=void 0,Ng("completed",e,{to_kbps:yg.bitrate,to_height:yg.height}),gg=0}function Pg(){if(void 0!==mg){var e=(new Date).getTime();gg+=e-mg}vg=void 0,Ng("cancelled",(new Date).getTime()-vg),gg=0}function Rg(){Cg()}function Ng(e,t,n){var r={message:Eg,data:Og(Og({},n),{},{category:"Playback",item:"quality change",action:e})};void 0!==t&&(r.data.time_spent=t,void 0!==mg&&Lg(),r.data.buffer_spent=gg),Ce.send(r)}function Cg(){mg=void 0,gg=void 0,vg=void 0,Tg=void 0,yg=void 0}var wg=function(){Cg(),L(O,A.REPORT_BUFFER_EMPTY,Ig),L(O,A.REPORT_BUFFER_FULL,Lg),L(b,A.ATLAS_CLEANUP,Rg),L(b,A.ATLAS_QUALITY_CHANGE_STARTED,_g),L(b,A.ATLAS_QUALITY_CHANGE_COMPLETED,Dg),L(b,A.ATLAS_QUALITY_CHANGE_CANCELLED,Pg)},Ug=function(){Cg()},Mg=function(e){pg=e},Fg=function(e,t){Tg=e,yg=t},jg=n(29186);function kg(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Gg(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?kg(Object(n),!0).forEach((function(t){Bg(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kg(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Bg(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Vg,Hg,xg,Yg,Zg,Kg=10,Wg=3,Qg=(0,c.w)("atlas/playback/qosHandler"),zg=null,Xg=null,qg=!0,$g=!1,Jg=1,eE=!1,tE=null,nE=!1;function rE(){var e=wa.getState().playback,t=e.selectedAudio;return e.audioTracks.find((function(e){return e.id===t}))}function aE(e){return e.filter((function(e){return e&&Object.hasOwnProperty.call(e,"bitrate")})).reduce((function(e,t){return e+t.bitrate}),0)}function iE(){nE||(rE()||Xg?((0,s.default)(zg,"id")!==(0,s.default)(Xg,"id")&&(Fg(zg||Xg,Xg),zg=Xg),function(){var e={};Xg&&(e.width=Xg.width,e.height=Xg.height,e.videoCodec=Xg.codec);var t=rE();t&&t.codec&&(e.audioCodec=t.codec),wa.dispatch((0,Xa.h3)(e))}(),function(){var e,t,n,r=wa.getState(),a={format:tm(),hashes:em(),chunkId:rm(),audioVersion:rE(),videoVersion:(0,we.Mr)(r)?null:Xg,textVersion:(e=wa.getState().playback,t=e.selectedClosedCaption,n=e.closedCaptionTracks.find((function(e){return e.id===t})),n?(tE=n,n):tE),provider:iu(),contentLength:ue.getDurationInMillisec(),trimmedLength:ue.getTrimmedDurationInMillisec(),isHLS:ue.isHLS(),hlsSdcdnHostParameterName:Xg&&Xg.parameter,mediaId:ue.id(),sourceMedia:nm(),ssl:o().ssl},i=Jm(a);if(ue.isHLS())try{var s=new URL(i.url);(0,we.Mr)(r)?s.searchParams.set("audioOnly",!0):s.searchParams.delete("audioOnly"),i.url=s.toString()}catch(e){}hg(i)}()):Qg.warn("No quality selected"))}function oE(){var e=(0,we.hz)(wa.getState()),t=e.width,n=e.height;km.setParameters({playerWidth:t,playerHeight:n})}function sE(e){var t,n=Vp.getVideoVersions();if(!(["high","med","low"].indexOf(e)>=0&&n&&n.length))return parseInt(e,10);switch(e.toLowerCase()){case"high":t=n[0].id;break;case"med":t=n[Math.round((n.length-1)/2)].id;break;case"low":t=n[n.length-1].id}return t}function cE(){var e=[Gm(),Vm()];Qg.debug("setRuningFilterFunction"),km.setFilters(e),km.setSelectModule(Ym())}function uE(){var e=[Hm()];Qg.debug("setForcedIdFilterFunctions"),km.setFilters(e),km.setSelectModule(Ym())}function dE(){Vg=clearTimeout(Vg),Hg&&(fE(Hg),Hg=null)}function lE(e){if(e){var t,n,r,a="qos setSelectedVideoVersion id: ".concat(e.id);e&&(a+=" width: ".concat(e.width),a+=" height: ".concat(e.height)),Qg.debug(a),Xg=e,t=Vp.getAvailableQualities().map((function(e){var t=function(e){var t=20*Math.round(e.height/20);return{text:"".concat(t,"p"),suffix:t>=720?" HD":"",bitrate:function(e){if(e>=1e3){var t=e/1e3,n=Math.round(10*t)/10;return" @ ".concat(n," Mbps")}return" @ ".concat(e," kbps")}(e.bitrate)}}(e),n=Xg&&Xg.id===e.id&&!qg;return Gg(Gg({},e),{},{label:t,active:!0,selected:n})})),(0!==t.length||ue.isHLS())&&(t=function(e){return e.push({id:-1,label:{text:"ui.qualityAuto"},height:0,active:!0,selected:qg||ue.isHLS()}),e}(t),U().setQuality(t),Ea.send("quality",t)),mE(),n=rE(),r=aE([Xg,n]),wa.dispatch((0,jg.N)({bitrate:r,sourceStreamVersion:Xg.sourceStreamVersion})),$g||iE(),Vg=setTimeout(dE,1e3)}else Qg.debug("setSelectedVideoVersion No selected version or same")}function fE(e){e?Vg?Hg=e:lE(e):Qg.debug("setSelectedVideoVersion No selected version")}function pE(e){Mg(qg=-1===e)}function mE(){ue.isHLS()||ue.isFLV()||Ie.get("externalvtt")||wa.dispatch((0,Xa.kY)(Vp.getTextVersions()))}function gE(){nE=!0,wa.dispatch(function(e){return{type:Yt.setHash,payload:e}}(em())),function(){if(!ue.isHLS()){var e=Vp.getAudioVersions();wa.dispatch((0,Xa.KS)(e))}}();var e=rE();e||(e=Vp.getDefaultAudioVersion())&&wa.dispatch((0,Xa.Ft)(e.id)),nE=!1;var t=Vp.getVideoVersions();t.length>0&&!e&&!ue.isHLS()&&wa.dispatch((0,Oa.Sc)(!0));var n,r=0===t.length&&!!e;if(wa.dispatch((0,Oa.zp)(r)),r)return mE(),void iE();if(0!==t.length){Xg&&t.some((function(e){return e.initUrl===Xg.initUrl&&e.segmentUrl===Xg.segmentUrl}))||(zg=null,Xg=null,Hg=null,dE(),xg=void 0,Jg=1);var a,i,o=(n=e,t.map((function(e,t){var r,a,i,o,s,c,u,d;return Gg({id:t},(a=n,i=(r=e)&&r.description||a&&a.description,o=r&&r.sourceStreamVersion||a&&a.sourceStreamVersion,s=r&&r.id,c=a&&a.id,u="number"==typeof s?s:c,d={description:i,sourceStreamVersion:o,bitrate:aE([r,a]),id:u},a&&(d.audio=a),r&&(d.video=r),d))})));o.length&&(eE||(pE(i=(i=sE(Zg))>=0?i:sE(Yg)),i>=0?(km.setForcedId(i),a=[Hm()]):a=[Bm()],Qg.debug("setInitialFilterFunctions"),km.setFilters(a),eE=!0),km.setStreams(o))}}function EE(){au(),iE()}function vE(e){km.setCurrentProviderName(e.to)}function yE(e){km.setParameters({chunkLengthInSec:e/1e3})}function TE(e){var t=parseInt(e,10);km.setForcedId(t),pE(t),qg?cE():uE(),dE(),lE(Vp.findOneVideoVersionById(t)),Qg.debug("onQualityChange change quality to: ".concat(t))}function hE(e,t){var n=!1;return e&&t?(e.height>t.height&&(n=!0),n):n}function bE(e){var t=e.video;if(t){var n,r,a,i,o,c=xg&&t.id===xg.id;!qg||(o=wa.getState(),(0,s.default)(o,"provider.currentProvider.isMulticastProvider",!1))||ue.isHLS()?fE(Xg||t):Xg?(i=Jg=c?Jg+1:1,n=(a=xg=t)&&hE(a,Xg)&&i>=Kg,r=function(e,t,n){return e&&hE(t,e)&&n>=Wg}(xg,Xg,Jg),fE(n||r?t:Xg)):fE(t)}}function SE(e){if(eE||ue.isHLS()){var t=e.video;t&&fE(t),km.off(km.event.QUALITY_SELECTED),km.on(km.event.QUALITY_SELECTED,bE),sE(Zg)>=0?uE():(km.setForcedId(void 0),qg=!0,cE())}}function OE(){I(b,A.BANDWIDTH_UPDATED)}function AE(e){wa.dispatch((0,jg.N)(e))}function IE(){$g=!0,Kg=10,Wg=3,Jg=1,Qg.debug("onAtlasQualityChangeStarted change to quality started: ".concat(Xg.id))}function LE(){$g=!1,km.setQualityPlaying(Xg),Qg.debug("onAtlasQualityChangeCompleted change to quality completed: ".concat(Xg.id))}function _E(){$g=!1}function DE(e){km.addThroughputSample(e)}function PE(){RE()}function RE(){nE=!1,zg=null,Xg=null,Hg=null,xg=void 0,$g=!1,Jg=1,tE=null}wa.subscribe("player.playerSize",(function(){oE()})),wa.subscribe("playback.selectedAudio",(function(){iE()})),wa.subscribe("playback.selectedClosedCaption",(function(){iE()})),wa.subscribe("playback.videoTrackDisabled",(function(){iE()}));var NE,CE,wE,UE,ME=function(e,t){Yg=e,Zg=t,L(h,A.QUALITY_CHANGE,TE),L(b,A.STREAM_VERSION_UPDATE,gE),L(h,A.CHANGE_PROVIDER,EE),L(b,A.PROVIDER_CHANGE,vE),L(b,A.CHUNK_LENGTH,yE),L(O,A.REPORT_BANDWIDTH,DE),L(b,A.ATLAS_CLEANUP,PE),L(b,A.ATLAS_QUALITY_CHANGE_STARTED,IE),L(b,A.ATLAS_QUALITY_CHANGE_COMPLETED,LE),L(b,A.ATLAS_QUALITY_CHANGE_CANCELLED,_E),km.init(),km.on(km.event.BANDWIDTH_UPDATE,OE),km.on(km.event.QUALITY_SELECTED,SE),km.on(km.event.STATS,AE),wg(),Mg(qg),oE()},FE=function(){km.reset(),Ug(),bg(),RE(),qg=!0},jE=n(91823),kE=100,GE=200,BE=300,VE=400,HE="reloadTime",xE=!1,YE=!1,ZE={},KE={},WE=[{msg:"unrecognized data format",logLevel:kE},{msg:"invalid content type",logLevel:kE},{msg:"no bytes",logLevel:BE},{msg:"unable to get segmentId",logLevel:GE},{msg:"VideoPlayer.stalled",logLevel:BE}],QE=(0,c.w)("atlas/logic/errorWatcher/watcherHtmlplayback");function zE(e,t,n){var r=(new Date).getTime(),a=e.replace(/(?:^\s+)|(?:\s+$)/g,"").replace(/[^\w]+/g,"_").replace(/[_]{2,}/g,"_");YE||(Object.prototype.hasOwnProperty.call(ZE,e)||(ZE[e]=0),r-ZE[e]<29e3||(ZE[e]=r,n=f({category:"Error",item:a,action:"",level:VE},n),wE&&(n.provider=wE),Ce.send({message:t,data:n})))}function XE(e){var t;switch(e.status){case ng.status.ERROR:t="server error";break;case ng.status.TIMEOUT:t="timeout";break;default:t="unknown error"}zE("tcdn_error",t,BE)}function qE(){var e,t,n={level:VE};"number"==typeof NE&&(n.position=Math.round(NE));var r=(0,we.C5)(wa.getState()).video;n.videoHeight=null!==(e=null==r?void 0:r.height)&&void 0!==e?e:0,n.videoWidth=null!==(t=null==r?void 0:r.width)&&void 0!==t?t:0,zE("heartbeat","heartbeat",n),KE.heartbeat=setTimeout(qE,3e4)}function $E(){UE=clearTimeout(UE)}function JE(e,t){UE&&$E(),UE=setTimeout((function(){zE(e,t,kE),QE.fatal(t)}),5e3)}function ev(e){(0,gn.M)(e)?JE("empty_stream_module","empty stream module received"):$E()}function tv(){$E();var e="browser does not support the content type";zE("unsupported_content",e,kE),QE.fatal(e)}var nv=function(){var e;YE=!1,xE||(e=le.ZP.get(HE),xE=!0,qE(),L(O,A.REPORT_BUFFER_EMPTY,(function(){KE.buffer||(KE.buffer=setTimeout((function(){CE&&zE("long buffer empty","buffer empty more than ".concat(1e4,"ms"),kE)}),1e4))})),L(O,A.REPORT_BUFFER_FULL,(function(){KE.buffer=clearTimeout(KE.buffer)})),L(b,A.PLAYING,(function(e){(CE=e)?NE||(KE.playing=clearTimeout(KE.playing),KE.playing=setTimeout((function(){var e="playback has not begun for ".concat(15e3,"ms");zE("playback has not begun",e,kE),QE.fatal(e)}),15e3)):(KE.progress=clearTimeout(KE.progress),KE.buffer=clearTimeout(KE.buffer),KE.playing=clearTimeout(KE.playing))})),L(b,A.ATLAS_PROGRESS,(function(e){var t=e.position;NE!==t&&(KE.playing=clearTimeout(KE.playing),KE.unrecoveredStalled=clearTimeout(KE.unrecoveredStalled),KE.progress=clearTimeout(KE.progress),KE.progress=setTimeout((function(){if(CE){var e="progress stalled more than ".concat(7e3,"ms");zE("progress stalled",e,kE),QE.fatal(e)}}),7e3)),NE=t})),L(b,A.ATLAS_ERROR,(function(e){if(e.error!==cn().errors.PLAY_ERROR){var t="atlas_".concat(e.error,"_error"),n="",r={level:BE};switch(e.error){case cn().errors.UNSUPPORTED:case cn().errors.INVALID_OPTIONS:r.level=kE;break;case cn().errors.VIDEO_PLAYER:n=e.details.message,r.level=GE;break;case cn().errors.UNRECOVERED_STALLED:r.level=GE;break;case cn().errors.SEGMENT_LOAD_FAILED:n=e.details.reason||"UNKNOWN",r.http_status=e.details.status,r.level=GE;break;case cn().errors.SEGMENT_NOT_FOUND:n=e.details.reason||"UNKNOWN",r.http_status=e.details.status,r.level=BE;break;case cn().errors.CAN_NOT_CREATE_URL:n=e.details.reason,r.level=GE;break;case cn().errors.NEW_REPRESENTATION:r.level=GE}e.error===cn().errors.UNRECOVERED_STALLED?KE.unrecoveredStalled||(KE.unrecoveredStalled=setTimeout((function(){zE(t,n,r)}),5e3)):zE(t,n,r)}})),L(b,A.ATLAS_LOG,(function(e){WE.forEach((function(t){var n=t.msg,r=t.logLevel;e.line.indexOf(n)>-1&&zE(n,e.line,{level:r})}))})),L(b,A.PLAY_OPTIONS,(function(e){if(e.baseUrl){var t=new URL(e.baseUrl);wE="".concat(t.protocol,"//").concat(t.hostname)}})),window.addEventListener("beforeunload",(function(){le.ZP.set(HE,{time:(new Date).getTime(),mid:ue.getMid()})})),L(b,A.ATLAS_CLEANUP,(function(e){e.indexOf("Unrecoverable atlas error")>-1?zE("atlas_reset",e,{level:kE}):e.indexOf("segment not found error")>-1?zE("atlas_reset",e,{level:BE}):zE("atlas_reset",e,{level:VE})})),L(b,A.URL_RESOLVE_FAILURE,XE),L(h,A.CHANGE_PROVIDER,(function(e){zE("provider change",(0,s.default)(e,"reason","unknown"),{level:BE})})),L(b,A.PROVIDER_CHANGE,(function(e){var t=new URL(e.to);wE="".concat(t.protocol,"//").concat(t.hostname)})),zE("load","Error logger loaded",{level:VE}),e&&(new Date).getTime()-e.time<3e4&&e.mid===ue.getMid()&&zE("reload","reload",{level:BE}),L(S,A.STREAM_UPDATE,ev),L(b,A.UNSUPPORTED,tv),JE("zero_stream_module","zero stream module received"))},rv=function(){YE=!0,ZE={},Object.getOwnPropertyNames(KE).forEach((function(e){clearTimeout(KE[e])})),KE={}},av=function(){nv()},iv=function(){rv()},ov=function(){return wa.dispatch({type:rt})},sv=function(e){return wa.dispatch({type:at,payload:{slides:e}})},cv=function(e){return wa.dispatch({type:it,payload:{slide:e}})};function uv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function dv(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?uv(Object(n),!0).forEach((function(t){lv(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):uv(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function lv(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fv(e,t,n,r,a,i,o){try{var s=e[i](o),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,a)}function pv(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){fv(i,r,a,o,s,"next",e)}function s(e){fv(i,r,a,o,s,"throw",e)}o(void 0)}))}}var mv,gv=(0,c.w)("atlas/logic/slideDeck/slideDeckHandler"),Ev=!o().ie||o().ie[0]&&o().ie[0]>9,vv=(mv=[],function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=e.map((function(e){return(0,s.default)(e,"url","")})),n=mv.filter((function(e){return!t.includes(e)}));n.forEach(URL.revokeObjectURL),mv=t});function yv(e){var t=new Blob([e],{type:"image/jpeg"});return URL.createObjectURL(t)}var Tv=function(){if(!Ev)return function(){var e=new Error("Browser not supported");return Promise.reject(e)};var e=null,t=null;function r(){return a.apply(this,arguments)}function a(){return(a=pv(regeneratorRuntime.mark((function r(){var a,i;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return e=new Map,r.next=3,Promise.all([n.e(142),n.e(467)]).then(n.bind(n,57564));case 3:a=r.sent,i=a.default,(t=new i).addEventListener("message",(function(t){var n=t.data,r=n.url,a=n.error,i=n.buffer,o=e.get(r);o&&(e.delete(r),a?o(new Error(a),null):o(null,i))})),t.addEventListener("error",(function(e){e.preventDefault(),gv.error(e.message)}));case 8:case"end":return r.stop()}}),r)})))).apply(this,arguments)}return function(){var n=pv(regeneratorRuntime.mark((function n(a){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(null!==t){n.next=3;break}return n.next=3,r();case 3:return n.abrupt("return",new Promise((function(n,r){var i=a.url,o=a.secret;e.set(i,(function(e,t){if(e)r(e);else{var i=dv(dv({},a),{},{url:yv(t)});n(i)}})),t.postMessage({url:i,secret:o})})));case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}();function hv(e){return dv({start:-1/0,end:1/0},e)}wa.subscribe("slideDeck.slides",vv);var bv=function(e){if(Ev&&(!Array.isArray(e)||e.length>0))if(e){var t=function(e){if(Array.isArray(e))return e.map(hv);if(e.show){var t=e.show;return[hv({url:t.url,secret:t.secret})]}return[]}(e);!function(e){if(0!==e.length){var t=[];e.forEach((function(e){Promise.resolve().then((function(){return function(e){return!!(0,s.default)(e,"url")}(e)?Tv(e):e})).then((function(e){t.push(e),sv(t)})).catch((function(e){gv.error('Decoding error: "'.concat(e.message,'"'))}))}))}else sv([])}(t)}else ov()},Sv=function(e){var t=1e3*e,n=wa.getState().slideDeck,r=n.slides.find((function(e){var n=e.start,r=e.end;return n<=t&&t<=r}));(0,s.default)(r,"url")!==(0,s.default)(n.currentSlide,"url")&&(gv.info("slide update",r),cv(r))},Ov=function(){ov()},Av=function(e){return wa.dispatch({type:Ye,payload:{visibility:e}})},Iv=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return wa.dispatch({type:Ke,payload:{searchResult:e}})},Lv=function(e){var t=!1;return"boolean"==typeof e?t=e:e.token&&(t=!0),wa.dispatch({type:Ze,payload:{module:e,visibility:t}})};n(56791),n(4917),(0,c.w)("multicast/multicast"),(0,c.w)("atlas/playback/hlsWatcher"),(0,c.w)("atlas/logic/ums/connectionParams"),(0,c.w)("atlas/logic/ums/umsHandler");var _v=function(e){},Dv=n(93492);function Pv(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){s=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(s)throw a}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Rv(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Rv(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Rv(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Nv,Cv={CLOSE_NORMAL:1e3,CLOSE_GOING_AWAY:1001,CLOSE_PROTOCOL_ERROR:1002,CLOSE_UNSUPPORTED:1003,CLOSE_NO_STATUS:1005,CLOSE_ABNORMAL:1006,CLOSE_INCONSISTENT_DATA_RECEIVED:1007,CLOSE_POLICY_VIOLATE:1008,CLOSE_TOO_LARGE:1009,CLOSE_MISSING_EXTENSION:1010,CLOSE_UNEXPECTED_CONDITION:1011,CLOSE_FAILED_TLS_HANDSHAKE:1015},wv=null,Uv=null,Mv=null,Fv=!1,jv=null,kv=null,Gv=0,Bv=[];function Vv(e){e&&Array.isArray(e)&&(function(e){var t=Pv(e,2)[1],n=Date.now();"string"==typeof t&&"opened"===t.trim()&&(n-kv<5e3&&clearTimeout(jv),wa.dispatch((0,Dv.pq)({inited:!0})))}(e),function(e){var t=Pv(e,3),n=t[0],r=t[1],a=t[2];if("string"!=typeof r||"opening"!==r.trim()||wv||(wv=n),"string"==typeof r&&r.includes("message")){var i=(0,s.default)(a,"1.0",{});!Uv&&i.meta&&(Uv=n),Mv||!i.stream||(0,gn.M)(i.stream)||(Mv=n)}if(!Fv&&Uv&&Mv&&wv){Fv=!0;var o=Math.max(Uv,Mv)-wv;wa.dispatch((0,Dv.mE)({timeToStartInMs:o}))}}(e),function(e){var t=Pv(e,3),n=t[1],r=t[2];if("string"==typeof n&&"closed"===n.trim()&&r){var a=Pv(r,2),i=a[0],o=a[1],s="".concat(Cv[i]," ").concat(i);o&&(s="".concat(s," ").concat(o)),wa.dispatch((0,Dv.Lv)({level:Rr.Q.WARNING,timeStamp:Date.now(),msg:s}))}}(e),function(e){var t=Pv(e,3),n=t[1],r=t[2];if("string"==typeof n&&"message"===n.trim()&&"reject"===(0,s.default)(r,"cmd")){Gv+=1;var a=r&&r.args?Object.keys(r.args[0])[0]:"unknown";"cluster"===a.trim()&&wa.dispatch((0,Dv.Vl)({level:Rr.Q.ERROR,timeStamp:Date.now(),msg:a})),Gv>3&&wa.dispatch((0,Dv.Vl)({level:Rr.Q.ERROR,timeStamp:Date.now(),msg:a}))}}(e),function(e){var t=Pv(e,3),n=t[0],r=t[1],a=t[2];if("string"==typeof r&&r.includes("message")){var i=(0,s.default)(a,"1.0",{});i.stream&&(0,gn.M)(i.stream)&&wa.dispatch((0,Dv.H$)({level:Rr.Q.ERROR,timeStamp:n,msg:"Stream module empty"}))}}(e))}function Hv(e){var t=e.performance,n=e.url;if(0===e.size){var r="unknown";/\.m4a$/.test(n)&&(r="Audio chunk empty"),/\.m4v$/.test(n)&&(r="Video chunk empty"),wa.dispatch((0,Dv.n2)({level:Rr.Q.WARNING,timeStamp:Date.now(),msg:r}))}if(t){var a=t.requestStart,i=t.responseStart,o=t.responseEnd;if(a&&i&&o){var s=Math.round(i-a),c=Math.round(o-i),u=s+c,d=Wc.isEcdnProvider(n);if(u>5e3){var l="Total: ".concat(u,"ms Req: ").concat(s,"ms Res: ").concat(c,"ms");wa.dispatch((0,Dv.Xw)({level:Rr.Q.WARNING,timeStamp:Date.now(),msg:l,request:s,response:c,total:u,isEcdn:d}))}}}}function xv(e){if(e){var t=e.error,n=e.recoverable;t&&"playError"!==t&&(n?wa.dispatch((0,Dv.UG)({level:Rr.Q.WARNING,timeStamp:Date.now(),msg:t})):wa.dispatch((0,Dv.XR)({level:Rr.Q.ERROR,timeStamp:Date.now(),msg:t})))}}function Yv(e){if(e){var t=e.line;if("string"==typeof t&&t.includes("process segment")){Bv.push(e.data);var n=function(e){var t=e.filter((function(e){var t=e.streamId,n=e.keyFrames;return t.includes("video")&&n.length})).reduce((function(e,t){return e.find((function(e){return e.segmentId===t.segmentId}))||e.push(t),e}),[]).sort((function(e,t){return e.segmentId-t.segmentId})).reduce((function(e,t){var n=e[e.length-1],r=n[n.length-1];return r&&r.segmentId!==t.segmentId-1?e.push([t]):n.push(t),e}),[[]]).map((function(e){return e.reduce((function(e,t){return e.concat(t.keyFrames)}),[]).reduce((function(e,t,n,r){if(n>0){var a=r[n-1];e.push(t-a)}return e}),[])})).reduce((function(e,t){return e.concat(t)}),[]),n=t.reduce((function(e,n){return e+n/t.length}),0);return{keyframeIntervals:t,avg:n}}(Bv=Bv.splice(-20)),r=n.avg;wa.dispatch((0,Dv.bG)({keyFrameInterval:r/1e3}))}}}function Zv(e){var t=e.tracking,n=t.umsConnectionStartTime,r=t.umsConnectionConnectedTime;if("number"==typeof n&&"number"==typeof r)return Math.round(r-n)}function Kv(e){var t=e.tracking,n=t.umsConnectionConnectedTime,r=t.streamModuleReceivedTime;if("number"==typeof n&&"number"==typeof r)return Math.round(r-n)}function Wv(e){var t=e.tracking,n=t.streamModuleReceivedTime,r=t.firstFrameTime;if("number"==typeof n&&"number"==typeof r)return Math.round(r-n)}function Qv(e){return{type:un,payload:e}}function zv(e){var t=e.date,n=e.source,r=e.line,a=e.data,i=e.level;if(void 0!==window.console){var s=[t=new Date(t).toISOString().slice(-13,-1),"[".concat(n,"]"),r];s=o().ie?[s.join(" ")]:["%c".concat(s.join("%c ")),"color: #cecece","font-weight:    bold",""],void 0!==a&&s.push(a),i<200&&window.console.error&&window.console.error.apply(console,s),300===i&&window.console.warn&&window.console.warn.apply(console,s),400===i&&window.console.info&&window.console.info.apply(console,s),500===i&&window.console.debug?window.console.debug.apply(console,s):window.console.log.apply(console,s),window.getUstreamPlayerLog||(window.getUstreamPlayerLog=function(){return c.Z.getLogs()})}}function Xv(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";Ce.send({message:"Unhandled exception",data:{message:e,stack:t.substring(0,2e3),category:"Unhandled exception"}})}de.Z.includes("".concat(V.Z.config.siteLocal,"/embed/test"))&&c.Z.addTransport((function(e){var t,n=e.date,r=e.source,a=e.line,i=e.data,o=e.level;try{t=new URL(de.Z).origin}catch(e){t=""}window.parent.postMessage(JSON.stringify({mte:[n,r,a,i,o]}),t)})),wa.getState().settings.debug&&c.Z.addTransport(zv),Nv=window.onerror,window.onerror=function(e,t,n,r,a){return c.Z.fatal({source:"jserror",line:"".concat(e," Cannot continue."),data:{url:t,lineNumber:n}}),Xv((0,s.default)(a,"message",e),(0,s.default)(a,"stack","")),!!Nv&&Nv(e,t,n)},window.addEventListener("unhandledrejection",(function(e){var t=(0,s.default)(e,"reason",""),n=(0,s.default)(e,"promise");n?n.catch((function(e){Xv((0,s.default)(e,"message",t),(0,s.default)(e,"stack",""))})):Xv(t)})),wa.subscribe("settings.debug",(function(e){e?c.Z.addTransport(zv):c.Z.removeTransport(zv)}));var qv=n(84457),$v=n(13535),Jv=n(88775),ey=(0,c.w)("atlas/logic/captionSearch/captionSearchService"),ty=V.Z.config.api||V.Z.fallbackConfig.api;function ny(e){ey.error("searchOnError",e),Iv()}var ry,ay={searchCaptions:function(e,t){if(t)if(void 0!==t.token){var n=t.token;e?function(e,t){var n=new XMLHttpRequest;function r(){return ny("".concat(n.status," ").concat(n.statusText))}n.addEventListener("load",(function(){if(200===n.status)try{e=JSON.parse(n.responseText),ey.debug("searchOnSuccess",e.caption_matches),Iv(e.caption_matches)}catch(e){ny("Response JSON parse failed")}else r();var e})),n.addEventListener("error",r),n.open("GET",function(e){var t=new URL("https://".concat(ty)),n=ue.isOffairVid()?ue.offairVid():ue.id();return t.pathname="videos/".concat(n,"/captions/search.json"),t.searchParams.set("q",function(e){return e.replace(/\s/g,"+")}(e)),t.searchParams.set("highlight",!0),t.toString()}(e),!0),n.setRequestHeader("Authorization","Bearer ".concat(t)),n.send()}(e,n):ny("Cannot call search api with empty search text.")}else ey.error("There is no token for search api.");else ey.error("There is no module for search api")}},iy=n(66533);function oy(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var sy=!1,cy=function(){};function uy(){iy.S1(Ga().playerState.get(),(function(e){e?wa.dispatch((0,yr.c0)(yr.GT.assistedReporting)):wa.dispatch((0,yr.yK)(yr.GT.assistedReporting))}),{recovery:5e3})}function dy(){var e={waiting:ue.isLiveContent()?1e4:2e4,stalled:1e4};Ga().playerState.init(e);var t=(0,s.default)(V.Z,"config.crt","crt-event-ingest.services.video.ibm.com");Ga().sender.init({ingestURL:"https://".concat(t,"/ingest"),clockSyncURL:"https://".concat(t,"/time"),getEnv:function(){function e(e){var t=(0,Nn.Z)(e,["label","language","country"]),n=t.label,r=t.language,a=t.country;return n&&r&&a?{languageCode:"".concat(r,"-").concat(a),name:n}:{}}var t=wa.getState(),n=function(){var e=Ga().playerState.STATES;switch(Ga().playerState.get().state){case e.playing:return"playing";case e.buffering:case e.stalled:return"buffering";case e.init:case e.waiting:case e.ready:default:return"stopped"}}(),r=e((0,we.z)(t)),a=r.languageCode,i=r.name,o=e((0,we.Km)(t)),c=o.languageCode,u=o.name,d=function(){var e=(0,we.C5)(t),n=e.width,r=e.height;if(n&&r)return"".concat(n,"x").concat(r)}(),l=ue.isVid()||ue.isOffairVid(),f=l?"recorded":"live",p=ue.isOffairVid()?ue.offairVid():ue.id(),m=Ws()("".concat(l?"recorded":"channel",".").concat(p)),g=(0,Nn.Z)(m,["rpin","rsid","appId","appVersion"]),E=g.rpin,v=g.rsid,y=g.appId,T=g.appVersion,h=(0,s.default)(t,"debug.frameRate");"N/A"===h&&(h=0);var b=(0,we.my)(t)||(0,we.XR)(t);return{playbackState:n,mediaType:f,mediaId:p,playbackMedia:(0,s.default)(t,"content.sourceMedia"),rpin:E,rsid:v,pageUrl:de.Z,appId:y,appVersion:T,userAgent:navigator.userAgent,buildNumber:fe.Z.BUILD_NUMBER,playbackVersion:"".concat(cn().version," (Atlas)"),cdnProviderName:(0,we.aW)(t),cdnServerHost:(0,we.ic)(t),authToken:b,resolution:d,framerate:h,bitrate:(0,s.default)(t,"qos.stats.bitrate",0),audioLanguageCode:c,audioName:u,closedCaptionLanguageCode:a,closedCaptionName:i,speed:(0,we.r6)(t),position:1e3*(0,we.Xn)(t),flotConnectionTime:Zv(t),firstStreamModuleTime:Kv(t),firstFrameTime:Wv(t)}},reportStats:function(e){var t=e.start,n=e.roundTripTime,r=e.httpStatus,a=void 0===r?200:r;if(!sy){var i=200===a?"success":"error";Ce.send({message:"Clock synchronisation finished",data:{category:"Debug",item:"Clock synchronisation",action:i,http_status:a,start_loading:Math.round(t),time_spent:Math.round(n)}}),sy=!0}}}),Ga().watcher.init(Ga().playerState.get(),Ga().sender.get())}function ly(){Ga().watcher.destroy(),Ga().sender.destroy(),Ga().playerState.destroy()}function fy(){var e=(0,c.w)("viewer/htmlplayback");e.debug("environment variables: ",o(),!0),e.debug("playback type selected",{playerVersion:fe.Z.BUILD_NUMBER,playbackType:"atlas",playbackVersion:cn().version},!0);var t,n,r,a,i,u,d={featured:!1},l=null,f=!1,p=!1,m=!1;function g(e){wa.getState().playback.playing===e&&f||(f=!0,wa.dispatch((0,Xa.OH)(e)),Ea.send("playing",e))}function E(){wa.dispatch(Vu({type:"unsupported"}))}function v(e){e.error===cn().errors.UNSUPPORTED&&E()}function y(){var e=wa.getState().content.trimInfo;e&&!p&&(ry.setHighlight(e),p=!0);var t=ue.getTrimmedDurationInMillisec()/1e3;wa.dispatch((0,Oa.uM)(t)),ry.setDuration(),m=!0,ry.showPlayScreen(),es.canStartAutoplay()?Ie.get("autoplay")&&(ry.hidePlayScreen(),M()):wa.subscribe("privacy.ibmCookie",k),ry.setContentAvailable(!0);var n=Ga().playerState.get();n&&(n.setProps({contentAvailable:!0}),wa.getState().playback.playing&&n.setProps({playing:!0}))}function _(){wa.dispatch((0,pd._r)([])),wa.dispatch((0,Xa.kY)([]))}function D(){Ie.get("disableEosSeek")||(ry.setSeek(0),wa.dispatch((0,Xa.eE)(0)))}function P(){ld()&&g(!1),-1!==n.indexOf("recorded")?ue.isOffairVid()?fd()?(_d(),ue.setHighlight([0,1]),p=!1,I(b,A.NEXT_OFFAIR_VIDEO)):ld()&&(e.debug("All offair videos played"),D(),F()):o().ios?(D(),F()):Zs.playPostroll():-1!==n.indexOf("channel")&&e.info("previous content has just finished and the current is live (channel)")}function R(){var e=km.getAverageBandwidth(2),t=km.getSelectedStreamVerison(),n=t&&t.video,i={category:"Loading",item:"buffering",action:"started",segment_size:e?Math.round(e.size):-1,net_speed:e?Math.round(e.speed):-1,current_kbps:(0,s.default)(n,"bitrate",void 0),current_height:(0,s.default)(n,"height",void 0)};Ce.send({message:"Buffering started",data:i}),a=(new Date).getTime(),clearTimeout(r),r=setTimeout((function(){return ry.setLoading(!0)}),3e3)}function N(){var e=km.getAverageBandwidth(2),t=km.getSelectedStreamVerison(),n=t&&t.video;if(a){var o={category:"Loading",item:"buffering",action:"completed",time_spent:(new Date).getTime()-a,segment_size:e?Math.round(e.size):-1,net_speed:e?Math.round(e.speed):-1,current_kbps:(0,s.default)(n,"bitrate",void 0),current_height:(0,s.default)(n,"height",void 0)};Ce.send({message:"Buffering completed",data:o}),a=null}if(!i){i=!0;var c=ue.getStreamType()||"unknown";Ce.send({message:"Playback started",data:{category:"Playback",item:"playback",action:"started",stream_type:c}});var u=wa.getState().playback,d=u.selectedClosedCaption,l=u.closedCaptionSelection;if(d>-1&&"manual"!==l){var f=(0,s.default)(wa.getState(),"playback.closedCaptionTracks",[]).find((function(e){return e.id===d}));if(f){var p=f.country,m=void 0===p?"00":p,g=f.language,E=f.isGenerated;Ce.send({message:"Playback started with CC",data:{category:"Playback",item:"CC",action:"displayed",cc_type:"broadcaster"===l?"from_broadcaster":"from_viewer",language:"".concat(g,"-").concat(m),generated:E}})}}}clearTimeout(r),ry.setLoading(!1)}function U(t){if(e.debug("onAdEvent",t),t.type===Qa.types.POSTROLL_FINISHED)return D(),g(!1),ry.setAdvertVisibility(!1),void F();void 0===t.contentPlaying||o().ios||(t.contentPlaying?M():F()),void 0!==t.controls&&ry.setUiVisibility(t.controls),t.type===Qa.types.VIDEO_STARTED&&ry.setAdvertVisibility(!0),t.type===Qa.types.VIDEO_FINISHED&&ry.setAdvertVisibility(!1),t.type===Qa.types.PREROLL_DONE&&(e.debug("onPreRollDone"),Nd())}function M(){e.debug("onPlaycall",{prerollDone:Zs.isPrerollDone()}),m&&(wa.getState().playback.playing||(g(!0),I(h,A.PLAY)))}function F(){e.debug("onPause",{prerollDone:Zs.isPrerollDone()}),g(!1),I(h,A.PAUSE)}function j(){var e=(0,we.hz)(wa.getState()),t=e.width,n=e.height;Zs.resize(t,n)}function k(){ry.hidePlayScreen(),M(),es.stopCheck()}function G(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"other";Ce.send({message:"Troubleshoot playback issue sent",data:{category:"Troubleshoot Playback Issue",item:"troubleshoot playback issue",action:"send",issue_type:t||"other",assisted_reporting_shown:e}})}function B(){var e=Ga().sender.get();if(e&&e.firstStartEvent){var t=wa.getState(),n=(0,s.default)(t,"playback.closedCaptionTracks",[]),r=(0,s.default)(t,"playback.audioTracks",[]);(n.length>0||r.length>0)&&e.send(Ga().sender.EVENTS.heartbeat)}}function H(){if(t){dy(),uy(),function(){n=ue.getMid();var e=Ws()(n);e&&e.destroy()}(),yf.init(n),Za(n),am();try{_v(n)}catch(t){e.error("Unexpected side effect has been occured while creating ums. Message: ".concat(t.message))}Ea.send("content",[ue.app(),ue.id()])}}wa.dispatch((u=performance.now(),{type:kr,payload:u})),window.addEventListener("unload",(function(){Ce.send({message:"Player closed",data:{category:"Playback",item:"playback",action:"player closed"}})})),L(h,A.LOAD,(function(t){var r=t[0],a=[];a=t[2]&&"boolean"!=typeof t[2]?[t[1],t[2]]:[t[1]];var o=ue.getMid(),s="".concat(r,".").concat(a.join("."));if(o!==s){var c,u;e.debug("Load media: ".concat(t[0],".").concat(t[1]),{type:r,contentParams:a}),ly(),ue.update(r,a),wa.dispatch((0,yr.VV)(1)),wa.dispatch(Qv()),wa.dispatch((0,Oa.gg)()),wa.dispatch((0,Oa.uM)()),wa.dispatch((0,Oa.iT)(ue.getMid())),wa.dispatch({type:dn,payload:undefined}),wa.dispatch(Ba({is360Video:void 0,fov:void 0})),wa.dispatch((0,Oa.Gz)()),wv=null,Uv=null,Mv=null,Fv=!1,Bv=[],null!==jv&&clearTimeout(jv),jv=null,kv=null,Gv=0,wa.dispatch((0,Dv.AB)()),wa.dispatch(Ha({remove:!0})),wa.dispatch(Va({remove:!0})),n!==ue.getMid()&&(wa.dispatch((0,Jv.FD)(void 0)),Av(!1),wa.dispatch((0,Jv.Q3)(!1)),Ov(),wa.dispatch((0,Xa.KS)([])),wa.dispatch({type:Wr}),_(),Ie.set("autoplay",!0),i=!1,f=!1,c=n,u=Ws()(c),e.debug("dispose",{mid:c}),l=null,p=!1,I(b,A.LIVE,!1),Ea.send("live",!1),ry.setContentAvailable(!1),Ka(c),dd(),u&&u.destroy(),yf.reset("Media change")),FE(),Zs.destroy(),_d();var d=ue.isVid()?Oa.w_.recorded:Oa.w_.live;wa.dispatch((0,Oa.y5)(d)),H()}else e.debug("Load cancelled",{currentMid:o,loadedMid:s})})),wa.subscribe("ums.password",H),wa.subscribe("ums.hash",H),wa.subscribe("ums.lock.type",(function(e){e&&(iy.ob(),ly())})),wa.subscribe("playback.isBufferEmpty",(function(e){var t=Ga().playerState.get();t&&t.setProps({waiting:e})})),wa.subscribe("playback.selectedAudio",B),wa.subscribe("playback.selectedClosedCaption",B),wa.subscribe("videoTag",(function(e){cy(),e&&(cy=(0,ja.Z)(e,(function(e){wa.dispatch((0,Dv.qo)(e))})),e.addEventListener("enterpictureinpicture",(function(){(0,Kd.T)({fromMode:"hidden",toMode:"showing"},e)})),e.addEventListener("leavepictureinpicture",(function(){(0,Kd.T)({fromMode:"showing",toMode:"hidden"},e)})))})),ry=new jE.Z({reduxStore:Ca,wrappedStore:wa,exposedVars:C.Z,domainMapping:V.Z,playbackVersion:"".concat(cn().version," (Atlas)"),getByContent:Ie.getByContent,getUrl:function(){return ue.getUrl.apply(ue,arguments)},getId:ue.id,getApp:ue.app,getCutStart:ue.getCutStart,isContentPlayable:ue.isContentPlayable,setHighlight:ue.setHighlight,isHLS:ue.isHLS,isVid:ue.isVid,isCid:ue.isCid,isLive:ue.live,isOffairImg:ue.isOffairImg,getAbsoluteSeekPositionInMs:ue.getAbsoluteSeekPositionInMs,getRelativeSeekPositionInMs:ue.getRelativeSeekPositionInMs,getTrimmedDurationInMillisec:ue.getTrimmedDurationInMillisec,saveHashToLocalStorage:jt.saveHashToLocalStorage,getHashFromLocalStorage:jt.getHashFromLocalStorage,isPollAnswered:qv.Z.isAnswered,searchCaptions:ay.searchCaptions,getPlayerState:function(){var e=Ga().playerState.get();if(e)return e.state},getInitialConfig:function(e){return Ie.get(e)}}),function(e){T=e}(ry),ry.addEventListener(w.Z.REPORT.centralLog,(function(e){var t=e.detail,n=t.message,r=t.data;Ce.send({message:n,data:r})})),ry.addEventListener(w.Z.COMMAND.theaterMode,(function(e){var t=e.detail.enabled;Ea.send("theaterMode",t)})),ry.addEventListener(w.Z.COMMAND.poll,(function(e){var t=e.detail;Ea.send("poll",t)})),ry.addEventListener(w.Z.COMMAND.qualityChange,(function(e){var t=e.detail.qualityId;I(h,A.QUALITY_CHANGE,t)})),ry.addEventListener(w.Z.COMMAND.sendLog,(function(t){var n=t.detail,r=n.reason,a=n.logSendingFromAssistedReporting;e.info("Report playback issue",{reason:r}),ry.setLogSendingStarted(),(0,Ja.Z)({onProgress:ry.setLogSendingProgress}).then((function(e){var t;ry.setLogSendingCompleted(e),G(a,r);var n=function(){var e=r.match(/(other): (.*)/);if(!e)return{type:r,text:""};var t,n,a=(n=3,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){s=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(s)throw a}}return i}}(t,n)||function(e,t){if(e){if("string"==typeof e)return oy(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?oy(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());return{type:a[1],text:a[2]}}(),i=n.type,o=n.text;null===(t=Ga().sender.get())||void 0===t||t.send(Ga().sender.EVENTS.error,{errorType:i,errorText:o,logId:e})})).catch((function(t){e.error(t.message),ry.setLogSendingCompleted()}))})),ry.addEventListener(w.Z.LOG.fatal,(function(t){var n=t.detail,r=n.line,a=n.data,i=n.keep;e.fatal(r,a,i)})),ry.addEventListener(w.Z.LOG.error,(function(t){var n=t.detail,r=n.line,a=n.data,i=n.keep;e.error(r,a,i)})),ry.addEventListener(w.Z.LOG.warn,(function(t){var n=t.detail,r=n.line,a=n.data,i=n.keep;e.warn(r,a,i)})),ry.addEventListener(w.Z.LOG.info,(function(t){var n=t.detail,r=n.line,a=n.data,i=n.keep;e.info(r,a,i)})),ry.addEventListener(w.Z.LOG.debug,(function(t){var n=t.detail,r=n.line,a=n.data,i=n.keep;e.debug(r,a,i)})),window.sendPlayerLog=function(){ry.setLogSendingStarted(),(0,Ja.Z)({onProgress:ry.setLogSendingProgress}).then((function(e){ry.setLogSendingCompleted(e),G(),console.log("Log sending complete. Issue ID: ".concat(e))})).catch((function(t){e.error(t.message),console.error(t),ry.setLogSendingCompleted()}))},Ie.get("findText")&&(wa.dispatch((0,Jv.FD)(decodeURIComponent(Ie.get("findText")))),wa.dispatch((0,Jv.Q3)(!0))),Ce.isLoggingEnabled()?av():iv(),Ld(),function(){t=!0,es.startCheck(),wa.dispatch((0,Oa.iT)(ue.getMid()));var r=ue.isVid()?Oa.w_.recorded:Oa.w_.live;wa.dispatch((0,Oa.y5)(r)),fn.Z.init("atlas"),Bu(),ME(Ie.get("initialQuality"),Ie.get("forcedQuality")),Jp(),ud(),L(b,A.LIVE,(function(e){if(e!==l){Ce.send({message:"Live status changed",data:{category:"Playback",item:"live status",action:"changed",status:e?"live":"off air"}});var t="boolean"==typeof l;t&&(Ov(),_()),t&&e&&(dy(),uy(),Ga().playerState.get().setProps({contentAvailable:!0}),wa.getState().playback.playing&&Ga().playerState.get().setProps({playing:!0})),e||(iy.ob(),ly())}if(Ea.send("live",e),Ie.set("isLive",e),l=e,Zs.isStarted()&&Zs.destroy(),l){n=ue.getMid();var r=Ws()(n);wa.dispatch((0,wd.hD)({umsInfo:r.internals})),wa.dispatch((0,Oa.y5)(Oa.w_.live))}wa.dispatch((0,Oa.Gz)(l)),Dd()})),L(b,A.CREATE_SLIDESHOW,(function(e){ry.startSlideShow(e),Zs.isStarted()&&Zs.destroy(),Ce.send({message:"Offair content displayed",data:{category:"Playback",item:"off air content",action:"displayed",offair_content_type:"image"}}),wa.dispatch((0,Oa.y5)(Oa.w_.offairSlide))})),L(b,A.ATLAS_THROTTLE,(function(e){ry.setThrottle(e)})),L(b,A.DESTROY_SLIDESHOW,(function(){ry.stopSlideShow()})),L(b,A.CREATE_OFFAIR_VIDEO,(function(t){n="recorded.".concat(t),setTimeout((function(){ue.setDurationInMillisec(0),wa.dispatch((0,Oa.uM)()),am(),Za(n),_(),Pd(!1),Rd(!1),dy(),uy();try{var r=Ws()(n);Ea.send("content",["recorded",t]),wa.dispatch((0,wd.hD)({umsInfo:r.internals})),Ce.send({message:"Offair content displayed",data:{category:"Playback",item:"off air content",action:"displayed",offair_content_type:"video"}}),wa.dispatch((0,Oa.y5)(Oa.w_.offairVideo))}catch(t){e.error("Unexpected side effect has been occured while creating ums. Message ".concat(t.message))}}),100)})),L(b,A.DESTROY_OFFAIR_VIDEO,(function(e){var t=Ws()("recorded.".concat(e));null==t||t.destroy()})),L(b,A.ATLAS_STORED_UPDATE,(function(e){wa.dispatch((0,Xa.x4)(e))})),L(b,A.ATLAS_BUFFERED_UPDATE,(function(e){wa.dispatch((0,Xa.x4)(e))})),L(b,A.ATLAS_PROGRESS,(function(e){var t=e.position,n=e.sourceMedia;ry.setAtlasProgress(t),Sv(t/1e3),wa.dispatch(function(e,t){return{type:Yt.setPosition,payload:{position:e,sourceMedia:t}}}(t,n));var r=Ga().playerState.get();r&&r.setProps({currentTime:t/1e3})})),L(S,A.THUMBNAIL_UPDATE,(function(e){Ea.send("thumbnail",e)})),L(S,A.BROADCASTER_UPDATE,(function(e){e.featured&&(d.featured=!0)})),L(S,A.META_UPDATE,(function(e){e.title&&(wa.dispatch(Qv(e.title)),Ea.send("title"),d.title=e.title),d.homepage=!1,d.autoplay=Ie.get("autoplay"),d.mobile=Wa,d.categories=e.category,d.userName=e.userName,d.contentLength=e.videoLength||555555;var t=(0,we.hz)(wa.getState()),n=t.width,r=t.height;Zs.initialize({countryCode:e.countryCode,adIntegration:e.adIntegration,width:n,height:r}),Zs.update(d),Ea.send("meta",e),Pd()})),L(S,A.SHARE_UPDATE,(function(e){Ea.send("share",e)})),L(b,"loading",(function(e){ry.setLoading(e)})),L(b,A.DURATION,(function(){var e=ue.getDurationInMillisec()/1e3;wa.dispatch((0,Oa.gg)(e)),ry.setDuration(),Ea.send("duration",e)})),L(b,A.PLAYING,(function(e){g(e),I(O,A.PLAYING,{mid:n,playing:e});var t=Ga().playerState.get();t&&(t.setProps({playing:e}),e&&wa.getState().playback.isBufferEmpty&&t.setProps({waiting:!0}))})),L(b,A.PROGRESS,(function(e){var t=function(e){if(ue.isHLS())return e;var t=ue.getCutStart();return(e-t)/(ue.getCutEnd()-t)}(e);ry.setProgress(t),wa.dispatch((0,Xa.eE)(t))})),L(b,A.RECORDED_READY,(function(){Dd()})),L(b,Qa.AD_EVENT,U),L(O,A.REPORT_BUFFER_EMPTY,R),L(O,A.REPORT_BUFFER_FULL,N),L(b,A.VIDEO_FINISHED,P),L(b,A.ATLAS_DOWNLOAD_ERROR,Wc.onProviderFailure),L(b,A.CONTENT_AVAILABLE,y),L(S,A.LIVE_CTA_UPDATE,(function(e){Ea.send("liveCtaUpdate",e)})),L(S,A.CAPTION_UPDATE,(function(e){Lv(e)})),L(S,A.SLIDES_UPDATE,(function(e){bv(e)})),L(b,A.UNSUPPORTED,E),L(b,A.ATLAS_ERROR,v),ry.addEventListener(w.Z.COMMAND.play,M),ry.addEventListener(w.Z.COMMAND.pause,F),ry.addEventListener(w.Z.COMMAND.seek,(function(e){var t=e.detail;!function(e,t){var r=wa.getState().playback.progress,a=wa.getState().content.trimmedDuration;I(O,A.SEEK,{mid:n,send:{from:r,to:e/a,duration:a}}),I(h,A.SEEK,{position:e,initiator:t})}(t.position,t.initiator)})),ry.addEventListener(w.Z.COMMAND.videoFinished,P),ry.addEventListener(w.Z.COMMAND.playScreenClicked,M),ry.addEventListener(w.Z.COMMAND.setCaptionPosition,(function(e){var t=e.detail.captionPosition;I(h,A.SET_CAPTION_POSITION,t)})),ry.addEventListener(w.Z.COMMAND.sendPollAnswer,(function(e){var t=e.detail,n=ue.getMid();Ws()(n).send("api/poll/vote",[t]),qv.Z.setPollAnswered(t.pollInstanceId)})),wa.subscribe("player.playerSize",j),mi(),null===jv&&(kv=Date.now(),jv=setTimeout((function(){wa.dispatch((0,Dv.pq)({inited:!1}))}),5e3)),L(b,A.DEBUG_FLOT_LOG,Vv),L(O,A.REPORT_BANDWIDTH,Hv),L(b,A.ATLAS_ERROR,xv),L(b,A.ATLAS_LOG,Yv),Ie.get("externalvtt")&&Ed(),H(),ry.setUiVisibility(!0),ry.setReady(!0),wa.dispatch((0,Xa.Uc)(!0)),Ea.send("ready",!0),Ce.send({message:"Initial loading completed",data:{category:"Loading",item:"initial loading",action:"completed"}}),Ie.get("autoplay")&&!i&&Ce.send({message:"Playback requested",data:{category:"Playback",item:"playback",action:"requested - autoplay"}}),Ie.get("volume")<100&&setTimeout((function(){return wa.dispatch((0,yr.jA)(Ie.get("volume")))}),0),(0,$v.a)()&&wa.dispatch((0,yr.c0)(yr.GT.oldBrowser))}()}function py(){Fa.cleanup(),Fa.setInitStart(),fy()}Ga().logger.onLog((function(e){var t=e.type,n=e.module,r=e.message,a=e.data;c.Z.log({level:t,source:n,line:r,data:a})}))},42610:function(e,t,n){"use strict";t.Z=function(e){return(0,a.default)(e,i.TYPES.OBJECT)};var r,a=(r=n(26680))&&r.__esModule?r:{default:r},i=n(58763)},81635:function(e){self,e.exports=function(){"use strict";var e={d:function(t,n){for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r:function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{default:function(){return hi}});var n="Atlas",r={POSITION:"".concat(n,".position"),FINISHED:"".concat(n,".finished"),BUFFER_EMPTY:"".concat(n,".bufferEmpty"),BUFFER_FULL:"".concat(n,".bufferFull"),METADATA:"".concat(n,".metadata"),BANDWIDTH:"".concat(n,".bandwidth"),STORED:"".concat(n,".stored"),BUFFERED:"".concat(n,".buffered"),SEEK_STARTED:"".concat(n,".seekStarted"),SEEK_COMPLETED:"".concat(n,".seekCompleted"),QUALITY_CHANGE_STARTED:"".concat(n,".qualityChangeStarted"),QUALITY_CHANGE_COMPLETED:"".concat(n,".qualityChangeCompleted"),QUALITY_CHANGE_CANCELLED:"".concat(n,".qualityChangeCancelled"),LANGUAGE_CHANGE_STARTED:"".concat(n,".languageChangeStarted"),LANGUAGE_CHANGE_COMPLETED:"".concat(n,".languageChangeCompleted"),LANGUAGE_CHANGE_CANCELLED:"".concat(n,".languageChangeCancelled"),ERROR:"".concat(n,".error"),LOG:"".concat(n,".log"),THROTTLE:"".concat(n,".throttle"),AUDIO_TRACKS:"".concat(n,".audioTracks"),TEXT_TRACKS:"".concat(n,".textTracks"),TEXT_TRACK_CUE_CHANGE:"".concat(n,".textTrackCueChange"),X08_DETECTED:"".concat(n,".x08Detected"),WEBKIT_SUPPORTS_FULLSCREEN:"".concat(n,".webkitSupportsFullscreen"),WEBKIT_ENTER_FULLSCREEN:"".concat(n,".webkitEnterFullscreen"),WEBKIT_END_FULLSCREEN:"".concat(n,".webkitEndFullscreen"),GAP_RECOVERING:"".concat(n,".gapRecovering"),ATLAS_SEEKABLE:"".concat(n,".atlasSeekable"),ATLAS_FULLY_INITIALIZED:"".concat(n,".atlasFullyInitialized")},a={UNSUPPORTED:"unsupported",INVALID_OPTIONS:"invalidOptions",SEGMENT_NOT_FOUND:"segmentNotFound",SEGMENT_LOAD_FAILED:"segmentLoadFailed",VIDEO_PLAYER:"videoPlayer",UNRECOVERED_STALLED:"unrecoveredStalled",CAN_NOT_CREATE_URL:"canNotCreateUrl",NEW_REPRESENTATION:"newRepresentation",PLAY_ERROR:"playError"},i={FLV_MOVIE:"flv",FLV_SEGMENTED:"flv/segmented",MP4_MOVIE:"mp4",MP4_SEGMENTED:"mp4/segmented",HLS:"hls",VTT:"text/vtt"},o=function(){var e={};function t(t,n,r){r=Number.isNaN(+r)?0:Math.max(-2,Math.min(2,+r)),e||(e={}),e[t]||(e[t]=[]);for(var a=e[t],i=0;a[i]&&a[i].priority>r;)i+=1;a.splice(i,0,{callback:n,priority:r})}function n(t,n){if(e&&e[t]){for(var r=0;r<e[t].length;r+=1)e[t][r].callback===n&&e[t].splice(r--,1);e[t].length||delete e[t]}}function r(t){return e&&Object.hasOwnProperty.call(e,t)?e[t].length:0}function a(t,n){for(var r=0;e&&e[t]&&r<e[t].length;r+=1)if(e[t][r].callback===n)return!0;return!1}return{addListener:t,removeListener:n,hasListener:function(t){return e&&Object.hasOwnProperty.call(e,t)&&!!e[t].length},listenerCount:r,allListenerCount:function(){return e?Object.getOwnPropertyNames(e).map(r).reduce((function(e,t){return e+t}),0):0},on:t,off:n,dispatch:function(t,n){if(e&&e[t]){var r,i=[];for(r=0;r<e[t].length;r+=1)i.push(e[t][r].callback);for(r=0;r<i.length;r+=1)a(t,i[r])&&i[r](n)}},cleanup:function(){e=null},MINIMUM_PRIORITY:-2,MAXIMUM_PRIORITY:2}},s={FATAL:100,ERROR:200,WARN:300,INFO:400,DEBUG:500},c=o(),u={LOG:"log"};function d(e,t,n,r){var a=new Date;if(c.hasListener(u.LOG)){var i={timestamp:a,source:e,line:t,data:n,level:r};c.dispatch(u.LOG,i)}}var l={create:function(e){return{debug:function(t,n){d(e,t,n,s.DEBUG)},info:function(t,n){d(e,t,n,s.INFO)},warn:function(t,n){d(e,t,n,s.WARN)},error:function(t,n){d(e,t,n,s.ERROR)},fatal:function(t,n){d(e,t,n,s.FATAL)}}},log:d,getStack:function(){return(new Error).stack.split("\n").slice(2).map((function(e){return e.substr(7)}))},events:u,levels:s,addListener:function(e,t){c.addListener(e,t)},removeListener:function(e,t){c.removeListener(e,t)},cleanup:function(){c.cleanup()}},f="Controller",p={BASE:f,FINISHED:"".concat(f,".finished"),STREAM_URL:"".concat(f,".streamURL"),ADD_BUFFER:"".concat(f,".addBuffer"),REMOVE_BUFFER:"".concat(f,".removeBuffer"),REQUEST_SEGMENT:"".concat(f,".requestSegment"),LOAD_MOVIE_META:"".concat(f,".loadMovieMeta"),LOAD_SEGMENT:"".concat(f,".loadSegment"),ABORT_DOWNLOAD:"".concat(f,".abortDownload"),CONTENT_MOVED:"".concat(f,".contentMoved"),BROADCASTER_TIME_UPDATE:"".concat(f,".broadcasterTimeUpdate"),REQUEST_KEYFRAME_POSITION:"".concat(f,".requestKeyFramePosition"),CANCEL_KEYFRAME_REQUEST:"".concat(f,".cancelKeyFrameRequest"),SWITCH_STREAM:"".concat(f,".switchStream"),CANCEL_STREAM_SWITCH:"".concat(f,".cancelStreamSwitch"),MISSING_RAP_AT_RANGE:"".concat(f,".missingRapAtPoint"),CAN_NOT_CREATE_URL:"".concat(f,".canNotCreateUrl"),NEW_REPRESENTATION:"".concat(f,".newRepresentation"),QUALITY_CHANGE_STARTED:"".concat(f,".qualityChangeStarted"),QUALITY_CHANGE_COMPLETED:"".concat(f,".qualityChangeCompleted"),QUALITY_CHANGE_CANCELLED:"".concat(f,".qualityChangeCancelled"),LANGUAGE_CHANGE_STARTED:"".concat(f,".languageChangeStarted"),LANGUAGE_CHANGE_COMPLETED:"".concat(f,".languageChangeCompleted"),LANGUAGE_CHANGE_CANCELLED:"".concat(f,".languageChangeCancelled"),ATLAS_FULLY_INITIALIZED:"".concat(f,".atlasFullyInitialized")},m="Debug",g={BASE:m,LOG:"".concat(m,".log")},E="SegmentDownloader",v={BASE:E,LOAD_INIT:"".concat(E,".loadInit"),LOAD_START:"".concat(E,".loadStart"),LOAD_COMPLETE:"".concat(E,".loadComplete"),RAW:"".concat(E,".raw"),SEGMENT:"".concat(E,".segment"),EMPTY_SEGMENT:"".concat(E,".emptySegment"),CONFIG:"".concat(E,".config"),FAILED:"".concat(E,".failed"),ABORTED:"".concat(E,".aborted"),DESTROY:"".concat(E,".destroy")},y="StorageManager",T={BASE:y,EOS_POSITION_DETECTED:"".concat(y,".eosPositionDetected"),SEGMENT_STORAGE_CREATED:"".concat(y,".segmentStorageCreated"),SEGMENT_STORAGE_REMOVED:"".concat(y,".segmentStorageRemoved"),SEGMENT_STORAGE_UPDATED:"".concat(y,".segmentStorageUpdated")},h="SegmentStorage",b={BASE:h,SEGMENT_MISSING:"".concat(h,".segmentMissing"),SEGMENT_MISSING_BY_ID:"".concat(h,".segmentMissingById"),KEYFRAME_POSITION:"".concat(h,".keyFramePosition"),SEGMENTS_REMOVED:"".concat(h,".segmentsRemoved"),SEGMENT_CHANGE:"".concat(h,".segmentChange")},S="VideoPlayer",O={BASE:S,ERROR:"".concat(S,".error"),POSITION:"".concat(S,".position"),BUFFERED:"".concat(S,".buffered"),BUFFER_EMPTY:"".concat(S,".bufferEmpty"),BUFFER_FULL:"".concat(S,".bufferFull"),SEEK_COMPLETED:"".concat(S,".seekCompleted"),STREAM_INFO:"".concat(S,".streamInfo"),THROTTLE:"".concat(S,".throttle"),RENDERER_CHANGE:"".concat(S,".rendererChange"),CC_DETECTED:"".concat(S,".ccDetected"),AUDIO_TRACKS:"".concat(S,".audioTracks"),TEXT_TRACKS:"".concat(S,".textTracks"),RESIZE:"".concat(S,".resize"),UNRECOVERED_STALLED:"".concat(S,".unrecoveredStalled"),PLAY_ERROR:"".concat(S,".playError"),WEBKIT_SUPPORTS_FULLSCREEN:"".concat(S,".webkitSupportsFullscreen")},A={ABORT:"abort",CAN_PLAY:"canplay",CAN_PLAY_THROUGH:"canplaythrough",DURATION_CHANGE:"durationchange",EMPTIED:"emptied",ENCRYPTED:"encrypted",ENDED:"ended",ERROR:"error",INTERRUPT_BEGIN:"interruptbegin",INTERRUPT_END:"interruptend",LOADED_DATA:"loadeddata",LOADED_METADATA:"loadedmetadata",LOAD_START:"loadstart",PAUSE:"pause",PLAY:"play",PLAYING:"playing",PROGRESS:"progress",RATE_CHANGE:"ratechange",SEEKED:"seeked",SEEKING:"seeking",STALLED:"stalled",SUSPEND:"suspend",TIME_UPDATE:"timeupdate",VOLUME_CHANGE:"volumechange",WAITING:"waiting",WEBKIT_ENTER_FULLSCREEN:"webkitenterfullscreen",WEBKIT_END_FULLSCREEN:"webkitendfullscreen"};function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var L="videoTagProxyEvents",_={BASE:L};Object.entries(A).forEach((function(e){var t,n=(2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),2!==i.length);o=!0);}catch(e){s=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(s)throw a}}return i}}(t)||function(e,t){if(e){if("string"==typeof e)return I(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?I(e,2):void 0}}(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),r=n[0],a=n[1];_[r]="".concat(L,".").concat(a)}));var D=_,P="Buffer",R={BASE:P,STREAM_SWITCH:"".concat(P,".streamSwitch"),BUFFER_CLEAR:"".concat(P,".bufferClear"),BUFFER_UPDATING:"".concat(P,".bufferUpdating"),BUFFER_UPDATED:"".concat(P,".bufferUpdated"),APPEND:"".concat(P,".append"),REMOVE:"".concat(P,".remove"),PURGE:"".concat(P,".purge")},N="BufferManager",C={BASE:N,BUFFER_ADDED:"".concat(N,".bufferAdded"),BUFFER_REMOVED:"".concat(N,".bufferRemoved"),APPEND_TO_BUFFER:"".concat(N,".appendToBuffer")},w=l.create("Facade"),U=o(),M=[p.CONTENT_MOVED,p.BROADCASTER_TIME_UPDATE,g.LOG,v.LOAD_INIT,v.LOAD_START,v.DESTROY,v.SEGMENT,v.EMPTY_SEGMENT,v.RAW,v.CONFIG,T.SEGMENT_STORAGE_CREATED,b.SEGMENT_CHANGE,O.POSITION,O.BUFFERED,O.STREAM_INFO,R.BUFFER_UPDATING,R.BUFFER_UPDATED,R.APPEND,C.APPEND_TO_BUFFER,D.PROGRESS,D.TIME_UPDATE],F={dispatch:function(e,t,n){0!==t.indexOf("Flash:")&&(t="Js:".concat(t)),-1===M.indexOf(e)&&w.debug("dispatch : ".concat(e," from ").concat(t," to ").concat(U.listenerCount(e)," listener(s)"),n);var r={type:e,originId:t,data:n};U.dispatch(r.type,r);var a=r.type.split(".");for(a.push("*");a.length>1;)a.splice(a.length-2,1),U.dispatch(a.join("."),r)},addListener:function(e,t,n){void 0!==e?U.addListener(e,t,n):w.warn("undefined event type listener adding is prohibited")},removeListener:function(e,t){U.removeListener(e,t)},validateNotificationData:function(e,t){for(var n=[],r=0;t&&r<t.length;r+=1)void 0===e.data[t[r]]&&n.push(t[r]);if(n.length)throw w.error("missing data from notification (".concat(n.join(", "),")"),e),new Error("Missing data from notification (".concat(n.join(", "),")"))},allListenerCount:function(){return U.allListenerCount()},cleanup:function(){U.cleanup()},MINIMUM_PRIORITY:U.MINIMUM_PRIORITY,MAXIMUM_PRIORITY:U.MAXIMUM_PRIORITY},j={MINIMUM_REMAINING_THRESHOLD:"minimumRemainingThreshold",MOVING_WINDOW_INTERVAL_DELAY:"movingWindowIntervalDelay",CONCURRENT_DOWNLOAD_COUNT:"concurrentDownloadCount",COLDSTART_THRESHOLD:"coldstartThreshold",BUFFER_COLLECT_DELAY_IN_MILLISEC:"bufferCollectTimeoutInMillisec",QUALITY_SWITCH_BUFFER_THRESHOLD:"qualitySwitchBufferThreshold",VIDEO_TAG_ATTRIBUTES:"videoTagAttributes",CHUNK_PRELOAD_COUNT:"chunkPreloadCount",MEMORY_LIMIT_IN_BYTES:"memoryLimitInBytes",FLASH_PROXY_URL_PLAIN:"flashProxyUrlPlain",FLASH_PROXY_URL_SECURE:"flashProxyUrlSecure",RENDER_TEXT_TRACKS_NATIVELY:"renderTextTracksNatively",HIDE_NATIVE_TRACKS:"hideNativeTracks"},k={};k[j.MINIMUM_REMAINING_THRESHOLD]=5e3,k[j.MOVING_WINDOW_INTERVAL_DELAY]=500,k[j.CONCURRENT_DOWNLOAD_COUNT]=2,k[j.COLDSTART_THRESHOLD]=1e3,k[j.BUFFER_COLLECT_DELAY_IN_MILLISEC]=1500,k[j.QUALITY_SWITCH_BUFFER_THRESHOLD]=2e3,k[j.VIDEO_TAG_ATTRIBUTES]=null,k[j.CHUNK_PRELOAD_COUNT]=5,k[j.MEMORY_LIMIT_IN_BYTES]=134217728,k[j.RENDER_TEXT_TRACKS_NATIVELY]=!0,k[j.HIDE_NATIVE_TRACKS]=!1;var G=k,B="AtlasAPI",V={BASE:B,PAUSE:"".concat(B,".pause"),RESUME:"".concat(B,".resume"),PLAYBACK_SPEED:"".concat(B,".playbackSpeed"),SEEK:"".concat(B,".seek"),SET_OPTION:"".concat(B,".setOption"),UPDATE_HASHES:"".concat(B,".updateHashes"),VOLUME:"".concat(B,".volume"),CAPTIONS:"".concat(B,".captions"),CAPTION_POSITION:"".concat(B,".captionPosition"),SELECT_AUDIO:"".concat(B,".selectAudio"),SUSPEND:"".concat(B,".suspend"),WAKE:"".concat(B,".wake"),CLEANUP:"".concat(B,".cleanup"),UPDATE_OPTIONS:"".concat(B,".updateOptions"),SET_MAX_MEMORY_USAGE:"".concat(B,".setMaxMemoryUsage")};function H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function x(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Y,Z="Options",K=l.create(Z);function W(e){return Y?Y[e]:void 0}function Q(e){return"number"==typeof e&&e>0&&e<1/0}var z={init:function(){Y||(Y=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?H(Object(n),!0).forEach((function(t){x(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},G))},get:W,set:function(e,t,n){if(Y[e]===t)return!1;var r,a,i=!0;switch(e){case j.MINIMUM_REMAINING_THRESHOLD:i=function(e){return!!Q(e)&&(Y[j.MINIMUM_REMAINING_THRESHOLD]=e,!0)}(t);break;case j.MOVING_WINDOW_INTERVAL_DELAY:i=function(e,t){return!(t||!Q(e)||(Y[j.MOVING_WINDOW_INTERVAL_DELAY]=e,0))}(t,n);break;case j.CONCURRENT_DOWNLOAD_COUNT:i=function(e){return!!Q(e)&&(Y[j.CONCURRENT_DOWNLOAD_COUNT]=e,!0)}(t);break;case j.QUALITY_SWITCH_BUFFER_THRESHOLD:i=function(e){return!(!Q(e)&&0!==e||(Y[j.QUALITY_SWITCH_BUFFER_THRESHOLD]=e,0))}(t);break;case j.VIDEO_TAG_ATTRIBUTES:i=function(e){return Y[j.VIDEO_TAG_ATTRIBUTES]=e,!0}(t);break;case j.CHUNK_PRELOAD_COUNT:i=function(e){return!!Q(e)&&(e>20&&K.warn('"'.concat(j.CHUNK_PRELOAD_COUNT,'" is too high, ')+"the recommended maximum is ".concat(20)),Y[j.CHUNK_PRELOAD_COUNT]=e,!0)}(t);break;case j.MEMORY_LIMIT_IN_BYTES:i=function(e){if(!Q(e))return!1;var t=5242880,n=1073741824;return e<t?K.warn('"'.concat(j.MEMORY_LIMIT_IN_BYTES,'" is too low, ')+"the recommended minimum is ".concat(t)):e>n&&K.warn('"'.concat(j.MEMORY_LIMIT_IN_BYTES,'" is too high, ')+"the recommended maximum is ".concat(n)),Y[j.MEMORY_LIMIT_IN_BYTES]=e,!0}(t);break;default:Y[e]=t}return i&&(r=V.SET_OPTION,a={name:e,value:W(e),externalCall:n},F.dispatch(r,Z,a)),i},cleanup:function(){Y=!1}},X={},q="MSEProxy",$={BASE:q,SOURCE_OBJECT_URL:"".concat(q,".sourceObjectURL"),SOURCE_OPEN:"".concat(q,".sourceOpen"),SOURCE_CLOSE:"".concat(q,".sourceClose"),SOURCE_BUFFER_ADDED:"".concat(q,".sourceBufferAdded"),SOURCE_BUFFER_REMOVED:"".concat(q,".sourceBufferRemoved")};function J(e,t){for(var n=0;t&&n<t.length;n+=1)if(t[n].start<=e&&t[n].end>=e)return t[n];return null}var ee={buffered:function(e){for(var t=[],n=0;n<e.length;n+=1)t.push({start:Math.floor(1e3*e.start(n)),end:Math.floor(1e3*e.end(n))});return t},current:J,next:function(e,t){for(var n=0;n<t.length&&!(t[n].start>e);)n+=1;return n<t.length?t[n]:null},remaining:function(e,t){var n=J(e,t);return n?n.end-e:0},remainingTotal:function(e,t){for(var n=0,r=0;r<t.length;r+=1)t[r].end>e&&(n+=t[r].end-Math.max(t[r].start,e));return n},intersect:function(e,t){if(!e&&!t)return[];if(e&&!t)return e;for(var n=0,r=0,a=[];n<e.length&&r<t.length;){var i=Math.max(e[n].start,t[r].start),o=Math.min(e[n].end,t[r].end);i<o&&a.push({start:i,end:o}),e[n].end<t[r].end?n+=1:(t[r].end<e[n].end||(n+=1),r+=1)}return a}},te=function(e){var t=[];function n(){for(;e&&t&&t.length;)e.removeEventListener(t[0].type,t[0].closure),t.shift()}return{addListener:function(n,r){t&&(t.push({type:n,closure:r}),e&&e.addEventListener(n,r))},removeListener:function(n,r){for(var a=0;t&&a<t.length;a+=1)t[a].type===n&&t[a].closure===r&&(t.splice(a--,1),e&&e.removeEventListener(n,r))},clearListeners:n,setTarget:function(n){!function(){for(var n=0;e&&t&&n<t.length;n+=1)e.removeEventListener(t[n].type,t[n].closure)}(),e=n,function(){for(var n=0;e&&t&&n<t.length;n+=1)e.addEventListener(t[n].type,t[n].closure)}()},destroy:function(){n(),t=null,e=null}}},ne="bytes",re="remove",ae="purge";function ie(e,t){F.dispatch(e,"ActionQueue",t)}var oe="Component",se={BASE:oe,CREATE:"".concat(oe,".create"),DESTROY:"".concat(oe,".destroy")};function ce(e){return(ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var ue="Shockwave Flash",de="application/x-shockwave-flash",le=navigator,fe=le.mimeTypes,pe=le.userAgent.toLowerCase(),me=le.platform.toLowerCase();function ge(){var e=/android/i.test(pe);return e&&(e=pe.match(/android (\d+)(?:\.(\d+))?(?:\.(\d+))?/i)).shift(),e}function Ee(){var e=/iphone|ipad|ipod/.test(pe);return e&&(e=pe.match(/os (\d*)?_?(\d*)?_?(\d*)/i)).shift(),e}function ve(){return/BB10(.*)Mobile/i.test(pe)}function ye(){return pe.indexOf("playstation")>-1}function Te(){var e=/chrome/i.test(pe);return e&&!he()&&(e=pe.match(/chrome\/(\d*)\.(\d*)?\.?(\d*)/i)).shift(),e}function he(){var e=!1;return void 0!==window.opera&&"[object Opera]"===window.opera.toString()?e=window.opera.version().split("."):navigator&&(e=pe.match(/opr\/(\d+)\.(\d+)\.(\d+)\.(\d+)/i)),e}function be(){var e,t;if(void 0===window.ActiveXObject)return!1;try{if(e=new window.ActiveXObject("ShockwaveFlash.ShockwaveFlash"))return!(t=e.GetVariable("$version"))||(t=t.split(" ")[1].split(","),[parseInt(t[0],10),parseInt(t[1],10),parseInt(t[2],10)])}catch(e){}return!1}var Se,Oe,Ae,Ie,Le={win:/win/.test(me||pe),mac:/mac/.test(me||pe),desktop:!(ge()||Ee()||ve()||ye()),ios:Ee(),android:ge(),blackberry:ve(),playstation:ye(),chrome:Te(),opera:he(),ff:/firefox/.test(pe),safari:/safari/.test(pe)&&!Te()&&!he(),ie:(Ie=document.getElementsByTagName("html")[0].className.indexOf("ie ")>-1,Ie||(Ie=pe.indexOf("trident")>-1),Ie),ssl:/https/.test(window.location.protocol),swf:(Ae=[0,0,0],void 0!==le.plugins&&"object"===ce(le.plugins[ue])?!(Oe=le.plugins[ue].description)||void 0!==fe&&fe[de]&&!fe[de].enabledPlugin||(Oe=Oe.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),Ae[0]=+Oe.replace(/^(.*)\..*$/,"$1"),Ae[1]=+Oe.replace(/^.*\.(.*)\s.*$/,"$1"),Ae[2]=/[a-zA-Z]/.test(Oe)?+Oe.replace(/^.*[a-zA-Z]+(.*)$/,"$1"):0):be()&&(Ae=be()),"000"===Ae.join("")&&(Ae=!1),Ae),flashPPAPI:(Se=fe&&fe[de]&&fe[de].enabledPlugin&&fe[de].enabledPlugin.filename||"","pepflashplayer.dll"===(Se=Se.toLowerCase())||"libpepflashplayer.so"===Se||"pepperflashplayer.plugin"===Se||"chrome.plugin"===Se.slice(-13)),flashActiveX:be(),nav:{appCodeName:le.appCodeName,appName:le.appName,appVersion:le.appVersion,cpuClass:le.cpuClass,platform:le.platform,product:le.product,userAgent:le.userAgent,vendor:le.vendor,vendorSub:le.vendorSub}},_e=4294967295,De="4.0.16",Pe=250;function Re(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ne="MSEProxy",Ce=l.create(Ne),we="sourceopen",Ue="sourceclose",Me=window.MediaSource||window.WebKitMediaSource;function Fe(e,t){F.dispatch(e,Ne,t)}function je(){return!!Me}Ce.info("".concat(Le.nav.appName," ").concat(Le.nav.appVersion));var ke=function(e){var t,n,r={};function a(){F.removeListener(V.SUSPEND,a),F.addListener(V.WAKE,i),u()}function i(){F.removeListener(V.WAKE,i),F.addListener(V.SUSPEND,a),c()}function o(e){F.validateNotificationData(e,["bufferId","contentType"]);var t=e.data.contentType.indexOf("vtt")>-1;r[e.data.bufferId]||t?t||Ce.warn("there is already a sourceBuffer for ".concat(e.data.bufferId)):(r[e.data.bufferId]=function(e,t){var n=l.create("ActionQueue.".concat(t)),r=te(e),a=[],i=!1;function o(){F.removeListener(O.ERROR,g),F.removeListener(R.APPEND,c),F.removeListener(R.REMOVE,u),F.removeListener(R.PURGE,d),F.removeListener($.SOURCE_CLOSE,o),F.removeListener(C.BUFFER_REMOVED,s),r.destroy(),a=null}function s(e){F.validateNotificationData(e,["bufferId"]),e.data.bufferId===t&&o()}function c(e){F.validateNotificationData(e,["streamId","bufferId","start","end","duration","bytes"]),e.data.bufferId===t&&f({streamId:e.data.streamId,type:ne,start:e.data.start,end:e.data.end,duration:e.data.duration,bytes:e.data.bytes})}function u(e){F.validateNotificationData(e,["streamId","bufferId","start","end"]),e.data.bufferId===t&&f({streamId:e.data.streamId,type:re,start:e.data.start,end:e.data.end})}function d(e){F.validateNotificationData(e,["streamId","bufferId"]),e.data.bufferId===t&&f({streamId:e.data.streamId,type:ae})}function f(e){i?(e.type===ae&&(a=[]),a.push(e)):p(e)}function p(r){var o="execute action";switch(r.type){case ne:n.debug(o,{streamId:r.streamId,type:r.type,start:r.start,end:r.end,duration:r.duration,length:r.bytes.length}),e.appendBuffer(r.bytes);break;case re:n.debug(o,{streamId:r.streamId,type:r.type,start:r.start,end:r.end}),e.remove(r.start/1e3,r.end/1e3);break;case ae:if(n.debug(o,{streamId:r.streamId,type:r.type,bufferedLength:e.buffered.length,actionsLength:a.length}),!e.buffered.length)return void m();e.remove(e.buffered.start(0),e.buffered.end(e.buffered.length-1))}i||(i=!0,ie(R.BUFFER_UPDATING,{bufferId:t}))}function m(){a.length?p(a.shift()):(i=!1,ie(R.BUFFER_UPDATED,{bufferId:t,ranges:ee.buffered(e.buffered)}))}function g(){a=[],i=!1,n.error("onVideoTagError")}return F.addListener(O.ERROR,g),F.addListener(R.APPEND,c),F.addListener(R.REMOVE,u),F.addListener(R.PURGE,d),F.addListener($.SOURCE_CLOSE,o),F.addListener(C.BUFFER_REMOVED,s),r.addListener("updateend",m),r.addListener("error",(function(){a=[],n.error("onError")})),r.addListener("abort",(function(){n.warn("abort")})),{bufferId:t,sourceBuffer:e}}(n.addSourceBuffer(e.data.contentType),e.data.bufferId),Ce.debug("created sourceBuffer for ".concat(e.data.bufferId)),Fe($.SOURCE_BUFFER_ADDED,{bufferId:e.data.bufferId}))}function s(e){if(F.validateNotificationData(e,["bufferId"]),r[e.data.bufferId]){try{n.removeSourceBuffer(r[e.data.bufferId].sourceBuffer)}catch(e){}delete r[e.data.bufferId],Fe($.SOURCE_BUFFER_REMOVED,{bufferId:e.data.bufferId})}else Ce.warn("there is no sourceBuffer for ".concat(e.data.bufferId))}function c(){n=new Me,t.setTarget(n),Fe($.SOURCE_OBJECT_URL,{source:URL.createObjectURL(n)})}function u(){n=null,r={},Fe($.SOURCE_CLOSE)}function d(t){switch(Ce.debug("onMediaSourceEvent",t),t.type){case we:n.duration=e&&e<1/0?e/1e3:_e,Fe($.SOURCE_OPEN);break;case Ue:Object.entries(r).forEach((function(e){var t,n=(2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),2!==i.length);o=!0);}catch(e){s=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(s)throw a}}return i}}(t)||function(e,t){if(e){if("string"==typeof e)return Re(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Re(e,2):void 0}}(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a=n[0],i=n[1].bufferId;Fe($.SOURCE_BUFFER_REMOVED,{bufferId:i}),delete r[a]})),Fe($.SOURCE_CLOSE)}}return Ce.debug("create"),(t=te()).addListener(we,d),t.addListener("sourceended",d),t.addListener(Ue,d),c(),F.addListener(C.BUFFER_ADDED,o),F.addListener(C.BUFFER_REMOVED,s),F.addListener(V.CLEANUP,(function e(){F.removeListener(C.BUFFER_ADDED,o),F.removeListener(C.BUFFER_REMOVED,s),F.removeListener(V.CLEANUP,e),F.removeListener(V.SUSPEND,a),F.removeListener(V.WAKE,i),u(),t.destroy(),t=null,Fe(se.DESTROY)})),F.addListener(V.SUSPEND,a),Fe(se.CREATE),{name:Ne}},Ge=je(),Be=function(e){return!!je()&&Me.isTypeSupported(e)},Ve=function(){var e,t,n,r,a,i,o="undefined",s="object",c="Shockwave Flash",u="application/x-shockwave-flash",d="SWFObjectExprInst",l="onreadystatechange",f=window,p=document,m=navigator,g=!1,E=[],v=[],y=[],T=[],h=!1,b=!1,S=!0,O=!1,A=function(){var e=typeof p.getElementById!==o&&typeof p.getElementsByTagName!==o&&typeof p.createElement!==o,t=m.userAgent.toLowerCase(),n=m.platform.toLowerCase(),r=/win/.test(n||t),a=/mac/.test(n||t),i=!!/webkit/.test(t)&&parseFloat(t.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")),d="Microsoft Internet Explorer"===m.appName,l=[0,0,0],E=null;if(typeof m.plugins!==o&&typeof m.plugins[c]===s)(E=m.plugins[c].description)&&typeof m.mimeTypes!==o&&m.mimeTypes[u]&&m.mimeTypes[u].enabledPlugin&&(g=!0,d=!1,E=E.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),l[0]=B(E.replace(/^(.*)\..*$/,"$1")),l[1]=B(E.replace(/^.*\.(.*)\s.*$/,"$1")),l[2]=/[a-zA-Z]/.test(E)?B(E.replace(/^.*[a-zA-Z]+(.*)$/,"$1")):0);else if(typeof f.ActiveXObject!==o)try{var v=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");v&&(E=v.GetVariable("$version"))&&(d=!0,l=[B((E=E.split(" ")[1].split(","))[0]),B(E[1]),B(E[2])])}catch(e){}return{w3:e,pv:l,wk:i,ie:d,win:r,mac:a}}();function I(){if(!h&&document.getElementsByTagName("body")[0]){try{var e,t=G("span");t.style.display="none",(e=p.getElementsByTagName("body")[0].appendChild(t)).parentNode.removeChild(e),e=null,t=null}catch(e){return}h=!0;for(var n=E.length,r=0;r<n;r++)E[r]()}}function L(e){h?e():E[E.length]=e}function _(){var e=v.length;if(e>0)for(var t=0;t<e;t++){var n=v[t].id,r=v[t].callbackFn,a={success:!1,id:n};if(A.pv[0]>0){var i=k(n);if(i)if(!V(v[t].swfVersion)||A.wk&&A.wk<312)if(v[t].expressInstall&&P()){var s={};s.data=v[t].expressInstall,s.width=i.getAttribute("width")||"0",s.height=i.getAttribute("height")||"0",i.getAttribute("class")&&(s.styleclass=i.getAttribute("class")),i.getAttribute("align")&&(s.align=i.getAttribute("align"));for(var c={},u=i.getElementsByTagName("param"),d=u.length,l=0;l<d;l++)"movie"!==u[l].getAttribute("name").toLowerCase()&&(c[u[l].getAttribute("name")]=u[l].getAttribute("value"));R(s,c,n,r)}else N(i),r&&r(a);else x(n,!0),r&&(a.success=!0,a.ref=D(n),a.id=n,r(a))}else if(x(n,!0),r){var f=D(n);f&&typeof f.SetVariable!==o&&(a.success=!0,a.ref=f,a.id=f.id),r(a)}}}function D(e){var t=null,n=k(e);return n&&"OBJECT"===n.nodeName.toUpperCase()&&(t=typeof n.SetVariable!==o?n:n.getElementsByTagName(s)[0]||n),t}function P(){return!b&&V("6.0.65")&&(A.win||A.mac)&&!(A.wk&&A.wk<312)}function R(a,i,s,c){var u=k(s);if(s=j(s),b=!0,n=c||null,r={success:!1,id:s},u){"OBJECT"===u.nodeName.toUpperCase()?(e=C(u),t=null):(e=u,t=s),a.id=d,(typeof a.width===o||!/%$/.test(a.width)&&B(a.width)<310)&&(a.width="310"),(typeof a.height===o||!/%$/.test(a.height)&&B(a.height)<137)&&(a.height="137");var l=A.ie?"ActiveX":"PlugIn",m="MMredirectURL="+encodeURIComponent(f.location.toString().replace(/&/g,"%26"))+"&MMplayerType="+l+"&MMdoctitle="+encodeURIComponent(p.title.slice(0,47)+" - Flash Player Installation");if(typeof i.flashvars!==o?i.flashvars+="&"+m:i.flashvars=m,A.ie&&4!=u.readyState){var g=G("div");s+="SWFObjectNew",g.setAttribute("id",s),u.parentNode.insertBefore(g,u),u.style.display="none",M(u)}w(a,i,s)}}function N(e){if(A.ie&&4!=e.readyState){e.style.display="none";var t=G("div");e.parentNode.insertBefore(t,e),t.parentNode.replaceChild(C(e),t),M(e)}else e.parentNode.replaceChild(C(e),e)}function C(e){var t=G("div");if(A.win&&A.ie)t.innerHTML=e.innerHTML;else{var n=e.getElementsByTagName(s)[0];if(n){var r=n.childNodes;if(r)for(var a=r.length,i=0;i<a;i++)1==r[i].nodeType&&"PARAM"===r[i].nodeName||8==r[i].nodeType||t.appendChild(r[i].cloneNode(!0))}}return t}function w(e,t,n){var r,a,i,c,d=k(n);if(n=j(n),A.wk&&A.wk<312)return r;if(d){var l,f,p,m=A.ie?G("div"):G(s);for(p in typeof e.id===o&&(e.id=n),t)t.hasOwnProperty(p)&&"movie"!==p.toLowerCase()&&U(m,p,t[p]);for(l in A.ie&&(a=e.data,i=m.innerHTML,(c=G("div")).innerHTML="<object classid='clsid:D27CDB6E-AE6D-11cf-96B8-444553540000'><param name='movie' value='"+a+"'>"+i+"</object>",m=c.firstChild),e)e.hasOwnProperty(l)&&("styleclass"===(f=l.toLowerCase())?m.setAttribute("class",e[l]):"classid"!==f&&"data"!==f&&m.setAttribute(l,e[l]));A.ie?y[y.length]=e.id:(m.setAttribute("type",u),m.setAttribute("data",e.data)),d.parentNode.replaceChild(m,d),r=m}return r}function U(e,t,n){var r=G("param");r.setAttribute("name",t),r.setAttribute("value",n),e.appendChild(r)}function M(e){var t=k(e);t&&"OBJECT"===t.nodeName.toUpperCase()&&(A.ie?(t.style.display="none",function e(){if(4==t.readyState){for(var n in t)"function"==typeof t[n]&&(t[n]=null);t.parentNode.removeChild(t)}else setTimeout(e,10)}()):t.parentNode.removeChild(t))}function F(e){return e&&e.nodeType&&1===e.nodeType}function j(e){return F(e)?e.id:e}function k(e){if(F(e))return e;var t=null;try{t=p.getElementById(e)}catch(e){}return t}function G(e){return p.createElement(e)}function B(e){return parseInt(e,10)}function V(e){e+="";var t=A.pv,n=e.split(".");return n[0]=B(n[0]),n[1]=B(n[1])||0,n[2]=B(n[2])||0,t[0]>n[0]||t[0]==n[0]&&t[1]>n[1]||t[0]==n[0]&&t[1]==n[1]&&t[2]>=n[2]}function H(e,t,n,r){var s=p.getElementsByTagName("head")[0];if(s){var c="string"==typeof n?n:"screen";if(r&&(a=null,i=null),!a||i!=c){var u=G("style");u.setAttribute("type","text/css"),u.setAttribute("media",c),a=s.appendChild(u),A.ie&&typeof p.styleSheets!==o&&p.styleSheets.length>0&&(a=p.styleSheets[p.styleSheets.length-1]),i=c}a&&(typeof a.addRule!==o?a.addRule(e,t):typeof p.createTextNode!==o&&a.appendChild(p.createTextNode(e+" {"+t+"}")))}}function x(e,t){if(S){var n=t?"visible":"hidden",r=k(e);h&&r?r.style.visibility=n:"string"==typeof e&&H("#"+e,"visibility:"+n)}}function Y(e){return null!==/[\\\"<>\.;]/.exec(e)&&typeof encodeURIComponent!==o?encodeURIComponent(e):e}return A.w3&&((typeof p.readyState!==o&&("complete"===p.readyState||"interactive"===p.readyState)||typeof p.readyState===o&&(p.getElementsByTagName("body")[0]||p.body))&&I(),h||(typeof p.addEventListener!==o&&p.addEventListener("DOMContentLoaded",I,!1),A.ie&&(p.attachEvent(l,(function e(){"complete"===p.readyState&&(p.detachEvent(l,e),I())})),f==top&&function e(){if(!h){try{p.documentElement.doScroll("left")}catch(t){return void setTimeout(e,0)}I()}}()),A.wk&&function e(){h||(/loaded|complete/.test(p.readyState)?I():setTimeout(e,0))}())),E[0]=function(){g?function(){var e=p.getElementsByTagName("body")[0],t=G(s);t.setAttribute("style","visibility: hidden;"),t.setAttribute("type",u);var n=e.appendChild(t);if(n){var r=0;!function a(){if(typeof n.GetVariable!==o)try{var i=n.GetVariable("$version");i&&(i=i.split(" ")[1].split(","),A.pv=[B(i[0]),B(i[1]),B(i[2])])}catch(e){A.pv=[8,0,0]}else if(r<10)return r++,void setTimeout(a,10);e.removeChild(t),n=null,_()}()}else _()}():_()},A.ie&&window.attachEvent("onunload",(function(){for(var e=T.length,t=0;t<e;t++)T[t][0].detachEvent(T[t][1],T[t][2]);for(var n=y.length,r=0;r<n;r++)M(y[r]);for(var a in A)A[a]=null;for(var i in A=null,Ve)Ve[i]=null;Ve=null})),{registerObject:function(e,t,n,r){if(A.w3&&e&&t){var a={};a.id=e,a.swfVersion=t,a.expressInstall=n,a.callbackFn=r,v[v.length]=a,x(e,!1)}else r&&r({success:!1,id:e})},getObjectById:function(e){if(A.w3)return D(e)},embedSWF:function(e,t,n,r,a,i,c,u,d,l){var f=j(t),p={success:!1,id:f};A.w3&&!(A.wk&&A.wk<312)&&e&&t&&n&&r&&a?(x(f,!1),L((function(){n+="",r+="";var m={};if(d&&typeof d===s)for(var g in d)m[g]=d[g];m.data=e,m.width=n,m.height=r;var E={};if(u&&typeof u===s)for(var v in u)E[v]=u[v];if(c&&typeof c===s)for(var y in c)if(c.hasOwnProperty(y)){var T=O?encodeURIComponent(y):y,h=O?encodeURIComponent(c[y]):c[y];typeof E.flashvars!==o?E.flashvars+="&"+T+"="+h:E.flashvars=T+"="+h}if(V(a)){var b=w(m,E,t);m.id==f&&x(f,!0),p.success=!0,p.ref=b,p.id=b.id}else{if(i&&P())return m.data=i,void R(m,E,t,l);x(f,!0)}l&&l(p)}))):l&&l(p)},switchOffAutoHideShow:function(){S=!1},enableUriEncoding:function(e){O=typeof e===o||e},ua:A,getFlashPlayerVersion:function(){return{major:A.pv[0],minor:A.pv[1],release:A.pv[2]}},hasFlashPlayerVersion:V,createSWF:function(e,t,n){return A.w3?w(e,t,n):void 0},showExpressInstall:function(e,t,n,r){A.w3&&P()&&R(e,t,n,r)},removeSWF:function(e){A.w3&&M(e)},createCSS:function(e,t,n,r){A.w3&&H(e,t,n,r)},addDomLoadEvent:L,addLoadEvent:function(e){if(typeof f.addEventListener!==o)f.addEventListener("load",e,!1);else if(typeof p.addEventListener!==o)p.addEventListener("load",e,!1);else if(typeof f.attachEvent!==o)!function(e,t,n){e.attachEvent(t,n),T[T.length]=[e,t,n]}(f,"onload",e);else if("function"==typeof f.onload){var t=f.onload;f.onload=function(){t(),e()}}else f.onload=e},getQueryParamValue:function(e){var t=p.location.search||p.location.hash;if(t){if(/\?/.test(t)&&(t=t.split("?")[1]),!e)return Y(t);for(var n=t.split("&"),r=0;r<n.length;r++)if(n[r].substring(0,n[r].indexOf("="))==e)return Y(n[r].substring(n[r].indexOf("=")+1))}return""},expressInstallCallback:function(){if(b){var a=k(d);a&&e&&(a.parentNode.replaceChild(e,a),t&&(x(t,!0),A.ie&&(e.style.display="block")),n&&n(r)),b=!1}},version:"2.3"}}(),He=Ve,xe=function(e,t,n,r){var a,i="",o="";if((void 0===t||t)&&(i+="abcdefghijklmnopqrstuvwxyz"),n&&(i+="ABCDEFGHIJKLMNOPQRSTUVWXYZ"),r&&(i+="0123456789"),i.length)for(a=0;a<e;a+=1)o+=i.substr(Math.floor(i.length*Math.random()),1);return o},Ye=function(e,t){for(var n="0";n.length<t;)n+=n;return(n+e).substr(-t,t)},Ze="FlashProxy",Ke="window.ustream.",We=l.create(Ze);function Qe(e,t){F.dispatch(e,Ze,t)}We.info("FlashPlayer version",{version:Le.swf});var ze=Le.swf[0]>=11&&!Le.safari,Xe="videoTagHandler",qe={BASE:Xe,PAUSE:"".concat(Xe,".pause"),PLAY:"".concat(Xe,".play"),SEEK:"".concat(Xe,".seek")},$e="coldStart";function Je(e,t){F.dispatch(e,$e,t)}var et=function(){var e=l.create($e),t=!1;function n(){F.addListener(D.LOADED_METADATA,a),F.addListener(D.CAN_PLAY_THROUGH,d),F.addListener(D.DURATION_CHANGE,c)}function r(){F.removeListener(D.LOADED_METADATA,a),F.removeListener(D.CAN_PLAY_THROUGH,d),F.removeListener(D.DURATION_CHANGE,c),F.removeListener(D.PROGRESS,u)}function a(){F.removeListener(D.LOADED_METADATA,a),Le.ios&&Je(qe.PLAY)}function i(){F.removeListener(D.TIME_UPDATE,i),t=!0}function o(){t||(F.removeListener(D.TIME_UPDATE,i),r()),F.removeListener(V.SUSPEND,o),F.addListener(V.WAKE,s)}function s(){F.removeListener(V.WAKE,s),F.addListener(V.SUSPEND,o),t||(F.addListener(D.TIME_UPDATE,i),n())}function c(t){e.debug("onDurationChange"),F.removeListener(D.DURATION_CHANGE,c),f(t)||F.addListener(D.PROGRESS,u)}function u(t){e.debug("onProgress"),f(t)}function d(){r(),Je(qe.PLAY)}function f(t){F.validateNotificationData(t,["buffered"]);var n=ee.remainingTotal(0,t.data.buffered,!0),r=z.get(j.COLDSTART_THRESHOLD);return e.debug("checkBufferOnColdStart",{buffered:t.data.buffered,remaining:n}),n>r&&n<1/0&&(e.info("buffer full, starting playback"),d(),!0)}return F.addListener(V.CLEANUP,(function e(){F.removeListener(V.CLEANUP,e),F.removeListener(V.SUSPEND,o),F.removeListener(V.WAKE,s),F.removeListener(D.TIME_UPDATE,i),r(),t=!1,Je(se.DESTROY)})),F.addListener(V.SUSPEND,o),F.addListener(D.TIME_UPDATE,i),n(),{name:$e}},tt="buffercollector";function nt(e,t){F.dispatch(e,tt,t)}var rt=function(){var e,t=l.create(tt),n=!1;function r(){n=!0}function a(){n=!1}function i(){n&&(t.debug("buffercollector - bufferempty stop stream (PAUSE)"),nt(qe.PAUSE),F.removeListener(D.PROGRESS,s),F.removeListener(D.TIME_UPDATE,s),F.addListener(D.PROGRESS,s),F.addListener(D.TIME_UPDATE,s))}function o(){t.debug("buffercollector - delay is over start stream (PLAY)"),nt(qe.PLAY)}function s(n){F.validateNotificationData(n,["position","buffered"]);var r=z.get(j.BUFFER_COLLECT_DELAY_IN_MILLISEC),a=ee.remainingTotal(n.data.position,n.data.buffered,!0);a>0&&a<1/0&&(t.debug("buffercollector - buffer collected, start delay"),e=setTimeout(o,r),F.removeListener(D.TIME_UPDATE,s),F.removeListener(D.PROGRESS,s))}return F.addListener(V.CLEANUP,(function t(){F.removeListener(V.CLEANUP,t),F.removeListener(D.WAITING,r),F.removeListener(D.PLAYING,a),F.removeListener(O.BUFFER_EMPTY,i),F.removeListener(D.PROGRESS,s),e=clearTimeout(e),nt(se.DESTROY)})),F.addListener(D.WAITING,r),F.addListener(D.PLAYING,a),F.addListener(O.BUFFER_EMPTY,i),{name:tt}},at="mseBuffered";function it(e,t){F.dispatch(e,at,t)}var ot="GapRecovery",st={BASE:ot,GAP_RECOVERING:"".concat(ot,".gapRecovering")},ct=Le.chrome||Le.safari,ut=Le.safari,dt="mseGapRecovery",lt="gap detected";function ft(e,t){F.dispatch(e,dt,t)}var pt,mt,gt=function(){var e=l.create("gapRecovery"),t=null,n=null,r=null,a=0;function i(){F.addListener(D.PROGRESS,s),F.addListener(D.STALLED,s)}function o(){F.removeListener(D.PROGRESS,s),F.removeListener(D.STALLED,s),F.removeListener(D.WAITING,u)}function s(i){F.validateNotificationData(i,["position","buffered"]),a=i.data.position;var o,s=ee.current(a,i.data.buffered),d=ee.next(a,i.data.buffered);if(r=d?d.start:null,!s&&d)e.warn(lt),u();else if(s&&d&&n!==s.end){var l=(n=s.end)-a;e.warn(lt,{playPosition:a,gapPosition:n,remainingUntilGap:l})}else null===n||d||(n=null,e.warn("gap cleared"));ct&&(null!==n&&null!==r?(o=a,null===t&&(t=setTimeout(u,Math.max(0,n-o-66)))):c()),F.removeListener(D.WAITING,u),null!==n&&F.addListener(D.WAITING,u)}function c(){null!==t&&(clearInterval(t),t=null)}function u(){F.removeListener(D.WAITING,u),ct&&c(),ft(st.GAP_RECOVERING,{position:r,gapLength:n?r-n:r-a}),ft(qe.PAUSE),ft(qe.SEEK,{position:r}),ft(qe.PLAY),e.warn("gap recovered",{playPosition:r}),n=null,r=null}function d(){c(),o(),F.removeListener(qe.SEEK,f),F.addListener(qe.SEEK,f,F.MINIMUM_PRIORITY)}function f(){F.removeListener(qe.SEEK,f),i()}return F.addListener(V.CLEANUP,(function e(){F.removeListener(V.CLEANUP,e),F.removeListener(V.SEEK,d),o(),F.removeListener(qe.SEEK,f),c(),ft(se.DESTROY)})),F.addListener(V.SEEK,d),i(),{name:dt}},Et="mseStalledRecovery";function vt(e,t){F.dispatch(e,Et,t)}var yt=function(){var e,t,n=l.create(Et),r=0,a=!1;function i(){a=!0}function o(){a=!1}function s(){t&&c(),a?n.debug("The stalled events are not handled when the buffer is empty"):t=setTimeout(d,1e3)}function c(){t=clearTimeout(t)}function u(e){F.validateNotificationData(e,["start","end"]),(pt=pt||[]).push(e.data)}function d(){if(vt(O.UNRECOVERED_STALLED,{position:e,remaining:r}),void 0===e||X.isLive&&0===e)return n.warn("unrecovered stalled event, but no playPosition for repair seek"),void s();n.warn("unrecovered stalled event, dispatching seek for repair"),t=void 0;var a=z.get(j.MOVING_WINDOW_INTERVAL_DELAY);vt(V.SEEK,{position:e+a})}function f(e){F.validateNotificationData(e,["position"]),e.data.position>mt&&(pt=void 0,h(),F.addListener(D.STALLED,g))}function m(t){t.data.position!==e&&c(),v(t)}function g(e){v(e),t||s()}function E(t){var r=function(e){if(!pt)return null;var t,n;for(n=0;n<pt.length;n+=1)if(e<=(t=pt[n]).end&&e>=t.start)return t;return null}(e);r?0!==r.start?vt(V.SEEK,{position:r.start-1}):n.warn("would have tried to seek before 0 position"):g(t)}function v(t){F.validateNotificationData(t,["position","remaining"]),e=t.data.position,r=t.data.remaining}function y(){F.removeListener(D.STALLED,g),c()}function T(){F.addListener(D.STALLED,g)}function h(){F.removeListener(p.MISSING_RAP_AT_RANGE,u),F.removeListener(D.STALLED,E),F.removeListener(D.TIME_UPDATE,f)}function b(t){F.validateNotificationData(t,["position"]),c(),F.removeListener(D.STALLED,g),e=t.data.position,mt=e,h(),F.addListener(p.MISSING_RAP_AT_RANGE,u),F.addListener(D.STALLED,E),F.addListener(D.TIME_UPDATE,f)}return F.addListener(V.CLEANUP,(function e(){F.removeListener(V.CLEANUP,e),F.removeListener(V.PAUSE,y),F.removeListener(V.RESUME,T),F.removeListener(V.SEEK,b),F.removeListener(D.TIME_UPDATE,m),F.removeListener(D.STALLED,g),F.removeListener(O.BUFFER_EMPTY,i),F.removeListener(O.BUFFER_FULL,o),h(),c(),vt(se.DESTROY),a=!1})),F.addListener(V.PAUSE,y),F.addListener(V.RESUME,T),F.addListener(V.SEEK,b),F.addListener(D.TIME_UPDATE,m),F.addListener(D.STALLED,g),F.addListener(O.BUFFER_EMPTY,i),F.addListener(O.BUFFER_FULL,o),{name:Et}},Tt="mseSeek";function ht(e,t){F.dispatch(e,Tt,t)}var bt=function(e){var t=l.create(Tt),n=null,r=!1;function a(){F.addListener(D.TIME_UPDATE,c,F.MAXIMUM_PRIORITY),F.addListener(D.SEEKED,c,F.MAXIMUM_PRIORITY)}function i(){F.removeListener(D.TIME_UPDATE,c),F.removeListener(D.SEEKED,c)}function o(){r=!0}function s(e){F.validateNotificationData(e,["position"]),r||ht(V.SEEK,{position:e.data.position}),r=!1}function c(e){F.validateNotificationData(e,["position","remaining"]),ht(O.POSITION,{position:e.data.position,remaining:e.data.remaining})}function u(e){F.validateNotificationData(e,["position"]),n=e.data.position,i(),F.removeListener(D.PROGRESS,d),F.addListener(D.PROGRESS,d),ht(qe.PAUSE)}function d(r){if(F.validateNotificationData(r,["buffered"]),ee.remainingTotal(n,r.data.buffered)>(Math.abs(e-n)>Pe?Pe:1)){var i=n;r.data.buffered.length>0&&(i=Math.max(r.data.buffered[0].start,n)),t.debug("onVideoProgressAfterSeek seeking to ".concat(i,", seekPosition: ").concat(n)),ht(qe.SEEK,{position:i}),ht(qe.PLAY),a(),F.removeListener(D.PROGRESS,d),n=null}}return F.addListener(D.SEEKING,s),F.addListener(V.SEEK,u),F.addListener(qe.SEEK,o),F.addListener(V.CLEANUP,(function e(){F.removeListener(D.SEEKING,s),F.removeListener(V.SEEK,u),F.removeListener(qe.SEEK,o),F.removeListener(V.CLEANUP,e),i(),F.removeListener(D.PROGRESS,d),r=!1,ht(se.DESTROY)})),a(),{name:Tt}},St="directSeek";function Ot(e,t){F.dispatch(e,St,t)}var At="directBuffered";function It(e,t){F.dispatch(e,At,t)}var Lt="directSeek";function _t(e,t){F.dispatch(e,Lt,t)}var Dt,Pt,Rt="TextTrackProxy",Nt={BASE:Rt,EMPTY_CUE_ADDED:"".concat(Rt,".emptyCueAdded"),TEXT_TRACK_ADDED:"".concat(Rt,".textTrackAdded"),TEXT_TRACK_CUE_CHANGE:"".concat(Rt,".textTrackCueChange")},Ct="VideoTagProxy",wt=l.create(Ct);function Ut(e,t){F.dispatch(e,Ct,t)}function Mt(e){if(Dt)return Dt;var t,n,r,a="atlas.".concat(xe(3)),i=Promise.resolve(),o=!0,s=!0,c=!1,u=1/0;function d(){l(),m()}function l(){Pt&&Le.ios&&(Array.from(Pt.textTracks).forEach((function(e){e.removeEventListener("cuechange",f)})),Array.from(Pt.textTracks).forEach((function(e){e.addEventListener("cuechange",f)})))}function f(e){var t=z.get(j.RENDER_TEXT_TRACKS_NATIVELY),n=z.get(j.HIDE_NATIVE_TRACKS);if(t&&n){var r=e.target;Ut(Nt.TEXT_TRACK_CUE_CHANGE,{activeCues:Array.from(r.activeCues)})}}function m(){if(Pt){var e=Array.from(Pt.textTracks||[]).filter((function(e){return e.language})).map((function(e){var t=e.id,n=e.label,r=e.language,a=e.mode;return{id:t,label:n,language:r,mode:void 0===a?"disabled":a}}));Ut(O.TEXT_TRACKS,e)}}function g(){var e=Array.from(Pt.audioTracks||[]).filter((function(e){return e.language})).map((function(e){var t=e.id,n=e.label,r=e.language,a=e.enabled;return{id:t,label:n,language:r,enabled:void 0!==a&&a}}));Ut(O.AUDIO_TRACKS,e)}function E(){F.removeListener(V.SUSPEND,E),F.removeListener(p.STREAM_URL,U),F.removeListener($.SOURCE_OBJECT_URL,U),r.setTarget(null),Pt.onerror=null,n="",Pt.src=n,F.addListener(V.WAKE,v),F.addListener(p.STREAM_URL,M),F.addListener($.SOURCE_OBJECT_URL,M)}function v(){F.removeListener(V.WAKE,v),F.removeListener(p.STREAM_URL,M),F.removeListener($.SOURCE_OBJECT_URL,M),r.setTarget(Pt),Pt.onerror=k,Pt.src=n,F.addListener(V.SUSPEND,E),F.addListener(p.STREAM_URL,U),F.addListener($.SOURCE_OBJECT_URL,U)}function y(e){F.validateNotificationData(e,["volume"]),Pt.volume=e.data.volume}function T(e){F.validateNotificationData(e,["speed"]),Pt.playbackRate=e.data.speed}function h(){wt.info("pausing"),o=!1,Pt.pause()}function b(){Pt.pause()}function S(){wt.info("resuming"),o=!0,P()}function I(e){if(z.get(j.RENDER_TEXT_TRACKS_NATIVELY)&&Pt&&Pt.textTracks&&Pt.textTracks.length){var t,n=e.data,r=n.isVisible,a=(t=n.trackId)>=Pt.textTracks.length?0:t,i=Array.from(Pt.textTracks),o=i.find((function(e){var t=e.mode;return["hidden","showing"].some((function(e){return e===t}))}));if(o&&(o.mode="disabled"),r){var s=i[a];if(s){var c=z.get(j.HIDE_NATIVE_TRACKS);s.mode=c?"hidden":"showing"}}}}function L(e){if(Pt&&Pt.audioTracks&&(r=Pt.audioTracks,Array.from(r).filter((function(e){return e.label})).length>1)){var t=Array.from(Pt.audioTracks||[]).find((function(e){return e.enabled})),n=Pt.audioTracks.getTrackById(e.data.id);if(!n||t.id===n.id)return;Ut(p.LANGUAGE_CHANGE_STARTED,{activeStreamId:"audio:".concat(t.id),targetStreamId:"audio:".concat(n.id)}),t.enabled=!1,n.enabled=!0,setTimeout((function(){F.addListener(D.TIME_UPDATE,(function e(){F.removeListener(D.TIME_UPDATE,e),Ut(p.LANGUAGE_CHANGE_COMPLETED,{prevStreamId:"audio:".concat(t.id),activeStreamId:"audio:".concat(n.id)})}))}),500)}var r}function _(){P()}function P(){Pt&&Pt.paused&&o&&(i=i.then((function(){return Pt.play()})).catch((function(e){return Ut(O.PLAY_ERROR,{error:e})})))}function R(){Pt.pause()}function N(e){F.validateNotificationData(e,["position"]),Pt.currentTime=e.data.position/1e3}function C(e){var t=Math.floor(1e3*Pt.currentTime),n=ee.buffered(Pt.buffered),r=ee.remaining(t,n);if(e.type!==A.STALLED||!Pt.paused)switch(Ut("videoTagProxyEvents.".concat(e.type),{position:t,buffered:n,remaining:r,readyState:Pt.readyState,networkState:Pt.networkState}),e.type){case A.PROGRESS:Ut(O.BUFFERED,{bufferId:"player",ranges:n});break;case A.TIME_UPDATE:s&&(wt.info("First timeUpdate event, the playback starts",{position:t,buffered:n,remaining:r}),s=!1),Pt&&!c&&(l(),m(),g(),c=!0);break;case A.LOADED_METADATA:Pt&&Le.safari&&Ut(O.WEBKIT_SUPPORTS_FULLSCREEN,!!Pt.webkitSupportsFullscreen)}}function w(e){switch(F.validateNotificationData(e,["source"]),e.type){case p.STREAM_URL:et(),rt(),function(){function e(e){F.validateNotificationData(e,["position"]),Ot(O.POSITION,{position:e.data.position})}F.addListener(D.TIME_UPDATE,e),F.addListener(V.CLEANUP,(function t(){F.removeListener(D.TIME_UPDATE,e),F.removeListener(V.CLEANUP,t),Ot(se.DESTROY)}))}(),function(){var e=!0,t=0;function n(n){F.validateNotificationData(n,["readyState"]),n.type===D.TIME_UPDATE&&(t=n.data.position),!e&&n.data.readyState<2?(e=!0,It(O.BUFFER_EMPTY,{position:t})):e&&n.data.readyState>=2&&(e=!1,It(O.BUFFER_FULL))}F.addListener("".concat(D.BASE,".*"),n),F.addListener(V.CLEANUP,(function e(){F.removeListener("".concat(D.BASE,".*"),n),F.removeListener(V.CLEANUP,e),It(se.DESTROY)}))}(),function(){function e(e){F.validateNotificationData(e,["position"]),_t(qe.SEEK,{position:e.data.position})}F.addListener(V.SEEK,e),F.addListener(V.CLEANUP,(function t(){F.removeListener(V.SEEK,e),F.removeListener(V.CLEANUP,t),_t(se.DESTROY)}))}();break;case $.SOURCE_OBJECT_URL:et(),rt(),function(){var e=!0;function t(t){F.validateNotificationData(t,["position","buffered"]);var n=ee.remaining(t.data.position,t.data.buffered);!e&&n<100?(e=!0,it(O.BUFFER_EMPTY,{position:t.data.position})):e&&n>500&&(e=!1,it(O.BUFFER_FULL))}F.addListener(D.TIME_UPDATE,t),F.addListener(D.PROGRESS,t),F.addListener(D.STALLED,t),F.addListener(V.CLEANUP,(function e(){F.removeListener(D.TIME_UPDATE,t),F.removeListener(D.PROGRESS,t),F.removeListener(D.STALLED,t),F.removeListener(V.CLEANUP,e),it(se.DESTROY)}))}(),gt(),yt(),bt(u)}F.removeListener(p.STREAM_URL,w),F.removeListener($.SOURCE_OBJECT_URL,w),F.addListener(p.STREAM_URL,U),F.addListener($.SOURCE_OBJECT_URL,U),U(e)}function U(e){F.validateNotificationData(e,["source"]),n=e.data.source,Pt.src=n}function M(e){F.validateNotificationData(e,["source"]),n=e.data.source}function k(e){var t={code:e.target.error.code};switch(e.target.error.code){case e.target.error.MEDIA_ERR_ABORTED:t.message="aborted";break;case e.target.error.MEDIA_ERR_NETWORK:t.message="network";break;case e.target.error.MEDIA_ERR_DECODE:t.message="decode";break;case e.target.error.MEDIA_ERR_SRC_NOT_SUPPORTED:t.message="unsupported";break;default:t.message="unknown"}wt.fatal("videotag error",t),Ut(O.ERROR,t)}return e.contentLength&&(u=void 0!==e.contentStart?e.contentStart:0,u+=e.contentLength),F.addListener(V.VOLUME,y),F.addListener(V.PLAYBACK_SPEED,T),F.addListener(V.PAUSE,h),F.addListener(V.RESUME,S),F.addListener(p.FINISHED,b),F.addListener(V.CLEANUP,(function e(){F.removeListener(V.VOLUME,y),F.removeListener(V.PLAYBACK_SPEED,T),F.removeListener(V.PAUSE,h),F.removeListener(V.RESUME,S),F.removeListener(p.FINISHED,b),F.removeListener(V.CLEANUP,e),F.removeListener(V.SUSPEND,E),F.removeListener(V.WAKE,v),F.removeListener(V.CAPTIONS,I),F.removeListener(V.SELECT_AUDIO,L),F.removeListener(p.STREAM_URL,w),F.removeListener($.SOURCE_OBJECT_URL,w),F.removeListener(p.STREAM_URL,U),F.removeListener($.SOURCE_OBJECT_URL,U),F.removeListener(p.STREAM_URL,M),F.removeListener($.SOURCE_OBJECT_URL,M),F.removeListener(qe.PLAY,_),F.removeListener(qe.PAUSE,R),F.removeListener(qe.SEEK,N),Pt&&Pt.textTracks&&Pt.textTracks.removeEventListener("change",d),Pt&&Pt.audioTracks&&Pt.audioTracks.removeEventListener("change",g),t.removeChild(Pt),t=null,n=void 0,r.destroy(),r=null,i=Promise.resolve(),s=!1,c=!1,o=!1,Pt=null,delete X.player,u=1/0,Dt=void 0,Ut(se.DESTROY)})),F.addListener(V.SUSPEND,E),F.addListener(V.CAPTIONS,I),F.addListener(V.SELECT_AUDIO,L),F.addListener(p.STREAM_URL,w),F.addListener($.SOURCE_OBJECT_URL,w),F.addListener(qe.PLAY,_),F.addListener(qe.PAUSE,R),F.addListener(qe.SEEK,N),Dt={name:Ct,initVideo:function(e){var n;(Pt=document.createElement("video")).style.width="100%",Pt.style.height="100%",Pt.id=a,Pt.onerror=k,(n=z.get(j.VIDEO_TAG_ATTRIBUTES))&&Object.keys(n).forEach((function(e){Pt.setAttribute(e,n[e])})),r=te(),Object.values(A).forEach((function(e){r.addListener(e,C)})),r.setTarget(Pt),Pt.textTracks&&Pt.textTracks.addEventListener("change",d),Pt.audioTracks&&Pt.audioTracks.addEventListener("change",g),(t=document.getElementById(e)).appendChild(Pt),X.player={type:"html",id:a,element:Pt},Ut(se.CREATE)},getMetrics:function(){if("function"==typeof Pt.getVideoPlaybackQuality){var e=Pt.getVideoPlaybackQuality();return{total:e.totalVideoFrames,dropped:e.droppedVideoFrames}}return{total:Pt.webkitDecodedFrameCount,dropped:Pt.webkitDroppedFrameCount}}}}var Ft={name:Ct,create:Mt,isSupported:!!document.createElement("video").canPlayType,isCompatible:function(e){return!!document.createElement("video").canPlayType(e)},getInstance:function(){return Dt||Mt(),Dt},getCurrentTime:function(){return Pt?Pt.currentTime:0}},jt=l.create("capabilities"),kt=[];Ge&&kt.push(i.MP4_SEGMENTED),ze&&(kt.push(i.FLV_SEGMENTED),kt.push(i.FLV_MOVIE)),Ft.isSupported&&(kt.push(i.MP4_MOVIE),Ft.isCompatible("application/vnd.apple.mpegURL")&&kt.push(i.HLS)),jt.info("capabilities",{capabilities:kt});var Gt=kt;function Bt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Vt(e){return(Vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Ht=l.create("validator"),xt=["audio/mp4","video/mp4","text/vtt"],Yt=["video/flv"],Zt={baseUrl:"string","[contentStart]":"number","[contentLength]":"number",segmentId:"number",representations:[{contentType:"string",codecs:"string","[initUrl]":"string",segmentUrl:"string",segmentLength:"number"}],"[hashes]":"object"},Kt={baseUrl:"string","[contentStart]":"number","[contentLength]":"number",segmentId:"number",representations:[{contentType:"string",segmentUrl:"string"}],"[hashes]":"object"},Wt={baseUrl:"string","[contentStart]":"number","[contentLength]":"number",segmentId:"number",representations:[{contentType:"string",segmentUrl:"string",segmentLength:"number"}],"[hashes]":"object"},Qt={url:"string",seekParameter:"string"},zt={url:"string"},Xt={url:"string"};function qt(e,t){var n=!0;if(e.representations&&e.representations.length)for(var r=0;r<e.representations.length;r+=1)-1===t.indexOf(e.representations[r].contentType)&&(Ht.error("invalid content type: ".concat(e.representations[r].contentType)),n=!1);else n=!1;return n}function $t(e,t,n){n=n||"options";var r=!0;return Object.entries(t).forEach((function(a){var i=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),2!==i.length);o=!0);}catch(e){s=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(s)throw a}}return i}}(e)||function(e,t){if(e){if("string"==typeof e)return Bt(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Bt(e,2):void 0}}(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(a),o=i[0],s=i[1],c="["===o.substr(0,1)&&"]"===o.substr(-1,1),u=o.substr(+c,o.length-2*c);if("string"==typeof s){var d=s;c||Object.hasOwnProperty.call(e,u)?Object.hasOwnProperty.call(e,u)&&Vt(e[u])!==d&&(Ht.error("".concat(n," invalid type of ").concat(u,": ").concat(Vt(e[u])," needed: ").concat(d)),r=!1):(Ht.error("".concat(n," missing property: ").concat(u)),r=!1)}else if(Vt(e[u])!==Vt(t[o]))Ht.error("".concat(n," invalid type of ").concat(u,": ").concat(Vt(e[u])," needed: ").concat(Vt(t[o]))),r=!1;else if(t[o].shift)for(var l=0;l<e[u].length;l+=1){var f="".concat(n,".").concat(u,"[").concat(l,"]");r=$t(e[u][l],t[o][0],f)&&r}})),r}var Jt="MetaDownloader",en={BASE:Jt,LOAD_INIT:"".concat(Jt,".loadInit"),LOAD_START:"".concat(Jt,".loadStart"),METADATA:"".concat(Jt,".metadata"),FAILED:"".concat(Jt,".failed"),DESTROY:"".concat(Jt,".destroy")},tn=[],nn=["url","initUrl","segmentUrl"];function rn(e){return e.contentType?e.contentType.split("/")[0]:e.format}function an(e){for(var t="",n=0;n<nn.length;n+=1)t+=":",t+=Object.hasOwnProperty.call(e,nn[n])?e[nn[n]]:"";return function(e,t){for(var n=0,r=0;r<e.length;r+=1)n=(1&n)<<31|n>>>1,n^=e.charCodeAt(r);return function(e,t){for(var n="",r=0;r<Math.ceil(t/4);r+=1)n=(15&e).toString(16)+n,e>>>=4;return n}(n,t)}(t,32)}var on,sn=function(e){return[rn(e),an(e)].join(":")},cn=function(e){var t=e.split(":");return{mediaType:t[0],hash:t[1]}},un="TextTrackProxy",dn=l.create(un),ln=window.VTTCue?window.VTTCue:window.TextTrackCue,fn="default",pn={top:2};function mn(e,t){F.dispatch(e,un,t)}function gn(){if(on)return on;var e,t=[],n=[],r={},a=!1,i="bytes",o="purge";function s(t){F.validateNotificationData(t,["streamId","bufferId","contentType"]),"text"===cn(t.data.streamId).mediaType&&(e=t.data.bufferId,mn(R.BUFFER_UPDATED,{bufferId:t.data.bufferId,ranges:[{start:0,end:0}]}))}function c(n){F.validateNotificationData(n,["bufferId","start","end","duration","bytes"]),e===n.data.bufferId&&(t.push({type:i,payload:n.data}),u())}function u(){if(!a)for(;t.length;){var e=t.shift();switch(e.type){case i:l(e.payload);break;case o:a=!0,g()}}}function d(e){F.validateNotificationData(e,["position"]),fn=e.data.position}function l(e){var t,r,a,i=function(e){if(""===String(e.start)||""===String(e.end)||!e.bytes.text)return null;var t=e.start/1e3,n=e.end/1e3;return function(e,t){var n=t.meta||{},r={id:t.id||void 0,line:-4,mode:"showing"},a=function(e){return"default"!==fn&&pn[fn]?pn[fn]:e.line&&e.line>=10?-4:e.line}(n);if(void 0!==a&&(n.line=a),!n.positionAlign&&n.align)switch(n.align){case"left":n.positionAlign=Le.ff?"line-left":"start";break;case"right":n.positionAlign=Le.ff?"line-right":"end"}var i=Object.assign(r,n);try{e=Object.assign(e,i)}catch(e){dn.warn("couldn't set meta properties to vtt cue")}return e}(new ln(t,n,e.bytes.text),e.bytes)}(e),o=p();if((a=function(e,t){return!!n.length&&n.filter((function(n){return n.start<=t&&n.end>=e}))[0]}(t=e.start,r=e.end))?a.end=Math.max(r,a.end):n.push({start:t,end:r}),n=n,i&&o)return o.addCue(i),void mn(R.BUFFER_UPDATED,{bufferId:e.bufferId,ranges:n});mn(Nt.EMPTY_CUE_ADDED,{track:o,bufferId:e.bufferId})}function f(e){return"stream_".concat(e)}function p(){var t=function(e){return tn[e]}(e),n=f(t.sourceStreamVersion);return Object.hasOwnProperty.call(r,n)?r[n]:function(e){var t;t=X.player.element.textTracks,Object.keys(t).forEach((function(e){var n=t[e];n.mode="disabled",n.removeEventListener("cuechange",m)}));var n=X.player.element.addTextTrack("subtitles",e.label,e.language);mn(Nt.TEXT_TRACK_ADDED,{label:e.label,language:e.language});var a=f(e.sourceStreamVersion);return n.mode=z.get(j.RENDER_TEXT_TRACKS_NATIVELY)?"showing":"hidden",n.addEventListener("cuechange",m),r[a]=n,r[a]}(t)}function m(e){if(!z.get(j.RENDER_TEXT_TRACKS_NATIVELY)){var t=e.target;mn(Nt.TEXT_TRACK_CUE_CHANGE,{activeCues:Array.from(t.activeCues)})}}function g(){var t=p();for(n=[];t.cues.length;)t.removeCue(t.cues[0]);mn(Nt.TEXT_TRACK_CUE_CHANGE,{activeCues:[]}),mn(R.BUFFER_CLEAR,{bufferId:e})}return dn.debug("create"),F.addListener(R.APPEND,c),F.addListener(R.BUFFER_UPDATED,(function(t){t.data.bufferId===e&&(a=!1)})),F.addListener(C.BUFFER_ADDED,s),F.addListener(V.CLEANUP,(function i(){F.removeListener(R.APPEND,c),F.removeListener(C.BUFFER_ADDED,s),F.removeListener(V.CAPTION_POSITION,d),F.removeListener(V.CLEANUP,i),t=[],e=void 0,n=[],r={},a=!1,fn="default",on=void 0,mn(se.DESTROY)})),F.addListener(V.CAPTION_POSITION,d),F.addListener(R.PURGE,(function(n){n.data.bufferId===e&&(t.push({type:o}),u())})),mn(se.CREATE),on={name:un}}var En={create:gn,name:un,getInstance:function(){return on||gn(),on}};function vn(e){var t;function n(){return t.bytes[t.position++]}function r(e){e=e||0,t.bytes[t.position++]=255&e}function a(e){r((e=e||0)>>>24&255),r(e>>>16&255),r(e>>>8&255),r(255&e)}return e instanceof Uint8Array||(e=new Uint8Array(e)),t={bytes:e,position:0,readUnsignedByte:n,readUnsignedInt16:function(){for(var e=0,t=0;t<2;t+=1)e=e<<8|n();return e},readUnsignedInt24:function(){for(var e=0,t=0;t<3;t+=1)e=e<<8|n();return e},readUnsignedInt32:function(){for(var e=0,t=0;t<4;t+=1)e=256*e+n();return e},readUnsignedInt64:function(){for(var e=0,t=0;t<8;t+=1)e=256*e+n();return e},readString:function(e){for(var n="",r=0;r<e;r+=1)n+=String.fromCharCode(t.bytes[t.position++]);return n},readBytes:function(e){var n=yn(t.bytes,t.position,e);return t.position+=e,n},writeUnsignedByte:r,writeUnsignedInt16:function(e){r((e=e||0)>>>8&255),r(255&e)},writeUnsignedInt24:function(e){r((e=e||0)>>>16&255),r(e>>>8&255),r(255&e)},writeUnsignedInt32:a,writeUnsignedInt64:function(e){a(Math.floor(e/Math.pow(2,32))),a(Math.floor(e%Math.pow(2,32)))},writeString:function(e){for(var n=0;n<e.length;n+=1)t.bytes[t.position++]=e.charCodeAt(n)},writeBytes:function(e){t.bytes.set(e,t.position),t.position+=e.length}}}function yn(e,t,n){if("function"==typeof e.slice)return e.slice(t,t+n);for(var r=new Uint8Array(n),a=0;a<n;a+=1)r[a]=e[t+a];return r}var Tn={create:vn,slice:yn,concat:function(e){var t,n=0;for(t=0;t<e.length;t+=1)n+=e[t].length;var r=vn(new Uint8Array(n));for(t=0;t<e.length;t+=1)r.writeBytes(e[t]);return r.bytes},stringify:function(e,t,n){var r="";n=n||1,t=t||4;for(var a=0;a<e.length;a+=1)r+=Ye(e[a].toString(16),2),a<e.length-1&&(n>1&&(a+1)%(t*n)==0?r+="\n":(a+1)%t==0&&(r+=" "));return r}},hn={"text/vtt":"text","audio/mp4":"arraybuffer","video/mp4":"arraybuffer"},bn="DownloadManager";function Sn(e,t){F.dispatch(e,bn,t)}var On=function(){function e(e){F.validateNotificationData(e,["loaderId","segmentId","streamId","url","contentType"]),function(e){var t,n,r="".concat("SegmentDownloader",".").concat(e.loaderId),a=l.create(r),i=new Date;function o(){n&&(n.onload=null,n.onerror=null,n.onprogress=null,n.abort(),n=null),F.removeListener(V.CLEANUP,u),F.removeListener(p.ABORT_DOWNLOAD,d),t=clearTimeout(t),s(v.DESTROY,{loaderId:e.loaderId})}function s(e,t){F.dispatch(e,r,t)}function c(){var t={streamId:e.streamId,segmentId:e.segmentId,url:e.url,contentType:e.contentType,status:n.status};0===n.status?t.reason="TIMEOUT":n.status>=400&&n.status<500&&(t.reason=function(){var e;if("string"==typeof n.response)e=n.response;else{if(!(window.ArrayBuffer&&window.Uint8Array&&n.response instanceof ArrayBuffer))return;var t=Tn.create(new Uint8Array(n.response));e=t.readString(t.bytes.length)}try{return JSON.parse(e).error}catch(e){return}}()),a.error("segment download error",t),s(v.FAILED,t),o()}function u(){o()}function d(t){F.validateNotificationData(t,["streamId"]),t.data.streamId===e.streamId&&o()}F.addListener(V.CLEANUP,u),F.addListener(p.ABORT_DOWNLOAD,d),(n=new XMLHttpRequest).open("GET",e.url,!0),n.responseType=hn[e.contentType],n.send(),n.onprogress=function(){t=clearTimeout(t),200===n.status&&s(v.LOAD_START,{streamId:e.streamId,segmentId:e.segmentId,url:e.url,contentType:e.contentType}),n.onprogress=null},n.onload=function(){var t,r=new Date;200===n.status?(t="text"===n.responseType?"".concat(n.response):new Uint8Array(n.response),s(v.RAW,{raw:t,streamId:e.streamId,segmentId:e.segmentId,contentType:e.contentType}),s(v.LOAD_COMPLETE,{url:e.url,time:r-i,size:t.length,streamId:e.streamId,segmentId:e.segmentId,contentType:e.contentType}),o()):c()},n.onerror=c,s(v.LOAD_INIT,{streamId:e.streamId,segmentId:e.segmentId,url:e.url,contentType:e.contentType}),t=setTimeout((function(){n&&(n.abort(),c())}),7e3),e.loaderId,e.url}(e.data)}return F.addListener(p.LOAD_SEGMENT,e),F.addListener(V.CLEANUP,(function t(){F.removeListener(p.LOAD_SEGMENT,e),F.removeListener(V.CLEANUP,t),Sn(se.DESTROY)})),Sn(se.CREATE),{name:bn}},An="GarbageCollector",In={BASE:An,DISCARD_START_SEGMENT:"".concat(An,".discardStartSegment"),DISCARD_END_SEGMENT:"".concat(An,".discardEndSegment")},Ln=function(e,t){var n,r="".concat("SegmentStorage",".").concat(e),a=t,i=l.create(r),o={},s=[],c=0,u=null,d=-1;function f(e,t){F.dispatch(e,r,t)}function p(){null!==u&&S(u),h()}function m(e,t){return t.segmentId===e.firstId-1}function g(e,t){return t.segmentId===e.lastId+1}function E(e,t){return e.firstId<=t.segmentId&&e.lastId>=t.segmentId}function v(){for(var e=T(),t=0;s.length>1&&t<s.length-1;t+=1)s[t].lastId+1===s[t+1].firstId&&(t===c?(s[t].appendSegments(s[t+1].segments),s.splice(t+1,1),t-=1):(s[t+1].prependSegments(s[t].segments),s.splice(t--,1)));c=s.indexOf(e)}function y(){for(var e=T(),t=s.length;--t>=0;)s[t].start===s[t].end&&s.splice(t,1);(c=s.indexOf(e))<0&&(s.length?(c=0,I(T().start),i.warn("removeEmptyBundles: currentBundle removed, bundleIndex set to 0")):i.debug("removeEmptyBundles: no remaining bundles"))}function T(){return s&&s.length>c?s[c]:null}function h(){var t;n.streamId=e,n.activeFragmentStartTime=(t=T())?t.activeFragmentStartTime:_e,n.hasNextFragment=!!T()&&T().hasNextFragment,n.hasNextRAPFragment=!!T()&&T().hasNextRAPFragment,n.nextFragmentContainsRAP=!!T()&&T().nextFragmentContainsRAP,n.nextFragmentStartTime=T()?T().nextFragmentStartTime:_e}function S(t,n){if(s.length&&0===s[0].firstId&&t<s[0].start&&t>=0)return c=0,void I(T().start);for(var r=0;s&&r<s.length;r+=1)if(A(s[r])<=t&&s[r].end>=t)return c=r,void I(t);c=_e,u=t,h(),n||f(b.SEGMENT_MISSING,{streamId:e,position:t})}function O(e){return 0!==e.duration}function A(e){var t=e.segments.findIndex(O);if(t<=0)return e.start;var n=t*a,r=a-e.segments[t].duration;return e.start-(n+r)}function I(t){!function(){if(T().end-u<Pe){var t=T().lastId+1;i.warn("active bundle available content is not enough after seek, requesting the next segment",{streamId:e,segmentId:t,seekPosition:u}),f(b.SEGMENT_MISSING_BY_ID,{streamId:e,segmentId:t})}}(),u=null,i.debug("setTimePosition ".concat(t)),T().setTimePosition(t),h()}return i.debug("construct ".concat(e)),n={getNextFragment:function(){var t,n=T()?T().getNextFragment():null;return h(),t=T().activeSegment.segmentId,d!==t&&(d=t,setTimeout((function(){f(b.SEGMENT_CHANGE,{segmentId:t,streamId:e})}),0)),n},getEoSPosition:function(){var e=s.find((function(e){return e.hasLastSegment}));return e&&e.duration>0?e.end:_e},getSegmentWithKeyframe:function(e){var t=T();if(t)return t.getSegmentWithKeyframe(e)},setTimePosition:S,removeSegmentFromBeginning:function(){var e=s&&s.length?s[0]:null;return!!e&&(e.removeSegmentFromBeginning(),y(),p(),!0)},removeSegmentFromEnd:function(){var e=s&&s.length?s[s.length-1]:null;return!!e&&(e.removeSegmentFromEnd(),y(),p(),!0)},destroy:function(){o={},s=[],c=0,u=null,d=-1},insertSegment:function(e){return!!function(e){for(var t=0;t<s.length;t+=1){if(m(s[t],e))return s[t].prependSegment(e),v(),!0;if(g(s[t],e))return s[t].appendSegment(e),v(),!0;if(E(s[t],e))return i.warn("findBundleForSegment : segment overlaps existing bundle",{bundleStart:s[t].start,bundleEnd:s[t].end,segmentStart:e.firstTimestamp,segmentEnd:e.lastTimestamp}),!1}return i.debug("creating new bundle for segment",{segmentId:e.segmentId,start:e.firstTimestamp,end:e.lastTimestamp}),s.push(function(){var e,t=[],n=0;function r(){return n<t.length?t[n]:null}function a(){if(!r())return!1;for(;!r().hasNextFragment&&n<t.length-1;)n<t.length-1&&(n+=1),r()&&r().reset(),o(),r();return r().hasNextFragment}function i(e){return r().keyFrames.length&&r().keyFrames[0]<=e}function o(){var n;e.start=t&&t.length?function(){for(var e=0;e<t.length;){if(t[e].firstTimestamp!==_e)return t[e].firstTimestamp;e+=1}return 0}():0,e.end=t&&t.length?function(){for(var e=t.length-1;e>=0;){if(t[e].lastTimestamp!==_e)return t[e].lastTimestamp;e-=1}return 0}():0,e.firstId=t&&t.length?t[0].segmentId:-1,e.lastId=t&&t.length?t[t.length-1].segmentId:-1,e.duration=function(){for(var e=0,n=0;n<t.length;n+=1)e+=t[n].duration;return e}(),e.avgSegmentDuration=e.duration/t.length,e.size=function(){for(var e=0,n=0;n<t.length;n+=1)e+=t[n].size;return e}(),e.segments=t,e.hasNextFragment=a(),e.hasNextRAPFragment=!!r()&&r().hasNextRAPFragment,e.nextFragmentContainsRAP=!!a()&&r().nextFragmentContainsRAP,e.nextFragmentStartTime=a()?r().nextFragmentStartTime:_e,e.activeSegment=r(),e.activeFragmentStartTime=(n=r())?n.activeFragmentStartTime:_e,e.hasLastSegment=t.some((function(e){return e.lastSegment}))}return e={getNextFragment:function(){var e=a()?r().getNextFragment():null;return o(),e},appendSegment:function(e){t.push(e),n===_e&&e.fragments.length&&(n=0),o()},prependSegment:function(e){t.unshift(e),n+=1,o()},appendSegments:function(e){t=t.concat(e),o()},prependSegments:function(e){t=e.concat(t),n+=t.length,o()},removeSegmentFromBeginning:function(){t.splice(0,1),n-=1,o()},removeSegmentFromEnd:function(){t.splice(-1,1),o()},setTimePosition:function(e){n=_e;for(var a=0;a<t.length;a+=1)t[a].firstTimestamp<=e&&(n=a);if(r()){for(;!i(e)&&n>0;)n-=1;r().setTimePosition(e)}o()},getSegmentWithKeyframe:function(e){return e=e||0,t.find((function(t){return t.keyFrames.some((function(t){return t>=e}))}))}},o(),e}()),s[s.length-1].appendSegment(e),n=T(),s.sort((function(e,t){return 0===e.duration||0===t.duration?e.firstId-t.firstId:e.start-t.start})),c=s.indexOf(n),!0;var n}(e)&&(p(),!0)},getState:function(){for(var t=[],n=[],r=0,a=[],i=[],o=0;o<s.length;o+=1)r+=s[o].size,t.push({start:s[o].start,end:s[o].end}),n.push({start:s[o].firstId,end:s[o].lastId}),a.push(s[o].duration),i.push(s[o].size);return{streamId:e,size:r,ranges:t,ids:n,bundleDurations:a,bundleSizes:i}},getConfigForHash:function(e){return o[e]},insertConfig:function(e,t){o[e]=t}},h(),n};function _n(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Dn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_n(Object(n),!0).forEach((function(t){Pn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_n(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Pn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Rn(e){return(X.representations||[]).find((function(t){return t.streamId===e}))}function Nn(e){var t=Rn(e);if(void 0!==t){var n=X.representations.indexOf(t);return X.representations.splice(n,1)}}var Cn,wn={addRepresentation:function(e,t,n){void 0===n&&(n="active"),X.representations=X.representations||[],Nn(t);var r=Dn(Dn({},e),{},{streamId:t,status:n});X.representations.push(r)},getRepresentation:Rn,removeRepresentation:Nn,cleanup:function(){Object.getOwnPropertyNames(X).forEach((function(e){delete X[e]}))}},Un="StorageManager";function Mn(e,t){F.dispatch(e,Un,t)}function Fn(){if(Cn)return Cn;var e={},t=-1/0,n={};function r(e){F.validateNotificationData(e,["position"]),t=e.data.position}function a(){t=-1/0}function i(e){F.validateNotificationData(e,["streamId","segment"]);var t=u(e.data.streamId);t.insertSegment(e.data.segment)&&Mn(T.SEGMENT_STORAGE_UPDATED,t.getState()),function(e){var t=u(e).getEoSPosition();t!==_e&&Mn(T.EOS_POSITION_DETECTED,{position:t})}(e.data.streamId)}function o(e){F.validateNotificationData(e,["streamId","after"]),n[e.data.streamId]=e.data.after,c(e.data.streamId)}function s(e){F.validateNotificationData(e,["streamId"]),delete n[e.data.streamId]}function c(e){var t=n[e];if(t||0===t){var r=u(e).getSegmentWithKeyframe(t);r&&(delete n[e],function(e,t){var n=e.keyFrames.find((function(e){return e>=t}));Mn(b.KEYFRAME_POSITION,{streamId:e.streamId,position:n})}(r,t))}}function u(t){return function(t){if(!Object.hasOwnProperty.call(e,t)){var n=function(e){return wn.getRepresentation(e).segmentLength}(t),r=Ln(t,n);e[t]=r,function(e){Mn(T.SEGMENT_STORAGE_CREATED,{streamId:e})}(t)}}(t),e[t]}function d(t){Object.hasOwnProperty.call(n,t)&&delete n[t],Object.hasOwnProperty.call(e,t)&&(e[t].destroy(),delete e[t],Mn(T.SEGMENT_STORAGE_REMOVED,{streamId:t}))}function l(e){F.validateNotificationData(e,["streamId","position"]);var n=u(e.data.streamId),r=Math.max(e.data.position,t+Pe);n.setTimePosition(r)}function f(e){F.validateNotificationData(e,["streamId","ranges"]),e.data.ranges.length?c(e.data.streamId):d(e.data.streamId)}function m(e){F.validateNotificationData(e,["streamId"]);var t,n=u(e.data.streamId);switch(e.type){case In.DISCARD_START_SEGMENT:t=n.removeSegmentFromBeginning();break;case In.DISCARD_END_SEGMENT:t=n.removeSegmentFromEnd()}t&&Mn(T.SEGMENT_STORAGE_UPDATED,n.getState())}function g(e){F.validateNotificationData(e,["streamId","config","hash"]),u(e.data.streamId).insertConfig(e.data.hash,e.data.config)}return X.player&&"flash"===X.player.type||(F.addListener(p.SWITCH_STREAM,l,F.MINIMUM_PRIORITY),F.addListener(V.SEEK,r),F.addListener(V.CLEANUP,(function t(){F.removeListener(p.SWITCH_STREAM,l),F.removeListener(V.SEEK,r),F.removeListener(V.CLEANUP,t),F.removeListener(T.SEGMENT_STORAGE_UPDATED,f),F.removeListener(qe.SEEK,a),F.removeListener(In.DISCARD_START_SEGMENT,m),F.removeListener(In.DISCARD_END_SEGMENT,m),F.removeListener(v.SEGMENT,i),F.removeListener(v.EMPTY_SEGMENT,i),F.removeListener(v.CONFIG,g),F.removeListener(p.REQUEST_KEYFRAME_POSITION,o),F.removeListener(p.CANCEL_KEYFRAME_REQUEST,s),Object.getOwnPropertyNames(e).forEach(d),e={},n={},Cn=void 0,Mn(se.DESTROY)})),F.addListener(T.SEGMENT_STORAGE_UPDATED,f),F.addListener(qe.SEEK,a),F.addListener(In.DISCARD_START_SEGMENT,m),F.addListener(In.DISCARD_END_SEGMENT,m),F.addListener(v.SEGMENT,i),F.addListener(v.EMPTY_SEGMENT,i),F.addListener(v.CONFIG,g),F.addListener(p.REQUEST_KEYFRAME_POSITION,o),F.addListener(p.CANCEL_KEYFRAME_REQUEST,s),Mn(se.CREATE)),Cn={name:Un,getSegmentStorage:u,removeSegmentStorage:d}}var jn={name:Un,create:Fn,getInstance:function(){return Cn||Fn(),Cn}},kn=function(e){return function(t,n){var r=t.segmentId,a=n.segmentId;return Math.min(r,a)>=e?r-a:a-r}},Gn={},Bn={};function Vn(e){return cn(e).mediaType}var Hn=function(e,t){Gn[e]=function(e){return{segmentUrl:e.segmentUrl?e.baseUrl+e.segmentUrl:""}}(t),t.hashes&&function(e,t){var n=Vn(e);Bn[n]||(Bn[n]=function(){var e={};return{add:function(t){if(!Object.hasOwnProperty.call(t,"id"))throw new Error('Invalid hashObject: missing "id"');if(!Object.hasOwnProperty.call(t,"hash"))throw new Error('Invalid hashObject: missing "hash"');e[t.id]=t.hash},getHashBySegmentId:function(t){var n=Object.keys(e).filter((function(e){return t-t%10===parseInt(e,10)})).pop();return e[n]}}}()),Object.getOwnPropertyNames(t).forEach((function(e){var r=t[e];Bn[n].add({id:e,hash:r})}))}(e,t.hashes)},xn=function(e,t){return function(e,t){return n=Gn[e].segmentUrl,r={segmentId:t,hashId:function(e,t){var n=Vn(e);if(!Bn[n])throw new Error('no hashes for "'.concat(n,'"'));var r=Bn[n].getHashBySegmentId(t);if(!r)throw new Error("cannot find hash for ".concat(t));return r}(e,t)},Object.hasOwnProperty.call(r,"segmentId")&&(r["segmentId%06d"]=Ye(r.segmentId,6),r["segmentId%04d"]=Ye(r.segmentId,4)),Object.getOwnPropertyNames(r).reduce((function(e,t){var n=r[t];return e.replace("#".concat(t,"#"),n)}),n);var n,r}(e,t)},Yn=function(e){delete Gn[e];var t=Vn(e);delete Bn[t]},Zn="DownloadQueue",Kn=l.create(Zn);function Wn(e,t){F.dispatch(e,Zn,t)}function Qn(e){return cn(e).mediaType}function zn(){return(new Date).getTime()}var Xn=function(){var e,t,n,r,a,i,o=[],s=[],c={},u={},d={},l=null;function f(){i=!0,C()}function m(e){if(F.validateNotificationData(e,["segmentId","streamId","contentType"]),t=e.data,!s.some((function(e){return t.segmentId===e.segmentId&&t.streamId===e.streamId}))){var t,n=M(e.data.streamId,e.data.segmentId);n&&!function(e){return o.some((function(t){return t.url===e}))}(n)&&(D(e.data),w())}}function g(e){F.validateNotificationData(e,["streamId"]);var t=[];s=s.filter((function(n){return n.streamId!==e.data.streamId||(t.push(n),!1)})),t.length&&Kn.debug("removed downloads with specific a streamId",{streamId:e.data.streamId,removedDownloads:t});var n=Qn(e.data.streamId);delete c[n],u[n]=0,k()}function E(r){F.validateNotificationData(r,["bufferId","currentId","playPosition"]),"video"===r.data.bufferId.substr(0,5)&&(e=r.data.currentId,t=r.data.playPosition,n=r.data.videoTagSegmentId||null)}function y(e){F.validateNotificationData(e,["streamId"]);var t=cn(e.data.streamId);d[t.mediaType]=t.hash}function T(e){F.validateNotificationData(e,["streamId"]),b(e.data.streamId)}function h(e){F.validateNotificationData(e,["streamId"]),b(e.data.streamId)}function b(e){var t=cn(e);d[t.mediaType]=void 0,C()}function S(e){F.validateNotificationData(e,["loaderId"]),o=o.filter((function(t){return t.loaderId!==e.data.loaderId})),k(),w()}function O(e){F.validateNotificationData(e,["segmentId","streamId","contentType"]);var t=Qn(e.data.streamId);u[t]=u[t]?u[t]+1:1;var n=1e3*u[t];!function(e,t){c[e]=zn()+t}(t,n),D(e.data),r||(r=setTimeout((function(){r=void 0,w()}),n))}function A(){i=!1}function I(){var e;do{e=xe(5)}while(!L(e));return e}function L(e){return o.every((function(t){return t.loaderId!==e}))}function _(e){F.validateNotificationData(e,["streamId"]);var t=Qn(e.data.streamId);u[t]=0}function D(e){var t=Qn(e.streamId);s.push({segmentId:e.segmentId,mediaType:t,streamId:e.streamId,contentType:e.contentType})}function P(){return Object.getOwnPropertyNames(d).some((function(e){return!!d[e]}))}function N(){return n&&!i?n:e||0}function C(){var e=[],t=N();s=s.filter((function(n){return!(n.segmentId<t&&(e.push(n),1))})),e.length&&Kn.debug("removed downloads which are passed by the play position",{removedDownloads:e}),k()}function w(){for(var e,n,r,a,i,u=(r=P()&&function(){var e,n=(e=(X.representations||[]).find((function(e){return"active"===e.status&&"video"===Qn(e.streamId)})))?e.streamId:void 0;if(!n)return!1;var r=l.getSegmentStorage(n),a=t+z.get(j.QUALITY_SWITCH_BUFFER_THRESHOLD),i=r.getSegmentWithKeyframe(a);return!!i&&i.segmentId}(),a=N(),P()?function(e,t,n){var r=kn(n||e);return function(e,n){var a=t[e.mediaType]===e.streamId,i=t[n.mediaType]===n.streamId;return a&&!i?-1:!a&&i?1:r(e,n)}}(a,d,r):kn(a));s.length&&o.length<z.get(j.CONCURRENT_DOWNLOAD_COUNT)-Object.getOwnPropertyNames(c).filter(U).length;){if(!(e=s.filter((function(e){return!U(e.mediaType)})).sort(u)).length)return void Kn.debug("resortedQueue is empty",{locks:c,queue:s});Kn.debug("resorted the queue before downloading a segment",{resortedQueue:e}),(n=e.shift()).loaderId=I(),n.url=M(n.streamId,n.segmentId),n.url&&(o.push(n),i=n,s.splice(s.indexOf(i),1),Wn(p.LOAD_SEGMENT,n))}k()}function U(e){if(!Object.hasOwnProperty.call(c,e))return!1;var t=c[e];return zn()<t}function M(e,t){try{return xn(e,t)}catch(n){return void Wn(p.CAN_NOT_CREATE_URL,{streamId:e,segmentId:t,reason:n.message})}}function k(){a.activeDownloaders=o,a.queue=s}return F.addListener(p.REQUEST_SEGMENT,m),F.addListener(p.ABORT_DOWNLOAD,g),F.addListener(p.CONTENT_MOVED,E),F.addListener(p.SWITCH_STREAM,y),F.addListener(p.CANCEL_STREAM_SWITCH,T),F.addListener(R.STREAM_SWITCH,h),F.addListener(V.CLEANUP,(function e(){F.removeListener(p.REQUEST_SEGMENT,m),F.removeListener(p.ABORT_DOWNLOAD,g),F.removeListener(p.CONTENT_MOVED,E),F.removeListener(p.SWITCH_STREAM,y),F.removeListener(p.CANCEL_STREAM_SWITCH,T),F.removeListener(R.STREAM_SWITCH,h),F.removeListener(V.CLEANUP,e),F.removeListener(V.SEEK,f),F.removeListener(v.FAILED,O),F.removeListener(v.LOAD_COMPLETE,_),F.removeListener(v.DESTROY,S),F.removeListener(qe.SEEK,A),l=null,o=null,s=null,c=null,r=clearTimeout(r),u=null,k(),Wn(se.DESTROY)})),F.addListener(V.SEEK,f),F.addListener(v.FAILED,O),F.addListener(v.LOAD_COMPLETE,_),F.addListener(v.DESTROY,S),F.addListener(qe.SEEK,A),l=jn.getInstance(),Wn(se.CREATE),a={name:Zn,isMediaTypeLocked:U},k(),a},qn={decorate:function(e){var t,n=Tn.create(e.bytes);for(n.position=e.fourCC?e.start+8:e.start,e.boxes=[];n.position<e.start+e.length;)(t={}).start=n.position,t.length=n.readUnsignedInt32(),t.fourCC=n.readString(4),t.bytes=e.bytes,e.boxes.push(t),n.position+=t.length-8}},$n={fmov:qn,free:qn,mdia:qn,minf:qn,moof:qn,moov:qn,mvex:qn,stbl:qn,traf:qn,trak:qn,ustm:qn,fhst:{decorate:function(e){function t(){var t,n=Tn.create(e.bytes);n.position=e.start+8,e.hashes=[];for(var r=0;r<Math.floor((e.length-8)/4);r+=1)t=n.readUnsignedInt32(),e.hashes.push(Ye(t.toString(16),8))}e.parseBytes=t,t()}},hash:{decorate:function(e){function t(){var t=Tn.create(e.bytes);t.position=e.start+8;var n=t.readUnsignedInt32();e.hash=Ye(n.toString(16),8)}e.parseBytes=t,t()}},idta:{decorate:function(e){function t(){var t=Tn.create(e.bytes);t.position=e.start+8,e.rawInit=t.readBytes(e.length-8)}e.parseBytes=t,t()}},sidx:{decorate:function(e){var t,n,r=Tn.create(e.bytes);r.position=e.start+8,e.version=r.readUnsignedByte(),e.rawFlags=r.readUnsignedInt24(),e.referenceId=r.readUnsignedInt32(),e.timeScale=r.readUnsignedInt32(),e.version?(e.earliestPresentationTime=r.readUnsignedInt64(),e.firstOffset=r.readUnsignedInt64()):(e.earliestPresentationTime=r.readUnsignedInt32(),e.firstOffset=r.readUnsignedInt32()),r.readUnsignedInt16(),e.referenceCount=r.readUnsignedInt16(),e.references=[];for(var a=0;a<e.referenceCount;a+=1)t={},n=r.readUnsignedInt32(),t.referenceType=!!(2147483648&n),t.subsegmentSize=2147483647&n,t.subsegmentDuration=r.readUnsignedInt32(),n=r.readUnsignedInt32(),t.containsRAP=!!(2147483648&n),t.rapType=(1879048192&n)>>>28,t.rapDeltaTime=268435455&n,e.references.push(t)}},styp:{decorate:function(e){var t=Tn.create(e.bytes);for(t.position=e.start+8,e.majorBrand=t.readString(4),e.minorVersion=t.readUnsignedInt32(),e.compatibleBrands=[];t.position<e.start+e.length;)e.compatibleBrands.push(t.readString(4))}},trun:{decorate:function(e){function t(){var t=Tn.create(e.bytes);t.position=e.start+8,e.version=t.readUnsignedByte(),e.flags=function(e){return{dataOffsetPresent:!!(1&e),firstSampleFlagsPresent:!!(4&e),sampleDurationsPresent:!!(256&e),sampleSizesPresent:!!(512&e),sampleFlagsPresent:!!(1024&e),sampleCompositionTimeOffsetsPresent:!!(2048&e)}}(t.readUnsignedInt24()),e.sampleCount=t.readUnsignedInt32(),e.flags.dataOffsetPresent&&(e.dataOffset=t.readUnsignedInt32()),e.flags.firstSampleFlagsPresent&&(e.firstSampleFlags=t.readUnsignedInt32()),e.samples=[];for(var n=0;n<e.sampleCount;n+=1){var r={};e.flags.sampleDurationsPresent&&(r.duration=t.readUnsignedInt32()),e.flags.sampleSizesPresent&&(r.size=t.readUnsignedInt32()),e.flags.sampleFlagsPresent&&(r.flags=t.readUnsignedInt32()),e.flags.sampleCompositionTimeOffsetsPresent&&(r.compositionTimeOffset=t.readUnsignedInt32()),e.samples.push(r)}}e.parseBytes=t,e.writeBytes=function(){e.flags=e.flags||{};var t=4*e.flags.dataOffsetPresent,n=4*e.flags.firstSampleFlagsPresent,r=4*(e.flags&&e.flags.sampleDurationsPresent)+4*(e.flags&&e.flags.sampleSizesPresent)+4*(e.flags&&e.flags.sampleFlagsPresent)+4*(e.flags&&e.flags.sampleCompositionTimeOffsetsPresent);e.length=16+t+n+e.sampleCount*r;var a=Tn.create(new Uint8Array(e.length));a.writeUnsignedInt32(e.length),a.writeString(e.fourCC),a.writeUnsignedByte(e.version),a.writeUnsignedInt24(function(e){var t=0;return t|=1*e.dataOffsetPresent,t|=4*e.firstSampleFlagsPresent,t|=256*e.sampleDurationsPresent,t|=512*e.sampleSizesPresent,(t|=1024*e.sampleFlagsPresent)|2048*e.sampleCompositionTimeOffsetsPresent}(e.flags)),a.writeUnsignedInt32(e.sampleCount),e.flags.dataOffsetPresent&&a.writeUnsignedInt32(e.dataOffset),e.flags.firstSampleFlagsPresent&&a.writeUnsignedInt32(e.firstSampleFlags);for(var i=0;i<e.sampleCount;i+=1)e.flags.sampleDurationsPresent&&a.writeUnsignedInt32(e.samples[i].duration),e.flags.sampleSizesPresent&&a.writeUnsignedInt32(e.samples[i].size),e.flags.sampleFlagsPresent&&a.writeUnsignedInt32(e.samples[i].flags),e.flags.sampleCompositionTimeOffsetsPresent&&a.writeUnsignedInt32(e.samples[i].compositionTimeOffset);e.bytes=a.bytes,e.start=0},t()}},tfdt:{decorate:function(e){function t(){var t=Tn.create(e.bytes);t.position=e.start+8,e.version=t.readUnsignedByte(),e.rawFlags=t.readUnsignedInt24(),e.version?e.baseMediaDecodeTime=t.readUnsignedInt64():e.baseMediaDecodeTime=t.readUnsignedInt32()}e.parseBytes=t,e.writeBytes=function(){e.length=12+(e.version?8:4);var t=Tn.create(new Uint8Array(e.length));t.writeUnsignedInt32(e.length),t.writeString(e.fourCC),t.writeUnsignedByte(e.version),t.writeUnsignedInt24(e.rawFlags),e.version?t.writeUnsignedInt64(e.baseMediaDecodeTime):t.writeUnsignedInt32(e.baseMediaDecodeTime),e.bytes=t.bytes,e.start=0},t()}},tfhd:{decorate:function(e){function t(){var t=Tn.create(e.bytes);t.position=e.start+8,e.version=t.readUnsignedByte(),e.flags=function(e){return{baseDataOffsetPresent:!!(1&e),sampleDescriptionIndexPresent:!!(2&e),defaultSampleDurationPresent:!!(8&e),defaultSampleSizePresent:!!(16&e),defaultSampleFlagsPresent:!!(32&e)}}(t.readUnsignedInt24()),e.trackId=t.readUnsignedInt32(),e.flags.baseDataOffsetPresent&&(e.baseDataOffset=t.readUnsignedInt64()),e.flags.sampleDescriptionIndexPresent&&(e.sampleDescriptionIndex=t.readUnsignedInt32()),e.flags.defaultSampleDurationPresent&&(e.defaultSampleDuration=t.readUnsignedInt32()),e.flags.defaultSampleSizePresent&&(e.defaultSampleSize=t.readUnsignedInt32()),e.flags.defaultSampleFlagsPresent&&(e.defaultSampleFlags=t.readUnsignedInt32())}e.parseBytes=t,e.writeBytes=function(){e.flags=e.flags||{},e.length=16,e.length+=8*e.flags.baseDataOffsetPresent,e.length+=4*e.flags.sampleDescriptionIndexPresent,e.length+=4*e.flags.defaultSampleDurationPresent,e.length+=4*e.flags.defaultSampleSizePresent,e.length+=4*e.flags.defaultSampleFlagsPresent;var t=Tn.create(new Uint8Array(e.length));t.writeUnsignedInt32(e.length),t.writeString(e.fourCC),t.writeUnsignedByte(e.version),t.writeUnsignedInt24(function(e){var t=0;return t|=1*e.baseDataOffsetPresent,t|=2*e.sampleDescriptionIndexPresent,t|=8*e.defaultSampleDurationPresent,(t|=16*e.defaultSampleSizePresent)|32*e.defaultSampleFlagsPresent}(e.flags)),t.writeUnsignedInt32(e.trackId),e.flags.baseDataOffsetPresent&&t.writeUnsignedInt64(e.baseDataOffset),e.flags.sampleDescriptionIndexPresent&&t.writeUnsignedInt32(e.sampleDescriptionIndex),e.flags.defaultSampleDurationPresent&&t.writeUnsignedInt32(e.defaultSampleDuration),e.flags.defaultSampleSizePresent&&t.writeUnsignedInt32(e.defaultSampleSize),e.flags.defaultSampleFlagsPresent&&t.writeUnsignedInt32(e.defaultSampleFlags),e.bytes=t.bytes,e.start=0},t()}},mfhd:{decorate:function(e){function t(){var t=Tn.create(e.bytes);t.position=e.start+8,e.version=t.readUnsignedByte(),e.rawFlags=t.readUnsignedInt24(),e.sequenceNumber=t.readUnsignedInt32()}e.parseBytes=t,e.writeBytes=function(){e.length=16;var t=Tn.create(new Uint8Array(e.length));t.writeUnsignedInt32(e.length),t.writeString(e.fourCC),t.writeUnsignedByte(e.version),t.writeUnsignedInt24(e.rawFlags),t.writeUnsignedInt32(e.sequenceNumber),e.bytes=t.bytes,e.start=0},t()}}},Jn=l.create("MP4Parser");function er(e){var t=e.fourCC?$n[e.fourCC]:qn;if(t&&(t.decorate(e),e.boxes)){for(var n=0;n<e.boxes.length;n+=1)er(e.boxes[n]);e.boxes.length&&(delete e.bytes,delete e.start,delete e.length)}}function tr(e){if(e.bytes)return e.length;if(e.boxes){for(var t=e.fourCC?8:0,n=0;n<e.boxes.length;n+=1)t+=tr(e.boxes[n]);return t}return 0}function nr(e,t){if(t.bytes)e.writeBytes(Tn.slice(t.bytes,t.start,t.length));else if(t.boxes){t.fourCC&&(e.writeUnsignedInt32(tr(t)),e.writeString(t.fourCC));for(var n=0;n<t.boxes.length;n+=1)nr(e,t.boxes[n])}else Jn.error("error writing ".concat(t.fourCC,", no bytes/boxes"))}var rr=function(e){var t={bytes:e,start:0,length:e.length};return er(t),t},ar=function(e){var t=Tn.create(new Uint8Array(tr(e)));return nr(t,e),t.bytes};function ir(e,t){for(var n=0;n<e.boxes.length;n+=1)if(e.boxes[n].fourCC===t)return e.boxes[n];return null}var or={getBoxByPath:function(e,t){for(var n=t.split(".");e&&n.length;)e=ir(e,n.shift());return e},getBoxByFourCC:ir},sr=function(e){return{sampleDegradationPriority:65535&e,sampleIsDifferenceSample:!!(e>>>16&1),samplePaddingValue:e>>>17&7,sampleHasRedundancy:e>>>20&3,sampleIsDependedOn:e>>>22&3,sampleDependsOn:e>>>24&3,reserved:e>>>26&63}},cr=function(e){var t=0;return t|=65535&e.sampleDegradationPriority,t|=+e.sampleIsDifferenceSample<<16,t|=(7&e.samplePaddingValue)<<17,t|=(3&e.sampleHasRedundancy)<<20,t|=(3&e.sampleIsDependedOn)<<22,(t|=(3&e.sampleDependsOn)<<24)|(63&e.reserved)<<26};function ur(e,t){for(var n=t.baseMediaDecodeTime,r=0;r<e.sampleCount;r+=1)n+=e.samples[r].duration;return n}function dr(e,t){for(var n=[],r=0;r<e.length;r+=1)n.push(or.getBoxByPath(e[r],t));return n}var lr="Buffer",fr=function(e,t,n){var r,a,i,o,s,c="".concat(lr,".").concat(e),u=l.create(c),d=t,f=!0,m={},g=[];function E(e,t){F.dispatch(e,lr,t)}function v(e){F.validateNotificationData(e,["position"]),a&&(S(),A()),o.getSegmentStorage(d).setTimePosition(e.data.position),L()}function y(t){F.validateNotificationData(t,["bufferId","streamId","position"]),t.data.bufferId===e&&(r=t.data.position,a=t.data.streamId,t.data.streamId.indexOf("text")>-1&&L())}function T(t){F.validateNotificationData(t,["bufferId"]),t.data.bufferId===e&&(r=void 0,a=void 0)}function h(){if(ut&&!e.includes("text")){u.debug("request append config",{bufferId:e});var t=o.getSegmentStorage(d).getConfigForHash(i);t?E(R.APPEND,{streamId:d,bufferId:e,start:0,end:0,duration:0,bytes:t}):i=void 0}}function b(t){if(F.validateNotificationData(t,["bufferId"]),t.data.bufferId===e){var s,c=o.getSegmentStorage(d);if(function(){if(!a)return!1;if(d.indexOf("text")>-1)return!0;var e=o.getSegmentStorage(d).activeFragmentStartTime;if(e===_e)return!1;var t=o.getSegmentStorage(a);return t.setTimePosition(e),t.activeFragmentStartTime!==_e&&t.nextFragmentStartTime>=r&&t.nextFragmentContainsRAP}())return void S();for(;c&&c.hasNextFragment&&!s;)s=c.getNextFragment(),f&&!s.containsRAP?s=null:f=!1;s&&(function(t){var n=o.getSegmentStorage(d);i!==t.hash&&n.getConfigForHash(t.hash)&&(u.info("appending config",{streamId:d,fragmentHash:t.hash,fragmentStart:t.start}),E(R.APPEND,{streamId:d,bufferId:e,start:t.start,end:t.end,duration:t.duration,bytes:n.getConfigForHash(t.hash)}),i=t.hash)}(s),function(t){var r=o.getSegmentStorage(d),a=t.bytes,i={start:t.start,end:t.end};"video"===n.substr(0,5)&&(t.containsRAP?r.hasNextFragment&&!r.nextFragmentContainsRAP&&(a=function(e,t){var n,r=o.getSegmentStorage(d),a=[];for(u.debug("merging subsequent fragments without RAP");r.hasNextFragment&&!r.nextFragmentContainsRAP;)n=r.getNextFragment(),e.end=n.end,a.push(n.bytes);return function(e){var t=function(e){for(var t=[],n=0;n<e.length;n+=1)t.push(rr(e[n]));return t}(e),n=t.shift(),r=or.getBoxByPath(n,"moof.traf.trun"),a=or.getBoxByPath(n,"moof.traf.tfdt"),i=r.length;!function(e,t,n){for(var r,a=dr(n,"moof.traf.trun"),i=dr(n,"moof.traf.tfdt"),o=0;o<a.length;o+=1)r=ur(e,t),e.samples[e.sampleCount-1].duration+=i[o].baseMediaDecodeTime-r,e.samples=e.samples.concat(a[o].samples),e.sampleCount=e.samples.length}(r,a,t),r.writeBytes(),r.dataOffset+=r.length-i,r.writeBytes();var o=or.getBoxByFourCC(n,"mdat");return o.bytes=function(e){var t,n,r=8;for(t=0;t<e.length;t+=1)r+=or.getBoxByFourCC(e[t],"mdat").length-8;var a=Tn.create(new Uint8Array(r));a.writeUnsignedInt32(r),a.writeString("mdat");var i=[];for(t=0;t<e.length;t+=1){n=or.getBoxByFourCC(e[t],"mdat");var o=Tn.slice(n.bytes,n.start+8,n.length-8);i.push(o),a.writeBytes(o)}return a.bytes}([n].concat(t)),o.start=0,o.length=o.bytes.length,ar(n)}([t].concat(a))}(i,a)):(a=function(e){var t=rr(e),n=or.getBoxByPath({boxes:t.boxes},"moof.traf.trun"),r=function(e){return e.flags.sampleFlagsPresent?sr(e.samples[0].flags):e.flags.firstSampleFlagsPresent?sr(e.firstSampleFlags):null}(n);return r.sampleIsDifferenceSample&&(r.sampleIsDifferenceSample=!1,r.sampleDependsOn=2,function(e,t){e.flags.sampleFlagsPresent?e.samples[0].flags=cr(t):e.flags.firstSampleFlagsPresent&&(e.firstSampleFlags=cr(t)),e.writeBytes()}(n,r)),ar(t)}(a),E(p.MISSING_RAP_AT_RANGE,{start:t.start,end:t.end}))),g.push(i),E(R.APPEND,{streamId:d,bufferId:e,start:t.start,end:t.end,duration:t.duration,bytes:a})}(s))}}function S(){if(d=a,a=void 0,r=void 0,u.info("switching stream"),d.indexOf("text")>-1)A();else{var e=o.getSegmentStorage(d);s=e.activeFragmentStartTime}}function A(){s=void 0,E(R.STREAM_SWITCH,{bufferId:e,streamId:d})}function I(t){if(F.validateNotificationData(t,["position"]),void 0!==s&&s<=t.data.position&&A(),g.length&&t.data.position-3e4>g[0].start){for(var n=g.shift(),r=t.data.position-5e3;g.length&&g[0].end<r;)n.end=g.shift().end;E(R.REMOVE,{streamId:d,bufferId:e,start:n.start,end:n.end})}}function L(){g=[],E(R.PURGE,{streamId:d,bufferId:e})}function _(t){e===t.data.bufferId&&(E(R.BUFFER_UPDATING,{bufferId:e}),E(R.BUFFER_UPDATED,{bufferId:e,ranges:g=[{start:0,end:0}]}))}return F.addListener(V.SEEK,v),F.addListener(p.SWITCH_STREAM,y),F.addListener(p.CANCEL_STREAM_SWITCH,T),F.addListener(Nt.TEXT_TRACK_ADDED,h),F.addListener(C.APPEND_TO_BUFFER,b),F.addListener(C.BUFFER_REMOVED,(function t(n){F.validateNotificationData(n,["bufferId"]),n.data.bufferId===e&&(F.removeListener(V.SEEK,v),F.removeListener(p.SWITCH_STREAM,y),F.removeListener(p.CANCEL_STREAM_SWITCH,T),F.removeListener(Nt.TEXT_TRACK_ADDED,h),F.removeListener(C.APPEND_TO_BUFFER,b),F.removeListener(C.BUFFER_REMOVED,t),F.removeListener(O.POSITION,I),F.removeListener(R.BUFFER_CLEAR,_),d=null,a=null,o=null,s=void 0)})),F.addListener(O.POSITION,I),F.addListener(R.BUFFER_CLEAR,_),o=jn.getInstance(),m.bufferId=e,m.contentType=n,m};function pr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var mr="BufferManager",gr=l.create(mr);function Er(e,t){F.dispatch(e,mr,t)}var vr=function(e,t){return Math.floor(1e3*function(e,t){return e/t}(e,t))},yr=["moof","mdat"],Tr=l.create("FragmentExtractor");function hr(e,t,n,r){var a=or.getBoxByPath({boxes:e},"moof.traf.tfdt"),i=or.getBoxByPath({boxes:e},"moof.traf.trun");if(a&&i){var o=vr(a.baseMediaDecodeTime,n),s=vr(t.subsegmentDuration,n);return{start:o,duration:s,end:o+s,bytes:ar({boxes:e}),containsRAP:!!t.containsRAP,rapType:t.rapType,rapDeltaTime:t.rapDeltaTime,sampleCount:i.samples.length,hash:r}}Tr.warn("a mandatory box is missing from the fragment, skip parsing.",{hash:r})}function br(e,t,n){F.dispatch(v.CONFIG,"ConfigExtractor",{config:e,hash:t,streamId:n})}var Sr=function(e,t,n,r){var a,i=0,o=[],s=0,c=_e,u=_e,d=0;function l(){return n&&n.length}function f(){return l()&&(0===i||i-1<n.length)}function p(){if(f())return n[0===i?i:i-1]}function m(){return l()&&i<n.length}function g(){i=0,E()}function E(){var e;a.hasActiveFragment=f(),a.activeFragmentStartTime=(e=p())?e.start:_e,a.hasNextFragment=m(),a.hasNextRAPFragment=function(){for(var e=i;e<n.length;){if(n[e].containsRAP)return!0;e+=1}return!1}(),a.nextFragmentContainsRAP=!!m()&&n[i].containsRAP,a.nextFragmentStartTime=m()?n[i].start:_e}return function(){for(var e=0;n&&e<n.length;e+=1)(n[e].containsRAP||"audio"===t.split(":")[0])&&o.push(n[e].start),s+=n[e].bytes.length;l()&&(c=n[0].start,u=n[n.length-1].start+n[n.length-1].duration,d=u-c)}(),a={getActiveFragment:p,lastSegment:!!r,getNextFragment:function(){var e=m()?n[i++]:void 0;return E(),e},setTimePosition:function(e){g();for(var t=0;n&&t<n.length;t+=1)if(n[t].containsRAP){if(!(n[t].start<=e))break;i=t}E()},reset:g,segmentId:e,streamId:t,fragments:n,size:s,keyFrames:o,firstTimestamp:c,lastTimestamp:u,duration:d},E(),a},Or="MP4SegmentWrapper",Ar=["video/mp4","audio/mp4"],Ir=function(){var e=l.create(Or);function t(e,t){F.dispatch(e,Or,t)}function n(n){F.validateNotificationData(n,["segmentId","streamId","raw","contentType"]),-1!==Ar.indexOf(n.data.contentType)&&(0===n.data.raw.length?(e.warn("zero byte segment",{streamId:n.data.streamId,segmentId:n.data.segmentId}),function(e){var n=Sr(e.segmentId,e.streamId,[]);t(v.EMPTY_SEGMENT,{segment:n,streamId:e.streamId,segmentId:e.segmentId})}({segmentId:n.data.segmentId,streamId:n.data.streamId})):function(n){var r,a,i,o=rr(n.raw);(function(e,t){!function(e,t){for(var n,r=0;t&&r<t.boxes.length;r+=1)"fmov"===t.boxes[r].fourCC&&(n=or.getBoxByFourCC(t.boxes[r],"hash"),br(or.getBoxByFourCC(t.boxes[r],"idta").rawInit,n.hash,e))}(e,or.getBoxByPath(t,"free.ustm"))})(n.streamId,o),or.getBoxByFourCC(o,"styp")&&(r=function(e,t){for(var n,r,a,i=or.getBoxByFourCC(t,"sidx"),o=[],s=[],c=function(e,t){var n=[e],r=or.getBoxByPath(t,"free.ustm.fhst");return r&&(n=r.hashes),n}(e,t),u=0;u<t.boxes.length;u+=1)r=t.boxes[u],-1!==yr.indexOf(r.fourCC)&&(s.push(r),yr.indexOf(r.fourCC)===yr.length-1&&(a=c[Math.min(o.length,c.length-1)],(n=hr(s,i.references[o.length],i.timeScale,a))&&o.push(n),s=[]));return o}(n.streamId,o),i=function(e){var t=!1,n=or.getBoxByFourCC(e,"styp");return n&&(t=-1!==n.compatibleBrands.indexOf("lmsg")),t}(o),a=Sr(n.segmentId,n.streamId,r,i),e.debug("process segment",{streamId:n.streamId,segmentId:n.segmentId,firstTimestamp:a.firstTimestamp,lastTimestamp:a.lastTimestamp,duration:a.duration,keyFrames:a.keyFrames,lastSegment:a.lastSegment}),t(v.SEGMENT,{segment:a,streamId:n.streamId,segmentId:n.segmentId,firstTimestamp:a.firstTimestamp,lastTimestamp:a.lastTimestamp,duration:a.duration,keyFrames:a.keyFrames}))}({segmentId:n.data.segmentId,streamId:n.data.streamId,raw:n.data.raw}))}return F.addListener(V.CLEANUP,(function e(){F.removeListener(V.CLEANUP,e),F.removeListener(v.RAW,n),t(se.DESTROY)})),F.addListener(v.RAW,n),t(se.CREATE),{name:Or}},Lr=" --\x3e ",_r=new RegExp("([0-9:.]+)".concat(Lr,"([0-9.:]+)(.*)"));function Dr(e){var t=e.replace(/[^0-9.:]/gi,"").split(":");return 60*Number(t[0])*60+60*Number(t[1])+Number(t[2])}var Pr,Rr="VTTSegmentWrapper",Nr=[i.VTT],Cr=function(){var e=l.create(Rr);function t(e,t){F.dispatch(e,Rr,t)}function n(n){F.validateNotificationData(n,["segmentId","streamId","raw","contentType"]),-1!==Nr.indexOf(n.data.contentType)&&function(n){var r=function(e,t){for(var n=[];e.length;){var r=e.shift(),a=1e3*r.start,i=1e3*r.end,o=r.payload.join("\n");n.push({start:a,duration:i-a,end:i,bytes:{id:r.id,meta:r.meta,text:o,length:o.length},containsRAP:!0,rapType:0,rapDeltaTime:0,sampleCount:r.payload.length,hash:t})}return n}(function(e){var t=[],n=e.replace(/\r\n/g,"\n").split("\n\n"),r=function(e){for(var t=0;t<e.length;){var n=e[t];if(_r.test(n))return t;t+=1}return-1}(n);return-1===!r?t:t=n.slice(r).map((function(e){return e.split("\n").filter((function(e){return""!==e}))})).filter((function(e){return e.length>=2})).map((function(e){return n=function(e){var t=e.filter((function(e){return new RegExp(Lr).test(e)}));return e.indexOf(t[0])}(t=e),r=0===n?null:t[0],a=n+1,o=(i=t[n].match(_r))[1],s=i[2],c=i[3]?function(e){return e.split(" ").filter((function(e){return!!e})).reduce((function(e,t){var n,r=t.split(":");switch(r[0]){case"A":r[0]="align";break;case"T":r[0]="position";break;case"L":r[0]="line";break;case"S":r[0]="size";break;case"D":r[0]="vertical"}return e[r[0]]=function(e){return/%$/.test(e)}(n=r[1])?+n.slice(0,-1):parseInt(n,10)||n,e}),{})}(i[3]):null,u=t.slice(a).filter((function(e){return""!==e})),{id:r,start:Dr(o),end:Dr(s),payload:u,meta:c};var t,n,r,a,i,o,s,c,u}))}(n.raw),n.streamId),a=Sr(n.segmentId,n.streamId,r);e.debug("process segment",{segment:a,streamId:n.streamId,segmentId:n.segmentId,firstTimestamp:a.firstTimestamp,lastTimestamp:a.lastTimestamp,duration:a.duration,keyFrames:a.keyFrames}),t(v.SEGMENT,{segment:a,streamId:n.streamId,segmentId:n.segmentId,firstTimestamp:a.firstTimestamp,lastTimestamp:a.lastTimestamp,duration:a.duration,keyFrames:a.keyFrames})}({segmentId:n.data.segmentId,streamId:n.data.streamId,raw:n.data.raw})}return F.addListener(V.CLEANUP,(function e(){F.removeListener(V.CLEANUP,e),F.removeListener(v.RAW,n),t(se.DESTROY)})),F.addListener(v.RAW,n),t(se.CREATE),{name:Rr}},wr="BroadcasterTimer",Ur=l.create(wr),Mr="ContentRangeLive";function Fr(){return(new Date).getTime()}var jr=function(e){var t,n,r,a,i,o=e.bufferId,s=e.segmentLength,c=(Pr||(Pr=function(){var e,t,n=E(),r=0,a=[];function i(){Ur.info("destroyed"),F.removeListener(V.PAUSE,d),F.removeListener(V.SUSPEND,d),F.removeListener(V.RESUME,l),F.removeListener(V.WAKE,l),F.removeListener(V.SET_OPTION,f),F.removeListener(V.CLEANUP,i),F.removeListener(p.FINISHED,m),o()}function o(){c(),a=[],r=0,t=void 0,Pr=null}function s(){e=setInterval(g,n)}function c(){clearInterval(e)}function u(){return(new Date).getTime()}function d(){c()}function l(){s()}function f(e){F.validateNotificationData(e,["name"]),e.data.name===j.MOVING_WINDOW_INTERVAL_DELAY&&(n=E(),c(),s())}function m(){c()}function g(){var e=t?u()-t:n;r+=e,t=u(),F.dispatch(p.BROADCASTER_TIME_UPDATE,wr,{position:r,bufferIds:a})}function E(){return z.get(j.MOVING_WINDOW_INTERVAL_DELAY)}return F.addListener(V.PAUSE,d),F.addListener(V.SUSPEND,d),F.addListener(V.RESUME,l),F.addListener(V.WAKE,l),F.addListener(V.SET_OPTION,f),F.addListener(V.CLEANUP,i),F.addListener(p.FINISHED,m),s(),{startInterval:s,reset:o,destroy:i,tickAhead:function(e){r=Math.max(0,r+e)},getPosition:function(){return r},setMovingWindow:g,addBufferId:function(e){a.push(e)}}}()),Pr),u=l.create("".concat(Mr,".").concat(o)),d=Date.now()-e.lastStreamModuleReceived,f=e.segmentStartId+Math.floor((d||0)/s),m=f,g=f,E=e.segmentStartId+Math.floor((e.contentLength||0)/s),v=f,y=e.contentLength?0:null;function T(e){F.validateNotificationData(e,["position"]),b(e.data.position)}function h(e){F.validateNotificationData(e,["position"]),b(e.data.position)}function b(e){a=Fr(),m=A(r=e)||null,c.setMovingWindow()}function S(e){if(F.validateNotificationData(e,["position","bufferIds"]),e.data.bufferIds.includes(o)){var t=v,n=y;if(a){var i=Fr()-a,c=r+i;c>=y&&(y=c)}(X.firstReferenceId||0===X.firstReferenceId)&&(v=X.firstReferenceId+Math.floor(e.data.position/s),g=v-10,E=v+1),I(),(t!==v||n!==y)&&F.dispatch(p.CONTENT_MOVED,Mr,{bufferId:o,currentId:v,playPosition:y,videoTagSegmentId:m})}}function A(e){if("number"!=typeof n||"number"!=typeof e)return v;var r=e-n;return Math.max(0,t+Math.floor(r/s))}function I(){i.startId=g,i.endId=E,i.currentId=v,i.playPosition=y}return F.addListener(O.POSITION,T,F.MAXIMUM_PRIORITY),F.addListener(D.STALLED,h,F.MAXIMUM_PRIORITY),F.addListener(V.SEEK,T,F.MAXIMUM_PRIORITY),F.addListener(p.BROADCASTER_TIME_UPDATE,S),c.addBufferId(o),i={setReferencePoint:function(e,r){t=e,n=r,X.firstReferencePosition=X.firstReferencePosition||n,X.firstReferenceId=X.firstReferenceId||t},getSegmentIdForPosition:function(e){c.setMovingWindow();var t=A(e);return t>=g&&t<=E?t:void 0},setContentEnd:function(e){E=e,I()},broadcasterTickAhead:c.tickAhead,destroy:function(){u.info("destroyed"),F.removeListener(O.POSITION,T),F.removeListener(V.SEEK,T),F.removeListener(D.STALLED,h),F.removeListener(p.BROADCASTER_TIME_UPDATE,S),g=null,E=null,v=null,t=null,n=null,r=null,a=null,I()},getPlayPosition:function(){return y}},I(),i},kr="ContentRangeRecorded",Gr="livePauseHandler",Br=null,Vr=null;function Hr(e,t){return t.findIndex((function(t){var n=t.start,r=t.end;return n<=e&&e<=r}))}var xr,Yr=function(e,t){var n,r,a;function i(t){n=t.data.position,r=e.getSegmentIdForPosition(n),F.addListener(T.SEGMENT_STORAGE_UPDATED,s)}function o(e,t){return e.start<=t&&e.end>=t}function s(e){F.validateNotificationData(e,["streamId","ranges","ids"]),a===e.data.streamId&&function(e){var t=function(e){var t=e.ids.findIndex((function(e){return o(e,r)}));return e.ranges[t]}(e);0!==(t?Math.abs(t.end-t.start):0)&&(o(t,n)?c():function(e){var t=function(e){return e.start>n?e.start:e.end}(e);xr.getSegmentStorage(a).setTimePosition(t),c()}(t))}({ranges:e.data.ranges,ids:e.data.ids})}function c(){n=null,r=null,F.removeListener(T.SEGMENT_STORAGE_UPDATED,s)}return a=t,xr=jn.getInstance(),F.addListener(V.SEEK,i),{setStreamId:function(e){a=e},destroy:function(){return c(),F.removeListener(V.SEEK,i),a=null,xr=null,null}}},Zr=function(e){var t=e.bufferId,n=e.representationsOptions,r=e.lastStreamModuleReceived,a=l.create("ContentLoader.".concat(t)),i=!n.contentLength;X.startTime=X.startTime||(new Date).getTime(),X.isLive=i;var o,s,c,u,d,f,m,g,E={},y={},h=sn(n),S=0,A=0,I=0;function L(){F.removeListener(V.CLEANUP,L),F.removeListener(V.SUSPEND,G),F.removeListener(b.SEGMENT_MISSING,J),F.removeListener(b.SEGMENT_MISSING_BY_ID,te),F.removeListener(v.SEGMENT,W),F.removeListener(v.EMPTY_SEGMENT,Q),F.removeListener(v.FAILED,q),F.removeListener(T.SEGMENT_STORAGE_UPDATED,K),F.removeListener(p.CONTENT_MOVED,H),F.removeListener(p.SWITCH_STREAM,x),F.removeListener(p.CANCEL_STREAM_SWITCH,Y),F.removeListener(R.STREAM_SWITCH,Z),F.removeListener(V.PAUSE,M),F.removeListener(V.SEEK,_),F.removeListener(V.WAKE,B),F.removeListener(v.SEGMENT,$),o=o.destroy(),s&&(s=s.destroy()),c=clearTimeout(c),m=m.destroy(),g&&(g=g.destroy()),E={},P(p.ABORT_DOWNLOAD,{streamId:h}),d&&P(p.ABORT_DOWNLOAD,{streamId:d})}function _(e){I=e.data.position,U(),F.removeListener(V.SEEK,_),F.addListener(qe.SEEK,D,F.MINIMUM_PRIORITY),F.addListener(O.SEEK_COMPLETED,D,F.MINIMUM_PRIORITY)}function D(){F.addListener(p.CONTENT_MOVED,H),F.addListener(V.PAUSE,M),F.removeListener(qe.SEEK,D),F.removeListener(O.SEEK_COMPLETED,D)}function P(e,t){F.dispatch(e,"ContentLoader",t)}function N(e,t,n){if(!function(e,t){return null!==w(e,t)}(e,t)){var r={streamId:e,segmentId:t,contentType:y[e].contentType,reason:n};P(p.REQUEST_SEGMENT,r)}}function C(e,t,n){c=setTimeout((function(){N(e,t,n)}),10)}function w(e,t){var n=E[e];if(!n)return null;for(var r=n.ids,a=0;a<r.length;a+=1){var i=r[a];if(i.start<=t&&t<=i.end)return i}return null}function U(){if(o){var e,t,n=function(){var e=E[h];if(!e)return null;if(!o)return null;var t,n,r,a=e.ranges,i=e.ids,s=(n=function(e){var t=e.start,n=e.end;return I>=t&&I<=n+200},-1===(r=(t=a).slice().reverse().findIndex(n))?-1:t.length-1-r);return-1===s?null:i[s]}();if(n)e=ee.remaining(o.playPosition,E[h].ranges),t=n.end+1;else{e=0,t=o.currentId;var r=w(h,t);r&&(t=r.end+1)}e<function(){if(i)return 1/0;var e=z.get(j.CHUNK_PRELOAD_COUNT);return y[h].segmentLength*e}()&&k(t)&&(N(h,t,"check remaining time"),d&&t>f&&N(d,t,"check remaining time while switching quality"))}}function M(){F.removeListener(V.SEEK,_),F.removeListener(p.CONTENT_MOVED,H),F.removeListener(V.PAUSE,M),F.addListener(V.SEEK,_)}function k(e){return o.startId<=e&&o.endId>=e}function G(){F.removeListener(V.SUSPEND,G),F.removeListener(p.CONTENT_MOVED,H),F.addListener(V.WAKE,B)}function B(){F.removeListener(V.WAKE,B),F.addListener(p.CONTENT_MOVED,H),F.addListener(V.SUSPEND,G)}function H(e){F.validateNotificationData(e,["bufferId","playPosition"]),I=e.data.playPosition,e.data.bufferId===t&&U()}function x(e){if(F.validateNotificationData(e,["bufferId","streamId","position"]),e.data.bufferId===t){if(d===h)return f=void 0,void(d=void 0);if(d===e.data.streamId)return;if(void 0!==(f=o.getSegmentIdForPosition(e.data.position))){N(d=e.data.streamId,f,"start quality change");var n=o.currentId,r=w(h,f);r&&(n=Math.max(n,r.end));for(var i=1;i<=n-f;i+=1)N(d,f+i,"request chunks before contentrange endId")}else a.error("unable to get segmentId for ".concat(e.data.position))}}function Y(e){F.validateNotificationData(e,["bufferId"]),e.data.bufferId===t&&(d&&P(p.ABORT_DOWNLOAD,{streamId:d}),d=void 0,f=void 0)}function Z(e){F.validateNotificationData(e,["bufferId","streamId"]),e.data.bufferId===t&&e.data.streamId===d&&(P(p.ABORT_DOWNLOAD,{streamId:h}),h=d,d=void 0,m.setStreamId(h),g&&g.setStreamId(h),ne())}function K(e){F.validateNotificationData(e,["streamId","ranges","ids"]);var t=e.data.streamId;Object.hasOwnProperty.call(y,t)&&(E[t]={ranges:e.data.ranges,ids:e.data.ids},U())}function W(e){if(F.validateNotificationData(e,["streamId","segmentId","firstTimestamp","duration","segment"]),Object.hasOwnProperty.call(y,e.data.streamId)&&e.data.firstTimestamp!==_e){i&&o.setReferencePoint(e.data.segmentId,e.data.firstTimestamp),e.data.segment.lastSegment&&o.setContentEnd(e.data.segmentId),Math.abs(y[e.data.streamId].segmentLength-e.data.duration)>.2*y[e.data.streamId].segmentLength&&a.warn("unusual segment duration: ".concat(e.data.duration,", segmentId: ").concat(e.data.segmentId)),S+=e.data.duration,A+=y[e.data.streamId].segmentLength;var t=S-A;a.debug("downloaded duration: ".concat(S,", expected duration: ").concat(A,", diff: ").concat(t))}}function Q(e){if(F.validateNotificationData(e,["streamId","segmentId"]),Object.hasOwnProperty.call(y,e.data.streamId)){var t=e.data.segmentId+1;!i&&k(t)&&N(e.data.streamId,t,"zero byte segment")}}function q(e){F.validateNotificationData(e,["streamId","segmentId","status"]),Object.hasOwnProperty.call(y,e.data.streamId)&&i&&404===e.data.status&&(F.removeListener(v.SEGMENT,$),F.addListener(v.SEGMENT,$,F.MAXIMUM_PRIORITY))}function $(e){F.validateNotificationData(e,["streamId","segmentId","firstTimestamp"]),Object.hasOwnProperty.call(y,e.data.streamId)&&(F.removeListener(v.SEGMENT,$),o.broadcasterTickAhead(-1e3))}function J(e){if(F.validateNotificationData(e,["streamId","position"]),Object.hasOwnProperty.call(y,e.data.streamId)){var t=o.getSegmentIdForPosition(e.data.position);void 0!==t?C(e.data.streamId,t,"segment missing by position"):a.error("unable to get segmentId for position: ".concat(e.data.position))}}function te(e){F.validateNotificationData(e,["streamId","segmentId"]),Object.hasOwnProperty.call(y,e.data.streamId)&&k(e.data.segmentId)&&C(e.data.streamId,e.data.segmentId,"segment missing by id")}function ne(){u.baseUrl=y[h].baseUrl,u.segmentUrl=y[h].segmentUrl,u.initUrl=y[h].initUrl,u.streamId=h}return a.debug("init",{bufferId:t,activeStreamId:h,representations:n}),F.addListener(V.CLEANUP,L),F.addListener(V.SUSPEND,G),F.addListener(b.SEGMENT_MISSING,J),F.addListener(b.SEGMENT_MISSING_BY_ID,te),F.addListener(v.SEGMENT,W),F.addListener(v.EMPTY_SEGMENT,Q),F.addListener(v.FAILED,q),F.addListener(T.SEGMENT_STORAGE_UPDATED,K),F.addListener(p.CONTENT_MOVED,H),F.addListener(p.SWITCH_STREAM,x),F.addListener(p.CANCEL_STREAM_SWITCH,Y),F.addListener(R.STREAM_SWITCH,Z),y[h]=n,function(e){var n,a=y[h];if(!a.contentLength)return o=jr({bufferId:t,segmentStartId:e,segmentLength:a.segmentLength,lastStreamModuleReceived:r}),s=function(e){return Br||(Br=function(e){function t(){var r=e.getPlayPosition()||X.firstReferencePosition,a=Date.now()-Vr;F.dispatch(V.SEEK,Gr,{position:r+a}),F.removeListener(V.RESUME,t),F.addListener(qe.SEEK,n)}function n(){F.addListener(V.PAUSE,r),F.removeListener(qe.SEEK,n)}function r(){Vr=Date.now(),F.addListener(V.RESUME,t),F.removeListener(V.PAUSE,r)}return F.addListener(V.PAUSE,r),F.dispatch(p.ATLAS_FULLY_INITIALIZED,Gr),{destroy:function(){F.removeListener(V.RESUME,t),F.removeListener(V.PAUSE,r),F.removeListener(qe.SEEK,n),Br=null,Vr=null}}}(e)),Br}(o),F.addListener(V.PAUSE,M),void F.addListener(V.SEEK,_);n=X.player&&X.player.element?1e3*X.player.element.currentTime:Date.now()-X.startTime,o=function(e){var t,n,r=e.bufferId,a=e.segmentLength,i=l.create("".concat(kr,".").concat(r)),o=e.segmentStartId,s=o,c=0,u=Math.floor(e.contentLength/a),d=Math.floor(e.startTime/a),f=e.contentLength?0:null;function m(e){F.validateNotificationData(e,["position"]),t=e.data.position,s=E(t)||null,g(e)}function g(e){F.validateNotificationData(e,["position"]);var t=d,n=f;f=e.data.position,d=o+Math.floor(f/a),v(),(t!==d||n!==f)&&F.dispatch(p.CONTENT_MOVED,kr,{bufferId:r,currentId:d,playPosition:f,videoTagSegmentId:s})}function E(e){return Math.floor(e/a)}function v(){n.currentId=d,n.playPosition=f,n.startId=c,n.endId=u}return F.addListener(V.SEEK,g),F.addListener(st.GAP_RECOVERING,g),F.addListener(O.POSITION,m,F.MAXIMUM_PRIORITY),n={getSegmentIdForPosition:E,setContentEnd:function(e){u=e,v()},destroy:function(){i.info("destroyed"),F.removeListener(V.SEEK,g),F.removeListener(st.GAP_RECOVERING,g),F.removeListener(O.POSITION,m),c=null,u=null,d=null,t=null,v()}},v(),F.dispatch(p.ATLAS_FULLY_INITIALIZED,kr),n}({bufferId:t,segmentStartId:e,segmentLength:a.segmentLength,contentLength:a.contentLength,startTime:n})}(y[h].segmentId),m=Yr(o,h),i&&(g=function(e){var t=e.contentRange,n=e.streamId,r=e.bufferId,a=l.create("StorageGapRecovery.".concat(r)),i=null,o=null,s=1;function c(e){F.validateNotificationData(e,["streamId","ranges"]);var n=e.data,r=n.streamId,c=n.ranges,u=void 0===c?[]:c;if(r===i&&!(s>0||u.length<=1)){var d=o.getSegmentStorage(i),l=d.activeFragmentStartTime,f=Hr(l,u);if(-1!==f&&f!==u.length-1){var p=Hr(t.playPosition,u);if(-1===p||p!==f){var m=u[u.length-1].start;a.warn("gap in the segment storage",{activeStreamId:i,currentStartTime:l,nextStartTime:m}),d.setTimePosition(m)}}}}function u(e){F.validateNotificationData(e,["volume"]),s=e.data.volume}return function(){if(i=n,o=jn.getInstance(),X.player&&X.player.element){var e=X.player.element;s=e.volume}F.addListener(T.SEGMENT_STORAGE_UPDATED,c),F.addListener(V.VOLUME,u)}(),{setStreamId:function(e){i=e},destroy:function(){F.removeListener(T.SEGMENT_STORAGE_UPDATED,c),F.removeListener(V.VOLUME,u),i=null,o=null,s=1}}}({contentRange:o,streamId:h,bufferId:t})),y[h].initUrl?N(h,o.currentId,"start with header"):N(h,o.currentId,"start with segment"),u={update:function(e){var t=sn(e);y[t]=e},destroy:L},ne(),u},Kr=function(e){var t,n,r,a=l.create("Representation.".concat(e.contentType)),i=sn(e),o="".concat(e.contentType,';codecs="').concat(e.codecs,'"'),s=0,c=!1;function u(e,t){F.dispatch(e,"buffer",t)}function d(){F.removeListener(V.SUSPEND,d),F.addListener(V.WAKE,f)}function f(){F.addListener(V.SUSPEND,d),F.removeListener(V.WAKE,f),m()}function m(){u(p.ADD_BUFFER,{streamId:i,contentType:o})}function g(e,t){var n=wn.getRepresentation(e),r=wn.getRepresentation(t);return n.label!==r.label||n.country!==r.country||n.language!==r.language?"language":"quality"}function E(e){"BufferManager"===e.originId.split(":")[1]&&m()}function v(e){F.validateNotificationData(e,["position"]),s=e.data.position}function y(r){if(F.validateNotificationData(r,["bufferId","contentType"]),r.data.contentType===o){F.removeListener(C.BUFFER_ADDED,y),t=r.data.bufferId,a.debug("onBufferAdded ".concat(t));var s=wn.getRepresentation(i);n=Zr({bufferId:t,representationsOptions:s,lastStreamModuleReceived:e.lastStreamModuleReceived})}}function T(e){F.validateNotificationData(e,["streamId","position"]),c&&e.data.streamId===i&&u(p.SWITCH_STREAM,{bufferId:t,streamId:r,position:e.data.position})}function h(e){if(F.validateNotificationData(e,["bufferId","streamId"]),e.data.bufferId===t){u("language"===g(i,r)?p.LANGUAGE_CHANGE_COMPLETED:p.QUALITY_CHANGE_COMPLETED,{prevStreamId:i,activeStreamId:r}),wn.removeRepresentation(i);var n=wn.getRepresentation(e.data.streamId);wn.addRepresentation(n,e.data.streamId,"active"),c=!1,i=e.data.streamId,r=void 0,S()}}function S(){var e=wn.getRepresentation(i);z.set(j.MOVING_WINDOW_INTERVAL_DELAY,e.segmentLength/10)}return wn.addRepresentation(e,i,"active"),S(),Hn(i,e),F.addListener(V.CLEANUP,(function e(){F.removeListener(V.CLEANUP,e),F.removeListener(V.SUSPEND,d),F.removeListener(V.WAKE,d),F.removeListener(se.CREATE,E),F.removeListener(C.BUFFER_ADDED,y),F.removeListener(O.POSITION,v),F.removeListener(b.KEYFRAME_POSITION,T),F.removeListener(R.STREAM_SWITCH,h),Yn(i),r&&Yn(r),i=void 0,t=void 0,o=void 0,n=void 0,s=0,r=void 0,c=!1,wn.cleanup()})),F.addListener(V.SUSPEND,d),F.addListener(se.CREATE,E),F.addListener(C.BUFFER_ADDED,y),F.addListener(O.POSITION,v),F.addListener(b.KEYFRAME_POSITION,T),F.addListener(R.STREAM_SWITCH,h),m(),{updateHash:function(e){var t=sn(e);Hn(t,e)},update:function(e){var d=sn(e);Hn(d,e);var l=d===i?"active":"requested";wn.addRepresentation(e,d,l),n&&n.update(e),c&&d!==r&&(a.debug("cancel stream switch",{activeStreamId:i,targetStreamId:r}),u("language"===g(i,r)?p.LANGUAGE_CHANGE_CANCELLED:p.QUALITY_CHANGE_CANCELLED,{activeStreamId:i,targetStreamId:r}),wn.removeRepresentation(r),u(p.CANCEL_KEYFRAME_REQUEST,{streamId:i}),u(p.CANCEL_STREAM_SWITCH,{bufferId:t,streamId:r}),r=void 0,c=!1),c||d===i||function(e){r=e,c=!0;var n=wn.getRepresentation(e).segmentLength;a.debug("switch stream, searching switch position",{activeStreamId:i,targetStreamId:r,playPosition:s,segmentLength:n}),u("language"===g(i,r)?p.LANGUAGE_CHANGE_STARTED:p.QUALITY_CHANGE_STARTED,{activeStreamId:i,targetStreamId:r}),o.indexOf("video")>-1?u(p.REQUEST_KEYFRAME_POSITION,{after:s,streamId:i}):u(p.SWITCH_STREAM,{bufferId:t,streamId:r,position:s})}(d)},destroy:function(){wn.removeRepresentation(i),wn.removeRepresentation(r),n.destroy()}}};function Wr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Qr="SegmentedController";function zr(e,t){F.dispatch(e,Qr,t)}var Xr=function(e){var t,n,r=l.create(Qr),a=1/0,o=!1,s=!1;function c(e){F.validateNotificationData(e,["position"]),a=Math.min(a,e.data.position),r.info("last segment reached, content finishes at ".concat(a))}function u(e){F.validateNotificationData(e,["position"]),o=!1,g(e.data.position)}function d(e){F.validateNotificationData(e,["position"]),g(e.data.position)}function f(e){F.validateNotificationData(e,["position"]),s=!0,g(e.data.position)}function m(){s=!1}function g(e){e>=a-(s?200:0)&&!o&&(r.info("content finished"),o=!0,n=setTimeout((function(){zr(p.FINISHED)}),10))}function E(){for(var t,n,r=[],a=0;a<e.representations.length;a+=1)n=e.representations[a],(t={}).contentType=n.contentType,t.codecs=n.codecs,t.mediaType=n.contentType,t.initUrl=n.initUrl,t.baseUrl=e.baseUrl,t.segmentUrl=n.segmentUrl,t.segmentId=e.segmentId,t.segmentLength=n.segmentLength||5e3,t.hashes=e.hashes,t.contentLength=e.contentLength,t.contentStart=e.contentStart,t.lastStreamModuleReceived=e.lastStreamModuleReceived,t.label=n.label,t.country=n.country,t.language=n.language,r.push(t);return r}function v(n){F.validateNotificationData(n,["hashes"]),e=Object.assign(e,{hashes:n.data.hashes}),E().forEach((function(e){var n=e.mediaType;t[n]&&t[n].updateHash(e)}))}function y(n){F.validateNotificationData(n,["options"]),e=n.data.options;for(var r=E(),a=[],i=0;i<r.length;i+=1){if(Object.hasOwnProperty.call(t,r[i].mediaType))t[r[i].mediaType].update(r[i]);else{if(["video/mp4","audio/mp4"].includes(r[i].mediaType))return void zr(p.NEW_REPRESENTATION,{mediaType:r[i].mediaType});t[r[i].mediaType]=Kr(r[i])}a.push(r[i].mediaType)}Object.entries(t).forEach((function(e){var n=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),2!==i.length);o=!0);}catch(e){s=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(s)throw a}}return i}}(e)||function(e,t){if(e){if("string"==typeof e)return Wr(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Wr(e,2):void 0}}(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e),r=n[0],i=n[1];a.indexOf(r)<0&&(i.destroy(),delete t[r])}))}function h(t){var n;F.validateNotificationData(t,["bufferId","contentType"]),-1!==t.data.contentType.indexOf(i.VTT)&&function(e,t){tn[e]||(tn[e]=t)}(t.data.bufferId,(n=i.VTT,e.representations.filter((function(e){return e.contentType===n}))[0]))}return e.contentLength&&(a=void 0!==e.contentStart?e.contentStart:0,a+=e.contentLength),function(e){t={};for(var n=0;n<e.length;n+=1)Object.hasOwnProperty.call(t,e[n].mediaType)?r.warn("duplicated media type: ".concat(e[n].mediaType)):t[e[n].mediaType]=Kr(e[n])}(E()),F.addListener(T.EOS_POSITION_DETECTED,c),F.addListener(O.POSITION,d),F.addListener(O.BUFFER_EMPTY,f),F.addListener(O.BUFFER_FULL,m),F.addListener(V.SEEK,u),F.addListener(V.CLEANUP,(function e(){F.removeListener(T.EOS_POSITION_DETECTED,c),F.removeListener(O.POSITION,d),F.removeListener(O.BUFFER_EMPTY,f),F.removeListener(O.BUFFER_FULL,m),F.removeListener(V.SEEK,u),F.removeListener(V.CLEANUP,e),F.removeListener(V.UPDATE_OPTIONS,y),F.removeListener(V.UPDATE_HASHES,v),F.removeListener(C.BUFFER_ADDED,h),s=!1,t=null,n=clearTimeout(n),zr(se.DESTROY)})),F.addListener(V.UPDATE_OPTIONS,y),F.addListener(V.UPDATE_HASHES,v),F.addListener(C.BUFFER_ADDED,h),zr(se.CREATE),{name:Qr}};function qr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){s=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(s)throw a}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return $r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$r(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Jr=l.create("URLTools"),ea=function(e){Jr.debug("serializeURLVariables ",e);var t=[];return Object.entries(e).forEach((function(e){var n=qr(e,2),r=n[0],a=n[1];t.push("".concat(r,"=").concat(a))})),t.join("&")};function ta(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var na="FLVSegmenterController",ra=l.create(na);function aa(e,t){F.dispatch(e,na,t)}var ia=function(e){var t,n,r,a,i,o,s,c,u=sn(e),d=!1,l=0;function f(){F.removeListener(V.CLEANUP,f),F.removeListener(en.METADATA,h),F.removeListener(en.FAILED,y),F.removeListener(C.BUFFER_ADDED,_),F.removeListener(v.LOAD_COMPLETE,L),F.removeListener(T.SEGMENT_STORAGE_UPDATED,E),F.removeListener(V.UPDATE_OPTIONS,D),F.removeListener(se.CREATE,m),F.removeListener(b.SEGMENT_MISSING,S),F.removeListener(V.SEEK,A),F.removeListener(O.POSITION,A),F.removeListener(O.POSITION,I),F.removeListener(O.BUFFER_EMPTY,I),aa(se.DESTROY)}function m(e){var t=e.originId.split(":")[1];ra.warn("onComponentCreate ".concat(t," ").concat("DownloadQueue")),"DownloadManager"===t&&g()}function g(){aa(p.LOAD_MOVIE_META,{url:"".concat(i,"?").concat(ea(o)),streamId:u})}function E(e){F.validateNotificationData(e,["streamId","ranges","ids"]),e.data.streamId===u&&(void 0===l&&e.data.ranges.length&&(l=e.data.ranges[0].start),s=e.data.ranges,c=e.data.ids,P())}function y(e){F.validateNotificationData(e,["streamId"]),ra.error("onDownloaderFailure"),f()}function h(e){if(F.validateNotificationData(e,["streamId","metadata"]),u===e.data.streamId)if(ra.debug("onDownloaderMetadata",e.data.metadata),e.data.metadata.segments){r=e.data.metadata.contentLength,a=e.data.metadata.contentSize,n=e.data.metadata.segments.positions,t=e.data.metadata.segments.times;for(var i=1;i<t.length;i+=1)t[i]===t[i-1]&&(t.splice(i,1),n.splice(i,1),i-=1);aa(p.ADD_BUFFER,{streamId:u,contentType:"flv"})}else ra.error("onDownloaderMetadata : no segment info in metadata, unable to continue"),f()}function S(e){F.validateNotificationData(e,["streamId","position"]),e.data.streamId===u&&(l=e.data.position,P())}function A(e){F.validateNotificationData(e,["position"]),l=e.data.position,P()}function I(e){F.validateNotificationData(e,["position"]);var t=e.type===O.BUFFER_EMPTY?200:0;e.data.position>=r-t&&(ra.info("content finished"),aa(p.FINISHED))}function L(e){F.validateNotificationData(e,["streamId"]),e.data.streamId===u&&(ra.debug("download complete"),d=!1)}function _(e){F.validateNotificationData(e,["streamId"]),R()}function D(e){F.validateNotificationData(e,["options"]),w(e.data.options)}function P(){ee.remaining(l,s)<5e3&&!d&&R()}function R(){var f=ee.current(l,s),m=f?c[s.indexOf(f)]:null,g=m?m.end+1:function(e){for(var n=1;n<t.length;n+=1)if(t[n]>e)return n-1;return 1/0}(l),E=function(e){for(var n,a,i,o=0,s=0;s<15e3&&e+o<t.length;)s+=(a=e+(o+=1),i=r,(a<(n=t).length?n[a]:i)-t[e]);return o}(g);g!==1/0&&E&&function(s,c){d&&aa(p.ABORT_DOWNLOAD,{streamId:u});for(var l=[],f=[],m=[],g=s;g<s+c;g+=1)l.push(g),m.push(N(n,a,g)),f.push(N(t,r,g));o[e.seekParameter]=n[s];var E="".concat(i,"?").concat(ea(o));d=!0,aa(p.LOAD_SEGMENT,{streamId:u,segmentIds:l,segmentDurations:f,segmentSizes:m,url:E})}(g,E)}function N(e,t,n){return(n<e.length-1?e[n+1]:t)-e[n]}function w(e){var t,n=(1,function(e){if(Array.isArray(e))return e}(t=e.url.split("?"))||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),1!==i.length);o=!0);}catch(e){s=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(s)throw a}}return i}}(t)||function(e,t){if(e){if("string"==typeof e)return ta(e,1);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ta(e,1):void 0}}(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());i=n[0],o=function(e){Jr.debug("parseURLVariables ".concat(e));var t,n={};if(-1!==e.indexOf("?")){t=e.split("?")[1].split("&");for(var r=0;r<t.length;r+=1){var a=qr(t[r].split("="),2),i=a[0],o=a[1];n[i]=o}}return n}(e.url)}return w(e),wn.addRepresentation(e,u,"active"),ra.debug("baseUrl: ".concat(i),o),o.ri=0,o.rs=0,F.addListener(V.CLEANUP,f),F.addListener(en.METADATA,h),F.addListener(en.FAILED,y),F.addListener(C.BUFFER_ADDED,_),F.addListener(v.LOAD_COMPLETE,L),F.addListener(T.SEGMENT_STORAGE_UPDATED,E),F.addListener(V.UPDATE_OPTIONS,D),F.addListener(se.CREATE,m),F.addListener(b.SEGMENT_MISSING,S),F.addListener(V.SEEK,A),F.addListener(O.POSITION,A),F.addListener(O.POSITION,I),F.addListener(O.BUFFER_EMPTY,I),aa(se.CREATE),aa(p.ATLAS_FULLY_INITIALIZED,na),g(),{name:na}},oa="DirectController";function sa(e,t){F.dispatch(e,oa,t)}var ca="GarbageCollector",ua="unused",da="used",la="switch",fa=.8,pa=l.create(ca);function ma(){return z.get(j.MEMORY_LIMIT_IN_BYTES)}function ga(e,t){F.dispatch(e,ca,t)}var Ea=function(){var e=0,t=!1,n={},r={},a=null;function i(){var n=ma();return e>n*(t?fa:1)}function o(c){F.validateNotificationData(c,["streamId"]);var u=ma();if(!i())return t=!1,pa.info("memory usage is back to normal",{memoryLimit:u,limitThreshold:u*fa,memoryUsage:e}),void F.removeListener(T.SEGMENT_STORAGE_UPDATED,o);var d=Object.getOwnPropertyNames(n).sort(s),l=!!d.length&&d.shift();if(!function(e){return n[e].usage===da||n[e].usage===la}(l)&&n[l].size>e-u)return a.removeSegmentStorage(l),void delete n[l];var f=!!l&&function(e){return function(e){return n[e]&&n[e].ids.length&&n[e].ids[0].start<r[e]}(e)?In.DISCARD_START_SEGMENT:!!function(e){return n[e]&&n[e].ids.length&&n[e].ids[n[e].ids.length-1].end>r[e]}(e)&&In.DISCARD_END_SEGMENT}(l);f?(t=!0,ga(f,{streamId:l})):(pa.warn("memory usage is high but there is no segment to discard",{memoryLimit:u,limitThreshold:u*fa,memoryUsage:e}),F.removeListener(T.SEGMENT_STORAGE_UPDATED,o))}function s(e,t){if(n[e].usage!==n[t].usage){if(n[t].usage===ua)return 1;if(n[e].usage===ua)return-1;if(n[t].usage===da)return 1;if(n[e].usage===da)return-1}return n[t].length-n[e].length}function c(e,t){if(t!==ua){var r={mediaType:cn(e).mediaType,usage:t};Object.keys(n).forEach((function(e){(function(e,t){if(Object.hasOwnProperty.call(n,e))return!1;for(var r=Object.keys(t),a=0;a<r.length;a+=1){var i=r[a];if(e[i]!==t[i])return!1}return!0})(e,r)&&(n[e].usage=ua)})),n[e]=n[e]||{},n[e].usage=t}else n[e].usage=t}function u(t){F.validateNotificationData(t,["streamId","size","ranges","ids"]),n[t.data.streamId]=n[t.data.streamId]||{};var r=n[t.data.streamId];r.ids=t.data.ids,r.size=t.data.size,r.ranges=t.data.ranges,r.length=function(e){for(var t=0,n=0;n<e.length;n+=1)t+=e[n].end-e[n].start;return t}(t.data.ranges),r.usage=r.usage||ua,r.mediaType=cn(t.data.streamId).mediaType,e=0,Object.values(n).forEach((function(t){var n;e+=null!==(n=null==t?void 0:t.size)&&void 0!==n?n:0}))}function d(n){F.validateNotificationData(n,["streamId","segmentId"]),r[n.data.streamId]=n.data.segmentId,c(n.data.streamId,da),t||function(t){if(i()){var n=ma();pa.info("memory usage exceeds limit",{memoryLimit:n,limitThreshold:n*fa,memoryUsage:e}),F.addListener(T.SEGMENT_STORAGE_UPDATED,o,F.MINIMUM_PRIORITY),o(t)}}(n)}function l(e){F.validateNotificationData(e,["streamId"]),c(e.data.streamId,da)}function f(e){F.validateNotificationData(e,["streamId"]),c(e.data.streamId,la)}function p(e){F.validateNotificationData(e,["limit"]),pa.warn("apiEvents.SET_MAX_MEMORY_USAGE is deprecated, use the options module!"),z.set(j.MEMORY_LIMIT_IN_BYTES,e.data.limit)}return pa.debug("init"),F.addListener(T.SEGMENT_STORAGE_UPDATED,u),F.addListener(b.SEGMENT_CHANGE,d),F.addListener(R.STREAM_SWITCH,l),F.addListener(C.BUFFER_ADDED,f),F.addListener(V.SET_MAX_MEMORY_USAGE,p),F.addListener(V.CLEANUP,(function e(){F.removeListener(T.SEGMENT_STORAGE_UPDATED,u),F.removeListener(T.SEGMENT_STORAGE_UPDATED,o),F.removeListener(b.SEGMENT_CHANGE,d),F.removeListener(R.STREAM_SWITCH,l),F.removeListener(C.BUFFER_ADDED,f),F.removeListener(V.SET_MAX_MEMORY_USAGE,p),F.removeListener(V.CLEANUP,e),n=null,r=null,a=null,ga(se.DESTROY)})),a=jn.getInstance(),ga(se.CREATE),{name:ca}},va=l.create("ComponentFactory");function ya(e){return e.some((function(e){return e.contentType===i.VTT}))}var Ta=function(e,t){!function(e,t){switch(t.format){case i.MP4_SEGMENTED:Ft.create(t).initVideo(e),ke(t.contentLength),ya(t.representations)&&En.create(t),function(){var e,t,n,r,a=[],i=!1,o={},s={},c={},u=0;function d(){for(i=!0;a.length;){var t=a.shift();m(t.streamId,t.contentType)}e=setInterval(S,1e3)}function l(){i=!1,E(),clearInterval(e)}function f(e){F.validateNotificationData(e,["streamId","contentType"]),i?m(e.data.streamId,e.data.contentType):a.push({streamId:e.data.streamId,contentType:e.data.contentType})}function m(e,t){var n,a=t.split("/")[0],i=Object.keys(o).filter((function(e){return e.indexOf(a)>-1}))[0];i?n=i:(n="".concat(a,".").concat(xe(3)),o[n]=fr(n,e,t)),X.firstReferencePosition&&r.getSegmentStorage(e).setTimePosition(X.firstReferencePosition+(Date.now()-X.startTime)),s[n]=[],Er(C.BUFFER_ADDED,{streamId:e,bufferId:n,contentType:t})}function g(e){Object.hasOwnProperty.call(o,e)&&(delete o[e],delete s[e],delete c[e],Er(C.BUFFER_REMOVED,{bufferId:e}))}function E(){Object.keys(o).forEach((function(e){return g(e)}))}function v(e){F.validateNotificationData(e,["bufferId"]),g(e.data.bufferId)}function y(e){F.validateNotificationData(e,["bufferId"]),c[e.data.bufferId]=!0}function h(e){F.validateNotificationData(e,["bufferId","ranges"]),c[e.data.bufferId]=!1,s[e.data.bufferId]=e.data.ranges,S()}function b(e){F.validateNotificationData(e,["position"]),u=e.data.position,S()}function S(){var e,r=function(){var e=["audio","video"].filter((function(e){return(X.representations||[]).some((function(t){return t.mediaType.indexOf(e)>-1}))}));return Object.getOwnPropertyNames(s).reduce((function(t,n){var r=n.split(".")[0];return-1!==e.indexOf(r)&&(t[n]=s[n]),t}),{})}(),a=(e=r,Object.getOwnPropertyNames(e).every((function(n){var r=e[n];return ee.remainingTotal(u,r)>=t}))),i=Object.getOwnPropertyNames(r).map((function(e){return r[e]})),o=ee.intersect.apply(null,i),d=ee.remainingTotal(u,o);a&&d<n?t+=1e3:t=z.get(j.MINIMUM_REMAINING_THRESHOLD),Object.entries(s).forEach((function(e){var n,r=function(e){if(Array.isArray(e))return e}(n=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),2!==i.length);o=!0);}catch(e){s=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(s)throw a}}return i}}(n)||function(e,t){if(e){if("string"==typeof e)return pr(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?pr(e,2):void 0}}(n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),a=r[0],i=r[1];if(!c[a]){var o=ee.remainingTotal(u,i);o||!X.representations||function(e){var t=e.substring(0,e.indexOf("."));return X.representations.some((function(e){return e.mediaType.indexOf(t)>-1}))}(a)?o<t&&Er(C.APPEND_TO_BUFFER,{bufferId:a}):g(a)}}))}gr.debug("create"),F.addListener($.SOURCE_OPEN,d),F.addListener($.SOURCE_CLOSE,l),F.addListener(p.ADD_BUFFER,f),F.addListener(p.REMOVE_BUFFER,v),F.addListener(V.CLEANUP,(function n(){F.removeListener($.SOURCE_OPEN,d),F.removeListener($.SOURCE_CLOSE,l),F.removeListener(p.ADD_BUFFER,f),F.removeListener(p.REMOVE_BUFFER,v),F.removeListener(V.CLEANUP,n),F.removeListener(R.BUFFER_UPDATING,y),F.removeListener(R.BUFFER_UPDATED,h),F.removeListener(O.POSITION,b),F.removeListener(V.SEEK,b),F.removeListener(T.SEGMENT_STORAGE_UPDATED,S),F.removeListener($.SOURCE_BUFFER_ADDED,S),F.removeListener(Nt.EMPTY_CUE_ADDED,S),E(),clearInterval(e),o=null,a=null,u=null,s=null,c=null,t=null,Er(se.DESTROY)})),F.addListener(R.BUFFER_UPDATING,y),F.addListener(R.BUFFER_UPDATED,h),F.addListener(O.POSITION,b),F.addListener(V.SEEK,b),F.addListener(T.SEGMENT_STORAGE_UPDATED,S),F.addListener($.SOURCE_BUFFER_ADDED,S),F.addListener(Nt.EMPTY_CUE_ADDED,S),t=z.get(j.MINIMUM_REMAINING_THRESHOLD),n=z.get(j.COLDSTART_THRESHOLD),Er(se.CREATE),r=jn.getInstance()}(),On(),Xn(),jn.create(),Ir(),Cr();break;case i.HLS:case i.MP4_MOVIE:Ft.create(t).initVideo(e);break;case i.FLV_MOVIE:case i.FLV_SEGMENTED:(function(e,t){var n,r,a=function(){var e=z.get(j.FLASH_PROXY_URL_SECURE),t=z.get(j.FLASH_PROXY_URL_PLAIN);if(void 0!==e&&void 0!==t)return"".concat(Le.ssl?e:t,"/player/atlas/atlas-4.0.0.swf");We.error("flash url is missing")}(),i="atlas.".concat(xe(3));function o(e){e.type===g.LOG?l.log(e.data.source,e.data.line,e.data.data,e.data.level):0!==e.originId.indexOf("Flash:")&&r&&r.dispatch(e.type,e.originId,e.data?encodeURIComponent(JSON.stringify(e.data)):null)}(n=function(e){var t=e.split("."),n=window;for(t.shift();t.length;)n[t[0]]||(n[t[0]]={}),n=n[t.shift()];return n}(Ke+i)).ready=function(){r=document.getElementById(i),Qe(se.CREATE)},n.dispatch=function(e){F.dispatch(e.type,e.originId,e.data?JSON.parse(decodeURIComponent(e.data)):null)},function(){var t=document.createElement("div");t.id=i,document.getElementById(e).appendChild(t);var n={url:a,width:"100%",height:"100%",minVersion:"11.0.0",params:{wmode:"opaque",allowfullscreen:!0,bgcolor:"#000000",allowscriptaccess:"always"},flashVars:{cpath:Ke+i}};He.embedSWF(n.url,i,n.width,n.height,n.minVersion,null,n.flashVars,n.params),X.player={type:"flash",id:i}}(),F.addListener("*",o),F.addListener(V.CLEANUP,(function e(){F.removeListener("*",o),F.removeListener(V.CLEANUP,e),r&&r.parentNode.removeChild(r),delete X.player,function(e){var t=e.split("."),n=window;for(t.shift();t.length>1;)n=n[t.shift()];delete n[t.shift()]}(Ke+i),Qe(se.DESTROY)}))})(e,t.debug),Xn()}}(e,t),function(e){switch(e.format){case i.FLV_MOVIE:Ea(),ia(e);break;case i.FLV_SEGMENTED:case i.MP4_SEGMENTED:Ea(),Xr(e);break;case i.HLS:case i.MP4_MOVIE:!function(e){var t;function n(){sa(qe.SEEK,{position:t}),F.removeListener(D.TIME_UPDATE,n)}function r(){sa(qe.PLAY),F.removeListener(D.EMPTIED,r),!X.isLive&&t>0&&F.addListener(D.TIME_UPDATE,n)}function a(n){F.validateNotificationData(n,["options"]);var a=e.url,i=n.data.options.url;a!==i&&function(e){F.addListener(D.EMPTIED,r),t=1e3*Ft.getCurrentTime(),sa(p.STREAM_URL,{source:e})}(i),e=n.data.options}function i(){sa(p.FINISHED)}function o(){sa(p.STREAM_URL,{source:e.url})}F.addListener(D.ENDED,i),F.addListener(V.CLEANUP,(function e(){F.removeListener(D.ENDED,i),F.removeListener(V.CLEANUP,e),F.removeListener(V.WAKE,o),F.removeListener(D.TIME_UPDATE,n),F.removeListener(V.UPDATE_OPTIONS,a),F.removeListener(D.EMPTIED,r),wn.cleanup(),sa(se.DESTROY)})),F.addListener(V.WAKE,o),F.addListener(V.UPDATE_OPTIONS,a),wn.addRepresentation(e,"direct","active"),sa(p.STREAM_URL,{source:e.url}),sa(p.ATLAS_FULLY_INITIALIZED,oa)}(e)}}(t)};function ha(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){s=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(s)throw a}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ba(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ba(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ba(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Sa(e){return(Sa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Oa,Aa,Ia,La=1,_a=l.create("Atlas"),Da=null;function Pa(){ka(r.ATLAS_FULLY_INITIALIZED)}function Ra(){Ba(),Ia.cleanup(),Ia=null,Aa=null,Da=null,z.cleanup(),Na(),Fa(se.CREATE,Va),Fa(O.ERROR,Ya),Fa(O.POSITION,Wa),Fa(O.RESIZE,Qa),Fa(O.BUFFERED,za),Fa(O.BUFFER_EMPTY,ai),Fa(O.BUFFER_FULL,ai),Fa(O.THROTTLE,ii),Fa(O.CC_DETECTED,oi),Fa(O.AUDIO_TRACKS,di),Fa(O.TEXT_TRACKS,li),Fa(O.SEEK_COMPLETED,gi),Fa(O.WEBKIT_SUPPORTS_FULLSCREEN,ui),Fa(D.WEBKIT_ENTER_FULLSCREEN,si),Fa(D.WEBKIT_END_FULLSCREEN,ci),Fa(O.UNRECOVERED_STALLED,pi),Fa(O.PLAY_ERROR,mi),Fa(qe.SEEK,gi),Fa(Nt.TEXT_TRACK_CUE_CHANGE,fi),Fa(R.BUFFER_UPDATED,za),Fa(v.LOAD_COMPLETE,Ha),Fa(v.FAILED,xa),Fa(T.SEGMENT_STORAGE_UPDATED,ni),Fa(p.FINISHED,ri),Fa(p.CAN_NOT_CREATE_URL,Za),Fa(p.NEW_REPRESENTATION,Ka),Fa(p.QUALITY_CHANGE_STARTED,Xa),Fa(p.QUALITY_CHANGE_CANCELLED,qa),Fa(p.QUALITY_CHANGE_COMPLETED,$a),Fa(p.ATLAS_FULLY_INITIALIZED,Pa),Fa(p.LANGUAGE_CHANGE_STARTED,Ja),Fa(p.LANGUAGE_CHANGE_CANCELLED,ei),Fa(p.LANGUAGE_CHANGE_COMPLETED,ti),Fa(en.METADATA,Ei),Fa(st.GAP_RECOVERING,vi),ja(V.CLEANUP),l.cleanup()}function Na(){Ti.initialized=!!Ia}function Ca(e){Ba(),ja(V.VOLUME,{volume:La=e})}function wa(e,t){Ba(),e===r.LOG?l.addListener(l.events.LOG,t):Ia.addListener(e,t)}function Ua(e,t){Ba(),e===r.LOG?l.removeListener(l.events.LOG,t):Ia.removeListener(e,t)}function Ma(e,t){F.addListener(e,t,F.MINIMUM_PRIORITY)}function Fa(e,t){F.removeListener(e,t)}function ja(e,t){F.dispatch(e,"atlas",t)}function ka(e,t){var n={event:e};"object"===Sa(t)&&null!==t&&Object.entries(t).forEach((function(e){var t=ha(e,2),r=t[0],a=t[1];"event"===r?_a.warn('notify: "event" property ignored on data'):n[r]=a})),Ia.dispatch("Atlas.*",n),Ia.dispatch(e,n)}function Ga(e,t,n){ka(r.ERROR,{error:e,recoverable:n=void 0===n||n,details:t})}function Ba(){if(!Ia)throw new Error("Initialize Atlas before usage!")}function Va(e){var t=e.originId.split(":")[1].split(".")[0];"QueueStreamProxy"!==t&&t!==Ft.name||Ca(La)}function Ha(e){F.validateNotificationData(e,["time","size","url"]);var t={time:e.data.time,size:e.data.size,url:e.data.url};if(window.performance&&"function"==typeof window.performance.getEntriesByName){var n=performance.getEntriesByName(e.data.url);if(n.length){var a=ha(n,1);t.performance=a[0],performance.clearResourceTimings()}}ka(r.BANDWIDTH,t)}function xa(e){F.validateNotificationData(e,["url","status"]),Ga(404===e.data.status||0===e.data.status?a.SEGMENT_NOT_FOUND:a.SEGMENT_LOAD_FAILED,{url:e.data.url,status:e.data.status,reason:e.data.reason})}function Ya(e){F.validateNotificationData(e,["code","message"]);var t={code:e.data.code,message:e.data.message};Ga(a.VIDEO_PLAYER,t,!1),Ra()}function Za(e){F.validateNotificationData(e,["streamId","segmentId","reason"]),Ga(a.CAN_NOT_CREATE_URL,e.data,!1),Ra()}function Ka(e){F.validateNotificationData(e,["mediaType"]),Ga(a.NEW_REPRESENTATION,e.data,!1),Ra()}function Wa(e){F.validateNotificationData(e,["position"]),ka(r.POSITION,{position:e.data.position})}function Qa(e){F.validateNotificationData(e,["width","height"]),Da={width:e.data.width,height:e.data.height}}function za(e){F.validateNotificationData(e,["bufferId","ranges"]),ka(r.BUFFERED,{ranges:e.data.ranges,bufferId:e.data.bufferId})}function Xa(e){F.validateNotificationData(e,["activeStreamId","targetStreamId"]),ka(r.QUALITY_CHANGE_STARTED,{activeStreamId:e.data.activeStreamId,targetStreamId:e.data.targetStreamId})}function qa(e){F.validateNotificationData(e,["activeStreamId","targetStreamId"]),ka(r.QUALITY_CHANGE_CANCELLED,{activeStreamId:e.data.activeStreamId,targetStreamId:e.data.targetStreamId})}function $a(e){F.validateNotificationData(e,["prevStreamId","activeStreamId"]),ka(r.QUALITY_CHANGE_COMPLETED,{prevStreamId:e.data.prevStreamId,activeStreamId:e.data.activeStreamId})}function Ja(e){F.validateNotificationData(e,["activeStreamId","targetStreamId"]),ka(r.LANGUAGE_CHANGE_STARTED,{activeStreamId:e.data.activeStreamId,targetStreamId:e.data.targetStreamId})}function ei(e){F.validateNotificationData(e,["activeStreamId","targetStreamId"]),ka(r.LANGUAGE_CHANGE_CANCELLED,{activeStreamId:e.data.activeStreamId,targetStreamId:e.data.targetStreamId})}function ti(e){F.validateNotificationData(e,["prevStreamId","activeStreamId"]),ka(r.LANGUAGE_CHANGE_COMPLETED,{prevStreamId:e.data.prevStreamId,activeStreamId:e.data.activeStreamId})}function ni(e){F.validateNotificationData(e,["streamId","ranges"]),ka(r.STORED,{ranges:e.data.ranges,streamId:e.data.streamId})}function ri(){ka(r.FINISHED)}function ai(e){switch(e.type){case O.BUFFER_EMPTY:_a.warn("buffer empty"),ka(r.BUFFER_EMPTY);break;case O.BUFFER_FULL:_a.info("buffer full"),ka(r.BUFFER_FULL)}}function ii(e){F.validateNotificationData(e,["state"]),ka(r.THROTTLE,{state:e.data.state})}function oi(){ka(r.X08_DETECTED)}function si(){ka(r.WEBKIT_ENTER_FULLSCREEN)}function ci(){ka(r.WEBKIT_END_FULLSCREEN)}function ui(e){ka(r.WEBKIT_SUPPORTS_FULLSCREEN,e)}function di(e){ka(r.AUDIO_TRACKS,e)}function li(e){ka(r.TEXT_TRACKS,e)}function fi(e){ka(r.TEXT_TRACK_CUE_CHANGE,e)}function pi(e){F.validateNotificationData(e,["position","remaining"]);var t={position:e.data.position,remaining:e.data.remaining};ka(a.UNRECOVERED_STALLED,t)}function mi(e){F.validateNotificationData(e,["error"]);var t={error:e.data.error};Ga(a.PLAY_ERROR,t)}function gi(){ka(r.SEEK_COMPLETED)}function Ei(e){F.validateNotificationData(e,["metadata"]),ka(r.METADATA,{type:"flv",data:e.data.metadata})}function vi(e){F.validateNotificationData(e,["position","gapLength"]),ka(r.GAP_RECOVERING,{gapEndPosition:e.data.position,gapLength:e.data.gapLength})}function yi(){return X.player&&X.player.element?X.player.element:null}var Ti={events:r,errors:a,logLevels:l.levels,formats:i,capabilities:Gt,version:De,internals:X,initialized:!1,initialize:function(e){Oa=e,_a.debug("initializing atlas ".concat(De),{containerId:Oa}),Ia=o(),z.init(),Na(),F.addListener(se.CREATE,Va)},cleanup:Ra,suspend:function(){Ba(),ja(V.SUSPEND)},wake:function(){Ba(),ja(V.WAKE)},play:function(e){if(_a.debug("play",e),Ba(),function(e){var t=!0;if(!e||"object"!==Vt(e))return!1;switch(e.format){case i.MP4_SEGMENTED:return(t=function(e){return!!e.representations&&e.representations.some((function(e){return!!e.contentType&&-1!==e.contentType.indexOf("text")}))}(e)?t&&$t(e,Kt):t&&$t(e,Zt))&&qt(e,xt);case i.FLV_SEGMENTED:return(t=t&&$t(e,Wt))&&qt(e,Yt);case i.FLV_MOVIE:return $t(e,Qt);case i.HLS:return $t(e,zt);case i.MP4_MOVIE:return $t(e,Xt);default:return Ht.error("unrecognized data format: ".concat(e.format)),!1}}(e)){var t,n=!Aa;X.isLive=e.isLive,Aa=e,n?function(e){return-1===Gt.indexOf(e.format)?(va.error("unsupported format",{format:e.format}),!1):!(e.format===i.MP4_SEGMENTED&&!function(e){for(var t,n,r,a=!0,o=0;e.representations&&o<e.representations.length;o+=1)(n=e.representations[o]).contentType===i.VTT?(t='application/mp4; codecs="text/vtt"',r=!0):(t="".concat(n.contentType,';codecs="').concat(n.codecs,'"'),r=Be(t)),r?va.info("playable type",{mediaType:t}):va.error("unplayable type",{mediaType:t}),a=a&&r;return a}(e))}(t=e)?(Ma(O.ERROR,Ya),Ma(O.POSITION,Wa),Ma(O.RESIZE,Qa),Ma(O.BUFFERED,za),Ma(O.BUFFER_EMPTY,ai),Ma(O.BUFFER_FULL,ai),Ma(O.THROTTLE,ii),Ma(O.SEEK_COMPLETED,gi),Ma(O.CC_DETECTED,oi),Ma(O.AUDIO_TRACKS,di),Ma(O.TEXT_TRACKS,li),Ma(O.WEBKIT_SUPPORTS_FULLSCREEN,ui),Ma(D.WEBKIT_ENTER_FULLSCREEN,si),Ma(D.WEBKIT_END_FULLSCREEN,ci),Ma(O.UNRECOVERED_STALLED,pi),Ma(O.PLAY_ERROR,mi),Ma(qe.SEEK,gi),Ma(Nt.TEXT_TRACK_CUE_CHANGE,fi),Ma(R.BUFFER_UPDATED,za),Ma(v.LOAD_COMPLETE,Ha),Ma(v.FAILED,xa),Ma(T.SEGMENT_STORAGE_UPDATED,ni),Ma(p.FINISHED,ri),Ma(p.CAN_NOT_CREATE_URL,Za),Ma(p.NEW_REPRESENTATION,Ka),Ma(p.QUALITY_CHANGE_STARTED,Xa),Ma(p.QUALITY_CHANGE_CANCELLED,qa),Ma(p.QUALITY_CHANGE_COMPLETED,$a),Ma(p.ATLAS_FULLY_INITIALIZED,Pa),Ma(p.LANGUAGE_CHANGE_STARTED,Ja),Ma(p.LANGUAGE_CHANGE_CANCELLED,ei),Ma(p.LANGUAGE_CHANGE_COMPLETED,ti),Ma(en.METADATA,Ei),Ma(st.GAP_RECOVERING,vi),Ta(Oa,t)):Ga(a.UNSUPPORTED):(function(e){e.format===i.MP4_SEGMENTED&&ya(e.representations)&&En.create()}(e),ja(V.UPDATE_OPTIONS,{options:e}))}else Ga(a.INVALID_OPTIONS)},pause:function(){Ba(),ja(V.PAUSE)},resume:function(){Ba(),ja(V.RESUME)},seek:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"user";Ba(),_a.info("seek",{position:e});var n=yi();ka(r.SEEK_STARTED,{from:n&&n.currentTime,to:e/1e3,initiator:t}),ja(V.SEEK,{position:Math.floor(e)})},getOption:function(e){return Ba(),z.get(e)},setOption:function(e,t){return Ba(),z.set(e,t,!0)},optionNames:j,getVideoTag:yi,getFlashObjectSize:function(){return Da},setHash:function(e){Ba(),ja(V.UPDATE_HASHES,{hashes:e})},setVolume:Ca,getVolume:function(){return Ba(),La},setPlaybackSpeed:function(e){Ba(),ja(V.PLAYBACK_SPEED,{speed:e})},setCaptionPosition:function(e){Ba(),ja(V.CAPTION_POSITION,{position:e})},toggleCaptions:function(e){var t=e.trackId,n=e.isVisible;Ba(),ja(V.CAPTIONS,{trackId:t,isVisible:n})},selectAudio:function(e){Ba(),ja(V.SELECT_AUDIO,{id:e})},getVideoMetrics:function(){return Ba(),Ft.getInstance().getMetrics()},on:wa,off:Ua,addListener:wa,removeListener:Ua};Na();var hi=Ti;return t}()}}]);